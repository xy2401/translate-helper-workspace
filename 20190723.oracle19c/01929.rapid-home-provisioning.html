<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="Fleet Patching and Provisioning is a software lifecycle management method for provisioning and maintaining Oracle homes.">
      <meta name="description" content="Fleet Patching and Provisioning is a software lifecycle management method for provisioning and maintaining Oracle homes.">
      <title>Fleet Patching and Provisioning and Maintenance</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Clusterware Administration and Deployment Guide">
      <meta property="og:description" content="Fleet Patching and Provisioning is a software lifecycle management method for provisioning and maintaining Oracle homes.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Clusterware Administration and Deployment Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="clusterware-administration-and-deployment-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-04-24T07:05:38-07:00">
      <meta name="dcterms.title" content="Clusterware Administration and Deployment Guide">
      <meta name="dcterms.dateCopyrighted" content="2007, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E95727-05">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="oracle-flex-clusters.html" title="Previous" type="text/html">
      <link rel="next" href="managing-oracle-cluster-registry-and-voting-files.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="CWADD">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="oracle-flex-clusters.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="managing-oracle-cluster-registry-and-voting-files.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Clusterware Administration and Deployment Guide</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Fleet Patching and Provisioning and Maintenance</li>
            </ol>
            <a id="GUID-CCEC5960-EDA4-4A3F-9643-0CA308EA49AA" name="GUID-CCEC5960-EDA4-4A3F-9643-0CA308EA49AA"></a><a id="CWADD92402"></a>
            
            <h2 id="CWADD-GUID-CCEC5960-EDA4-4A3F-9643-0CA308EA49AA" class="sect2"><span class="enumeration_chapter">5 </span>Fleet Patching and Provisioning and Maintenance
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>Fleet Patching and Provisioning is a software lifecycle management method for provisioning and maintaining Oracle homes.</p>
               <p>Fleet Patching and Provisioning enables mass deployment and maintenance of standard operating environments for databases, clusters, and user-defined software types. With Fleet Patching and Provisioning, you can also install clusters and provision, patch, scale, and upgrade Oracle Grid Infrastructure and Oracle Database 11<span class="italic">g</span> release 2 (11.2), and later. Additionally, you can provision applications and middleware.
               </p>
               <div class="p">Fleet Patching and Provisioning is a service in Oracle Grid Infrastructure that you can use in either of the following modes:
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>As a central server (<a href="glossary.html#GUID-9B0F2E98-277F-478E-8D49-3216423E061C"><span class="xrefglossterm">Fleet Patching and Provisioning Server</span></a>), that stores and manages standardized <a href="glossary.html#GUID-2241F26E-0652-46E7-A3C4-B8EBC0939F3E"><span class="xrefglossterm">image</span></a>s, called <a href="glossary.html#GUID-FE7C4C15-DA65-4737-B310-3284EB59EBA0"><span class="xrefglossterm">gold image</span></a>s. You can deploy gold images to any number of nodes across a data center. You can use the deployed homes to create new clusters and databases, and patch, upgrade, and scale existing installations.
                        </p>
                        <p>The server manages software homes on the cluster hosting the Fleet Patching and Provisioning Server, itself, Fleet Patching and Provisioning Clients, and can also manage installations running Oracle Grid Infrastructure 11<span class="italic">g</span> release 2 (11.2.0.3 and 11.2.0.4) and 12<span class="italic">c</span> release 1 (12.1.0.2). The server can also manage installations running no grid infrastructure.
                        </p>
                        <p>A Fleet Patching and Provisioning Server can provision new installations and can manage existing installations without any changes to the existing installations (such as no agent, daemon, or configuration prerequisites). Fleet Patching and Provisioning Servers also include capabilities for automatically sharing gold images among peer Fleet Patching and Provisioning Servers to support enterprises with geographically distributed data centers.</p>
                     </li>
                     <li>
                        <p>As a client (Fleet Patching and Provisioning Client), that can be managed from the central Fleet Patching and Provisioning Server or directly by running commands on the Fleet Patching and Provisioning Client, itself. As with the Fleet Patching and Provisioning Server, the Fleet Patching and Provisioning Client is a service built in to Oracle Grid Infrastructure and is available with Oracle Grid Infrastructure 12<span class="italic">c</span> release 2 (12.2.0.1), and later. The Fleet Patching and Provisioning Client service can retrieve gold images from the Fleet Patching and Provisioning Server, upload new images based on policy, and apply maintenance operations to itself.
                        </p>
                     </li>
                  </ul>
               </div>
               <p>For patching operations, a third option is available with Oracle Database and Oracle Grid Infrastructure 18c. The procedures for updating database and grid infrastructure homes have been modularized into independent <span class="italic">automatons</span> that are included with Oracle Database and Oracle Grid Infrastructure, and can be run locally without any central Fleet Patching and Provisioning Server in the architecture. This provides an immediate entry point to the capabilities of Fleet Patching and Provisioning as soon as you bring up an Oracle Database or cluster.
               </p>
               <div class="p">Managing Oracle software using Fleet Patching and Provisioning:
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Ensures standardization and enables high degrees of automation with gold images and managed lineage of deployed software.</p>
                     </li>
                     <li>
                        <p>Minimizes the maintenance window by deploying new homes (gold images) out-of-place, without disrupting active databases or clusters.</p>
                     </li>
                     <li>
                        <p>Simplifies maintenance by providing automatons that are invoked with an API across database versions and deployment models.</p>
                     </li>
                     <li>
                        <p>Reduces maintenance risk with built-in validations and a dry-run mode to ensure operations will succeed end-to-end.</p>
                     </li>
                     <li>
                        <p>In the event of an issue, commands are resumable and restartable, further reducing risk of maintenance operations.</p>
                     </li>
                     <li>
                        <p>Minimizes and, in many cases, eliminates the impact of patching and upgrades, with features that include:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Zero-downtime database upgrade: A fully-automated upgrade executed entirely within the deployment with no extra nodes or external storage required.</p>
                           </li>
                           <li>
                              <p>Adaptive management of database sessions and OJVM during rolling patching.</p>
                           </li>
                           <li>
                              <p>Options for fine-grained management of consolidated deployments.</p>
                           </li>
                        </ul>
                     </li>
                  </ul>
               </div>
               <p>The deployment and maintenance operations are extensible, allowing customizations to include environment-specific actions into the automated workflow.</p>
               <div class="section">
                  <p class="subhead1" id="GUID-CCEC5960-EDA4-4A3F-9643-0CA308EA49AA__GUID-F2D6C009-800E-4077-B779-C2EEF7044782">Fleet Patching and Provisioning Automatons</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><span class="italic">Zero-downtime database upgrade</span> automates all of the steps involved in a database upgrade to minimize or even eliminate application downtime while upgrading an Oracle database. It also minimizes resource requirements and provides a fallback path in case the upgrade must be rolled back.
                        </p>
                     </li>
                     <li>
                        <p><span class="italic">Adaptive Oracle RAC Rolling Patching for OJVM Deployments</span>: In a clustered environment, the default approach for Fleet Patching and Provisioning for patching a database is Oracle RAC rolling patching. However non-rolling may be required if the patched database home contains OJVM patches. In this case, Fleet Patching and Provisioning determines whether rolling patching is possible and does so, if applicable.
                        </p>
                     </li>
                     <li>
                        <p><span class="italic">Dry-run command evaluation</span>: Before running any command, Fleet Patching and Provisioning checks various preconditions to ensure the command will succeed. However, some conditions cannot be detected prior to a command running. And, while Fleet Patching and Provisioning allows a failed command to be reverted or resumed after an error condition is corrected, it is preferable to address as many potential issues as possible before the command is run. The command evaluation mode will test the preconditions for a given command, without making any changes, and report potential problems and correct them before the command is actually run.
                        </p>
                     </li>
                     <li>
                        <div class="p"><span class="italic">Independent automatons</span>: Prior to Oracle Database 18c, performing any Fleet Patching and Provisioning operation (for example, switching a database home to a later version) required the presence of a central Fleet Patching and Provisioning Server. Beginning with Oracle Database 18c, key functionality can be performed independently, with no central Fleet Patching and Provisioning Server in the architecture.
                           <div class="infoboxnote" id="GUID-CCEC5960-EDA4-4A3F-9643-0CA308EA49AA__GUID-57991E83-C2C4-44CF-9BB1-7D3A22D66226">
                              <p class="notep1">Note:</p>When you install Oracle Grid Infrastructure, the Fleet Patching and Provisioning Server is configured, by default, in the <span class="italic">local</span> mode to support the <span class="italic">local switch home</span> capability. If you must configure the general Fleet Patching and Provisioning Server product, then you must remove the current local-mode Fleet Patching and Provisioning Server, using the following commands, as <code class="codeph">root</code>:<pre class="pre codeblock"><code># srvctl stop rhpserver</code></pre><p>Ignore a message similar to "Fleet Patching and Provisioning Server is not running".</p><pre class="pre codeblock"><code># srvctl remove rhpserver</code></pre></div>
                        </div>
                     </li>
                  </ul>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-CCEC5960-EDA4-4A3F-9643-0CA308EA49AA__GUID-21BB7458-BDD6-4FB6-99D4-1CD2C69E0082">Global Fleet Standardization and Management</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><span class="italic">Sharing gold images between peer Fleet Patching and Provisioning Servers</span>: Large enterprises typically host multiple data centers and, within each data center, there may be separate network segments. In the Fleet Patching and Provisioning architecture, one Fleet Patching and Provisioning Server operates on a set of targets within a given data center (or network segment of a data center). Therefore each data center requires at least one Fleet Patching and Provisioning Server.
                        </p>
                        <p>While each data center may have some unique requirements in terms of the gold images that target servers will use, the goal of standardization is using the same gold image across all data centers whenever possible. To that end, Fleet Patching and Provisioning supports peer-to-peer sharing of gold images to easily propagate gold images among multiple Fleet Patching and Provisioning Servers.</p>
                     </li>
                     <li>
                        <div class="p"><span class="italic">Gold image drift detection and aggregation</span>: After you provision a software home from a gold image, you may have to apply a patch directly to the deployed home. At this point the deployed home has drifted from the gold image. Fleet Patching and Provisioning provides two capabilities for monitoring and reporting drift:
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Fleet Patching and Provisioning compares a specific home to its parent gold image and lists any patches that are applied to the home but that are not in the gold image.</p>
                              </li>
                              <li>
                                 <p>Fleet Patching and Provisioning compares a specific gold image to all of its descendant homes and lists the aggregation of all patches applied to those homes that are not in the gold image. This provides a build specification for a new gold image that could be applied to all of the descendants of the original gold image, such that no patches will be lost from any of those deployments.</p>
                              </li>
                           </ul>
                        </div>
                     </li>
                     <li>
                        <p><span class="italic">Configuration collection and reporting</span>: The Fleet Patching and Provisioning Server can collect and retain operating system configuration and the root file system contents of specified Fleet Patching and Provisioning Clients. If a Fleet Patching and Provisioning Client node is rendered unusable (for example, a user accidentally deletes or changes operating system configuration or the root file system), then it can be difficult to determine the problem and correct it. This feature automates the collection of relevant information, enabling simple restoration in the event of node failure.
                        </p>
                     </li>
                  </ul>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-CCEC5960-EDA4-4A3F-9643-0CA308EA49AA__GUID-D212A924-1923-43C0-B536-EF7A9075E3BC">Flexibility and Extensibility</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <div class="p"><span class="italic">RESTful API</span>: Fleet Patching and Provisioning provides a RESTful API for many common operations, including provisioning, patching, upgrading, and query operations.
                           <div class="infoboxnotealso" id="GUID-CCEC5960-EDA4-4A3F-9643-0CA308EA49AA__GUID-AE768EA4-0C36-4EE1-A129-2ED44921769D">
                              <p class="notep1">See Also:</p><a href="../dbrst/index.html" target="_blank"><span><cite>Oracle Database REST API Reference</cite></span></a></div>
                        </div>
                     </li>
                     <li>
                        <p><span class="italic">Customizable authentication</span>: Host-to-host authentication in certain environments, particularly in compliance-conscious industries, such as financials and e-commerce, often uses technologies and products that are not supported, natively, by Fleet Patching and Provisioning. This feature allows integrating Fleet Patching and Provisioning authentication with the mechanisms in use at your data center.
                        </p>
                     </li>
                     <li>
                        <p><span class="italic">Command scheduler</span>: The ability to schedule and bundle automated tasks is essential for maintenance of a large database estate. Fleet Patching and Provisioning supports scheduling tasks such as provisioning software homes, switching to a new home, and scaling a cluster. Also, you can add a list of clients to a command, facilitating large-scale operations.
                        </p>
                     </li>
                     <li>
                        <p><span class="italic">Configurable connectivity</span>: As security concerns and compliance requirements increase, so do the restrictions on connectivity across the intranets of many enterprises. You can configure the small set ports used for communication between the Fleet Patching and Provisioning Server and its Clients, allowing low-impact integration into firewalled or audit-conscious environments.
                        </p>
                     </li>
                  </ul>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-CCEC5960-EDA4-4A3F-9643-0CA308EA49AA__GUID-FA0DAFAD-CAB1-48EB-9148-6F363AE179E7">Other Fleet Patching and Provisioning Features</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><span class="italic">Zero-downtime upgrade</span>: Automation of all of upgrade steps involved minimizes or even eliminates application downtime while upgrading an Oracle Database. It also minimizes resource requirements and provides a fallback path in case you must roll back the upgrade. You can run a zero-downtime upgrade on certain versions of Oracle RAC and Oracle RAC One Node databases.
                        </p>
                     </li>
                     <li>
                        <p><span class="italic">Provision new server pools</span>: The Fleet Patching and Provisioning Server can install and configure Oracle Grid Infrastructure (11<span class="italic">g</span> release 2 (11.2.0.4), and 12<span class="italic">c</span> release 1 (12.1.0.2) and release 2 (12.2)) on nodes that have no Oracle software inventory and can then manage those deployments with the full complement of Fleet Patching and Provisioning functionality.
                        </p>
                     </li>
                     <li>
                        <p><span class="italic">Provision and manage any software home</span>: Fleet Patching and Provisioning enables you to create a gold image from any software home. You can then provision that software to any Fleet Patching and Provisioning Client or target as a working copy of a gold image. The software may be any binary that you will run on a Fleet Patching and Provisioning Client or target.
                        </p>
                     </li>
                     <li>
                        <p><span class="italic">Provision, scale, patch, and upgrade Oracle Grid Infrastructure</span>: The Fleet Patching and Provisioning Server can provision Oracle Grid Infrastructure 11<span class="italic">g</span> release 2 (11.2.0.4) homes, and later, add or delete nodes from an Oracle Grid Infrastructure configuration, and can also be used to patch and upgrade Oracle Grid Infrastructure homes. In addition, there is a rollback capability that facilitates undoing a failed patch procedure. While patching Oracle Grid Infrastructure, you can use Fleet Patching and Provisioning to optionally patch any database homes hosted on the cluster.
                        </p>
                     </li>
                     <li>
                        <p><span class="italic">Provision, scale, patch, and upgrade Oracle Database</span>: You can use Fleet Patching and Provisioning, you can provision, scale, and patch Oracle Database 11<span class="italic">g</span> release 2 (11.2.0.4), and later. You can also upgrade Oracle Databases from 11<span class="italic">g</span> release 2 (11.2.0.3) to 11<span class="italic">g</span> release 2 (11.2.0.4); from 11<span class="italic">g</span> release 2 (11.2.0.4) to 12<span class="italic">c</span> release 1 (12.1.0.2); and from 11<span class="italic">g</span> release 2 (11.2.0.4) or 12<span class="italic">c</span> release 1 (12.1.0.2) to 12<span class="italic">c</span> release 2 (12.2).
                        </p>
                        <p>When you provision such software, Fleet Patching and Provisioning offers additional features for creating various types of databases (such as Oracle RAC, single instance, and Oracle Real Application Clusters One Node (Oracle RAC One Node) databases) on different types of storage, and other options, such as using templates and creating container databases (CDBs). The Fleet Patching and Provisioning Server can add nodes to an Oracle RAC configuration, and remove nodes from an Oracle RAC configuration. Fleet Patching and Provisioning also improves and makes more efficient patching of database software, allowing for rapid and remote patching of the software, in most cases, without any downtime for the database.</p>
                     </li>
                     <li>
                        <p><span class="italic">Support for single-instance databases</span>: You can use Fleet Patching and Provisioning to provision, patch, and upgrade single-instance databases running on clusters or Oracle Restart, or on single, standalone nodes.
                        </p>
                     </li>
                     <li>
                        <p><span class="italic">Advanced patching capabilities</span>: When patching an Oracle Grid Infrastructure or Oracle Database home, Fleet Patching and Provisioning offers a batch mode that speeds the patching process by patching some or all nodes of a cluster in parallel, rather than sequentially.
                        </p>
                        <p>For Oracle Database homes, you can define disjoint sets of nodes. Each set of nodes is updated sequentially. By defining sets with reference to the database instances running on them, you can minimize the impact of rolling updates by ensuring that services are never taken completely offline. A “smartmove” option is available to help define the sets of batches to meet this goal.</p>
                        <p>Integration with Application Continuity is another enhancement to help eliminate the impact of maintenance. This provides the ability to gracefully drain and relocate services within a cluster, completely masking the maintenance from users.</p>
                     </li>
                     <li>
                        <p><span class="italic">Notifications</span>:The Fleet Patching and Provisioning Server is the central repository for the software homes available to the data center. Therefore, it is essential that administrators throughout the data center be aware of changes to the inventory which might impact their areas of responsibility.
                        </p>
                        <p>Fleet Patching and Provisioning enables you and other users to subscribe to image series events. Anyone subscribed will be notified by email of any changes to the images available in a particular image series. Also, users can be notified by email when a working copy of a gold image is added to or deleted from a client.</p>
                     </li>
                     <li>
                        <p><span class="italic">Custom workflow support</span>: You can create actions for various Fleet Patching and Provisioning operations, such as importing images, adding or deleting working copies of the gold images, and managing a software home. You can define different actions for each operation, and further differentiate by the type of image to which the operation applies. Actions that you define can be executed before or after the given operation, and are executed on the deployment the operation applies to, whether it is the Fleet Patching and Provisioning Server, a target that is not running a Fleet Patching and Provisioning Client, or a target that is running a Fleet Patching and Provisioning Client.
                        </p>
                     </li>
                     <li>
                        <p><span class="italic">Resume failed operations</span>: If an operation, such as adding an image, provisioning a working copy of a gold image, or performing a scale, patch or upgrade fails, then Fleet Patching and Provisioning reports the error and stops. After the problem is corrected (for example, a directory permissions or ownership misconfiguration on a target node), you can rerun the RHPCTL command that failed, and it will resume from the point of failure. This avoids redoing any work that may have been completed prior to the failure.
                        </p>
                     </li>
                     <li>
                        <p><span class="italic">Audit command</span>: The Fleet Patching and Provisioning Server records the execution of all Fleet Patching and Provisioning operations and also records their outcome (whether success or failure). An audit mechanism enables you to query the audit log in a variety of dimensions, and also to manage its contents and size.
                        </p>
                     </li>
                  </ul>
               </div>
               <!-- class="section" -->
               <div class="infoboxnote" id="GUID-CCEC5960-EDA4-4A3F-9643-0CA308EA49AA__GUID-9726D570-4A7D-4DF5-8464-8E4C2769B59B">
                  <p class="notep1">Note:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Oracle does not support Fleet Patching and Provisioning on HP-UX or Windows operating systems.</p>
                     </li>
                     <li>
                        <p>The Fleet Patching and Provisioning Server does not manage operating system images.</p>
                     </li>
                  </ul>
               </div>
               <p>This section includes the following topics:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="rapid-home-provisioning.html#GUID-CA5067D0-3847-48F5-BBC7-37617DDBCF66" title="Conceptual information regarding Fleet Patching and Provisioning architecture.">Fleet Patching and Provisioning Architecture</a></p>
                  </li>
                  <li>
                     <p><a href="rapid-home-provisioning.html#GUID-33FC643F-0A2C-4EFF-A13A-D3054D945119" title="Implementing Fleet Patching and Provisioning involves creating a Fleet Patching and Provisioning Server, adding gold images to the server, and creating working copies of gold images to provision software.">Fleet Patching and Provisioning Implementation</a></p>
                  </li>
                  <li>
                     <p><a href="rapid-home-provisioning.html#GUID-F4F263A1-0580-4386-B929-5252A196632E" title="The Fleet Patching and Provisioning Server provides an efficient and secure platform for the distribution of Oracle Grid Infrastructure homes to targets and Fleet Patching and Provisioning Clients.">Oracle Grid Infrastructure Management</a></p>
                  </li>
                  <li>
                     <p><a href="rapid-home-provisioning.html#GUID-F1F48984-C440-44F4-9D62-BDB4BE1CDB4A" title="The Fleet Patching and Provisioning Server provides an efficient and secure platform for the distribution of Oracle Database Homes to targets and Fleet Patching and Provisioning Clients.">Oracle Database Software Management</a></p>
                  </li>
                  <li>
                     <p><a href="rapid-home-provisioning.html#GUID-40D3B039-92D9-4325-908B-C40C7FA9B805" title="Using Fleet Patching and Provisioning, which automates and orchestrates database upgrades, you can upgrade an Oracle RAC or Oracle RAC One Node database with no disruption in service.">Zero-Downtime Upgrade</a></p>
                  </li>
                  <li>
                     <p><a href="rapid-home-provisioning.html#GUID-6CDC373B-6261-4BF8-BD60-2E9E2C3E0168" title="Oracle recommends out-of-place patching when applying updates.">Persistent Home Path During Patching</a></p>
                  </li>
                  <li>
                     <p><a href="rapid-home-provisioning.html#GUID-8D6EC31C-C179-4939-B153-C02F4398C9E0" title="Management tasks for Fleet Patching and Provisioning Clients include creation, enabling and disabling, creating users and assigning roles to those users, and managing passwords.">Managing Fleet Patching and Provisioning Clients</a></p>
                  </li>
               </ul>
            </div>
            <div>
               <div class="relinfo">
                  <p><strong>Related Topics</strong></p>
                  <ul>
                     <li><a href="../install-and-upgrade.html" target="_blank"><span><cite>Oracle Real Application Clusters Installation Guide</cite></span></a></li>
                  </ul>
               </div>
            </div><a id="CWADD92545"></a><div class="props_rev_3"><a id="GUID-CA5067D0-3847-48F5-BBC7-37617DDBCF66" name="GUID-CA5067D0-3847-48F5-BBC7-37617DDBCF66"></a><h3 id="CWADD-GUID-CA5067D0-3847-48F5-BBC7-37617DDBCF66" class="sect3">Fleet Patching and Provisioning Architecture</h3>
               <div>
                  <p>Conceptual information regarding Fleet Patching and Provisioning architecture.</p>
                  <p>The Fleet Patching and Provisioning architecture consists of a Fleet Patching and Provisioning Server and any number of Fleet Patching and Provisioning Clients and targets. Oracle recommends deploying the Fleet Patching and Provisioning Server in a multi-node cluster so that it is highly available.</p>
                  <p>The Fleet Patching and Provisioning Server cluster is a repository for all data, of which there are primarily two types:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Gold images</p>
                     </li>
                     <li>
                        <p>Metadata related to users, roles, permissions, and identities</p>
                     </li>
                  </ul>
                  <p>The Fleet Patching and Provisioning Server acts as a central server for provisioning Oracle Database homes, Oracle Grid Infrastructure homes, and other application software homes, making them available to the cluster hosting the Fleet Patching and Provisioning Server and to the Fleet Patching and Provisioning Client clusters and targets.</p>
                  <p>Users operate on the Fleet Patching and Provisioning Server or Fleet Patching and Provisioning Client to request deployment of Oracle homes or to query gold images. When a user makes a request for an Oracle home, specifying a gold image, the Fleet Patching and Provisioning Client communicates with the Fleet Patching and Provisioning Server to pass on the request. The Fleet Patching and Provisioning Server processes the request by taking appropriate action to instantiate a copy of the gold image, and to make it available to the Fleet Patching and Provisioning Client cluster using available technologies such as Oracle Automatic Storage Management Cluster File System (Oracle ACFS) and local file systems.</p>
                  <p>The Fleet Patching and Provisioning Server communicates with Fleet Patching and Provisioning Clients (running Oracle Grid Infrastructure 12<span class="italic">c</span> release 2 (12.2.0.1) or later), and targets (a target is an installation with Oracle Grid Infrastructure 12c release 1 (12.1.0.2) or release 11.2, or with no Oracle Grid Infrastructure installed) using the following ports, several of which you can configure, as described in <a href="rapid-home-provisioning.html#GUID-CA5067D0-3847-48F5-BBC7-37617DDBCF66__GUID-69618B75-2338-4B0F-B2A5-6F76EAC2B1F2" title="Describes communication ports used between Fleet Patching and Provisioning Servers and Fleet Patching and Provisioning Clients, targets, or both.">Table 5-1</a>. Additionally, differences in ports used when communicating with Fleet Patching and Provisioning Clients versus targets are noted.
                  </p>
                  <div class="tblformalwide" id="GUID-CA5067D0-3847-48F5-BBC7-37617DDBCF66__GUID-69618B75-2338-4B0F-B2A5-6F76EAC2B1F2">
                     <p class="titleintable">Table 5-1 Fleet Patching and Provisioning Communication Ports</p>
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="Fleet Patching and Provisioning Communication Ports" summary="Describes communication ports used between Fleet Patching and Provisioning Servers and Fleet Patching and Provisioning Clients, targets, or both." width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="20%" id="d25134e637">Client, Target, or Both</th>
                              <th align="left" valign="bottom" width="20%" id="d25134e639">Protocol</th>
                              <th align="left" valign="bottom" width="20%" id="d25134e641">Port</th>
                              <th align="left" valign="bottom" width="20%" id="d25134e643">Purpose</th>
                              <th align="left" valign="bottom" width="20%" id="d25134e645">Description</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d25134e649" headers="d25134e637 ">
                                 <p>Target</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e649 d25134e639 ">
                                 <p>TCP</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e649 d25134e641 ">
                                 <p>22</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e649 d25134e643 ">
                                 <p>SSH</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e649 d25134e645 ">
                                 <p>Authentication-based operations involving clientless targets.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d25134e665" headers="d25134e637 ">
                                 <p>Client</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e665 d25134e639 ">
                                 <p>TCP</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e665 d25134e641 ">
                                 <p>22</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e665 d25134e643 ">
                                 <p>SSH</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e665 d25134e645 ">
                                 <p>Provisioning of Oracle Grid Infrastructure 12<span class="italic">c</span> release 2 (12.2.0.1) or later requires an SSH port. (Subsequent Fleet Patching and Provisioning Server/Client interactions use the JMX path.)
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d25134e684" headers="d25134e637 ">
                                 <p>Client</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e684 d25134e639 ">
                                 <p>TCP</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e684 d25134e641 ">
                                 <p>8896</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e684 d25134e643 ">
                                 <p>JMX registry and server port</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e684 d25134e645 ">
                                 <p>For establishing Fleet Patching and Provisioning Server communication with Fleet Patching and Provisioning Clients.</p>
                                 <p>You can configure this port using the <code class="codeph">srvctl modify rhpserver -port <span class="variable" translate="no">port_number</span></code> command.
                                 </p>
                                 <p><span class="bold">Note:</span> The preceding command requires you to restart the service.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d25134e711" headers="d25134e637 ">
                                 <p>Client</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e711 d25134e639 ">
                                 <p>UDP</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e711 d25134e641 ">
                                 <p>Port 53 must be open only on the Fleet Patching and Provisioning Server to accept incoming connections.</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e711 d25134e643 ">
                                 <p>GNS port</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e711 d25134e645 ">
                                 <p>GNS is used for Fleet Patching and Provisioning Clients to locate the Fleet Patching and Provisioning Server.</p>
                                 <p>You can configure GNS with or without zone delegation.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d25134e729" headers="d25134e637 ">
                                 <p>Both</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e729 d25134e639 ">
                                 <p>TCP</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e729 d25134e641 ">
                                 <p>Specify one port for each RHPCTL command from ephemeral port range, or one port as specified with the <code class="codeph">srvctl modify rhpserver &#x2013;pl_port <span class="variable" translate="no">port_number</span></code> command.
                                 </p>
                                 <p>Progress listener port must be open to accept incoming connections on the server where RHPCTL is run (whether a Fleet Patching and Provisioning Server or Client).</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e729 d25134e643 ">
                                 <p>Command progress listener</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e729 d25134e645 ">
                                 <p>Fleet Patching and Provisioning Server opens a random port from the ephemeral range to monitor progress on the client or target, or uses the fixed port you specify with the <code class="codeph">srvctl modify rhpserver &#x2013;pl_port <span class="variable" translate="no">port_number</span></code> and multiplexes across clients/targets.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d25134e757" headers="d25134e637 ">
                                 <p>Clients running Oracle Database 18c or Oracle Database 12<span class="italic">c</span> release 2 (12.2.0.1) with the January 2018 RU, or later
                                 </p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e757 d25134e639 ">
                                 <p>TCP</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e757 d25134e641 ">
                                 <p>You must have six ports for gold image provisioning on a Fleet Patching and Provisioning Client server to accept incoming connections.</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e757 d25134e643 ">
                                 <p>Gold image transfers to Oracle Database 18c clients and clients with the 2018 January RU (running the <code class="codeph">rhpctl add workingcopy</code> command on the Fleet Patching and Provisioning Server)
                                 </p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e757 d25134e645 ">
                                 <p>Transferring copies of gold images from the Fleet Patching and Provisioning Server to clients uses six ports chosen from the ephemeral range, or six ports from the range you define using the <code class="codeph">srvctl modify rhpserver -port_range <span class="variable" translate="no">port_number_range</span></code>. In this case, specify a range to accommodate the anticipated degree of parallelism (concurrent transfers) you will use. If the <code class="codeph">port_range</code> value is specified and if RHPS manages 12.2 clients, then the client must be patched to 12.2.0.1.180717OCWJUL2018RU or later.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d25134e787" headers="d25134e637 ">
                                 <p>Both</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e787 d25134e639 ">
                                 <p>TCP/UDP</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e787 d25134e641 ">
                                 <p>Fixed and configurable ports, as described in <a href="rapid-home-provisioning.html#GUID-CA5067D0-3847-48F5-BBC7-37617DDBCF66__GUID-8D86DD62-83BE-4BDF-8BEF-4A999DDB1885" title="Describes ports for use with NFS">Table 5-2</a></p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e787 d25134e643 ">
                                 <p>NFS</p>
                                 <p>NFS is not required if RHPC clusters are at release 18c (18.4) or later.</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e787 d25134e645 ">
                                 <p>Fleet Patching and Provisioning Server transfers software homes to targets and Oracle Database 12<span class="italic">c</span> release 2 (12.2.0.1) pre-January 2018 RU clients using temporary NFS mount points. NFS is also used for remote command execution support on clients and targets (all versions). 
                                 </p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="tblformalwide" id="GUID-CA5067D0-3847-48F5-BBC7-37617DDBCF66__GUID-8D86DD62-83BE-4BDF-8BEF-4A999DDB1885">
                     <p class="titleintable">Table 5-2 Ports for NFS</p>
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="Ports for NFS" summary="Describes ports for use with NFS" width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="20%" id="d25134e821">Port</th>
                              <th align="left" valign="bottom" width="20%" id="d25134e823">Description</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d25134e827" headers="d25134e821 ">
                                 <p>2049, 111</p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e827 d25134e823 ">
                                 <p>Fixed NFS ports</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d25134e834" headers="d25134e821 ">
                                 <p>Six ports chosen from ephemeral range (default) or defined in <code>/etc/sysconfig/nfs</code></p>
                              </td>
                              <td align="left" valign="top" width="20%" headers="d25134e834 d25134e823 ">
                                 <div class="p">Configurable NFS ports, with each item followed by its configuration file entry:
                                    <ul class="simple" style="list-style-type: none;padding-left:0;">
                                       <li>rpc: STATD_PORT</li>
                                       <li>rpc status out: STATD_OUTGOING_PORT</li>
                                       <li>rpc quota: RQUOTAD_PORT</li>
                                       <li>rpc mountd: MOUNTD_PORT</li>
                                       <li>rpc lockd tcp: LOCKD_TCPPORT</li>
                                       <li>rpc lockd udp: LOCKD_UDPPORT</li>
                                    </ul>
                                 </div>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div><a id="CWADD92585"></a><div class="props_rev_3"><a id="GUID-3B15B8F9-208E-4881-B62F-1B35E70FB64E" name="GUID-3B15B8F9-208E-4881-B62F-1B35E70FB64E"></a><h4 id="CWADD-GUID-3B15B8F9-208E-4881-B62F-1B35E70FB64E" class="sect4">Fleet Patching and Provisioning Server</h4>
                  <div>
                     <p>The Fleet Patching and Provisioning Server is a highly available software provisioning system that uses Oracle Automatic Storage Management (Oracle ASM), Oracle Automatic Storage Management Cluster File System (Oracle ACFS), Grid Naming Service (GNS), and other components.</p>
                     <p>The Fleet Patching and Provisioning Server primarily acts as a central server for provisioning Oracle homes, making them available to Fleet Patching and Provisioning Client and targets.</p>
                     <p>Features of the Fleet Patching and Provisioning Server:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Efficiently stores gold images and image series for the managed homes, including separate binaries, and metadata related to users, roles, and permissions.</p>
                        </li>
                        <li>
                           <p>Provides a list of available homes to clients upon request.</p>
                        </li>
                        <li>
                           <p>Patch a software home once and then deploy the home to any Fleet Patching and Provisioning Client or any other target, instead of patching every site.</p>
                        </li>
                        <li>
                           <p>Provides the ability to report on existing deployments.</p>
                        </li>
                        <li>
                           <p>Deploys homes on physical servers and virtual machines.</p>
                        </li>
                        <li>
                           <p>Notifies subscribers of changes to image series.</p>
                        </li>
                        <li>
                           <p>Maintains an audit log of all RHPCTL commands run.</p>
                        </li>
                     </ul>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-817F0470-7F7F-446B-9160-AA63DE5EF09E" name="GUID-817F0470-7F7F-446B-9160-AA63DE5EF09E"></a><h4 id="CWADD-GUID-817F0470-7F7F-446B-9160-AA63DE5EF09E" class="sect4">Fleet Patching and Provisioning Targets</h4>
                  <div>
                     <p>Computers of which Fleet Patching and Provisioning is aware are known as targets.</p>
                     <p>Fleet Patching and Provisioning Servers can create new targets, and can also install and configure Oracle Grid Infrastructure on targets with only an operating system installed. Subsequently, Fleet Patching and Provisioning Server can provision database and other software on those targets, perform maintenance, scale the target cluster, in addition to many other operations. All Fleet Patching and Provisioning commands are run on the Fleet Patching and Provisioning Server. Targets running the Fleet Patching and Provisioning Client in Oracle Clusterware 12<span class="italic">c</span> release 2 (12.2), and later, may also run many of the Fleet Patching and Provisioning commands to request new software from the Fleet Patching and Provisioning Server and initiate maintenance themselves, among other tasks.
                     </p>
                     <div class="infoboxnote" id="GUID-817F0470-7F7F-446B-9160-AA63DE5EF09E__GUID-8C5E4165-F38F-4F2E-91DC-DE24047E0148">
                        <p class="notep1">Note:</p>If you have targets running the Fleet Patching and Provisioning Client in Oracle Clusterware prior to 12<span class="italic">c</span> release 2 (12.2), then you can import images using the RHPCTL utility without making them clients. For clients running in Oracle Clusterware 12<span class="italic">c</span> release 2 (12.2), and later, you must configure and enable Fleet Patching and Provisioning Clients to simplify connectivity and credential issues.
                     </div>
                  </div>
               </div><a id="CWADD92586"></a><div class="props_rev_3"><a id="GUID-67917A2D-9C1E-423D-9BCB-FDD88E5663DD" name="GUID-67917A2D-9C1E-423D-9BCB-FDD88E5663DD"></a><h4 id="CWADD-GUID-67917A2D-9C1E-423D-9BCB-FDD88E5663DD" class="sect4">Fleet Patching and Provisioning Clients</h4>
                  <div>
                     <p>The Fleet Patching and Provisioning Client is part of the Oracle Grid Infrastructure. Users operate on a Fleet Patching and Provisioning Client to perform tasks such as requesting deployment of Oracle homes and listing available gold images.</p>
                     <p>When a user requests an Oracle home specifying a gold image, the Fleet Patching and Provisioning Client communicates with the Fleet Patching and Provisioning Server to pass on the request. The Fleet Patching and Provisioning Server processes the request by instantiating a working copy of the gold image and making it available to the Fleet Patching and Provisioning Client using Oracle ACFS or a different local file system.</p>
                     <p>The Fleet Patching and Provisioning Client:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Can use Oracle ACFS to store working copies of gold images which can be rapidly provisioned as local homes; new homes can be quickly created or undone using Oracle ACFS snapshots.</p>
                           <div class="infoboxnote" id="GUID-67917A2D-9C1E-423D-9BCB-FDD88E5663DD__GUID-E97A141E-2147-487D-8B9F-E88A25B2E8F0">
                              <p class="notep1">Note:</p>
                              <p>Oracle supports using other local file systems besides Oracle ACFS.</p>
                           </div>
                        </li>
                        <li>
                           <p>Provides a list of available homes from the Fleet Patching and Provisioning Server.</p>
                        </li>
                        <li>
                           <p>Has full functionality in Oracle Clusterware 12<span class="italic">c</span> release 2 (12.2) and can communicate with Fleet Patching and Provisioning Servers from Oracle Clusterware 12<span class="italic">c</span> release 2 (12.2), or later.
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning.html#GUID-E65C9FC4-C8AC-4BF6-A689-A70C70B3A636" title="Users operate on a Fleet Patching and Provisioning Client to perform tasks such as requesting deployment of Oracle homes and querying gold images.">Creating a Fleet Patching and Provisioning Client</a></li>
                        </ul>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-44D851A3-9478-4A6F-A779-70FB85191A2C" name="GUID-44D851A3-9478-4A6F-A779-70FB85191A2C"></a><h4 id="CWADD-GUID-44D851A3-9478-4A6F-A779-70FB85191A2C" class="sect4">Authentication Options for Fleet Patching and Provisioning Operations</h4>
                  <div>
                     <p>Some RHPCTL commands show authentication choices as an optional parameter.</p>
                     <p>Specifying an authentication option is not required when running an RHPCTL command on a Fleet Patching and Provisioning Client, nor when running an RHPCTL command on the Fleet Patching and Provisioning Server and operating on a Fleet Patching and Provisioning Client, because the server and client establish a trusted relationship when the client is created, and authentication is handled internally each time a transaction takes place. (The only condition for server/client communication under which an authentication option must be specified is when the server is provisioning a new Oracle Grid Infrastructure deployment—in this case, the client does not yet exist.)</p>
                     <div class="p">To operate on a target that is not a Fleet Patching and Provisioning Client, you must provide the Fleet Patching and Provisioning Server with information allowing it to authenticate with the target. The options are as follows:
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Provide the <code class="codeph">root</code> password (on <code class="codeph">stdin</code>) for the target
                              </p>
                           </li>
                           <li>
                              <p>Provide the <code class="codeph">sudo</code> user name, <code class="codeph">sudo</code> binary path, and the password (<code class="codeph">stdin</code>) for target
                              </p>
                           </li>
                           <li>
                              <p>Provide a password (either <code class="codeph">root</code> or <code class="codeph">sudouser</code>) non-interactively from local encrypted store (using the <code class="codeph">-cred</code> authentication parameter)
                              </p>
                           </li>
                           <li>
                              <p>Provide a path to the identity file stored on the Fleet Patching and Provisioning Server for SSL-encrypted passwordless authentication (using the <code class="codeph">-auth sshkey</code> option)
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="section">
                        <p class="subhead3" id="GUID-44D851A3-9478-4A6F-A779-70FB85191A2C__GUID-D9E12B72-8557-4D68-97C7-FB923FB2E6B4">Passwordless Authentication Details</p>
                        <div class="p">The Fleet Patching and Provisioning Server can authenticate to targets over SSH using a key pair. To enable this option, you must establish user equivalence between the <code class="codeph">crsusr</code> on the Fleet Patching and Provisioning Server and <code class="codeph">root</code> or a <code class="codeph">sudouser</code> on the target.
                           <div class="infoboxnote" id="GUID-44D851A3-9478-4A6F-A779-70FB85191A2C__GUID-22CB29D1-85F5-427A-8552-A9DC37D73585">
                              <p class="notep1">Note:</p>The steps to create that equivalence are platform-dependent and so not shown in detail here. For Linux, see commands <code class="codeph">ssh-keygen</code> to be run on the target and <code class="codeph">ssh-copy-id</code> to be run on the Fleet Patching and Provisioning Server.
                           </div>
                        </div>
                        <div class="p">For example, assuming that you have established user equivalency between <code class="codeph">crsusr</code> on the Fleet Patching and Provisioning Server and <code class="codeph">root</code> on the target node, <code class="codeph">nonRHPClient4004.example.com</code>, and saved the key information on the Fleet Patching and Provisioning Server at <code>/home/oracle/rhp/ssh-key/key &#x2013;path</code>, then the following command will provision a copy of the specified gold image to the target node with passwordless authentication:<pre class="pre codeblock"><code>$ rhpctl add workingcopy -workingcopy db12102_160607wc1 &#x2013;image db12102_160607
  -targetnode nonRHPClient4004.example.com &#x2013;path /u01/app/oracle/12.1/rhp/dbhome_1
  -oraclebase /u01/app/oracle -auth sshkey -arg1 user:root -arg2
   identity_file:/home/oracle/rhp/ssh-key/key</code></pre></div>
                        <div class="p">For equivalency between <code class="codeph">crsusr</code> on the Fleet Patching and Provisioning Server and a privileged user (other than <code class="codeph">root</code>) on the target, the <code class="codeph">-auth</code> portion of the command would be similar to the following:<pre class="pre codeblock"><code>-auth sshkey -arg1 user:<span class="variable" translate="no">ssh_user</span> -arg2 identity_file:<span class="variable" translate="no">path_to_identity_file_on_RHPS</span>
 -arg3 sudo_location:<span class="variable" translate="no">path_to_sudo_binary_on_target</span></code></pre></div>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-5CCBB74C-D6BD-4681-98DF-96A16E14CE17" title="Adds credentials to the Oracle Cluster Registry (OCR).">rhpctl add credentials</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-EB74413B-F6A5-43AB-B19F-1050BB1260B4" title="Deletes credentials from the Oracle Cluster Registry (OCR).">rhpctl delete credentials</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-61929F3C-A50A-45EA-8B4A-D11E245A6493" title="Creates a working copy on a client cluster.">rhpctl add workingcopy</a></li>
                        </ul>
                     </div>
                  </div>
               </div><a id="CWADD92588"></a><div class="props_rev_3"><a id="GUID-3AE65540-02ED-4178-8ACC-BC45094C214B" name="GUID-3AE65540-02ED-4178-8ACC-BC45094C214B"></a><h4 id="CWADD-GUID-3AE65540-02ED-4178-8ACC-BC45094C214B" class="sect4">Fleet Patching and Provisioning Roles</h4>
                  <div>
                     <p>An administrator assigns <a id="d25134e1684" class="indexterm-anchor"></a>roles to Fleet Patching and Provisioning users with access-level permissions defined for each role. Users on Fleet Patching and Provisioning Clients are also assigned specific roles. Fleet Patching and Provisioning includes basic built-in and composite built-in roles.
                     </p>
                  </div>
                  <div class="props_rev_3"><a id="GUID-BBB0C3C2-40C5-4595-A699-C410EB9BCD1A" name="GUID-BBB0C3C2-40C5-4595-A699-C410EB9BCD1A"></a><h5 id="CWADD-GUID-BBB0C3C2-40C5-4595-A699-C410EB9BCD1A" class="sect5">Basic Built-In Roles</h5>
                     <div>
                        <div class="section">
                           <p>The <a id="d25134e1807" class="indexterm-anchor"></a>basic built-in roles and their functions are:
                           </p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>GH_ROLE_ADMIN: An administrative role for everything related to roles. Users assigned this role are able to run <code class="codeph">rhpctl <span class="variable" translate="no">verb</span> role</code> commands.
                                 </p>
                              </li>
                              <li>
                                 <p>GH_SITE_ADMIN: An administrative role for everything related to Fleet Patching and Provisioning Clients. Users assigned this role are able to run <code class="codeph">rhpctl <span class="variable" translate="no">verb</span> client</code> commands.
                                 </p>
                              </li>
                              <li>
                                 <p>GH_SERIES_ADMIN: An administrative role for everything related to image series. Users assigned this role are able to run <code class="codeph">rhpctl <span class="variable" translate="no">verb</span> series</code> commands.
                                 </p>
                              </li>
                              <li>
                                 <p>GH_SERIES_CONTRIB: Users assigned this role can add images to a series using the <code class="codeph">rhpctl insertimage series</code> command, or delete images from a series using the <code class="codeph">rhpctl deleteimage series</code> command.
                                 </p>
                              </li>
                              <li>
                                 <p>GH_WC_ADMIN: An administrative role for everything related to working copies of gold images. Users assigned this role are able to run <code class="codeph">rhpctl <span class="variable" translate="no">verb</span> workingcopy</code> commands.
                                 </p>
                              </li>
                              <li>
                                 <p>GH_WC_OPER: A role that enables users to create a working copy of a gold image for themselves or others using the <code class="codeph">rhpctl add workingcopy</code> command with the <code class="codeph">-user</code> option (when creating for others). Users assigned this role do not have administrative privileges and can only administer the working copies of gold images that they create.
                                 </p>
                              </li>
                              <li>
                                 <p>GH_WC_USER: A role that enables users to create a working copy of a gold image using the <code class="codeph">rhpctl add workingcopy</code> command. Users assigned this role do not have administrative privileges and can only delete working copies that they create.
                                 </p>
                              </li>
                              <li>
                                 <p>GH_IMG_ADMIN: An administrative role for everything related to images. Users assigned this role are able to run <code class="codeph">rhpctl <span class="variable" translate="no">verb</span> image</code> commands.
                                 </p>
                              </li>
                              <li>
                                 <p>GH_IMG_USER: A role that enables users to create an image using the <code class="codeph">rhpctl add | import image</code> commands. Users assigned this role do not have administrative privileges and can only delete images that they create.
                                 </p>
                              </li>
                              <li>
                                 <p>GH_IMG_TESTABLE: A role that enables users to add a working copy of an image that is in the <code class="codeph">TESTABLE</code> state. Users assigned this role must also be assigned either the GH_WC_ADMIN role or the GH_WC_USER role to add a working copy.
                                 </p>
                              </li>
                              <li>
                                 <p>GH_IMG_RESTRICT: A role that enables users to add a working copy from an image that is in the <code class="codeph">RESTRICTED</code> state. Users assigned this role must also be assigned either the GH_WC_ADMIN role or the GH_WC_USER role to add a working copy.
                                 </p>
                              </li>
                              <li>
                                 <p>GH_IMG_PUBLISH: Users assigned this role can promote an image to another state or retract an image from the <code class="codeph">PUBLISHED</code> state to either the <code class="codeph">TESTABLE</code> or <code class="codeph">RESTRICTED</code> state.
                                 </p>
                              </li>
                              <li>
                                 <p>GH_IMG_VISIBILITY: Users assigned this role can modify access to promoted or published images using the <code class="codeph">rhpctl allow | disallow image</code> commands.
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-DDFA409C-8C12-453E-907D-6D75E50BFE7B" name="GUID-DDFA409C-8C12-453E-907D-6D75E50BFE7B"></a><h5 id="CWADD-GUID-DDFA409C-8C12-453E-907D-6D75E50BFE7B" class="sect5">Composite Built-In Roles</h5>
                     <div>
                        <div class="section">
                           <p>The <a id="d25134e2039" class="indexterm-anchor"></a>composite built-in roles and their functions are:
                           </p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>GH_SA: The Oracle Grid Infrastructure user on a Fleet Patching and Provisioning Server automatically inherits this role.</p>
                                 <p>The GH_SA role includes the following basic built-in roles: GH_ROLE_ADMIN, GH_SITE_ADMIN, GH_SERIES_ADMIN, GH_SERIES_CONTRIB, GH_WC_ADMIN, GH_IMG_ADMIN, GH_IMG_TESTABLE, GH_IMG_RESTRICT, GH_IMG_PUBLISH, and GH_IMG_VISIBILITY.</p>
                              </li>
                              <li>
                                 <p>GH_CA: The Oracle Grid Infrastructure user on a Fleet Patching and Provisioning Client automatically inherits this role.</p>
                                 <p>The GH_CA role includes the following basic built-in roles: GH_SERIES_ADMIN, GH_SERIES_CONTRIB, GH_WC_ADMIN, GH_IMG_ADMIN, GH_IMG_TESTABLE, GH_IMG_RESTRICT, GH_IMG_PUBLISH, and GH_IMG_VISIBILITY.</p>
                              </li>
                              <li>
                                 <p>GH_OPER: This role includes the following built-in roles: GH_WC_OPER, GH_SERIES_ADMIN, GH_IMG_TESTABLE, GH_IMG_RESTRICT, and GH_IMG_USER. Users assigned this role can delete only images that they have created.</p>
                              </li>
                           </ul>
                           <p>Consider a gold image called <code class="codeph">G1</code> that is available on the Fleet Patching and Provisioning Server.
                           </p>
                           <p>Further consider that a user, <code class="codeph">U1</code>, on a Fleet Patching and Provisioning Client, <code class="codeph">Cl1</code>, has the GH_WC_USER role. If <code class="codeph">U1</code> requests to provision an Oracle home based on the gold image <code class="codeph">G1</code>, then <code class="codeph">U1</code> can do so, because of the permissions granted by the GH_WC_USER role. If <code class="codeph">U1</code> requests to delete <code class="codeph">G1</code>, however, then that request would be denied because the GH_WC_USER role does not have the necessary permissions.
                           </p>
                           <p>The Fleet Patching and Provisioning Server can associate user-role mappings to the Fleet Patching and Provisioning Client. After the Fleet Patching and Provisioning Server delegates user-role mappings, the Fleet Patching and Provisioning Client can then modify user-role mappings on the Fleet Patching and Provisioning Server for all users that belong to the Fleet Patching and Provisioning Client. This is implied by the fact that only the Fleet Patching and Provisioning Server qualifies user IDs from a Fleet Patching and Provisioning Client site with the client cluster name of that site. Thus, the Fleet Patching and Provisioning Client <code class="codeph">CL1</code> will not be able to update user mappings of a user on <code class="codeph">CL2</code>, where <code class="codeph">CL2</code> is the cluster name of a different Fleet Patching and Provisioning Client.
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="CWADD93060"></a><div class="props_rev_3"><a id="GUID-DF1DCE94-B92D-4925-971C-6C60929E455F" name="GUID-DF1DCE94-B92D-4925-971C-6C60929E455F"></a><h4 id="CWADD-GUID-DF1DCE94-B92D-4925-971C-6C60929E455F" class="sect4">Fleet Patching and Provisioning Images</h4>
                  <div>
                     <p></p>
                     <p>By default, when you create a gold image using either <code class="codeph">rhpctl import image</code> or <code class="codeph">rhpctl add image</code>, the image is ready to provision working copies. However, under certain conditions, you may want to restrict access to images and require someone to test or validate the image before making it available for general use.
                     </p>
                     <p>You can also create a set of gold images on the Fleet Patching and Provisioning Server that can be collectively categorized as a gold image series which relate to each other, such as identical release versions, gold images published by a particular user, or images for a particular department within an organization.</p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning.html#GUID-7D5E221B-4F74-4ECE-ADD1-6F060D6D7A7C">Image State</a></li>
                           <li><a href="rapid-home-provisioning.html#GUID-1FE5E4A1-3920-467C-B2DD-749F436D35E6" title="An image series is a convenient way to group different gold images into a logical sequence.">Image Series</a></li>
                           <li><a href="rapid-home-provisioning.html#GUID-E3AF7DAC-8612-445B-9368-60A30C1DA474" title="When you add or import a gold image, you must specify an image type.">Image Type</a></li>
                        </ul>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-69A53A58-F50D-43E2-B79C-405369113FF8" name="GUID-69A53A58-F50D-43E2-B79C-405369113FF8"></a><h4 id="CWADD-GUID-69A53A58-F50D-43E2-B79C-405369113FF8" class="sect4">Gold Image Distribution Among Fleet Patching and Provisioning Servers</h4>
                  <div>
                     <p>Fleet Patching and Provisioning can automatically share and synchronize gold images between Fleet Patching and Provisioning Servers.</p>
                     <div class="section">In the Fleet Patching and Provisioning architecture, one Fleet Patching and Provisioning Server manages a set of Fleet Patching and Provisioning Clients and targets within a given data center (or network segment of a data center). If you have more than one data center or a segmented data center, you must have more than one Fleet Patching and Provisioning Server.</div>
                     <!-- class="section" -->
                     <div class="section">In the Fleet Patching and Provisioning architecture, one Fleet Patching and Provisioning Server manages a set of Fleet Patching and Provisioning Clients and targets within a given data center (or network segment of a data center). If you have more than one data center or a segmented data center, then you must have more than one Fleet Patching and Provisioning Server to facilitate large-scale standardization across multiple estates.</div>
                     <!-- class="section" -->
                     <div class="section">Fleet Patching and Provisioning Servers retain the ability to create and manage gold images private to their scope, so local customizations are seamlessly supported.</div>
                     <!-- class="section" -->
                     <div class="p">You must first establish a peer relationship between two Fleet Patching and Provisioning Servers. Registration uses the names of the Fleet Patching and Provisioning Server clusters. The names of the two clusters can be the same but there is one naming restriction: a Fleet Patching and Provisioning Server (<code class="codeph">RHPS_1</code>, for example) cannot register a peer Fleet Patching and Provisioning Server if that peer has the same name as a Fleet Patching and Provisioning Client or target within the management domain of <code class="codeph">RHPS_1</code>.
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>On one Fleet Patching and Provisioning Server, create a file containing the server’s configuration information, as follows:</span><div><pre class="pre codeblock"><code>$ rhpctl export server -serverdata <span class="variable" translate="no">file_path</span></code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Copy the file to a second Fleet Patching and Provisioning Server.</span></li>
                        <li class="stepexpand"><span>Complete the registration of the second Fleet Patching and Provisioning Server, as follows:</span><div><pre class="pre codeblock"><code>$ rhpctl register server -server <span class="variable" translate="no">server_cluster_name</span> -serverdata <span class="variable" translate="no">file</span> {-root
  | {-sudouser <span class="variable" translate="no">user_name</span> -sudopath <span class="variable" translate="no">sudo_path</span>}}</code></pre><p>The credentials are the login credentials for the first Fleet Patching and Provisioning Server.</p>
                           </div>
                        </li>
                     </ol>
                     <div class="section">Once you register a Fleet Patching and Provisioning Server as a peer, the following command displays the peer (or peers) of the server:<pre class="pre codeblock"><code>$ rhpctl query peerserver</code></pre><div class="p">You can inspect the images on a peer Fleet Patching and Provisioning Server, as follows:<pre class="pre codeblock"><code>$ rhpctl query image -server <span class="variable" translate="no">server_cluster_name</span></code></pre></div>
                        <p>The preceding command displays all images on a specific peer Fleet Patching and Provisioning Server. Additionally, you can specify a peer server along with the <code class="codeph">-image <span class="variable" translate="no">image_name</span></code> parameter to display details of a specific image on a specific peer server.
                        </p>
                        <p>A Fleet Patching and Provisioning Server can have multiple peers. Oracle does not support chained relationships between peers, however, such as, if <code class="codeph">RHPS_1</code> is a peer of <code class="codeph">RHPS_2</code>, and <code class="codeph">RHPS_2</code> is also a peer of <code class="codeph">RHPS_3</code>, then no relationship is established or implied between <code class="codeph">RHPS_1</code> and <code class="codeph">RHPS_3</code>, although you can make them peers if you want.
                        </p>
                        <div class="p">Retrieve a copy or copies of gold images from a peer Fleet Patching and Provisioning Server, as follows:<pre class="pre codeblock"><code>$ rhpctl instantiate image &#x2013;server <span class="variable" translate="no">server_cluster_name</span></code></pre></div>
                        <div class="p">Running the <code class="codeph">rhpctl instantiate image</code> command activates an auto-update mechanism. From that point on, when you create gold images on a peer Fleet Patching and Provisioning Server (such as <code class="codeph">RHPS_2</code>), they are candidates for being automatically copied to the Fleet Patching and Provisioning Server that performed the instantiate operation (such as <code class="codeph">RHPS_1</code>). Whether a new gold image is automatically copied depends on that image’s relevance to any instantiate parameters that you may include in the command:
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><code class="codeph">-all</code>: Creates an automatic push for all gold images created on <code class="codeph">RHPS_2</code> to <code class="codeph">RHPS_1</code></p>
                              </li>
                              <li>
                                 <p><code class="codeph">-image <span class="variable" translate="no">image_name</span></code>: Creates an automatic push for all new descendant gold images of the named image created on <code class="codeph">RHPS_2</code> to <code class="codeph">RHPS_1</code>. A descendant of the named image is an image that is created on <code class="codeph">RHPS_2</code> using the <code class="codeph">rhpctl add image</code> command.
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">-series <span class="variable" translate="no">series_name</span></code>: Creates an automatic push for all gold images added to the named series on <code class="codeph">RHPS_2</code> to <code class="codeph">RHPS_1</code></p>
                              </li>
                              <li>
                                 <p><code class="codeph">-imagetype <span class="variable" translate="no">image_type</span></code>: Creates an automatic push for all gold images created of the named image type on <code class="codeph">RHPS_2</code> to <code class="codeph">RHPS_1</code></p>
                              </li>
                           </ul>
                        </div>
                        <p>To stop receiving updates that were established by the <code class="codeph">rhpctl instantiate image</code> command, run <code class="codeph">rhpctl uninstantiate image</code> and specify the peer Fleet Patching and Provisioning Server and one of the following: all, image name, image series name, or image type.
                        </p>
                        <div class="p">End the peer relationship, as follows, on any one of the Fleet Patching and Provisioning Servers:<pre class="pre codeblock"><code>$ rhpctl unregister server -server <span class="variable" translate="no">server_cluster_name</span></code></pre></div>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-0363908C-9003-4674-A361-72430E8A2487" title="Exports data from the repository to a Fleet Patching and Provisioning Server data file.">rhpctl export server</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-E004E59B-1388-4DBE-97DF-865AEBAC75D8" title="Registers the specific Fleet Patching and Provisioning Server as a peer server.">rhpctl register server</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-48AE57CE-5946-4D84-966B-2FDEF74D07A6" title="Displays information for a registered peer Fleet Patching and Provisioning Server.">rhpctl query peerserver</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-8365ABC0-B4E6-45BE-9616-8956E3E32CDD" title="Displays the configuration of an existing image.">rhpctl query image</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-8F63A46A-2580-444D-A8BE-1B06D2147323" title="Requests copies of gold images from a peer Fleet Patching and Provisioning Server.">rhpctl instantiate image</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-F91D87BD-3141-404A-BFB2-E8B5042C1779" title="Stops updates for previously requested images from a peer Fleet Patching and Provisioning Server.">rhpctl uninstantiate image</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-401A62BB-587F-45BF-9218-1174C1AF5834" title="Unregisters a specific Fleet Patching and Provisioning Server as a peer server.">rhpctl unregister server</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-A12679AF-D30B-4E96-94AF-ED2AA703F428" name="GUID-A12679AF-D30B-4E96-94AF-ED2AA703F428"></a><h4 id="CWADD-GUID-A12679AF-D30B-4E96-94AF-ED2AA703F428" class="sect4">Fleet Patching and Provisioning Server Auditing</h4>
                  <div>
                     <p>The Fleet Patching and Provisioning Server records the execution of all Fleet Patching and Provisioning operations, and also records whether those operations succeeded or failed.</p>
                     <div class="section">
                        <p>An audit mechanism enables administrators to query the audit log in a variety of dimensions, and also to manage its contents and size.</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-80D9C9A4-12EF-4D3C-8750-DCF3A4933C2E" name="GUID-80D9C9A4-12EF-4D3C-8750-DCF3A4933C2E"></a><h4 id="CWADD-GUID-80D9C9A4-12EF-4D3C-8750-DCF3A4933C2E" class="sect4">Fleet Patching and Provisioning Notifications</h4>
                  <div>
                     <p>The Fleet Patching and Provisioning Server is the central repository for the software homes available to the data center. Therefore, it is essential for administrators throughout the data center to be aware of changes to the inventory that may impact their areas of responsibility.</p>
                     <div class="section">
                        <p>You can create subscriptions to image series events. Fleet Patching and Provisioning notifies a subscribed role or number of users by email of any changes to the images available in the series, including addition or removal of an image. Each series may have a unique group of subscribers.</p>
                        <p>Also, when a working copy of a gold image is added to or deleted from a target, the owner of the working copy and any additional users can be notified by email. If you want to enable notifications for additional Fleet Patching and Provisioning events, you can create a user-defined action as described in the next section.</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="CWADD92589"></a><div class="props_rev_3"><a id="GUID-33FC643F-0A2C-4EFF-A13A-D3054D945119" name="GUID-33FC643F-0A2C-4EFF-A13A-D3054D945119"></a><h3 id="CWADD-GUID-33FC643F-0A2C-4EFF-A13A-D3054D945119" class="sect3">Fleet Patching and Provisioning Implementation</h3>
               <div>
                  <p>Implementing Fleet Patching and Provisioning involves creating a Fleet Patching and Provisioning Server, adding gold images to the server, and creating working copies of gold images to provision software.</p>
                  <p>After you install and configure Oracle Clusterware, you can configure and start using Fleet Patching and Provisioning. You must create a Fleet Patching and Provisioning Server where you create and store gold images of database and other software homes.</p>
               </div><a id="CWADD92648"></a><div class="props_rev_3"><a id="GUID-50B4A759-EE58-47AF-9B50-84572A58606A" name="GUID-50B4A759-EE58-47AF-9B50-84572A58606A"></a><h4 id="CWADD-GUID-50B4A759-EE58-47AF-9B50-84572A58606A" class="sect4">Creating a Fleet Patching and Provisioning Server</h4>
                  <div>
                     <p>The Fleet Patching and Provisioning Server uses a repository that you create in an Oracle ACFS file system in which you store all the software homes that you want to make available to clients and targets.</p>
                     <div class="section">
                        <p>To create a Fleet Patching and Provisioning Server:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Use the Oracle ASM configuration assistant (ASMCA) to create an Oracle ASM disk group on the Fleet Patching and Provisioning Server to store software, as follows:</span><div><pre class="pre codeblock"><code>$ <span class="variable" translate="no">Grid_home</span>/bin/asmca</code></pre><p>Because this disk group is used to store software, Oracle recommends a minimum of 50 GB for this disk group.</p>
                              <div class="infoboxnote" id="GUID-50B4A759-EE58-47AF-9B50-84572A58606A__GUID-9549C3DB-B206-4219-840D-065F282FC846">
                                 <p class="notep1">Note:</p>
                                 <p>You must set Oracle ASM Dynamic Volume Manager (Oracle ADVM) compatibility settings for this disk group to <code class="codeph">12.1</code>.
                                 </p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Provide a mount path that exists on all nodes of the cluster. The Fleet Patching and Provisioning Server uses this path to mount gold images.</span><div><pre class="pre codeblock"><code>$ mkdir -p <span class="variable" translate="no">storage_path</span>/images</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>As <code class="codeph">root</code>, create the Fleet Patching and Provisioning Server resource, as follows:</span><div><pre class="pre codeblock"><code># <span class="variable" translate="no">Grid_home</span>/bin/srvctl add rhpserver -storage <span class="variable" translate="no">storage_path</span>
    -diskgroup <span class="variable" translate="no">disk_group_name</span></code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Start the Fleet Patching and Provisioning Server, as follows:</span><div><pre class="pre codeblock"><code>$ <span class="variable" translate="no">Grid_home</span>/bin/srvctl start rhpserver</code></pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>After you start the Fleet Patching and Provisioning Server, use the Fleet Patching and Provisioning Control (RHPCTL) utility to further manage Fleet Patching and Provisioning.</p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="../ostmg/diskgroup-compatibility.html#OSTMG-GUID-FBB5AA72-5208-48E1-BD8D-0FD4C6876F34" target="_blank"><span><cite>Oracle Automatic Storage Management Administrator's Guide</cite></span></a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-66345667-F035-4ADB-A25F-5530299E04B7" title="Use the Fleet Patching and Provisioning Control (RHPCTL) utility to manage Fleet Patching and Provisioning in your cluster.">Fleet Patching and Provisioning Control (RHPCTL) Command Reference</a></li>
                           <li><a href="server-control-command-reference.html#GUID-1DCA9E3F-B929-4555-B673-921FF3588AC3" title="Use the Server Control (SRVCTL) utility to manage various components and applications in your cluster.">Server Control (SRVCTL) Command Reference</a></li>
                        </ul>
                     </div>
                  </div>
               </div><a id="CWADD92649"></a><div class="props_rev_3"><a id="GUID-58793EAD-3C8B-4C3F-A5CB-680BD5693A14" name="GUID-58793EAD-3C8B-4C3F-A5CB-680BD5693A14"></a><h4 id="CWADD-GUID-58793EAD-3C8B-4C3F-A5CB-680BD5693A14" class="sect4">Adding Gold Images to the Fleet Patching and Provisioning Server</h4>
                  <div>
                     <p>Use RHPCTL to add gold images for later provisioning of software.</p>
                     <div class="section">
                        <p>The Fleet Patching and Provisioning Server stores and serves gold images of software homes. These images must be instantiated on the Fleet Patching and Provisioning Server.</p>
                        <div class="infoboxnote" id="GUID-58793EAD-3C8B-4C3F-A5CB-680BD5693A14__GUID-B9C7EF26-38E3-4A25-9163-839FC055AB01">
                           <p class="notep1">Note:</p>
                           <p>Images are read-only, and you cannot run programs from them. To create a usable software home from an image, you must create a working copy of a gold image. You cannot directly use images as software homes. You can, however, use images to create working copies (software homes).</p>
                        </div>
                        <p>You can import software to the Fleet Patching and Provisioning Server using any one of the following methods:</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>You can import an image from an installed home on the Fleet Patching and Provisioning Server using the following command:</p><pre class="pre codeblock"><code>rhpctl import image -image <span class="variable" translate="no">image_name</span> -path <span class="variable" translate="no">path_to_installed_home</span>
  [-imagetype ORACLEDBSOFTWARE | ORACLEGISOFTWARE | ORACLEGGSOFTWARE | SOFTWARE]
</code></pre></li>
                           <li>
                              <p>You can import an image from an installed home on a Fleet Patching and Provisioning Client, using the following command run from the Fleet Patching and Provisioning Client:</p><pre class="pre codeblock"><code>rhpctl import image -image <span class="variable" translate="no">image_name</span> -path <span class="variable" translate="no">path_to_installed_home</span>
</code></pre></li>
                           <li>
                              <p>You can create an image from an existing working copy using the following command:</p><pre class="pre codeblock"><code>rhpctl add image &#x2013;image <span class="variable" translate="no">image_name</span> -workingcopy <span class="variable" translate="no">working_copy_name</span>
</code></pre></li>
                        </ul>
                        <p>Use the first two commands in the preceding list to seed the image repository, and to add additional images over time. Use the third command on the Fleet Patching and Provisioning Server as part of the workflow for creating a gold image that includes patches applied to a pre-existing gold image.</p>
                        <p>The preceding three commands also create an Oracle ACFS file system in the Fleet Patching and Provisioning root directory, similar to the following:</p><pre class="pre codeblock"><code>/u01/rhp/images/images/RDBMS_121020617524</code></pre></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning.html#GUID-CD92C0DB-D5E2-427A-8784-94F4C140B279" title="To patch an Oracle database, you move the database home to a new home, which includes the patches you want to implement.">Patching Oracle Database Software</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-BB5B4501-E270-482A-ADEF-B3D487A9055E" title="This section describes RHPCTL command usage information, and lists and describes RHPCTL commands.">RHPCTL Command Reference</a></li>
                        </ul>
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-7D5E221B-4F74-4ECE-ADD1-6F060D6D7A7C" name="GUID-7D5E221B-4F74-4ECE-ADD1-6F060D6D7A7C"></a><h5 id="CWADD-GUID-7D5E221B-4F74-4ECE-ADD1-6F060D6D7A7C" class="sect5">Image State</h5>
                     <div>
                        <p>You can set the <a id="d25134e3485" class="indexterm-anchor"></a>state of an image to <code class="codeph">TESTABLE</code> or <code class="codeph">RESTRICTED</code> so that only users with the GH_IMG_TESTABLE or GH_IMG_RESTRICT roles can provision working copies from this image. Once the image has been tested or validated, you can change the state and make the image available for general use by running the <code class="codeph">rhpctl promote image -image </code><span class="italic"><code class="codeph">image_name</code></span><code class="codeph"> -state PUBLISHED</code> command. The default image state is <code class="codeph">PUBLISHED</code> when you add a new gold image, but you can optionally specify a different state with the <code class="codeph">rhpctl add image</code> and <code class="codeph">rhpctl import image</code> commands.
                        </p>
                     </div>
                  </div>
                  <div class="props_rev_3"><a id="GUID-1FE5E4A1-3920-467C-B2DD-749F436D35E6" name="GUID-1FE5E4A1-3920-467C-B2DD-749F436D35E6"></a><h5 id="CWADD-GUID-1FE5E4A1-3920-467C-B2DD-749F436D35E6" class="sect5">Image Series</h5>
                     <div>
                        <p>An image series is a convenient way to group different gold images into a logical sequence.</p>
                        <p>Fleet Patching and Provisioning treats each image as an independent entity with respect to other images. No relationship is assumed between images, even if they follow some specific nomenclature. The image administrator may choose to name images in a logical manner that makes sense to the user community, but this does not create any management grouping within the Fleet Patching and Provisioning framework.</p>
                        <p>Use the <code class="codeph">rhpctl add series</code> command to create an image series and associate one or more images to this series. The list of images in an image series is an ordered list. Use the <code class="codeph">rhpctl insertimage series</code> and <code class="codeph">rhpctl deleteimage series</code> to add and delete images in an image series. You can also change the order of images in a series using these commands.
                        </p>
                        <p>The <code class="codeph">insertimage</code> and <code class="codeph">deleteimage</code> commands do not instantiate or delete actual gold images but only change the list. Also, an image can belong to more than one series (or no series at all).
                        </p>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-E3AF7DAC-8612-445B-9368-60A30C1DA474" name="GUID-E3AF7DAC-8612-445B-9368-60A30C1DA474"></a><h5 id="CWADD-GUID-E3AF7DAC-8612-445B-9368-60A30C1DA474" class="sect5">Image Type</h5>
                     <div>
                        <p>When you add or import a gold image, you must specify an image type.</p>
                        <div class="p">Oracle Clusterware provides the following built-in base image types:
                           <ul class="simple" style="list-style-type: none;padding-left:0;">
                              <li>ORACLEDBSOFTWARE</li>
                              <li>ORACLEGISOFTWARE</li>
                              <li>ORACLEGGSOFTWARE</li>
                              <li>SOFTWARE</li>
                           </ul>
                        </div>
                        <p>Every gold image must have an image type, and you can create your own image types. A new image type must be based on one of the built-in types. The image type directs Fleet Patching and Provisioning to apply its capabilities for managing Oracle Grid Infrastructure and Oracle Database homes. Fleet Patching and Provisioning also uses image type to organize the custom workflow support framework.</p>
                        <div class="section">
                           <p class="subhead3" id="GUID-E3AF7DAC-8612-445B-9368-60A30C1DA474__GUID-ABC7FC26-98B7-4FD4-9223-9EA6EC3100E4">Creating a Custom Image Type</p>
                           <p>Use the <code class="codeph">rhpctl add imagetype</code> command to create custom image types.
                           </p>
                           <p>For example, to create an image type called DBTEST, which is based on the ORACLEDBSOFTWARE image type:</p><pre class="pre codeblock"><code>$ rhpctl add imagetype -imagetype DBTEST -basetype ORACLEDBSOFTWARE</code></pre><div class="infoboxnote" id="GUID-E3AF7DAC-8612-445B-9368-60A30C1DA474__GUID-4C069D6E-91A9-4425-A9EE-C92DA864AB6C">
                              <p class="notep1">Note:</p>When you create an image type that is based on an existing image type, the new image type does not inherit any user actions (for custom workflow support) from the base type.
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="CWADD93063"></a><div class="props_rev_3"><a id="GUID-FE6E954E-89D7-4AE3-9B9B-A26B787ECBAE" name="GUID-FE6E954E-89D7-4AE3-9B9B-A26B787ECBAE"></a><h4 id="CWADD-GUID-FE6E954E-89D7-4AE3-9B9B-A26B787ECBAE" class="sect4">Provisioning Copies of Gold Images</h4>
                  <div>
                     <p>Use RHPCTL to provision copies of gold images to Fleet Patching and Provisioning Servers, Clients, and targets.</p>
                     <div class="section">
                        <p>After you create and import a gold image, you can provision software by adding a copy of the gold image (called a working copy) on the Fleet Patching and Provisioning Server, on a Fleet Patching and Provisioning Client, or a target. You can run the software provisioning command on either the Server or a Client.</p>
                     </div>
                     <!-- class="section" -->
                     <ul>
                        <li class="stepexpand"><span>To create a working copy on the Fleet Patching and Provisioning Server:</span><div><pre class="pre codeblock"><code>$ rhpctl add workingcopy -workingcopy <span class="variable" translate="no">working_copy_name</span> -image <span class="variable" translate="no">image_name</span>
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>To create a working copy in a local file system on a Fleet Patching and Provisioning Client:</span><div><pre class="pre codeblock"><code>$ rhpctl add workingcopy -workingcopy <span class="variable" translate="no">working_copy_name</span> -image <span class="variable" translate="no">image_name</span>
   -storagetype LOCAL -path <span class="variable" translate="no">path_to_software_home</span></code></pre></div>
                        </li>
                        <li class="stepexpand"><span>To create a working copy on a Fleet Patching and Provisioning Client from the Fleet Patching and Provisioning Server:</span><div><pre class="pre codeblock"><code>$ rhpctl add workingcopy -workingcopy <span class="variable" translate="no">working_copy_name</span> -image <span class="variable" translate="no">image_name</span>
   -client <span class="variable" translate="no">client_cluster_name</span></code></pre></div>
                        </li>
                     </ul>
                     <div class="section">
                        <div class="infoboxnote" id="GUID-FE6E954E-89D7-4AE3-9B9B-A26B787ECBAE__GUID-9286594C-2C93-4D9D-BF55-96B9B0431749">
                           <p class="notep1">Note:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>The directory you specify in the <code class="codeph">-path</code> parameter must be empty.
                                 </p>
                              </li>
                              <li>
                                 <p>You can re-run the provisioning command in case of an interruption or failure due to system or user errors. After you fix the reported errors, re-run the command and it will resume from the point of failure.</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning.html#GUID-94758068-0E75-40E1-BCAC-EFF25CBB76F1" title="Choose one of three storage options where Fleet Patching and Provisioning stores working copies of gold images.">Storage Options for Provisioned Software</a></li>
                        </ul>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-F343ADA0-D2B1-4451-AF2B-3E069FE15279" name="GUID-F343ADA0-D2B1-4451-AF2B-3E069FE15279"></a><h5 id="CWADD-GUID-F343ADA0-D2B1-4451-AF2B-3E069FE15279" class="sect5">User Group Management in Fleet Patching and Provisioning</h5>
                     <div>
                        <p>When you create a working copy of a gold image as part of a move or upgrade operation, Fleet Patching and Provisioning configures the operating system groups in the new working copy to match those of the source software home (either the unmanaged or the managed home from which you move or upgrade).</p>
                        <p>When you create a gold image of SOFTWARE image type, any user groups in the source are not inherited and images of this type never contain user group information. When you provision a working copy from a SOFTWARE gold image using the <code class="codeph">rhpctl add workingcopy</code> command, you can, optionally, configure user groups in the working copy using the <code class="codeph">-groups</code> parameter.
                        </p>
                        <p>The <code class="codeph">rhpctl move database</code>, <code class="codeph">rhpctl move gihome</code>, <code class="codeph">rhpctl upgrade database</code>, and <code class="codeph">rhpctl upgrade gihome</code> commands all require you to specify a source home (either an unmanaged home or a managed home (working copy) that you provisioned using Fleet Patching and Provisioning), and a destination home (which must be a working copy).
                        </p>
                        <p>When you have provisioned the destination home using the <code class="codeph">rhpctl add workingcopy</code> command, prior to performing a move or upgrade operation, you must ensure that the groups configured in the source home match those in the destination home. Fleet Patching and Provisioning configures the groups as part of the add operation.
                        </p>
                        <p>When you create a gold image of either the ORACLEGISOFTWARE or the ORACLEDBSOFTWARE image type from a source software home (using the <code class="codeph">rhpctl import image</code> command) or from a working copy (using the <code class="codeph">rhpctl add image</code> command), the gold image inherits the Oracle user groups that were configured in the source. You cannot override this feature.
                        </p>
                        <p>You can define user groups for ORACLEGISOFTWARE and ORACLEDBSOFTWARE working copies using the <code class="codeph">rhpctl add workingcopy</code> command, depending on the image type and user group, as discussed in the subsequent sections.
                        </p>
                        <p>This section describes how Fleet Patching and Provisioning manages user group configuration, and how the <code class="codeph">-groups</code> command-line option of <code class="codeph">rhpctl add workingcopy</code> functions.
                        </p>
                        <div class="section">
                           <p class="subhead3" id="GUID-F343ADA0-D2B1-4451-AF2B-3E069FE15279__GUID-E2B7AB57-0580-44EB-8384-140D4B79755F">ORACLEGISOFTWARE (Oracle Grid Infrastructure 11<span class="italic">g</span> release 2 (11.2), and 12<span class="italic">c</span> release 1 (12.1) and release 2 (12.2))
                           </p>
                           <p>When you provision an Oracle Grid Infrastructure working copy of a gold image, the groups are set in the working copy according to the type of provisioning (whether regular provisioning or software only, and with or without the <code class="codeph">-local</code> parameter), and whether you specify the <code class="codeph">-groups</code> parameter with <code class="codeph">rhpctl add workingcopy</code>. You can define OSDBA and OSASM user groups in Oracle Grid Infrastructure software with either the <code class="codeph">-softwareonly</code> command parameter or by using a response file with the <code class="codeph">rhpctl add workingcopy</code> command.
                           </p>
                           <p>If you are provisioning only the Oracle Grid Infrastructure software using the <code class="codeph">-softwareonly</code> command parameter, then you cannot use the <code class="codeph">-groups</code> parameter, and Fleet Patching and Provisioning obtains OSDBA and OSASM user group information from the active Grid home.
                           </p>
                           <p>If you use the <code class="codeph">-local</code> command parameter (which is only valid when you use the <code class="codeph">-softwareonly</code> command parameter) with <code class="codeph">rhpctl add workingcopy</code>, then Fleet Patching and Provisioning takes the values of the groups from the command line (using the <code class="codeph">-groups</code> parameter) or uses the default values, which Fleet Patching and Provisioning obtains from the <code class="codeph">osdbagrp</code> binary of the gold image.
                           </p>
                           <p>If none of the preceding applies, then Fleet Patching and Provisioning uses the installer default user group.</p>
                           <div class="p">If you are provisioning and configuring a working copy using information from a response file, then Fleet Patching and Provisioning:
                              <ol>
                                 <li>
                                    <p>Uses the value of the user group from the command line, if provided, for OSDBA or OSASM, or both.</p>
                                 </li>
                                 <li>
                                    <p>If you provide no value on the command line, then Fleet Patching and Provisioning retrieves the user group information defined in the response file.</p>
                                 </li>
                              </ol>
                           </div>
                           <p>If you are defining the OSOPER Oracle group, then, again, you can either use the <code class="codeph">-softwareonly</code> command parameter or use a response file with the <code class="codeph">rhpctl add workingcopy</code> command.
                           </p>
                           <p>If you use the <code class="codeph">-softwareonly</code> command parameter, then you can provide the value on the command line (using the <code class="codeph">-groups</code> parameter) or leave the user group undefined.
                           </p>
                           <p>If you are provisioning and configuring a working copy of a gold image using information from a response file, then you can provide the value on the command line, use the information contained in the response file, or leave the OSOPER Oracle group undefined.</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-F343ADA0-D2B1-4451-AF2B-3E069FE15279__GUID-4054A9F9-E51A-4B4F-9022-CF81029693AA">ORACLEDBSOFTWARE (Oracle Database 11<span class="italic">g</span> release 2 (11.2), and 12<span class="italic">c</span> release 1 (12.1) and release 2 (12.2))
                           </p>
                           <p>If you are provisioning a working copy of Oracle Database software and you want to define Oracle groups, then use the <code class="codeph">-groups</code> command parameter with the <code class="codeph">rhpctl add workingcopy</code> command. Oracle groups available in the various Oracle Database releases are as follows:
                           </p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Oracle Database 11<span class="italic">g</span> release 2 (11.2)
                                 </p>
                                 <ul class="simple" style="list-style-type: none;padding-left:0;">
                                    <li>OSDBA</li>
                                    <li>OSOPER</li>
                                 </ul>
                              </li>
                              <li>
                                 <p>Oracle Database 12<span class="italic">c</span> release 1 (12.1)
                                 </p>
                                 <ul class="simple" style="list-style-type: none;padding-left:0;">
                                    <li>OSDBA</li>
                                    <li>OSOPER</li>
                                    <li>OSBACKUP</li>
                                    <li>OSDG</li>
                                    <li>OSKM</li>
                                 </ul>
                              </li>
                              <li>
                                 <p>Oracle Database 12<span class="italic">c</span> release 2 (12.2)
                                 </p>
                                 <ul class="simple" style="list-style-type: none;padding-left:0;">
                                    <li>OSDBA</li>
                                    <li>OSOPER</li>
                                    <li>OSBACKUP</li>
                                    <li>OSDG</li>
                                    <li>OSKM</li>
                                    <li>OSRAC</li>
                                 </ul>
                              </li>
                           </ul>
                           <p>Regardless of which of the preceding groups you are defining (except for OSOPER), Fleet Patching and Provisioning takes the values of the groups from the command line (using the <code class="codeph">-groups</code> parameter) or uses the default values, which Fleet Patching and Provisioning obtains from the <code class="codeph">osdbagrp</code> binary of the gold image.
                           </p>
                           <p>If any group picked up from the <code class="codeph">osdbagrp</code> binary is not in the list of groups to which the database user belongs (given by the <code class="codeph">id</code> command), then Fleet Patching and Provisioning uses the installer default user group. Otherwise, the database user is the user running the <code class="codeph">rhpctl add workingcopy</code> command.
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="CWADD93064"></a><div class="props_rev_3"><a id="GUID-94758068-0E75-40E1-BCAC-EFF25CBB76F1" name="GUID-94758068-0E75-40E1-BCAC-EFF25CBB76F1"></a><h5 id="CWADD-GUID-94758068-0E75-40E1-BCAC-EFF25CBB76F1" class="sect5">Storage Options for Provisioned Software</h5>
                     <div>
                        <p>Choose one of three storage options where Fleet Patching and Provisioning stores working copies of gold images.</p>
                        <p>When you provision software using the <code class="codeph">rhpctl add workingcopy</code> command, you can choose from three storage options where Fleet Patching and Provisioning places that software:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>In an Oracle ACFS shared file system managed by Fleet Patching and Provisioning (for database homes only)</p>
                           </li>
                           <li>
                              <p>In a local file system not managed by Fleet Patching and Provisioning</p>
                           </li>
                        </ul>
                        <p>Using the <code class="codeph">rhpctl add workingcopy</code> command with the <code class="codeph">&#x2013;storagetype</code> and <code class="codeph">&#x2013;path</code> parameters, you can choose where you store provisioned working copies. The applicability of the parameters depends on whether the node (or nodes) to which you are provisioning the working copy is a Fleet Patching and Provisioning Server, Fleet Patching and Provisioning Client, or a non-Fleet Patching and Provisioning client. You can choose from the following values for the <code class="codeph">&#x2013;stroragetype</code> parameter:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">RHP_MANAGED</code>: Choosing this value, which is available for Fleet Patching and Provisioning Servers and Fleet Patching and Provisioning Clients, stores working copies in an Oracle ACFS shared file system. The <code class="codeph">&#x2013;path</code> parameter is not used with this option because Fleet Patching and Provisioning manages the storage option.
                              </p>
                              <div class="infoboxnote" id="GUID-94758068-0E75-40E1-BCAC-EFF25CBB76F1__GUID-E13E3FE5-B983-4191-A717-370F849A5391">
                                 <p class="notep1">Notes:</p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>You cannot store Oracle Grid Infrastructure homes in <code class="codeph">RHP_MANAGED</code> storage.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Oracle recommends using the <code class="codeph">RHP_MANAGED</code> storage type, which is available on Fleet Patching and Provisioning Servers, and on Clients configured with an Oracle ASM disk group.
                                       </p>
                                    </li>
                                    <li>
                                       <p>If you provision working copies on a Fleet Patching and Provisioning Server, then you do not need to specify the <code class="codeph">-storagetype</code> option because it will default to <code class="codeph">RHP_MANAGED</code>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>If you choose to provision working&nbsp;copies on a Fleet Patching and Provisioning Client, and you do not specify the <code class="codeph">-path</code> parameter, then the storage type defaults to <code class="codeph">RHP_MANAGED</code> only if there is an Oracle ASM disk group on the client. Otherwise the command will fail. If you specify a location on the client for the <code class="codeph">-path</code> parameter, then the storage type defaults to <code class="codeph">LOCAL</code> with or without an Oracle ASM disk group.
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <p><code class="codeph">LOCAL</code>: Choosing this value stores working copies in a local file system that is not managed by Fleet Patching and Provisioning. You must specify a path to the file system on the Fleet Patching and Provisioning Server, Fleet Patching and Provisioning Client, or non-Fleet Patching and Provisioning client, or to the Oracle ASM disk group on the Fleet Patching and Provisioning Client.
                              </p>
                           </li>
                        </ul>
                        <p>In cases where you specify the <code class="codeph">&#x2013;path</code> parameter, if the file system is shared among all of the nodes in the cluster, then the working copy gets created on this shared storage. If the file system is not shared, then the working copy gets created in the location of the given path on every node in the cluster.
                        </p>
                        <div class="infoboxnote" id="GUID-94758068-0E75-40E1-BCAC-EFF25CBB76F1__GUID-095CD677-DCCD-441C-AC1B-9E70E7767F49">
                           <p class="notep1">Note:</p>The directory you specify in the <code class="codeph">-path</code> parameter must be empty.
                        </div>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>Related Topics</strong></p>
                           <ul>
                              <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-61929F3C-A50A-45EA-8B4A-D11E245A6493" title="Creates a working copy on a client cluster.">rhpctl add workingcopy</a></li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="CWADD93065"></a><div class="props_rev_3"><a id="GUID-40F14729-5687-404E-8F89-83144E4673CF" name="GUID-40F14729-5687-404E-8F89-83144E4673CF"></a><h5 id="CWADD-GUID-40F14729-5687-404E-8F89-83144E4673CF" class="sect5">Provisioning for a Different User</h5>
                     <div>
                        <p>If you want a different user to provision software other than the user running the command, then use the <code class="codeph">-user</code> parameter of the <code class="codeph">rhpctl add workingcopy</code> command.
                        </p>
                        <div class="section">
                           <p>When the provisioning is completed, all files and directories of the provisioned software are owned by the user you specified. Permissions on files on the remotely provisioned software are the same as the permissions that existed on the gold image from where you provisioned the application software.</p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-5DDE9952-9D6E-4DD7-99C1-245081954645" name="GUID-5DDE9952-9D6E-4DD7-99C1-245081954645"></a><h4 id="CWADD-GUID-5DDE9952-9D6E-4DD7-99C1-245081954645" class="sect4">Propagating Images Between Fleet Patching and Provisioning Servers</h4>
                  <div>
                     <p>With automatic image propagation, you can set up automated copies of software images across different peer Fleet Patching and Provisioning Servers. Gold images that you register at one site are copied to peer Fleet Patching and Provisioning Servers.</p>
                     <div class="section">In a peer-to-peer relationship between two Fleet Patching and Provisioning Servers, one server is the source for software images and the other is the destination for software images.</div>
                     <!-- class="section" -->
                     <div class="section">The criteria for copying software images between servers can be based on certain policies, such as software image type, image series, or all software images. When you register an image that meets the criteria for software image propagation, a copy of this image propagates to all registered peer servers.</div>
                     <!-- class="section" -->
                     <div class="p">The following example procedure establishes a relationship between two Fleet Patching and Provisioning Server sites, <code class="codeph">RHPS-A</code> and <code class="codeph">RHPS-B</code>, where <code class="codeph">RHPS-A</code> is the source and <code class="codeph">RHPS-B</code> is the destination for software images.
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Run the following command on <code class="codeph">RHPS-B</code>:</span><div><pre class="pre codeblock"><code>$ rhpctl export server -server RHPS-A -serverdata <span class="variable" translate="no">file_path</span></code></pre><p>The preceding command creates a file named <code>RHPS-B.xml</code> in the directory path you specify for the <code class="codeph">-serverdata</code> parameter.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Run the following command to register a peer server to the current Fleet Patching and Provisioning Server:</span><div><pre class="pre codeblock"><code>$ rhpctl register server -server RHPS-B -serverdata /tmp/RHPS-B.xml</code></pre><p>The preceding command copies the <code>RHPS-B.xml</code> file that was created in the previous step to a location on the server where you run the command, which is <code>/tmp/RHPS-B.xml</code>, in this case.
                              </p>
                              <p>The cluster in which you run the preceding command is the source site, and the server that you specify on the command line is the destination site to which software images are copied.</p>
                              <p>Use the <code class="codeph">rhpctl unregister server</code> command to remove the peer-to-peer relationship.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Run the following command on <code class="codeph">RHPS-B</code> to propagate software images from <code class="codeph">RHPS-A</code> to <code class="codeph">RHPS-B</code>:</span><div><pre class="pre codeblock"><code>$ rhpctl instantiate image -server RHPS-A  -all</code></pre><div class="p">The preceding command propagates all images from <code class="codeph">RHPS-A</code> to <code class="codeph">RHPS-B</code>. If an image already exists on <code class="codeph">RHPS-B</code>, then it is not propagated again.
                                 <div class="infoboxnote" id="GUID-5DDE9952-9D6E-4DD7-99C1-245081954645__GUID-CC55A4A0-8CEA-4628-B5D0-A1C674435216">
                                    <p class="notep1">Note:</p>Propagation of images is based on the image name. RHPCTL does not compare the content of the images, themselves, to determine whether they are different. If an image you want to propagate has a non-unique name, then RHPCTL assumes that the images are identical and does not propagate the image.
                                 </div>
                              </div>
                              <p>Use the <code class="codeph">rhpctl uninstantiate image</code> command to cancel the propagation of a particular image. Any propagation already in progress is not affected by this command, and will continue until complete. The <code class="codeph">-all</code> parameter removes any values for the <code class="codeph">-imagetype</code> and <code class="codeph">-series</code> parameters.
                              </p>
                           </div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-0363908C-9003-4674-A361-72430E8A2487" title="Exports data from the repository to a Fleet Patching and Provisioning Server data file.">rhpctl export server</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-E004E59B-1388-4DBE-97DF-865AEBAC75D8" title="Registers the specific Fleet Patching and Provisioning Server as a peer server.">rhpctl register server</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-401A62BB-587F-45BF-9218-1174C1AF5834" title="Unregisters a specific Fleet Patching and Provisioning Server as a peer server.">rhpctl unregister server</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-8F63A46A-2580-444D-A8BE-1B06D2147323" title="Requests copies of gold images from a peer Fleet Patching and Provisioning Server.">rhpctl instantiate image</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-F91D87BD-3141-404A-BFB2-E8B5042C1779" title="Stops updates for previously requested images from a peer Fleet Patching and Provisioning Server.">rhpctl uninstantiate image</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="sect2"><a id="GUID-F4F263A1-0580-4386-B929-5252A196632E" name="GUID-F4F263A1-0580-4386-B929-5252A196632E"></a><h3 id="CWADD-GUID-F4F263A1-0580-4386-B929-5252A196632E" class="sect3">Oracle Grid Infrastructure Management</h3>
               <div>
                  <p>The Fleet Patching and Provisioning Server provides an efficient and secure platform for the distribution of Oracle Grid Infrastructure homes to targets and Fleet Patching and Provisioning Clients.</p>
                  <p>Also, Fleet Patching and Provisioning Clients have the ability to fetch Oracle Grid Infrastructure homes from the Fleet Patching and Provisioning Server.</p>
                  <p>Oracle Grid Infrastructure homes are distributed in the form of working copies of gold images. After a working copy has been provisioned, Fleet Patching and Provisioning can optionally configure Oracle Grid Infrastructure. This gives Fleet Patching and Provisioning the ability to create an Oracle Grid Infrastructure installation on a group of one or more nodes that initially do not have Oracle Grid Infrastructure installed.</p>
                  <p>Fleet Patching and Provisioning also has commands for managing Oracle Grid Infrastructure homes, such as switching to a patched home or upgrading to a new Oracle Grid Infrastructure version. These are both single commands that orchestrate the numerous steps involved. Reverting to the original home is just as simple. Also, Fleet Patching and Provisioning can add or delete nodes from an Oracle Grid Infrastructure configuration.</p>
               </div>
               <div class="sect3"><a id="GUID-31A09C7F-CC05-4343-8C1A-C99E33B7AFC7" name="GUID-31A09C7F-CC05-4343-8C1A-C99E33B7AFC7"></a><h4 id="CWADD-GUID-31A09C7F-CC05-4343-8C1A-C99E33B7AFC7" class="sect4">About Deploying Oracle Grid Infrastructure Using Fleet Patching and Provisioning (FPP)</h4>
                  <div>
                     <p>Fleet Patching and Provisioning (FPP) is a software lifecycle management method for provisioning and maintaining Oracle homes. Fleet Patching and Provisioning enables mass deployment and maintenance of standard operating environments for databases, clusters, and user-defined software types.</p>
                     <div class="infoboxnote" id="GUID-31A09C7F-CC05-4343-8C1A-C99E33B7AFC7__GUID-ED7E64BD-4196-494E-94EB-52079FFB7E7B">
                        <p class="notep1">Note:</p>Starting with Oracle Grid Infrastructure 19c, the feature formerly known as Rapid Home Provisioning (RHP) is now Fleet Patching and Provisioning (FPP).
                     </div>
                     <p> Fleet Patching and Provisioning enables you to install clusters, and provision, patch, scale, and upgrade Oracle Grid Infrastructure, Oracle Restart, and Oracle Database homes. The supported versions are 11.2, 12.1, 12.2, 18c, and 19c. You can also provision applications and middleware using Fleet Patching and Provisioning.</p>
                     <p>Fleet Patching and Provisioning is a service in Oracle Grid Infrastructure that you can use in either of the following modes:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Central Fleet Patching and Provisioning Server </p>
                           <p>The Fleet Patching and Provisioning Server stores and manages standardized images, called gold images. Gold images can be deployed to any number of nodes across the data center. You can create new clusters and databases on the deployed homes and can use them to patch, upgrade, and scale existing installations.</p>
                           <div class="p">The Fleet Patching and Provisioning Server can manage the following types of installations: 
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>Software homes on the cluster hosting the Fleet Patching and Provisioning Server itself.</p>
                                 </li>
                                 <li>
                                    <p>Fleet Patching and Provisioning Clients running Oracle Grid Infrastructure 12c Release 2 (12.2), 18c, and 19c.</p>
                                 </li>
                                 <li>
                                    <p>Installations running Oracle Grid Infrastructure 11g Release 2 (11.2) and 12c Release 1 (12.1).</p>
                                 </li>
                                 <li>
                                    <p>Installations running without Oracle Grid Infrastructure.</p>
                                 </li>
                              </ul>
                           </div>
                           <p>The Fleet Patching and Provisioning Server can provision new installations and can manage existing installations without requiring any changes to the existing installations. The Fleet Patching and Provisioning Server can automatically share gold images among peer servers to support enterprises with geographically distributed data centers.</p>
                        </li>
                        <li>
                           <p>Fleet Patching and Provisioning Client</p>
                           <p>The Fleet Patching and Provisioning Client can be managed from the Fleet Patching and Provisioning Server, or directly by executing commands on the client itself. The Fleet Patching and Provisioning Client is a service built into the Oracle Grid Infrastructure and is available in Oracle Grid Infrastructure 12c Release 2 (12.2) and later releases. The Fleet Patching and Provisioning Client can retrieve gold images from the Fleet Patching and Provisioning Server, upload new images based on the policy, and apply maintenance operations to itself.</p>
                        </li>
                     </ul>
                     <div class="section">
                        <p class="subhead3" id="GUID-31A09C7F-CC05-4343-8C1A-C99E33B7AFC7__GUID-E5549D9E-52B9-4C39-AC7B-54B3400D528A">Fleet Patching and Provisioning</p>
                        <p>Deploying Oracle software using Fleet Patching and Provisioning has the following advantages:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Ensures standardization and enables high degrees of automation with gold images and managed lineage of deployed software.</p>
                           </li>
                           <li>
                              <p>Minimizes downtime by deploying new homes as images (called gold images) out-of-place, without disrupting active databases or clusters.</p>
                           </li>
                           <li>
                              <p>Simplifies maintenance by providing automatons which are invoked with a simple, consistent API across database versions and deployment models.</p>
                           </li>
                           <li>
                              <p>Reduces maintenance risk with built-in validations and a “dry run” mode to test the operations.</p>
                           </li>
                           <li>
                              <p>Enables you to resume or restart the commands in the event of an unforeseen issue, reducing the risk of maintenance operations.</p>
                           </li>
                           <li>
                              <p>Minimizes and often eliminates the impact of patching and upgrades, with features that include:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>Zero-downtime database upgrade with fully automated upgrade, executed entirely within the deployment without requiring any extra nodes or external storage.</p>
                                 </li>
                                 <li>
                                    <p>Adaptive management of database sessions and OJVM during rolling patching.</p>
                                 </li>
                                 <li>
                                    <p>Options for management of consolidated deployments.</p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>The deployment and maintenance operations enable customizations to include environment-specific actions into the automated workflow.</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning.html#CWADD92402" target="_blank"><span><cite>Oracle Clusterware Administration and Deployment Guide</cite></span></a></li>
                        </ul>
                     </div>
                     <div class="infoboxnotealso" id="GUID-31A09C7F-CC05-4343-8C1A-C99E33B7AFC7__GUID-1E3F2B12-F069-4BE8-B24E-E003A62FA4EB">
                        <p class="notep1">See Also:</p> <span><cite>Oracle Clusterware Administration and Deployment Guide</cite></span> for information about setting up the Fleet Patching and Provisioning Server and Client, and for creating and using gold images for provisioning and patching Oracle Grid Infrastructure and Oracle Database homes.
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-CD7FC0E1-31BD-45D3-A3D0-2DB788E4DB24" name="GUID-CD7FC0E1-31BD-45D3-A3D0-2DB788E4DB24"></a><h4 id="CWADD-GUID-CD7FC0E1-31BD-45D3-A3D0-2DB788E4DB24" class="sect4">Provisioning Oracle Grid Infrastructure Software</h4>
                  <div>
                     <p>Fleet Patching and Provisioning has several methods to provision and, optionally, configure Oracle Grid Infrastructure and Oracle Restart grid infrastructure homes.</p>
                     <div class="section">Fleet Patching and Provisioning can provision and configure Oracle Grid Infrastructure on one or more nodes that do not currently have a Grid home, and then configure Oracle Grid Infrastructure to form a single-node or multi-node Oracle Grid Infrastructure installation.</div>
                     <!-- class="section" -->
                     <div class="section">Use the <code class="codeph">rhpctl add workingcopy</code> command to install and configure Oracle Grid Infrastructure, and to enable simple and repeatable creation of standardized deployments.
                     </div>
                     <!-- class="section" -->
                     <div class="section">The Fleet Patching and Provisioning Server can also provision an Oracle Grid Infrastructure home to a node or cluster that is currently running Oracle Grid Infrastructure. The currently running Grid home can be a home that Fleet Patching and Provisioning did not provision (an <span class="italic">unmanaged</span> home) or a home that Fleet Patching and Provisioning did provision (a <span class="italic">managed</span> home).
                     </div>
                     <!-- class="section" -->
                     <div class="section">You can also provision an Oracle Restart grid infrastructure to a node in the cluster.</div>
                     <!-- class="section" -->
                     <div class="section">In either case, use the <code class="codeph">-softwareonly</code> parameter of the <code class="codeph">rhpctl add workingcopy</code> command. This provisions but does not activate the new Grid home, so that when you are ready to switch to that new home, you can do so with a single command.
                     </div>
                     <!-- class="section" -->
                     <ul>
                        <li class="stepexpand"><span>To inform Fleet Patching and Provisioning the nodes on which to install Oracle Grid Infrastructure, and to configure Oracle Grid Infrastructure, you provide directions in a response file, as in the following example:</span><div><pre class="pre codeblock"><code>$ rhpctl add workingcopy -workingcopy GI_HOME_11204_WCPY -image GI_HOME_11204 &#x2013;responsefile /u01/app/rhpinfo/GI_11204_install.txt
  {<span class="variable" translate="no">authentication_option</span>}</code></pre><div class="p">The preceding command provisions the <code class="codeph">GI_HOME_11204_WCPY</code> working copy based on the <code class="codeph">GI_HOME_11204</code> gold image to a target specified in the <code class="codeph">GI_11204_install.txt</code> response file. In addition to identifying the target nodes, the response file specifies information about the Oracle Grid Infrastructure configuration, such as Oracle ASM and GNS parameters.
                                 <div class="infoboxnote" id="GUID-CD7FC0E1-31BD-45D3-A3D0-2DB788E4DB24__GUID-91F9102A-ED77-4C5A-8A85-5D5BF3A38093">
                                    <p class="notep1">Note:</p>The <code class="codeph">oracle.install.crs.rootconfig.executeRootScript=<span class="variable" translate="no">xxx</span></code> response file parameter is overridden and always set to <code class="codeph">false</code> for Fleet Patching and Provisioning, regardless of what you specify in the response file.
                                 </div>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>To provision an Oracle Grid Infrastructure home to a node or cluster that is currently running Oracle Grid Infrastructure:</span><div><pre class="pre codeblock"><code>$ rhpctl add workingcopy -workingcopy GI_HOME_12201_PATCHED_WCPY -image GI_HOME_12201_PSU1 &#x2013;client CLUST_002 -softwareonly</code></pre><p>The preceding command provisions a new working copy based on the <code class="codeph">GI_HOME_12201_PSU1</code> gold image to the Fleet Patching and Provisioning Client (that is running Oracle Grid Infrastructure 12<span class="italic">c</span> release 2 (12.2)) named <code class="codeph">CLUST_002</code>. When you provision to a target that is not running Oracle Grid Infrastructure 12<span class="italic">c</span> release 2 (12.2) (such as, a target running Oracle Grid Infrastructure 12<span class="italic">c</span> release 1 (12.1) or Oracle Grid Infrastructure 11<span class="italic">g</span> release 2 (11.2)), use the <code class="codeph">-targetnode</code> parameter instead of <code class="codeph">-client</code>.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Specify a target node on which you want to provision an Oracle Restart grid infrastructure, as follows:</span><div><pre class="pre codeblock"><code>$ rhpctl add workingcopy -workingcopy SIHA_GI -image goldimage -targetnode <span class="variable" translate="no">remote_node_name</span> -resposnefile <span class="variable" translate="no">Oracle_Restart_resposne_file</span> {<span class="variable" translate="no">authentication_option</span>}</code></pre></div>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning.html#GUID-44D851A3-9478-4A6F-A779-70FB85191A2C" title="Some RHPCTL commands show authentication choices as an optional parameter.">Authentication Options for Fleet Patching and Provisioning Operations</a></li>
                        </ul>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-856C7378-2510-4B3E-8BE1-B4D79DF4FE8B" name="GUID-856C7378-2510-4B3E-8BE1-B4D79DF4FE8B"></a><h4 id="CWADD-GUID-856C7378-2510-4B3E-8BE1-B4D79DF4FE8B" class="sect4">Patching Oracle Grid Infrastructure Software</h4>
                  <div>
                     <p>Fleet Patching and Provisioning provides three methods to patch Oracle Grid Infrastructure software homes: rolling, non-rolling, and in batches.</p>
                     <div class="section">Patching Oracle Grid Infrastructure software involves moving the Grid home to a patched version of the current Grid home. When the patching operation is initiated by a Fleet Patching and Provisioning Server or Client, the patched version must be a working copy of a gold image. The working copy to which you are moving the Grid home can be at a lower patch level than the current home. This facilitates rollback if any problems occur after moving to the higher-level patched home.
                        <p> You can also perform this operation using the independent automaton in an environment where no Fleet Patching and Provisioning Server is present. In this case, the source and destination homes are not working copies of gold images, but are two installed homes that you deployed with some method other than using Fleet Patching and Provisioning.</p>
                        <p>This section includes the following topics:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="rapid-home-provisioning.html#GUID-98C7EAF9-D7B3-4293-ABE5-ACC2F270F632" title="The rolling method for patching Oracle Grid Infrastructure is the default method.">Patching Oracle Grid Infrastructure Using the Rolling Method</a></p>
                           </li>
                           <li>
                              <p><a href="rapid-home-provisioning.html#GUID-5C9CE736-0C43-4E55-9275-F655AB73C140" title="You can use the -nonrolling parameter with the rhpctl move gihome command, which restarts the Oracle Grid Infrastructure stack on all nodes in parallel.">Patching Oracle Grid Infrastructure Using the Non-Rolling Method</a></p>
                           </li>
                           <li>
                              <p><a href="rapid-home-provisioning.html#GUID-83518C02-E439-49E7-A406-47FE5DCF49B0" title="The third patching method is to sequentially process batches of nodes, with a number of nodes in each batch being restarted in parallel.">Patching Oracle Grid Infrastructure Using Batches</a></p>
                           </li>
                           <li>
                              <p><a href="rapid-home-provisioning.html#GUID-A0C98197-0383-4B9F-A520-C4166EAF3180" title="When you patch an Oracle Grid Infrastructure deployment, Fleet Patching and Provisioning enables you to simultaneously patch the Oracle Database homes on the cluster, so you can patch both types of software homes in a single maintenance operation.">Combined Oracle Grid Infrastructure and Oracle Database Patching</a></p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-61929F3C-A50A-45EA-8B4A-D11E245A6493">rhpctl add workingcopy</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-4706B307-CEDE-4A91-97DE-6AFF552AEDC8">rhpctl move gihome</a></li>
                        </ul>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-98C7EAF9-D7B3-4293-ABE5-ACC2F270F632" name="GUID-98C7EAF9-D7B3-4293-ABE5-ACC2F270F632"></a><h5 id="CWADD-GUID-98C7EAF9-D7B3-4293-ABE5-ACC2F270F632" class="sect5">Patching Oracle Grid Infrastructure Using the Rolling Method</h5>
                     <div>
                        <p>The rolling method for patching Oracle Grid Infrastructure is the default method.</p>
                        <div class="section">You use the <code class="codeph">rhpctl move gihome</code> command (an atomic operation), which returns after the Oracle Grid Infrastructure stack on each node has been restarted on the new home. Nodes are restarted sequentially, so that only one node at a time will be offline, while all other nodes in the cluster remain online.
                        </div>
                        <!-- class="section" -->
                        <ul>
                           <li class="stepexpand"><span>Move the Oracle Grid Infrastructure home to a working copy of the same release level, as follows:</span><div><pre class="pre codeblock"><code>$ rhpctl move gihome -client <span class="variable" translate="no">cluster_name</span> &#x2013;sourcewc <span class="variable" translate="no">Grid_home_1</span> &#x2013;destwc <span class="variable" translate="no">Grid_home_2</span></code></pre><p>The preceding command moves the running Oracle Grid Infrastructure home from the current managed home (the <code class="codeph">sourcewc</code>) to the patched home (<code class="codeph">destwc</code>) on the specific client cluster. The patched home must be provisioned on the client.
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>If the move operation fails at some point before completing, then you can rerun the operation by running the command again and the operation will resume where it left off. This enables you to fix whatever problem caused the failure and resume processing from the point of failure. Or you can undo the partially completed operation and return the configuration to its initial state, as follows:</span><div><pre class="pre codeblock"><code>$ rhpctl move gihome -destwc <span class="variable" translate="no">destination_workingcopy_name</span> -revert [<span class="variable" translate="no">authentication_option</span>]</code></pre><p>You can use the <code class="codeph">-revert</code> parameter with an un-managed home.
                                 </p>
                              </div>
                           </li>
                        </ul>
                        <div class="section">
                           <div class="infoboxnote" id="GUID-98C7EAF9-D7B3-4293-ABE5-ACC2F270F632__GUID-33238487-FB19-4BC9-89D0-F1146D5497A0">
                              <p class="notep1">Notes:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>You cannot move the Grid home to a home that Fleet Patching and Provisioning does not manage. Therefore, rollback (to the original home) applies only to moves between two working copies. This restriction does not apply when using the independent automaton since it operates on unmanaged homes only.</p>
                                 </li>
                                 <li>
                                    <p>You can delete the source working copy at any time after moving a Grid home. Once you delete the working copy, however, you cannot perform a rollback. Also, use the <code class="codeph">rhpctl delete workingcopy</code> command (as opposed to <code class="codeph">rm</code>, for example) to remove the source working copy to keep the Fleet Patching and Provisioning inventory correct.
                                    </p>
                                 </li>
                                 <li>
                                    <p>If you use the <code class="codeph">-abort</code> parameter to terminate the patching operation, then Fleet Patching and Provisioning does not clean up or undo any of the patching steps. The cluster, databases, or both may be in an inconsistent state because all nodes are not patched.
                                    </p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-5C9CE736-0C43-4E55-9275-F655AB73C140" name="GUID-5C9CE736-0C43-4E55-9275-F655AB73C140"></a><h5 id="CWADD-GUID-5C9CE736-0C43-4E55-9275-F655AB73C140" class="sect5">Patching Oracle Grid Infrastructure Using the Non-Rolling Method</h5>
                     <div>
                        <p>You can use the <code class="codeph">-nonrolling</code> parameter with the <code class="codeph">rhpctl move gihome</code> command, which restarts the Oracle Grid Infrastructure stack on all nodes in parallel.
                        </p>
                        <div class="section">As with the rolling method, this is an atomic command which returns after all nodes are online.</div>
                        <!-- class="section" -->
                        <ul>
                           <li class="stepexpand"><span>Use the following command to patch Oracle Grid Infrastructure in an non-rolling fashion:</span><div><pre class="pre codeblock"><code>$ rhpctl move gihome -client <span class="variable" translate="no">cluster_name</span> &#x2013;sourcewc <span class="variable" translate="no">Grid_home_1</span> &#x2013;destwc <span class="variable" translate="no">Grid_home_2</span> -nonrolling</code></pre></div>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-83518C02-E439-49E7-A406-47FE5DCF49B0" name="GUID-83518C02-E439-49E7-A406-47FE5DCF49B0"></a><h5 id="CWADD-GUID-83518C02-E439-49E7-A406-47FE5DCF49B0" class="sect5">Patching Oracle Grid Infrastructure Using Batches</h5>
                     <div>
                        <p>The third patching method is to sequentially process batches of nodes, with a number of nodes in each batch being restarted in parallel.</p>
                        <div class="section">This method maximizes service availability during the patching process. When you patch Oracle Grid Infrastructure 12<span class="italic">c</span> release 2 (12.2.x) software homes, you can define the batches on the command line or choose to have Fleet Patching and Provisioning generate the list of batches based on its analysis of the database services running in the cluster.
                        </div>
                        <!-- class="section" -->
                        <div class="section">There are two methods for defining batches:
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="rapid-home-provisioning.html#GUID-83518C02-E439-49E7-A406-47FE5DCF49B0__USER-DEFINEDBATCHES-5B5324C9">User-Defined Batches</a></p>
                              </li>
                              <li>
                                 <p><a href="rapid-home-provisioning.html#GUID-83518C02-E439-49E7-A406-47FE5DCF49B0__RAPIDHOMEPROVISIONING-DEFINEDBATCHE-5B531F59">Fleet Patching and Provisioning-Defined Batches</a></p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="section" id="GUID-83518C02-E439-49E7-A406-47FE5DCF49B0__USER-DEFINEDBATCHES-5B5324C9">
                           <p class="subhead3" id="GUID-83518C02-E439-49E7-A406-47FE5DCF49B0__GUID-E21983C3-C7F0-4FFE-B317-97F743EF7712">User-Defined Batches</p>
                           <p>When you use this method of patching, the first time you run the <code class="codeph">rhpctl move gihome</code> command, you must specify the source home, the destination home, the batches, and other options, as needed. The command terminates after the first node restarts.
                           </p>
                           <p>To patch Oracle Grid Infrastructure using batches that you define:</p>
                           <ol>
                              <li>
                                 <p>Define a list of batches on the command line and begin the patching process, as in the following example:</p><pre class="pre codeblock"><code>$ rhpctl move gihome -sourcewc wc1 -destwc wc2 -batches "(n1),(n2,n3),(n4)"</code></pre><p>The preceding command example initiates the move operation, and terminates and reports successful when the Oracle Grid Infrastructure stack restarts in the first batch. Oracle Grid Infrastructure restarts the batches in the order you specified in the <code class="codeph">-batches</code> parameter.
                                 </p>
                                 <p>In the command example, node <code class="codeph">n1</code> forms the first batch, nodes <code class="codeph">n2</code> and <code class="codeph">n3</code> form the second batch, and node <code class="codeph">n4</code> forms the last batch. The command defines the source working copy as <code class="codeph">wc1</code> and the patched (destination) working copy as <code class="codeph">wc2</code>.
                                 </p>
                                 <div class="infoboxnote" id="GUID-83518C02-E439-49E7-A406-47FE5DCF49B0__GUID-9C2857EF-2E1A-48DA-AD2E-84EFC1BB49BB">
                                    <p class="notep1">Notes:</p>
                                    <p>You can specify batches such that singleton services (policy-managed singleton services or administrator-managed services running on one instance) are relocated between batches and non-singleton services remain partially available during the patching process.</p>
                                 </div>
                              </li>
                              <li>
                                 <p>You must process the next batch by running the <code class="codeph">rhpctl move gihome</code> command, again, as follows:
                                 </p><pre class="pre codeblock"><code>$ rhpctl move gihome -destwc wc2 -continue</code></pre><p>The preceding command example restarts the Oracle Grid Infrastructure stack on the second batch (nodes <code class="codeph">n2</code> and <code class="codeph">n3</code>). The command terminates by reporting that the second batch was successfully patched.
                                 </p>
                              </li>
                              <li>
                                 <p>Repeat the previous step until you have processed the last batch of nodes. If you attempt to run the command with the <code class="codeph">-continue</code> parameter after the last batch has been processed, then the command returns an error.
                                 </p>
                                 <p>If the <code class="codeph">rhpctl move gihome</code> command fails at any time during the above sequence, then, after determining and fixing the cause of the failure, rerun the command with the <code class="codeph">-continue</code> option to attempt to patch the failed batch. If you want to skip the failed batch and continue with the next batch, use the <code class="codeph">-continue</code> and <code class="codeph">-skip</code> parameters. If you attempt to skip over the last batch, then the move operation is terminated.
                                 </p>
                                 <p>Alternatively, you can reissue the command using the <code class="codeph">-revert</code> parameter to undo the changes that have been made and return the configuration to its initial state.
                                 </p>
                                 <p>You can use the <code class="codeph">-abort</code> parameter instead of the <code class="codeph">-continue</code> parameter at any point in the preceding procedure to terminate the patching process and leave the cluster in its current state.
                                 </p>
                                 <div class="infoboxnote" id="GUID-83518C02-E439-49E7-A406-47FE5DCF49B0__GUID-72638C6B-CE52-42DF-83EF-7FD38AF37124">
                                    <p class="notep1">Notes:</p>
                                    <ul style="list-style-type: disc;">
                                       <li>
                                          <p>Policy-managed services hosted on a server pool with one active server, and administrator-managed services with one preferred instance and no available instances cannot be relocated and will go OFFLINE while instances are being restarted.</p>
                                       </li>
                                       <li>
                                          <p>If a move operation is in progress, then you cannot initiate another move operation from the same source home or to the same destination home.</p>
                                       </li>
                                       <li>
                                          <p>After the move operation has ended, services may be running on nodes different from the ones they were running on before the move and you will have to manually relocate them back to the original instances, if necessary.</p>
                                       </li>
                                       <li>
                                          <p>If you use the <code class="codeph">-abort</code> parameter to terminate the patching operation, then Fleet Patching and Provisioning does not clean up or undo any of the patching steps. The cluster, databases, or both may be in an inconsistent state because all nodes are not patched.
                                          </p>
                                       </li>
                                       <li>
                                          <p>Depending on the start dependencies, services that were offline before the move began could come online during the move.</p>
                                       </li>
                                    </ul>
                                 </div>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                        <div class="section" id="GUID-83518C02-E439-49E7-A406-47FE5DCF49B0__RAPIDHOMEPROVISIONING-DEFINEDBATCHE-5B531F59">
                           <p class="subhead3" id="GUID-83518C02-E439-49E7-A406-47FE5DCF49B0__GUID-64FDD6DB-027A-47D9-A189-C482625C8C30">Fleet Patching and Provisioning-Defined Batches</p>
                           <p>Using Fleet Patching and Provisioning to define and patch batches of nodes means that you need only run one command, as shown in the following command example, where the source working is <code class="codeph">wc1</code> and the destination working copy is <code class="codeph">wc2</code>:
                           </p><pre class="pre codeblock"><code>$ rhpctl move gihome -sourcewc wc1 -destwc wc2 -smartmove -saf <span class="variable" translate="no">Z+</span> [-eval]</code></pre><p>There is no need for you to do anything else unless you used the <code class="codeph">-separate</code> parameter with the command. In that case, the move operation waits for user intervention to proceed to the next batch, and then you will have to run the command with the <code class="codeph">-continue</code> parameter after each batch completes.
                           </p>
                           <div class="p">If the move operation fails at some point before completing, then you can either rerun the operation by running the command again, or you can undo the partially completed operation, as follows:<pre class="pre codeblock"><code>$ rhpctl move gihome -destwc <span class="variable" translate="no">destination_workingcopy_name</span> -revert [<span class="variable" translate="no">authentication_option</span>]</code></pre>You can use the <code class="codeph">-revert</code> parameter with an un-managed home.
                           </div>
                           <p>The parameters used in the preceding example are as follows:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <div class="p"><code class="codeph">-smartmove</code>: This parameter restarts the Oracle Grid Infrastructure stack on disjoint sets of nodes so that singleton resources are relocated before Oracle Grid Infrastructure starts.
                                    <div class="infoboxnote" id="GUID-83518C02-E439-49E7-A406-47FE5DCF49B0__GUID-7A593538-CE7D-45A7-ADD3-8CC20B343F54">
                                       <p class="notep1">Note:</p>If the server pool to which a resource belongs contains only one active server, then that resource will go offline as relocation cannot take place.
                                    </div>
                                 </div>
                                 <p>The <code class="codeph">-smartmove</code> parameter:
                                 </p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>Creates a map of services and nodes on which they are running.</p>
                                    </li>
                                    <li>
                                       <p>Creates batches of nodes. The first batch will contain only the Hub node, if the configuration is an Oracle Flex Cluster. For additional batches, a node can be merged into a batch if:</p>
                                       <ul style="list-style-type: disc;">
                                          <li>
                                             <p>The availability of any non-singleton service, running on this node, does not go below the specified service availability factor (or the default of 50%).</p>
                                          </li>
                                          <li>
                                             <p>There is a singleton service running on this node and the batch does not contain any of the relocation target nodes for the service.</p>
                                          </li>
                                       </ul>
                                    </li>
                                    <li>
                                       <p>Restarts the Oracle Grid Infrastructure stack batch by batch.</p>
                                    </li>
                                 </ul>
                              </li>
                              <li>
                                 <p>Service availability factor (<code class="codeph">-saf <span class="variable" translate="no">Z+</span></code>): You can specify a positive number, as a percentage, that will indicate the minimum number of database instances on which a database service must be running. For example:
                                 </p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>If you specify <code class="codeph">-saf 50</code> for a service running on two instances, then only one instance can go offline at a time.
                                       </p>
                                    </li>
                                    <li>
                                       <p>If you specify <code class="codeph">-saf 50</code> for a service running on three instances, then only one instance can go offline at a time.
                                       </p>
                                    </li>
                                    <li>
                                       <p>If you specify <code class="codeph">-saf 75</code> for a service running on two instances, then an error occurs because the target can never be met.
                                       </p>
                                    </li>
                                    <li>
                                       <p>The service availability factor is applicable for services running on at least two instances. As such, the service availability factor can be 0% to indicate a non-rolling move, but not 100%. The default is 50%.</p>
                                    </li>
                                    <li>
                                       <p>If you specify a service availability factor for singleton services, then the parameter will be ignored because the availability of such services is 100% and the services will be relocated.</p>
                                    </li>
                                 </ul>
                              </li>
                              <li>
                                 <p><code class="codeph">-eval</code>: You can optionally use this parameter to view the auto-generated batches. This parameter also shows the sequence of the move operation without actually patching the software.
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>Related Topics</strong></p>
                           <ul>
                              <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-4706B307-CEDE-4A91-97DE-6AFF552AEDC8" title="Moves the Oracle Grid Infrastructure software stack from one home to another.">rhpctl move gihome</a></li>
                           </ul>
                        </div>
                     </div>
                     
                  </div>
                  <div class="sect4"><a id="GUID-A0C98197-0383-4B9F-A520-C4166EAF3180" name="GUID-A0C98197-0383-4B9F-A520-C4166EAF3180"></a><h5 id="CWADD-GUID-A0C98197-0383-4B9F-A520-C4166EAF3180" class="sect5">Combined Oracle Grid Infrastructure and Oracle Database Patching</h5>
                     <div>
                        <p>When you patch an Oracle Grid Infrastructure deployment, Fleet Patching and Provisioning enables you to simultaneously patch the Oracle Database homes on the cluster, so you can patch both types of software homes in a single maintenance operation.</p>
                        <div class="infoboxnote" id="GUID-A0C98197-0383-4B9F-A520-C4166EAF3180__GUID-BEE8637F-3B46-4455-8A99-67D84C99FA7D">
                           <p class="notep1">Note:</p>You cannot patch both Oracle Grid Infrastructure and Oracle Database in combination, with the independent automaton.
                        </div>
                        <p>The following optional parameters of the <code class="codeph">rhpctl move gihome</code> command are relevant to the combined Oracle Grid Infrastructure and Oracle Database patching use case:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">-auto</code>: Automatically patch databases along with patching Oracle Grid Infrastructure
                              </p>
                           </li>
                           <li>
                              <div class="p"><code class="codeph">-dbhomes <span class="variable" translate="no">mapping_of_Oracle_homes</span></code>: Mapping of source and destination working copies in the following format:<pre class="pre codeblock"><code>sourcewc1=destwc1,...,<span class="variable" translate="no">source_oracle_home_path</span>=destwc<span class="variable" translate="no">N</span></code></pre></div>
                           </li>
                           <li>
                              <p><code class="codeph">-dblist <span class="variable" translate="no">db_name_list</span></code>: Patch only the specified databases
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">-excludedblist <span class="variable" translate="no">db_name_list</span></code>: Patch all databases except the specified databases
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">-nodatapatch</code>: Indicates that <code class="codeph">datapatch</code> is not be run for databases being moved
                              </p>
                           </li>
                        </ul>
                        <p>As an example, assume that a Fleet Patching and Provisioning Server with Oracle Grid Infrastructure 12<span class="italic">c</span> release 2 (12.2) has provisioned the following working copies on an Oracle Grid Infrastructure 12<span class="italic">c</span> release 1 (12.1.0.2) target cluster which includes the node <code class="codeph">test_749</code>:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">GI121WC1</code>: The active Grid home on the Oracle Grid Infrastructure 12<span class="italic">c</span> release 1 (12.1.0.2) cluster
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">GI121WC2</code>: A software-only Grid home on the Oracle Grid Infrastructure 12<span class="italic">c</span> release 1 (12.1.0.2) cluster
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">DB121WC1</code>: An Oracle RAC 12<span class="italic">c</span> release 1 (12.1.0.2.0) database home running database instances
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">DB121025WC1</code>: An Oracle RAC 12<span class="italic">c</span> release 1 (12.1.0.2.5) database home with no database instances (this is the patched home)
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">DB112WC1</code>: An Oracle RAC 11<span class="italic">g</span> release 2 (11.2.0.4.0) database home running database instances
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">DB112045WC1</code>: An Oracle RAC 11<span class="italic">g</span> release 2 (11.2.0.4.5) database home with no database instances (this is the patched home)
                              </p>
                           </li>
                        </ul>
                        <p>Further assume that you want to simultaneously move</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Oracle Grid Infrastructure from working copy <code class="codeph">GI121WC1</code> to working copy <code class="codeph">GI121WC2</code></p>
                           </li>
                           <li>
                              <p>Oracle RAC Database <code class="codeph">db1</code> from working copy <code class="codeph">DB121WC1</code> to working copy <code class="codeph">DB121025WC1</code></p>
                           </li>
                           <li>
                              <p>Oracle RAC Database <code class="codeph">db2</code> in working copy <code class="codeph">DB112WC1</code> to working copy <code class="codeph">DB112045WC1</code></p>
                           </li>
                        </ul>
                        <p>The following single command accomplishes the moves:</p><pre class="pre codeblock"><code>$ rhpctl move gihome -sourcewc GI121WC1 -destwc GI121WC2 -auto
  -dbhomes DB121WC1=DB121025WC1,DB112WC1=DB112045WC1 -targetnode test_749 {<span class="variable" translate="no">authentication_option</span>}</code></pre><div class="infoboxnote" id="GUID-A0C98197-0383-4B9F-A520-C4166EAF3180__GUID-BA4F9D32-F682-43B8-9844-314B594002C7">
                           <p class="notep1">Notes:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>If you have an existing Oracle home that is not currently a working copy, then specify the Oracle home path instead of the working copy name for the source home. In the preceding example, if the Oracle home path for an existing 12.1.0.2 home is <code class="codeph">/u01/app/prod/12.1.0.2/dbhome1</code>, then replace <code class="codeph">DB121WC1=DB121025WC1</code> with <code class="codeph">/u01/app/prod/12.1.0.2/dbhome1=DB121025WC1</code>.
                                 </p>
                              </li>
                              <li>
                                 <div class="p">If the move operation fails at some point before completing, then you can either resolve the cause of the failure and resume the operation by rerunning the command, or you can undo the partially completed operation by issuing the following command, which restores the configuration to its initial state:<pre class="pre codeblock"><code>$ rhpctl move gihome -destwc GI121WC2 -revert {<span class="variable" translate="no">authentication_option</span>}</code></pre></div>
                              </li>
                           </ul>
                        </div>
                        <p>In the preceding command example, the Oracle Grid Infrastructure 12<span class="italic">c</span> release 1 (12.1.0.2) Grid home moves from working copy <code class="codeph">GI121WC1</code> to working copy <code class="codeph">GI121WC2</code>, databases running on working copy <code class="codeph">DB121WC1</code> move to working copy <code class="codeph">DB121025WC1</code>, and databases running on working copy <code class="codeph">DB112WC1</code> move to working copy <code class="codeph">DB112045WC1</code>.
                        </p>
                        <p>For each node in the client cluster, RHPCTL:</p>
                        <ol>
                           <li>
                              <p>Runs any configured pre-operation user actions for moving the Oracle Grid Infrastructure (<code class="codeph">move gihome</code>).
                              </p>
                           </li>
                           <li>
                              <p>Runs any configured pre-operation user actions for moving the database working copies (<code class="codeph">move database</code>).
                              </p>
                           </li>
                           <li>
                              <p>Stops services running on the node, and applies drain and disconnect options.</p>
                           </li>
                           <li>
                              <p>Performs the relevant patching operations for Oracle Clusterware and Oracle Database.</p>
                           </li>
                           <li>
                              <p>Runs any configured post-operation user actions for moving the database working copies (<code class="codeph">move database</code>).
                              </p>
                           </li>
                           <li>
                              <p>Runs any configured post-operation user actions for moving the Oracle Grid Infrastructure working copy (<code class="codeph">move gihome</code>).
                              </p>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>Related Topics</strong></p>
                           <ul>
                              <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-4706B307-CEDE-4A91-97DE-6AFF552AEDC8" title="Moves the Oracle Grid Infrastructure software stack from one home to another.">rhpctl move gihome</a></li>
                           </ul>
                        </div>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-A40643A4-9ADA-4F35-87B6-967BC24363FF" name="GUID-A40643A4-9ADA-4F35-87B6-967BC24363FF"></a><h5 id="CWADD-GUID-A40643A4-9ADA-4F35-87B6-967BC24363FF" class="sect5">Zero-Downtime Oracle Grid Infrastructure Patching</h5>
                     <div>
                        <p>Use Fleet Patching and Provisioning to patch Oracle Grid Infrastructure without bringing down Oracle RAC database instances.</p>
                        <div class="section">Current methods of patching the Oracle Grid Infrastructure require that you bring down all Oracle RAC database instances on the node where you are patching the Oracle Grid Infrastructure home. This issue is addressed in the Grid Infrastructure layer where by the database instances can continue to run during the grid infrastructure patching.</div>
                        <!-- class="section" -->
                        <ul>
                           <li class="stepexpand"><span>To enable zero-downtime Oracle Grid Infrastructure patching, use the <code class="codeph">rhpctl move gihome</code> command in a manner similar to the following:</span><div><pre class="pre codeblock"><code>rhpctl move gihome -tgip</code></pre></div>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-FF5595BC-8603-4564-9DD8-C53484330519" name="GUID-FF5595BC-8603-4564-9DD8-C53484330519"></a><h4 id="CWADD-GUID-FF5595BC-8603-4564-9DD8-C53484330519" class="sect4">Patching Oracle Grid Infrastructure Using Local-Mode Configuration</h4>
                  <div>
                     <p>When you install Oracle Grid Infrastructure or when you upgrade an older version to this current version, the Fleet Patching and Provisioning Server is configured automatically in local mode.</p>
                     <div class="section">
                        <div class="p">The local-mode operation enables you to perform grid infrastructure and database patching operations on the local cluster in a simplified environment without having to register or deploy gold images. Deploy either the grid infrastructure or the database patched home and run the patch operation using either the <code class="codeph">rhpctl move gihome</code> or <code class="codeph">rhpctl move database</code> command, specifying the source and destination paths instead of working copy names.
                           <div class="infoboxnote" id="GUID-FF5595BC-8603-4564-9DD8-C53484330519__GUID-02F11B15-D338-4E73-B5EB-EC979146E343">
                              <p class="notep1">Note:</p>You must enable and start the Fleet Patching and Provisioning Server using the following commands before you can use the local-mode patching operation:<pre class="pre codeblock"><code>$ srvctl enable rhpserver
$ srvctl start rhpserver</code></pre></div>
                        </div>
                        <div class="p">To switch the Fleet Patching and Provisioning Server from local mode to the regular, central mode (to manage remote targets), you must delete the current Fleet Patching and Provisioning Server in local mode, as follows:<pre class="pre codeblock"><code>$ srvctl stop rhpserver
$ srvctl remove rhpserver</code></pre></div>
                        <p>Proceed with the steps described in "Creating a Fleet Patching and Provisioning Server" to create the central-mode Fleet Patching and Provisioning Server.</p>
                     </div>
                     <!-- class="section" -->
                     <ul>
                        <li class="stepexpand"><span>The independent automaton for patching Oracle Grid Infrastructure performs all of the steps necessary to switch from one home to another. Because the automaton is not aware of gold images, moving the database requires two home paths, as follows:</span><div><pre class="pre codeblock"><code>$ rhpctl move gihome &#x2013;sourcehome <span class="variable" translate="no">Oracle_home_path</span> -destinationhome <span class="variable" translate="no">Oracle_home_path</span></code></pre></div>
                        </li>
                     </ul>
                     <div class="section">Use the following <code class="codeph">rhpctl move gihome</code> command parameters for the patching operation:
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">-node</code>: If the home you are moving is an Oracle Grid Infrastructure home installed on more than one node, then the default operation is a rolling update on all nodes. To apply a patch to just one node, specify the name of that node with this parameter.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">-nonrolling</code>: If the home you are moving is an Oracle Grid Infrastructure home installed on more than one node, then the default operation is a rolling update on all nodes. To patch all nodes in a nonrolling manner, use this parameter instead of the <code class="codeph">-node</code> parameter.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">-ignorewcpatches</code>: By default, Fleet Patching and Provisioning will not perform the move operation if the destination home is missing any patches present in the source home. You can override this functionality by using this parameter, for example, to move back to a previous source home if you must undo an update.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning.html#GUID-50B4A759-EE58-47AF-9B50-84572A58606A" title="The Fleet Patching and Provisioning Server uses a repository that you create in an Oracle ACFS file system in which you store all the software homes that you want to make available to clients and targets.">Creating a Fleet Patching and Provisioning Server</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-7F6F87C2-57B9-410F-9ECF-231909CB4F14" name="GUID-7F6F87C2-57B9-410F-9ECF-231909CB4F14"></a><h4 id="CWADD-GUID-7F6F87C2-57B9-410F-9ECF-231909CB4F14" class="sect4">Error Prevention and Automated Recovery Options</h4>
                  <div>
                     <p>Fleet Patching and Provisioning has error prevention and automated recovery options to assist you during maintenance operations.</p>
                     <p>During maintenance operations, errors must be avoided whenever possible and, when they occur, you must have automated recovery paths to avoid service disruption.</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-7F6F87C2-57B9-410F-9ECF-231909CB4F14__GUID-C8541044-AEB0-4E8C-BEB0-2FBD053C9C97">Error Prevention</p>
                        <p>Many RHPCTL commands include the <code class="codeph">-eval</code> parameter, which you can use to run the command and evaluate the current configuration without making any changes to determine if the command can be successfully run and how running the command will impact the configuration. Commands that you run using the <code class="codeph">-eval</code> parameter run as many prerequisite checks as possible without changing the configuration. If errors are encountered, then RHPCTL reports them in the command output. After you correct any errors, you can run the command again using <code class="codeph">-eval</code> to validate the corrections. Running the command successfully using <code class="codeph">&#x2013;eval</code> provides a high degree of confidence that running the actual command will succeed.
                        </p>
                        <p>You can test commands with the <code class="codeph">-eval</code> parameter outside of any maintenance window, so the full window is available for the maintenance procedure, itself.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-7F6F87C2-57B9-410F-9ECF-231909CB4F14__GUID-9FEB682D-905B-4747-A7EF-E3B30F4891B3">Automated Recovery Options</p>
                        <p>During maintenance operations, errors can occur either in-flight (for example, partway through either an <code class="codeph">rhpctl move database</code> or <code class="codeph">rhpctl move gihome</code> command) or after a successful operation (for example, after an <code class="codeph">rhpctl move database</code> command, you encounter performance or behavior issues).
                        </p>
                        <p><span class="bold">In-Flight Errors</span></p>
                        <div class="p">Should in-flight errors occur during move operations:
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Correct any errors that RHPCTL report and rerun the command, which will resume running at the point of failure.</p>
                                 <p>If rerunning the command succeeds and the move operation has a post-operation user action associated with it, then the user action is run. If there is a pre-operation user action, however, then RHPCTL does not rerun the command.</p>
                              </li>
                              <li>
                                 <p>Run a new move command, specifying only the destination from the failed move (working copy or unmanaged home), an authentication option, if required, and use the <code class="codeph">-revert</code> parameter. This will restore the configuration to its initial state.
                                 </p>
                                 <p>No user actions associated with the operation are run.</p>
                              </li>
                              <li>
                                 <p>Run a new move command, specifying only the destination from the failed move (working copy or unmanaged home), an authentication option if required, and the <code class="codeph">-abort</code> parameter. This leaves the configuration in its current state. Manual intervention is required at this point to place the configuration in a final state.
                                 </p>
                                 <p>No user actions associated with the operation are run.</p>
                              </li>
                           </ul>
                        </div>
                        <p><span class="bold">Post-Update Issues</span></p>
                        <div class="p">Even after a successful move operation to a new database or Oracle Grid Infrastructure home, you still may need to undo the change and roll back to the prior home. You can do this by rerunning the command with the source and destination homes reversed. This is, effectively, a fresh move operation performed without reference to the previous move operation.
                           <div class="infoboxnote" id="GUID-7F6F87C2-57B9-410F-9ECF-231909CB4F14__GUID-AD870256-958E-4506-B063-8966854B4007">
                              <p class="notep1">Note:</p>For the independent automatons, the source and destination homes are always unmanaged homes (those homes not provisioned by Fleet Patching and Provisioning). When the move operation is run on a Fleet Patching and Provisioning Server or Fleet Patching and Provisioning Client, the destination home must be a managed home that was provisioned by Fleet Patching and Provisioning.
                           </div>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-8CFE4E4C-DD4E-4E5B-81E7-A71CBC220E1E" name="GUID-8CFE4E4C-DD4E-4E5B-81E7-A71CBC220E1E"></a><h4 id="CWADD-GUID-8CFE4E4C-DD4E-4E5B-81E7-A71CBC220E1E" class="sect4">Upgrading Oracle Grid Infrastructure Software</h4>
                  <div>
                     <p>If you are using Fleet Patching and Provisioning, then you can use a single command to upgrade an Oracle Grid Infrastructure home.</p>
                     <div class="section">
                        <p>Fleet Patching and Provisioning supports upgrades to Oracle Grid Infrastructure 12<span class="italic">c</span> release 1 (12.1.0.2) from 11<span class="italic">g</span> release 2 (11.2.0.3 and 11.2.0.4). Upgrading to Oracle Grid Infrastructure 12<span class="italic">c</span> release 2 (12.2.0.1) is supported from 11<span class="italic">g</span> release 2 (11.2.0.3 and 11.2.0.4) and 12<span class="italic">c</span> release 1 (12.1.0.2). The destination for the upgrade can be a working copy of a gold image already provisioned or you can choose to create the working copy as part of this operation.
                        </p>
                        <p>As an example, assume that a target cluster is running Oracle Grid Infrastructure on an Oracle Grid Infrastructure home that was provisioned by Fleet Patching and Provisioning. This Oracle Grid Infrastructure home is 11<span class="italic">g</span> release 2 (11.2.0.4) and the working copy is named accordingly.
                        </p>
                        <p>After provisioning a working copy version of Oracle Grid Infrastructure 12<span class="italic">c</span> release 2 (12.2.0.1) (named GIOH12201 in this example), you can upgrade to that working copy with this single command:
                        </p><pre class="pre codeblock"><code>$ rhpctl upgrade gihome -sourcewc GIOH11204 -destwc GIOH12201</code></pre><div class="p">Fleet Patching and Provisioning is able to identify the cluster to upgrade based on the name of the source working copy. If the target cluster was running on an unmanaged Oracle Grid Infrastructure home, then you would specify the path of the source home rather than providing a source working copy name, and you must also specify the target cluster.
                           <div class="infoboxnote" id="GUID-8CFE4E4C-DD4E-4E5B-81E7-A71CBC220E1E__GUID-9B09578B-20DE-421E-A27C-DA5830DF152A">
                              <p class="notep1">Note:</p>You can delete the source working copy at any time after completing an upgrade. Once you delete the working copy, however, you cannot perform a rollback. Also, use the <code class="codeph">rhpctl delete workingcopy</code> command (as opposed to <code class="codeph">rm</code>, for example) to remove the source working copy to keep the Fleet Patching and Provisioning inventory correct.
                           </div>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-F1F48984-C440-44F4-9D62-BDB4BE1CDB4A" name="GUID-F1F48984-C440-44F4-9D62-BDB4BE1CDB4A"></a><h3 id="CWADD-GUID-F1F48984-C440-44F4-9D62-BDB4BE1CDB4A" class="sect3">Oracle Database Software Management</h3>
               <div>
                  <p>The Fleet Patching and Provisioning Server provides an efficient and secure platform for the distribution of Oracle Database Homes to targets and Fleet Patching and Provisioning Clients.</p>
                  <p>Also, Fleet Patching and Provisioning Clients have the ability to fetch database homes from the Fleet Patching and Provisioning Server.</p>
                  <p>Oracle Database homes are distributed in the form of working copies of gold images. Database instances (one or more) can then be created on the working copy.</p>
                  <p>Fleet Patching and Provisioning also has commands for managing existing databases, such as switching to a patched home or upgrading to a new database version. These are both single commands which orchestrate the numerous steps involved. Reverting to the original home is just as simple.</p>
               </div>
               <div class="sect3"><a id="GUID-34B6F969-E70E-480D-AC7F-9858E11FF293" name="GUID-34B6F969-E70E-480D-AC7F-9858E11FF293"></a><h4 id="CWADD-GUID-34B6F969-E70E-480D-AC7F-9858E11FF293" class="sect4">Provisioning a Copy of a Gold Image of a Database Home</h4>
                  <div>
                     <p>Use the <code class="codeph">rhpctl add workingcopy</code> command to provision a working copy of a database home on a Fleet Patching and Provisioning Server, Client, or target.
                     </p>
                     <ul>
                        <li class="stepexpand"><span>Run the <code class="codeph">rhpctl add workingcopy</code> command on a Fleet Patching and Provisioning Server, similar to the following example:</span><div><pre class="pre codeblock"><code>$ rhpctl add workingcopy -image db12c -path /u01/app/dbusr/product/12.2.0/db12201
  -client client_007 -oraclebase /u01/app/dbusr/ -workingcopy wc_db122_1</code></pre><p>The preceding command example creates a working copy named <code class="codeph">wc_db122_1</code> on all nodes of the Fleet Patching and Provisioning Client cluster named <code class="codeph">client_007</code>. The gold image <code class="codeph">db12c</code> is the source of the workingcopy. The directory path locations that you specify in the command must be empty.
                              </p>
                           </div>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-61929F3C-A50A-45EA-8B4A-D11E245A6493">rhpctl add workingcopy</a></li>
                        </ul>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-8EEE7B35-43C4-4C26-95C6-C39B702F1EF1" name="GUID-8EEE7B35-43C4-4C26-95C6-C39B702F1EF1"></a><h4 id="CWADD-GUID-8EEE7B35-43C4-4C26-95C6-C39B702F1EF1" class="sect4">Creating an Oracle Database on a Copy of a Gold Image</h4>
                  <div>
                     <p>Create an Oracle Database on a working copy.</p>
                     <div class="section">
                        <p>The Fleet Patching and Provisioning Server can add a database on a working copy that is on the Fleet Patching and Provisioning Server, itself, a Fleet Patching and Provisioning Client, or a non-Fleet Patching and Provisioning Client target. A Fleet Patching and Provisioning Client can create a database on a working copy that is running on the Fleet Patching and Provisioning Client, itself.</p>
                     </div>
                     <!-- class="section" -->
                     <ul>
                        <li class="stepexpand"><span>After you create a working copy of a gold image and provision that working copy to a target, you can create an Oracle Database on the working copy using the <code class="codeph">rhpctl add database</code> command, similar to the following command example, which creates an Oracle Real Application Clusters (Oracle RAC) database called <code class="codeph">db12201</code> on a working copy called <code class="codeph">wc_db122_1</code>:</span><div><pre class="pre codeblock"><code>$ rhpctl add database &#x2013;workingcopy wc_db122_1 &#x2013;dbname db12201 -node client_007_node1,client_007_node2 -dbtype RAC -datafileDestination DATA007_DG</code></pre></div>
                        </li>
                     </ul>
                     <div class="section">The preceding example creates an administrator-managed Oracle RAC database on two nodes in a client cluster. The data file destination is an Oracle ASM disk group that was created prior to running the command. Additionally, you can create Oracle RAC One Node and non-cluster databases.
                        <div class="infoboxnote" id="GUID-8EEE7B35-43C4-4C26-95C6-C39B702F1EF1__GUID-32A4EDD9-193D-4203-AB58-A59C7F235C1D">
                           <p class="notep1">Note:</p>When you create a database using Fleet Patching and Provisioning, the feature uses random passwords for both the SYS and SYSTEM schemas in the database and you cannot retrieve these passwords. A user with the DBA or operator role must connect to the database, locally, on the node where it is running and reset the passwords to these two accounts.
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-CD92C0DB-D5E2-427A-8784-94F4C140B279" name="GUID-CD92C0DB-D5E2-427A-8784-94F4C140B279"></a><h4 id="CWADD-GUID-CD92C0DB-D5E2-427A-8784-94F4C140B279" class="sect4">Patching Oracle Database Software</h4>
                  <div>
                     <p>To patch an Oracle database, you move the database home to a new home, which includes the patches you want to implement.</p>
                     <div class="section">Use the <code class="codeph">rhpctl move database</code> command to move one or more database homes to a working copy of the same database release level. The databases may be running on a working copy, or on an Oracle Database home that is not managed by Fleet Patching and Provisioning.
                     </div>
                     <!-- class="section" -->
                     <div class="section">When the move operation is initiated by a Fleet Patching and Provisioning Server or Client, the version moved to must be a working copy of a gold image. You can also perform this operation using the independent automaton in an environment where no Fleet Patching and Provisioning Server is present. In this case, the source and destination homes are not working copies of gold images, but are two installed homes that you deployed with some method other than using Fleet Patching and Provisioning.</div>
                     <!-- class="section" -->
                     <div class="section">The working copy to which you are moving the database can be at a lower patch level than the current database home. This facilitates rollback in the event that you encounter any problems after moving to the higher level patched home.</div>
                     <!-- class="section" -->
                     <div class="section">The working copy to which you are moving the database home can be at the same patch level as the original working copy. This is useful if you are moving a database home from one storage location to another, or if you wish to convert an unmanaged home to a managed home while staying at the same patch level.</div>
                     <!-- class="section" -->
                     <div class="section">Fleet Patching and Provisioning applies all patches out-of-place, minimizing the downtime necessary for maintenance. Fleet Patching and Provisioning also preserves the current configuration, enabling the rollback capability previously described. By default, Fleet Patching and Provisioning applies patches in a rolling manner, which reduces, and in many cases eliminates, service downtime. Use the&nbsp;<code class="codeph">-nonrolling</code> option to perform patching in non-rolling mode.&nbsp;The database is then completely stopped on the old&nbsp;<code class="codeph">ORACLE_HOME</code>, and then restarted to make it run from the newly patched&nbsp;<code class="codeph">ORACLE_HOME</code>.
                        <div class="infoboxnote" id="GUID-CD92C0DB-D5E2-427A-8784-94F4C140B279__GUID-798067EB-E9CA-4292-B958-1538CFF860E8">
                           <p class="notep1">Note:</p>Part of the patching process includes applying Datapatch. When you move an Oracle Database 12<span class="italic">c</span> release 1 (12.1) or higher, Fleet Patching and Provisioning completes this step for you. When you move to a version previous to Oracle Database 12<span class="italic">c</span> release 1 (12.1), however, you must run Datapatch manually. Fleet Patching and Provisioning is Oracle Data Guard-aware, and will not apply Datapatch to Oracle Data Guard standbys.
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p><span class="bold">Workflow for Database Patching</span></p>Assume that a database named <code class="codeph">myorcldb</code> is running on a working copy that was created from an Oracle Database 12c release 2 (12.2) gold image named <code class="codeph">DB122</code>. The typical workflow for patching an Oracle Database home is as follows:
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Create a working copy of the Oracle Database that you want to patch, in this case <code class="codeph">DB122</code>.</span></li>
                        <li class="stepexpand"><span>Apply the patch to the working copy you created.</span></li>
                        <li class="stepexpand"><span>Test and validate the patched working copy.</span></li>
                        <li class="stepexpand"><span>Use the <code class="codeph">rhpctl add image</code> command to create a gold image (for example, <code class="codeph">DB122_PATCH</code>) from the patched working copy.</span><div>
                              <div class="infoboxnote" id="GUID-CD92C0DB-D5E2-427A-8784-94F4C140B279__GUID-37F07A1D-A6CB-4C90-974F-B3EA70C70D16">
                                 <p class="notep1">Note:</p>The working copy you specify in the preceding command must be hosted on the Fleet Patching and Provisioning Server in Fleet Patching and Provisioning-managed storage.
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Delete the patched working copy with the patched Oracle Database using the <code class="codeph">rhpctl delete workingcopy</code> command.</span><div>
                              <div class="infoboxnote" id="GUID-CD92C0DB-D5E2-427A-8784-94F4C140B279__GUID-56F8104D-9F2F-4B39-BE0E-8F0CFC7DB106">
                                 <p class="notep1">Note:</p>Do not remove directly using the <code class="codeph">rm</code> command or some other method, because this does not update the Fleet Patching and Provisioning inventory information.
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Create a working copy from the patched gold image, (<code class="codeph">DB122_PATCH</code>).</span></li>
                        <li class="stepexpand"><span>Move <code class="codeph">myorcldb</code> to the working copy you just created.</span></li>
                        <li class="stepexpand"><span>When you are confident that you will not need to roll back to the working copy on which the database was running at the beginning of the procedure, delete that working copy using the <code class="codeph">rhpctl delete workingcopy</code> command.</span></li>
                     </ol>
                     <div class="section">
                        <p><span class="bold">Patching Oracle Database Using Batches</span></p>
                        <p>During database patching, Fleet Patching and Provisioning can sequentially process batches of nodes, with a number of nodes in each batch being restarted in parallel. This method maximizes service availability during the patching process. You can define the batches on the command line or choose to have Fleet Patching and Provisioning generate the list of batches based on its analysis of the database services running in the cluster.</p>
                        <p><span class="bold">Adaptive Oracle RAC-Rolling Patching for OJVM Deployments</span></p>
                        <p>In a clustered environment, the default approach for applying database maintenance with Fleet Patching and Provisioning is Oracle RAC rolling. However, non-rolling may be required if the new (patched) database home contains OJVM patches. In this case, Fleet Patching and Provisioning determines whether the rolling approach is possible, and rolls when applicable. (See MOS Note 2217053.1 for details.)</p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning.html#GUID-856C7378-2510-4B3E-8BE1-B4D79DF4FE8B">Patching Oracle Grid Infrastructure Software</a></li>
                           <li><a href="rapid-home-provisioning.html#GUID-FE6E954E-89D7-4AE3-9B9B-A26B787ECBAE">Provisioning Copies of Gold Images</a></li>
                           <li><a href="rapid-home-provisioning.html#GUID-58793EAD-3C8B-4C3F-A5CB-680BD5693A14">Adding Gold Images to the Fleet Patching and Provisioning Server</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-BB5B4501-E270-482A-ADEF-B3D487A9055E">RHPCTL Command Reference</a></li>
                        </ul>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-FD8CDD66-7821-4817-84FC-B0109D2929D5" name="GUID-FD8CDD66-7821-4817-84FC-B0109D2929D5"></a><h4 id="CWADD-GUID-FD8CDD66-7821-4817-84FC-B0109D2929D5" class="sect4">Patching Oracle Database with the Independent Automaton</h4>
                  <div>
                     <p>The independent local-mode automaton updates Oracle Database homes, including Oracle Database single-instance databases in a cluster or standalone (with no Oracle Grid Infrastructure), an Oracle RAC database, or an Oracle RAC One Node database.</p>
                     <div class="section">In a clustered environment, the database source home can be Oracle Database 11<span class="italic">g</span> (11.2.0.4), 12<span class="italic">c</span> (12.1.0.2), 12<span class="italic">c</span> (12.2.0.1), or later.
                     </div>
                     <!-- class="section" -->
                     <div class="section">In a standalone (non-clustered) environment, the database home must be Oracle Database 18c or later.</div>
                     <!-- class="section" -->
                     <div class="section">The automaton runs locally on the deployment and does not require a Fleet Patching and Provisioning Server in the architecture. (If there is a Fleet Patching and Provisioning Server in the architecture, then the automaton does not communicate with it, and the Fleet Patching and Provisioning Server cannot interact with the independent automaton.)</div>
                     <!-- class="section" -->
                     <ul>
                        <li class="stepexpand"><span>The independent automaton for Oracle Database patching performs all of the steps necessary to switch from one home to another. Because the automaton is not aware of gold images, moving the database requires two home paths, as follows:</span><div><pre class="pre codeblock"><code>$ rhpctl move database &#x2013;sourcehome <span class="variable" translate="no">Oracle_home_path</span> -destinationhome <span class="variable" translate="no">Oracle_home_path</span></code></pre></div>
                        </li>
                     </ul>
                     <div class="section">Use the following <code class="codeph">rhpctl move database</code> command parameters for any of the patching scenarios:
                        <ul style="list-style-type: disc;">
                           <li>
                              <div class="p"><code class="codeph">-dbname</code>: If the database home is hosting more than one database, you can move specific databases by specifying a comma-delimited list with this parameter. Databases not specified are not moved. If you do not use this parameter, then RHPCTL moves all databases.
                                 <div class="infoboxnote" id="GUID-FD8CDD66-7821-4817-84FC-B0109D2929D5__GUID-BE551544-86B9-4B21-8CA2-22B62F606C41">
                                    <p class="notep1">Note:</p>If you are moving a non-clustered (single-instance) database, then, for the value of the <code class="codeph">-dbname</code> parameter, you must specify the SID of the database instead of the database name.
                                 </div>
                              </div>
                           </li>
                           <li>
                              <p><code class="codeph">-ignorewcpatches</code>: By default, Fleet Patching and Provisioning will not perform the move operation if the destination home is missing any patches present in the source home. You can override this functionality by using this parameter, for example, to move back to a previous source home if you must undo an update.
                              </p>
                           </li>
                        </ul>
                        <div class="p">The following parameters apply only to clustered environments:
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><code class="codeph">-node</code>: If the home you are moving is a database home installed on more than one node, then the default operation is a rolling update on all nodes. To apply a patch to just one node, specify the name of that node with this parameter.
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">-nonrolling</code>: If the home you are moving is a database home installed on more than one node, then the default operation is a rolling update on all nodes. To patch all nodes in a nonrolling manner, use this parameter instead of the <code class="codeph">-node</code> parameter.
                                 </p>
                              </li>
                              <li>
                                 <p></p>
                              </li>
                           </ul>
                        </div>
                        <p><code class="codeph">-disconnect</code> and <code class="codeph">-noreplay</code>: Applies to single-instance Oracle Databases, and Oracle RAC and Oracle RAC One Node database instances. Use the <code class="codeph">-disconnect</code> parameter to disconnect all sessions before stopping or relocating services. If you choose to use <code class="codeph">-disconnect</code>, then you can choose to use the <code class="codeph">-noreplay</code> parameter to disable session replay during disconnection.
                        </p>
                        <p><code class="codeph">-drain_timeout</code>: Applies to single-instance Oracle Databases, and Oracle RAC, and Oracle RAC One Node database instances. Use this parameter to specify the time, in seconds, allowed for resource draining to be completed from each node. Accepted values are an empty string (""), 0, or any positive integer. The default value is an empty string, which means that this parameter is not set. This is applicable to older versions to maintain traditional behavior. If it is set to 0, then the stop option is applied immediately.
                        </p>
                        <p>The draining period is intended for planned maintenance operations. During the draining period, on each node in succession, all current client requests are processed, but new requests are not accepted.</p>
                        <p><code class="codeph">-stopoption</code>: Applies to single-instance Oracle Databases, and Oracle RAC, and Oracle RAC One Node database instances. Specify a stop option for the database. Stop options include: ABORT, IMMEDIATE, NORMAL, TRANSACTIONAL, and TRANSACTIONAL_LOCAL.
                        </p>
                        <div class="infoboxnote" id="GUID-FD8CDD66-7821-4817-84FC-B0109D2929D5__GUID-FE4798CD-5BBC-41A4-88ED-4DF8032B64DF">
                           <p class="notep1">Note:</p>The <code class="codeph">rhpctl move database</code> command is Oracle Data Guard-aware, and will not run Datapatch if the database is an Oracle Data Guard standby.
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-C10036DC-B091-40E1-B46B-8ACF38B20066" title="Moves one or more databases from a source working copy or any Oracle Database home to a patched working copy.">rhpctl move database</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-CB42840D-3ECB-4AB4-B338-FD9F0D856AC3" name="GUID-CB42840D-3ECB-4AB4-B338-FD9F0D856AC3"></a><h4 id="CWADD-GUID-CB42840D-3ECB-4AB4-B338-FD9F0D856AC3" class="sect4">Patching Oracle Exadata Software</h4>
                  <div>
                     <p>In addition to Oracle Grid Infrastructure and Oracle Database homes, Fleet Patching and Provisioning supports patching the Oracle Exadata components: database nodes, storage cells, and InfiniBand switches.</p>
                     <div class="section">The first time you patch an Oracle Exadata system using Fleet Patching and Provisioning, run the <code class="codeph">rhpctl add workingcopy</code> command, which stores the Oracle Exadata system information (list of nodes and the images with which they were last patched) on the Fleet Patching and Provisioning Server, before patching the desired Oracle Exadata nodes.
                     </div>
                     <!-- class="section" -->
                     <div class="section">For subsequent patching, run the <code class="codeph">rhpctl update workingcopy</code> command. After patching, Fleet Patching and Provisioning updates the images of the nodes.
                     </div>
                     <!-- class="section" -->
                     <div class="section">When you run the <code class="codeph">rhpctl query workingcopy</code> command for a working copy based on the <code class="codeph">EXAPATCHSOFTWARE</code> image type, the command returns a list of nodes and their images.
                     </div>
                     <!-- class="section" -->
                     <div class="section">To use Fleet Patching and Provisioning to patch Oracle Exadata:</div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Import an image of the <code class="codeph">EXAPATCHSOFTWARE</code> image type, using the <code class="codeph">rhpctl import image</code> command, similar to the following:</span><div><pre class="pre codeblock"><code>$ rhpctl import image -image EXA1 -imagetype EXAPATCHSOFTWARE -path /tmp/ExadataPatchBundle
  -version 12.1.2.2.3.160720</code></pre><div class="infoboxnote" id="GUID-CB42840D-3ECB-4AB4-B338-FD9F0D856AC3__GUID-F8784395-3035-4943-A515-6C32E7F375B2">
                                 <p class="notep1">Note:</p>You must rename the patch zip files to include the words <span class="italic">storage</span>, <span class="italic">database</span> and, <span class="italic">iso</span>, so that Fleet Patching and Provisioning can distinguish among them.
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>If this is the first time you are using Fleet Patching and Provisioning to patch Oracle Exadata, then use the <code class="codeph">rhpctl add workingcopy</code> command, as follows:</span><div><pre class="pre codeblock"><code>$ rhpctl add workingcopy -image <span class="variable" translate="no">image_name</span> -root {[-dbnodes <span class="variable" translate="no">dbnode_list</span>]
  [-cells <span class="variable" translate="no">cell_list</span>] [-ibswitches <span class="variable" translate="no">ibswitch_list</span>]} [-fromnode <span class="variable" translate="no">node_name</span>]
  [-unkey] [-smtpfrom "<span class="variable" translate="no">address</span>"] [-smtpto "<span class="variable" translate="no">addresses</span>"] [-precheckonly]
  [-modifyatprereq] [-resetforce] [-force]</code></pre><p>The preceding command stores the list of nodes (database nodes, cells, and InfiniBand switches) and the version of each node in Fleet Patching and Provisioning on the working copy, in addition to the type of node and the type of image.</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>For subsequent patching operations, after you create a gold image with updated database, storage cell, and switch files, run the <code class="codeph">rhpctl update workingcopy</code> command to patch one, two, or all three Oracle Exadata components, as follows:</span><div><pre class="pre codeblock"><code>$ rhpctl update workingcopy -image <span class="variable" translate="no">image_name</span> -root {[-dbnodes <span class="variable" translate="no">dbnode_list</span>] [-cells <span class="variable" translate="no">cell_list</span>]
  [-ibswitches <span class="variable" translate="no">ibswitch_list</span>]} [-fromnode <span class="variable" translate="no">node_name</span>] [-unkey] [-smtpfrom "<span class="variable" translate="no">address</span>"]
  [-smtpto "<span class="variable" translate="no">addresses</span>"] [-precheckonly] [-modifyatprereq] [-resetforce] [-force]</code></pre><div class="infoboxnote" id="GUID-CB42840D-3ECB-4AB4-B338-FD9F0D856AC3__GUID-BB30A4AA-A344-4C7D-B0A8-7F03A0D2B102">
                                 <p class="notep1">Note:</p>The name of the working copy remains the same throughout the life cycle of patching the given Oracle Exadata target.
                              </div>
                              <p>You can choose to patch only the database nodes, cells, or InfiniBand switches or any combination of the three. Patching occurs in the following order: InfiniBand switches, cells, database nodes.</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Display the list of nodes and their images, as follows:</span><div><pre class="pre codeblock"><code>$ rhpctl query workingcopy -workingcopy <span class="variable" translate="no">working_copy_name</span></code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Delete the working copy, as follows:</span><div><pre class="pre codeblock"><code>rhpctl delete workingcopy -workingcopy <span class="variable" translate="no">working_copy_name</span></code></pre></div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-5282B39C-4D95-4205-A180-ED4D874E2540" title="Creates an image on the Fleet Patching and Provisioning Server.">rhpctl import image</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-61929F3C-A50A-45EA-8B4A-D11E245A6493" title="Creates a working copy on a client cluster.">rhpctl add workingcopy</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-4CFB9687-A8D7-4AFB-AEE4-F249B9464083" title="Updates a working copy on a client cluster.">rhpctl update workingcopy</a></li>
                        </ul>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-3EDC1553-8411-4363-BCDC-DF4687AB3D60" name="GUID-3EDC1553-8411-4363-BCDC-DF4687AB3D60"></a><h4 id="CWADD-GUID-3EDC1553-8411-4363-BCDC-DF4687AB3D60" class="sect4">Upgrading Oracle Database Software</h4>
                  <div>
                     <p>Fleet Patching and Provisioning provides two options for upgrading Oracle Database. Both options are performed with a single command.</p>
                     <div class="section">The <code class="codeph">rhpctl upgrade database</code> command performs a traditional upgrade incurring downtime. The <code class="codeph">rhpctl zdtupgrade database</code> command performs an Oracle RAC or Oracle RAC One Node upgrade with minimal or no downtime.
                     </div>
                     <!-- class="section" -->
                     <div class="section">Use the <code class="codeph">rhpctl upgrade database</code> command to upgrade to Oracle Database 12<span class="italic">c</span> release 1 (12.1.0.2) from Oracle Database 11<span class="italic">g</span> release 2 (11.2.0.3 and 11.2.0.4). Upgrading to Oracle Database 12<span class="italic">c</span> release 2 (12.2.0.1) is supported from Oracle Database 11<span class="italic">g</span> release 2 (11.2.0.3 and 11.2.0.4) and Oracle Database 12<span class="italic">c</span> release 1 (12.1.0.2).
                        <div class="infoboxnote" id="GUID-3EDC1553-8411-4363-BCDC-DF4687AB3D60__GUID-6AB1793C-A365-4CB9-8BEC-ED9A83D5E9D4">
                           <p class="notep1">Note:</p>The version of Oracle Grid Infrastructure on which the pre-upgrade database is running must be the same version or higher than the version of the database to which you are upgrading.
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">The destination for the upgrade can be a working copy already provisioned, or you can choose to create the working copy of gold image as part of this operation.</div>
                     <!-- class="section" -->
                     <div class="section">The pre-upgrade database can be running on a working copy (a managed home that was provisioned by Fleet Patching and Provisioning) or on an unmanaged home. In the first case, you can roll back the upgrade process with a single RHPCTL command.
                        <div class="infoboxnote" id="GUID-3EDC1553-8411-4363-BCDC-DF4687AB3D60__GUID-732520D0-C464-4C9D-83F1-9F91B902889B">
                           <p class="notep1">Note:</p>You can delete the source working copy at any time after completing an upgrade. Once you delete the working copy, however, you cannot perform a rollback. Also, use the <code class="codeph">rhpctl delete workingcopy</code> command (as opposed to <code class="codeph">rm</code>, for example) to remove the source working copy to keep the Fleet Patching and Provisioning inventory correct.
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-926A4D78-0BAB-45EA-B5A4-B9B11BF77374">rhpctl upgrade database</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-9D6C5016-F10F-42F2-8175-E2D995655C33">rhpctl zdtupgrade database</a></li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-40D3B039-92D9-4325-908B-C40C7FA9B805" name="GUID-40D3B039-92D9-4325-908B-C40C7FA9B805"></a><h3 id="CWADD-GUID-40D3B039-92D9-4325-908B-C40C7FA9B805" class="sect3">Zero-Downtime Upgrade</h3>
               <div>
                  <p>Using Fleet Patching and Provisioning, which automates and orchestrates database upgrades, you can upgrade an Oracle RAC or Oracle RAC One Node database with no disruption in service.</p>
                  <p>The zero-downtime upgrade process is resumable, restartable, and recoverable should any errors interrupt the process. You can fix the issue then re-run the command, and Fleet Patching and Provisioning continues from the error point. Oracle also provides hooks at the beginning and end of the zero-downtime upgrade process, allowing call outs to user-defined scripts, so you can customize the process.</p>
                  <div class="p">You can use the zero-downtime upgrade process to upgrade databases that meet the following criteria:
                     <ul style="list-style-type: disc;">
                        <li>
                           <div class="p"><span class="bold">Database upgrade targets</span>: Oracle RAC and Oracle RAC One Node, with the following upgrade paths:
                              <ul class="simple" style="list-style-type: none;padding-left:0;">
                                 <li>11<span class="italic">g</span> release 2 (11.2.0.4) to 12<span class="italic">c</span> release 1 (12.1.0.2)
                                 </li>
                                 <li>11<span class="italic">g</span> release 2 (11.2.0.4) to 12<span class="italic">c</span> release 2 (12.2.0.1)
                                 </li>
                                 <li>12<span class="italic">c</span> release 1 (12.1.0.2) to 12<span class="italic">c</span> release 2 (12.2.0.1)
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li>
                           <p><span class="bold">Fleet Patching and Provisioning management</span>: The source database home can either be unmanaged (not provisioned by Fleet Patching and Provisioning service) or managed (provisioned by Fleet Patching and Provisioning service)
                           </p>
                        </li>
                        <li>
                           <p><span class="bold">Database state</span>: The source database must be in archive log mode
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div class="section">
                     <p class="subhead2" id="GUID-40D3B039-92D9-4325-908B-C40C7FA9B805__GUID-2BACFFCF-CD60-46F8-8D89-96320F477E11">Upgrading Container Databases</p>
                     <p>You can use Fleet Patching and Provisioning to upgrade CDBs but Fleet Patching and Provisioning does not support converting a non-CDB to a CDB during upgrade. To prepare for a zero-downtime upgrade, you complete configuration steps and validation checks. When you run a zero-downtime upgrade using Fleet Patching and Provisioning, you can stop the upgrade and resume it, if necessary. You can recover from any upgrade errors, and you can restart the upgrade. You also have the ability to insert calls to your own scripts during the upgrade, so you can customize your upgrade procedure.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-40D3B039-92D9-4325-908B-C40C7FA9B805__GUID-80BB3126-AAF4-4210-8874-DC2DDB821D03">Zero-Downtime Upgrade Environment Prerequisites</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><span class="bold">Server environment</span>: Oracle Grid Infrastructure 18c with Fleet Patching and Provisioning
                           </p>
                        </li>
                        <li>
                           <div class="p"><span class="bold">Database hosts</span>: Databases hosted on one of the following platforms:
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>Oracle Grid Infrastructure 18c Fleet Patching and Provisioning Client</p>
                                 </li>
                                 <li>
                                    <p>Oracle Grid Infrastructure 18c Fleet Patching and Provisioning Server</p>
                                 </li>
                                 <li>
                                    <p>Oracle Grid Infrastructure 12<span class="italic">c</span> (12.2.0.1) Fleet Patching and Provisioning Client
                                    </p>
                                 </li>
                                 <li>
                                    <p>Oracle Grid Infrastructure 12<span class="italic">c</span> (12.1.0.2) target cluster
                                    </p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li>
                           <div class="p"><span class="bold">Database-specific prerequisites for the environment</span>: During an upgrade, Fleet Patching and Provisioning manages replication to a local data file to preserve transactions applied to the new database when it is ready. There are two possibilities for the local data file:
                              <ul class="simple" style="list-style-type: none;padding-left:0;">
                                 <li>Snap clone, which is available if the database data files and redo and archive redo logs are on Oracle ACFS file systems</li>
                                 <li>Full copy, for all other cases</li>
                              </ul>
                           </div>
                        </li>
                        <li>
                           <p>Fleet Patching and Provisioning requires either Oracle GoldenGate or Oracle Data Guard during a zero-downtime database upgrade. As part of the upgrade procedure, Fleet Patching and Provisioning configures and manages the Oracle GoldenGate deployment.</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
               <div class="sect3"><a id="GUID-08160350-092E-4546-9B21-C61EBED811B1" name="GUID-08160350-092E-4546-9B21-C61EBED811B1"></a><h4 id="CWADD-GUID-08160350-092E-4546-9B21-C61EBED811B1" class="sect4">Running a Zero-Downtime Upgrade Using Oracle GoldenGate for Replication</h4>
                  <div>
                     <p>Run a zero-downtime upgrade using Oracle GoldenGate for replication.</p>
                     <div class="p">
                        <ol>
                           <li>
                              <p>Prepare the Fleet Patching and Provisioning Server.</p>
                              <div class="p">Create gold images of the Oracle GoldenGate software in the image library of the Fleet Patching and Provisioning Server.
                                 <div class="infoboxnote" id="GUID-08160350-092E-4546-9B21-C61EBED811B1__GUID-52C3558D-4ACA-4B36-B313-23E12F8859BA">
                                    <p class="notep1">Note:</p>You can download the Oracle GoldenGate software for your platform from Oracle eDelivery. The Oracle GoldenGate 12.3 installable kit contains the required software for both Oracle Database 11<span class="italic">g</span> and Oracle Database 12<span class="italic">c</span> databases.
                                 </div>
                              </div>
                              <p>If you download the Oracle GoldenGate software, then extract the software home and perform a <span class="italic">software only</span> installation on the Fleet Patching and Provisioning Server.
                              </p>
                              <div class="p">Create gold images of the Oracle GoldenGate software for both databases, as follows:<pre class="pre codeblock"><code>$ rhpctl import image -image 112ggimage -path <span class="variable" translate="no">path</span> -imagetype ORACLEGGSOFTWARE
$ rhpctl import image -image 12ggimage -path <span class="variable" translate="no">path</span> -imagetype ORACLEGGSOFTWARE</code></pre>In both of the preceding commands, <code class="codeph"><span class="variable" translate="no">path</span></code> refers to the location of the Oracle GoldenGate software home on the Fleet Patching and Provisioning Server for each release of the database.
                              </div>
                           </li>
                           <li>
                              <p>Prepare the target database.</p>
                              <div class="p">Provision working copies of the Oracle GoldenGate software to the cluster hosting the database, as follows:<pre class="pre codeblock"><code>$ rhpctl add workingcopy -workingcopy GG_Wcopy_11g -image 112ggimage -user
  <span class="variable" translate="no">user_name</span> -node <span class="variable" translate="no">12102_cluster_node</span> -path <span class="variable" translate="no">path</span> {-root | -sudouser user_name
  -sudopath <span class="variable" translate="no">sudo_bin_path</span>}
$ rhpctl add workingcopy -workingcopy GG_Wcopy_12c -image 12ggimage -user
  <span class="variable" translate="no">user_name</span> -node <span class="variable" translate="no">12102_cluster_node</span> -path <span class="variable" translate="no">path</span> {-root | -sudouser user_name
  -sudopath <span class="variable" translate="no">sudo_bin_path</span>}</code></pre></div>
                              <div class="p">If the database is hosted on the Fleet Patching and Provisioning Server, itself, then neither the <code class="codeph">-targetnode</code> nor <code class="codeph">-client</code> parameters are required.
                                 <div class="infoboxnote" id="GUID-08160350-092E-4546-9B21-C61EBED811B1__GUID-9B391F8E-2DD3-4E9B-AC5D-803B091572D2">
                                    <p class="notep1">Note:</p>Working copy names must be unique, therefore you must use a different working copy name on subsequent targets. You can create unique working copy names by including the name of the target/client cluster name in the working copy name.
                                 </div>
                              </div>
                           </li>
                           <li>
                              <p>Provision a working copy of the Oracle Database 12<span class="italic">c</span> software home to the target cluster.
                              </p>
                           </li>
                        </ol>
                        <div class="infoboxnote" id="GUID-08160350-092E-4546-9B21-C61EBED811B1__GUID-7367A9C2-62C6-4FB9-A192-8FD0B192E92A">
                           <p class="notep1">Note:</p>You can do this preparation ahead of the maintenance window without disrupting any operations taking place on the target.
                        </div>
                     </div>
                     <!-- class="section" -->
                     <ul>
                        <li class="stepexpand"><span>You can run the upgrade command on the Fleet Patching and Provisioning Server to upgrade a database hosted on the server, an Oracle Database 12<span class="italic">c</span> release 1 (12.1.0.2) target cluster, or a database hosted on a Fleet Patching and Provisioning Client 12<span class="italic">c</span> release 2 (12.2.0.1) or 18c. You can also run the command a Fleet Patching and Provisioning Client 18c to upgrade a database hosted on the client, itself.</span><div>Use the upgrade command similar to the following:<pre class="pre codeblock"><code>$ rhpctl zdtupgrade database -dbname sierra -destwc DB_Wcopy_121 -ggsrcwc
  GG_Wcopy_11g -ggdstwc GG_Wcopy_12c -targetnode <span class="variable" translate="no">12102_cluster_node</span> -root</code></pre><p>In the preceding command, <code class="codeph"><span class="variable" translate="no">12102_cluster_node</span></code> refers to the Oracle Grid Infrastructure 12<span class="italic">c</span> release 1 (12.1.0.2) cluster hosting the database you want to upgrade.
                              </p>
                           </div>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-5282B39C-4D95-4205-A180-ED4D874E2540" title="Creates an image on the Fleet Patching and Provisioning Server.">rhpctl import image</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-61929F3C-A50A-45EA-8B4A-D11E245A6493" title="Creates a working copy on a client cluster.">rhpctl add workingcopy</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-9D6C5016-F10F-42F2-8175-E2D995655C33" title="Enables zero downtime database upgrade for Oracle RAC and Oracle RAC One Node databases.">rhpctl zdtupgrade database</a></li>
                        </ul>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-9223FCA7-481A-472F-B1FB-EAED510FB63A" name="GUID-9223FCA7-481A-472F-B1FB-EAED510FB63A"></a><h4 id="CWADD-GUID-9223FCA7-481A-472F-B1FB-EAED510FB63A" class="sect4">Running a Zero-Downtime Upgrade Using Oracle Data Guard for Replication</h4>
                  <div>
                     <p>Run a zero-downtime upgrade using Oracle Data Guard for replication.</p>
                     <div class="section">You can run the zero-downtime upgrade command using Oracle Data Guard’s transient logical standby (TLS) feature. All of the steps involved are orchestrated by the zero-downtime upgrade command.</div>
                     <!-- class="section" -->
                     <div class="p">After you provision the destination database Home, the following prerequisites must be met:
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Data Guard Broker is not enabled</p>
                           </li>
                           <li>
                              <p>Flash recovery area (FRA) is configured</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <ul>
                        <li class="stepexpand"><span>The following example of a zero-downtime upgrade using Oracle Data Guard upgrades an Oracle Database 11<span class="italic">g</span> release 2 (11.2.0.4), <code class="codeph">sierra</code>, running on the target cluster, which includes a node, <code class="codeph">targetclust003</code>, to an Oracle Database 12<span class="italic">c</span> release 1 (12.1.0.2) (the destination working copy, which was provisioned from a Gold Image stored on the Fleet Patching and Provisioning Server named <code class="codeph">rhps.example.com</code>):</span><div><pre class="pre codeblock"><code>$ <kbd class="userinput">rhpctl zdtupgrade database -dbname sierra -destwc WC121DB4344 -clonedatadg DBDATA -targetnode node90743 -root</kbd>

Enter user "root" password:
node90753.example.com: starting zero downtime upgrade operation ...
node90753.example.com: verifying patches applied to Oracle homes ...
node90753.example.com: verifying if database "sierra" can be upgraded with zero downtime ...
node90743: 15:09:10.459: Verifying whether database "sierra" can be cloned ...
node90743: 15:09:10.462: Verifying that database "sierra" is a primary database ...
node90743: 15:09:14.672: Verifying that connections can be created to database "sierra" ...
&lt; ... &gt;
node90743: 15:14:58.015: Starting redo apply ...
node90743: 15:15:07.133: Configuring primary database "sierra" ...
####################################################################
node90753.example.com: retrieving information about database "xmvotkvd" ...
node90753.example.com: creating services for snapshot database "xmvotkvd" ...
####################################################################
node90743: 15:15:33.640: Macro step 1: Getting information and validating setup ...
&lt; ... &gt;
node90743: 15:16:02.844: Macro step 2: Backing up user environment in case upgrade is aborted  ...
node90743: 15:16:02.848: Stopping media recovery for database "xmvotkvd" ...
node90743: 15:16:05.858: Creating initial restore point "NZDRU_0000_0001" ...
&lt; ... &gt;
node90743: 15:16:17.611: Macro step 3: Creating transient logical standby from existing physical standby ...
node90743: 15:16:18.719: Stopping instance "xmvotkvd2" of database "xmvotkvd" ...
node90743: 15:16:43.187: Verifying that database "sierra" is a primary database ...
&lt; ... &gt;
node90743: 15:19:27.158: Macro step 4: Upgrading transient logical standby database ...
node90743: 15:20:27.272: Disabling service "sierrasvc" of database "xmvotkvd" ...
node90743: 16:36:54.684: Macro step 5: Validating upgraded transient logical standby database ...
node90743: 16:37:09.576: Creating checkpoint "NZDRU_0301" for database "xmvotkvd" during stage "3" and task "1" ...
node90743: 16:37:09.579: Stopping media recovery for database "xmvotkvd" ...
node90743: 16:37:10.792: Creating restore point "NZDRU_0301" for database "xmvotkvd" ...
node90743: 16:37:11.998: Macro step 6: Switching role of transient logical standby database ...
node90743: 16:37:12.002: Verifying that database "sierra" is a primary database ...
&lt; ... &gt;
node90743: 16:39:07.425: Macro step 7: Flashback former primary database to pre-upgrade restore point and convert to physical standby ...
node90743: 16:39:08.833: Stopping instance "sierra2" of database "sierra" ...
&lt; ... &gt;
node90743: 16:41:17.138: Macro step 8: Recovering former primary database ...
node90743: 16:41:19.045: Verifying that database "sierra" is mounted ...
&lt; ... &gt;
node90743: 17:20:21.378: Macro step 9: Switching back ...
&lt; ... &gt;
####################################################################
node90753.example.com: deleting snapshot database "xmvotkvd" ...</code></pre></div>
                        </li>
                     </ul>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-C24A5EA8-BD8D-4458-BA61-877DDFBE72E7" name="GUID-C24A5EA8-BD8D-4458-BA61-877DDFBE72E7"></a><h4 id="CWADD-GUID-C24A5EA8-BD8D-4458-BA61-877DDFBE72E7" class="sect4">Customizing Zero-Downtime Upgrades</h4>
                  <div>
                     <p>You can customize zero-downtime upgrades using the user-action framework of Fleet Patching and Provisioning.</p>
                     <div class="p">To use the user-action framework, you can provide a separate script for any or all of the points listed in the overall process.
                        <div class="tblformal" id="GUID-C24A5EA8-BD8D-4458-BA61-877DDFBE72E7__ZERO-DOWNTIMEUPGRADEPLUGINS-34477E2A">
                           <p class="titleintable">Table 5-3 Zero-Downtime Upgrade Plugins</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="Zero-Downtime Upgrade Plugins" summary="Describes zero-downtime upgrade plugins." frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="20%" id="d25134e9655">Plugin Type</th>
                                    <th align="left" valign="bottom" width="20%" id="d25134e9657">Pre or Post</th>
                                    <th align="left" valign="bottom" width="20%" id="d25134e9659">Plugin runs...</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td rowspan="2" align="left" valign="top" width="20%" id="d25134e9663" headers="d25134e9655 "><code class="codeph">ZDTUPGRADE_DATABASE</code></td>
                                    <td align="left" valign="top" width="20%" headers="d25134e9663 d25134e9657 ">
                                       <p>Pre</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d25134e9663 d25134e9659 ">
                                       <p>Before Fleet Patching and Provisioning starts zero-downtime upgrade.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" headers="d25134e9663 d25134e9657 ">
                                       <p>Post</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d25134e9663 d25134e9659 ">
                                       <p>After Fleet Patching and Provisioning completes zero-downtime upgrade.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td rowspan="2" align="left" valign="top" width="20%" id="d25134e9680" headers="d25134e9655 "><code class="codeph">ZDTUPGRADE_DATABASE_SNAPDB</code></td>
                                    <td align="left" valign="top" width="20%" headers="d25134e9680 d25134e9657 ">
                                       <p>Pre</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d25134e9680 d25134e9659 ">
                                       <p>Before creating the snapshot or full-clone database.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" headers="d25134e9680 d25134e9657 ">
                                       <p>Post</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d25134e9680 d25134e9659 ">
                                       <p>After starting the snapshot or full-clone database (but before switching over).</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td rowspan="2" align="left" valign="top" width="20%" id="d25134e9697" headers="d25134e9655 "><code class="codeph">ZDTUPGRADE_DATABASE_DBUA</code></td>
                                    <td align="left" valign="top" width="20%" headers="d25134e9697 d25134e9657 ">
                                       <p>Pre</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d25134e9697 d25134e9659 ">
                                       <p>Before running DBUA (after switching over).</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" headers="d25134e9697 d25134e9657 ">
                                       <p>Post</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d25134e9697 d25134e9659 ">
                                       <p>After DBUA completes.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td rowspan="2" align="left" valign="top" width="20%" id="d25134e9714" headers="d25134e9655 "><code class="codeph">ZDTUPGRADE_DATABASE_SWITCHBACK</code></td>
                                    <td align="left" valign="top" width="20%" headers="d25134e9714 d25134e9657 ">
                                       <p>Pre</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d25134e9714 d25134e9659 ">
                                       <p>Before switching back users to the upgraded source database.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="20%" headers="d25134e9714 d25134e9657 ">
                                       <p>Post</p>
                                    </td>
                                    <td align="left" valign="top" width="20%" headers="d25134e9714 d25134e9659 ">
                                       <p>After switching back users to the upgraded source database (before deleting snapshot or full-clone database).</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                     <!-- class="section" -->
                     <ul>
                        <li class="stepexpand"><span>To register a plugin to be run during a zero-downtime upgrade, run the following command:</span><div><pre class="pre codeblock"><code>$ rhpctl add useraction -useraction <span class="variable" translate="no">user_action_name</span> -actionscript <span class="variable" translate="no">script_name</span>
  {-pre | -post} -optype {ZDTUPGRADE_DATABASE | ZDTUPGRADE_DATABASE_SNAPDB |
   ZDTUPGRADE_DATABASE_DBUA | ZDTUPGRADE_DATABASE_SWITCHBACK}</code></pre><p>You can specify run-time input to the plugins using the <code class="codeph">-useractiondata</code> option of the <code class="codeph">rhpctl zdtupgrade database</code> command.
                              </p>
                           </div>
                        </li>
                     </ul>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-6CDC373B-6261-4BF8-BD60-2E9E2C3E0168" name="GUID-6CDC373B-6261-4BF8-BD60-2E9E2C3E0168"></a><h3 id="CWADD-GUID-6CDC373B-6261-4BF8-BD60-2E9E2C3E0168" class="sect3">Persistent Home Path During Patching</h3>
               <div>
                  <p>Oracle recommends out-of-place patching when applying updates.</p>
                  <p>Out-of-place patching involves deploying the patched environment in a new directory path and then switching the software home to the new path. This approach allows for non-disruptive software distribution because the existing home remains active while the new home is provisioned, and also facilitates rollback because the unpatched software home is available should any issues arise after the switch. Additionally, out-of-place patching for databases enables you to choose to move a subset of instances to the new home if more than one instance is running on the home, whereas with in-place patching, you must patch all instances at the same time.</p>
                  <p>A potential impediment to traditional out-of-place patching is that the software home path changes. While Fleet Patching and Provisioning manages this internally and transparently for Oracle Database and Oracle Grid Infrastructure software, some users have developed scripts which depend on the path. To address this, Fleet Patching and Provisioning uses a file system feature that enables separation of gold image software from the site-specific configuration changes, so the software home path is persistent throughout updates.</p>
                  <p>This feature is available with Oracle Database 12<span class="italic">c</span> release 2 (12.2) and Oracle Grid Infrastructure 12<span class="italic">c</span> release 2 (12.2) working copies provisioned in local storage. Also, if you provision an Oracle Database 12<span class="italic">c</span> release 2 (12.2) or an Oracle Grid Infrastructure 12<span class="italic">c</span> release 2 (12.2) home without using this feature, then, during a patching operation using either the <code class="codeph">rhpctl move database</code> or <code class="codeph">rhpctl move gihome</code> command, you can convert to this configuration and take advantage of the feature.
                  </p>
                  <div class="infoboxnote" id="GUID-6CDC373B-6261-4BF8-BD60-2E9E2C3E0168__GUID-CB083092-3523-462B-80B5-714A419C5525">
                     <p class="notep1">Note:</p>You can only patch Oracle Grid Infrastructure on a Fleet Patching and Provisioning Client with a home that is based on a persistent home path from a Fleet Patching and Provisioning Server.
                  </div>
               </div>
            </div><a id="CWADD93066"></a><div class="props_rev_3"><a id="GUID-8D6EC31C-C179-4939-B153-C02F4398C9E0" name="GUID-8D6EC31C-C179-4939-B153-C02F4398C9E0"></a><h3 id="CWADD-GUID-8D6EC31C-C179-4939-B153-C02F4398C9E0" class="sect3">Managing Fleet Patching and Provisioning Clients</h3>
               <div>
                  <p>Management tasks for Fleet Patching and Provisioning Clients include creation, enabling and disabling, creating users and assigning roles to those users, and managing passwords.</p>
                  <p>Using SRVCTL and RHPCTL, you can perform all management tasks for a Fleet Patching and Provisioning Client.</p>
               </div><a id="CWADD92650"></a><div class="props_rev_3"><a id="GUID-E65C9FC4-C8AC-4BF6-A689-A70C70B3A636" name="GUID-E65C9FC4-C8AC-4BF6-A689-A70C70B3A636"></a><h4 id="CWADD-GUID-E65C9FC4-C8AC-4BF6-A689-A70C70B3A636" class="sect4">Creating a Fleet Patching and Provisioning Client</h4>
                  <div>
                     <p>Users operate on a Fleet Patching and Provisioning Client to perform tasks such as requesting deployment of Oracle homes and querying gold images.</p>
                     <div class="section">
                        <p>To create a Fleet Patching and Provisioning Client:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>If there is no highly available VIP (HAVIP) on the Fleet Patching and Provisioning Server, then, as the <code class="codeph">root</code> user, create an HAVIP, as follows:</span><div><pre class="pre codeblock"><code># srvctl add havip -id <span class="variable" translate="no">id</span> -address {<span class="variable" translate="no">host_name</span> | <span class="variable" translate="no">ip_address</span>}
</code></pre><p>You can specify either a host name or IPv4 or IPv6 IP address. The IP address that you specify for HAVIP or the address that is resolved from the specified host name <span class="italic">must not</span> be in use when you run this command.
                              </p>
                              <div class="infoboxnote" id="GUID-E65C9FC4-C8AC-4BF6-A689-A70C70B3A636__GUID-66427A78-96F0-4C53-9BE4-A8E25BD634B3">
                                 <p class="notep1">Note:</p>
                                 <p>The highly available VIP must be in the same subnet as the default network configured in the Fleet Patching and Provisioning Server cluster. You can obtain the subnet by running the following command:</p><pre class="pre codeblock"><code>$ srvctl config network -netnum <span class="variable" translate="no">network_number</span></code></pre></div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>On the Fleet Patching and Provisioning Server as the Grid home owner, create the client data file, as follows:</span><div><pre class="pre codeblock"><code>$ rhpctl add client -client <span class="variable" translate="no">client_cluster_name</span> -toclientdata <span class="variable" translate="no">path</span>
</code></pre><p>RHPCTL creates the client data file in the directory path you specify after the <code class="codeph">-toclientdata</code> flag. The name of the client data file is <code class="codeph"><span class="variable" translate="no">client_cluster_name</span>.xml</code>.
                              </p>
                              <div class="infoboxnote" id="GUID-E65C9FC4-C8AC-4BF6-A689-A70C70B3A636__GUID-851AD92A-B2B4-4235-AC50-4500FAAC177B">
                                 <p class="notep1">Note:</p>
                                 <p>The <code class="codeph"><span class="variable" translate="no">client_cluster_name</span></code> must be unique and it must match the cluster name of the client cluster where you run step <a href="rapid-home-provisioning.html#GUID-E65C9FC4-C8AC-4BF6-A689-A70C70B3A636__CBBBIDBH">4</a>.
                                 </p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Copy the client data file that you created in the previous step to a directory on the client cluster that has read/write permissions to the Grid home owner on the Fleet Patching and Provisioning Client.</span></li>
                        <li class="stepexpand" id="GUID-E65C9FC4-C8AC-4BF6-A689-A70C70B3A636__CBBBIDBH"><span>Create the Fleet Patching and Provisioning Client by running the following command as <code class="codeph">root</code> on the client cluster:</span><div><pre class="pre codeblock"><code># srvctl add rhpclient -clientdata <span class="variable" translate="no">path_to_client_data</span>
   [-diskgroup <span class="variable" translate="no">disk_group_name</span> -storage <span class="variable" translate="no">base_path</span>]</code></pre><p>If you want to provision working copies to Oracle ACFS storage on this cluster, and you have already created a disk group for this purpose, then specify this disk group in the preceding command. In this case, also specify a storage path which will be used as a base path for all mount points when creating Oracle ACFS file systems for storing working copies.</p>
                              <div class="infoboxnote" id="GUID-E65C9FC4-C8AC-4BF6-A689-A70C70B3A636__GUID-6A053CB3-5CAE-4B12-AFE1-0E45D5DC3398">
                                 <p class="notep1">Note:</p>
                                 <p>Once you configure a disk group on a Fleet Patching and Provisioning Client, you cannot remove it from or change it in the Fleet Patching and Provisioning Client configuration. The only way you can do either (change or remove) is to completely remove the Fleet Patching and Provisioning Client using the <code class="codeph">srvctl remove client</code> command, and then add it back with a different disk group, if necessary. Before you remove a Fleet Patching and Provisioning Client, ensure that you remove all registered users from this cluster and all working copies provisioned on this cluster.
                                 </p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Start the Fleet Patching and Provisioning Client, as follows:</span><div><pre class="pre codeblock"><code>$ srvctl start rhpclient</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Check the status of the Fleet Patching and Provisioning Client, as follows:</span><div><pre class="pre codeblock"><code>$ srvctl status rhpclient</code></pre></div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="../racad/server-control-utility-reference.html#RACAD-GUID-C2D37BAB-DA98-49B4-A777-F2B3AA8D2E7A" target="_blank"><span><cite>Oracle Real Application Clusters Administration and Deployment Guide</cite></span></a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-66345667-F035-4ADB-A25F-5530299E04B7" title="Use the Fleet Patching and Provisioning Control (RHPCTL) utility to manage Fleet Patching and Provisioning in your cluster.">Fleet Patching and Provisioning Control (RHPCTL) Command Reference</a></li>
                        </ul>
                     </div>
                  </div>
               </div><a id="CWADD93067"></a><div class="props_rev_3"><a id="GUID-E9DBA610-DF3C-45F3-9127-070BE602A52E" name="GUID-E9DBA610-DF3C-45F3-9127-070BE602A52E"></a><h4 id="CWADD-GUID-E9DBA610-DF3C-45F3-9127-070BE602A52E" class="sect4">Enabling and Disabling Fleet Patching and Provisioning Clients</h4>
                  <div>
                     <p>On the Fleet Patching and Provisioning Server, you can enable or disable a Fleet Patching and Provisioning Client.</p>
                     <div class="section">
                        <p>Fleet Patching and Provisioning Clients communicate with the Fleet Patching and Provisioning Server for all actions. You cannot run any RHPCTL commands without a connection to a Fleet Patching and Provisioning Server.</p>
                        <p>To enable or disable a Fleet Patching and Provisioning Client, run the following command from the Fleet Patching and Provisioning Server cluster:</p><pre class="pre codeblock"><code>$ rhpctl modify client -client <span class="variable" translate="no">client_name</span> -enabled TRUE | FALSE</code></pre><p>To enable a Fleet Patching and Provisioning Client, specify <code class="codeph">-enabled TRUE</code>. Conversely, specify <code class="codeph">-enabled FALSE</code> to disable the client. When you disable a Fleet Patching and Provisioning Client cluster, all RHPCTL commands from that client cluster will be rejected by the Fleet Patching and Provisioning Server, unless and until you re-enable the client.
                        </p>
                        <div class="infoboxnote" id="GUID-E9DBA610-DF3C-45F3-9127-070BE602A52E__GUID-815C0EC2-C183-4C62-8E55-85DA0C3D58B4">
                           <p class="notep1">Note:</p>
                           <p>Disabling a Fleet Patching and Provisioning Client cluster does not disable any existing working copies on the client cluster. The working copies will continue to function and any databases in those working copies will continue to run.</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-838D76D6-C7BB-4057-BCFE-9ED92139EC42" name="GUID-838D76D6-C7BB-4057-BCFE-9ED92139EC42"></a><h4 id="CWADD-GUID-838D76D6-C7BB-4057-BCFE-9ED92139EC42" class="sect4">Deleting a Fleet Patching and Provisioning Client</h4>
                  <div>
                     <p>Use the following procedure to delete a Fleet Patching and Provisioning Client.</p>
                     <ol>
                        <li class="stepexpand"><span>Before deleting the Fleet Patching and Provisioning Client, you must first delete the working copies and users on the Fleet Patching and Provisioning Server, as follows:</span><ol type="a">
                              <li class="substepexpand"><span>Query the list of working copies that have been provisioned on the Fleet Patching and Provisioning Client cluster.</span><div>
                                    <p>Run the following command:</p><pre class="pre codeblock"><code>$ rhpctl query workingcopy -client <span class="italic">client_name</span></code></pre></div>
                              </li>
                              <li class="substepexpand"><span>Delete each of the working copies listed in the output of the preceding command.</span><div>
                                    <p>Run the following command for each working copy and specify the name of the working copy you want to delete:</p><pre class="pre codeblock"><code>$ rhpctl delete workingcopy -workingcopy <span class="italic">working_copy_name</span></code></pre></div>
                              </li>
                              <li class="substepexpand"><span>Query the list of users from the Fleet Patching and Provisioning Client cluster.</span><div>
                                    <p>Run the following command:</p><pre class="pre codeblock"><code>$ rhpctl query user -client <span class="italic">client_name</span></code></pre></div>
                              </li>
                              <li class="substepexpand"><span>Delete the users listed in the output of the preceding command, as follows:</span><div>
                                    <p>Run the following command and specify the name of the user you want to delete and the name of the client:</p><pre class="pre codeblock"><code>$ rhpctl delete user -user <span class="italic">user_name</span> —client <span class="italic">client_name</span></code></pre></div>
                              </li>
                           </ol>
                        </li>
                        <li class="stepexpand"><span>On the Fleet Patching and Provisioning Client cluster, delete the client, as follows:</span><ol type="a">
                              <li class="substepexpand"><span>Stop the Fleet Patching and Provisioning Client daemon.</span><div>
                                    <p>Run the following command:</p><pre class="pre codeblock"><code>$ srvctl stop rhpclient</code></pre></div>
                              </li>
                              <li class="substepexpand"><span>Delete the Fleet Patching and Provisioning Client configuration.</span><div>
                                    <p>Run the following command:</p><pre class="pre codeblock"><code>$ srvctl remove rhpclient</code></pre></div>
                              </li>
                           </ol>
                        </li>
                        <li class="stepexpand"><span>Delete the client site configuration on the Fleet Patching and Provisioning Server cluster.<code class="codeph"></code></span><div>
                              <p>Run the following command and specify the name of the client:</p><pre class="pre codeblock"><code>$ rhpctl delete client -client <span class="italic">client_name</span></code></pre></div>
                        </li>
                     </ol>
                  </div>
               </div><a id="CWADD93068"></a><div class="props_rev_3"><a id="GUID-43A1B15A-CF4A-4C1F-BFE1-C830CFD4D44F" name="GUID-43A1B15A-CF4A-4C1F-BFE1-C830CFD4D44F"></a><h4 id="CWADD-GUID-43A1B15A-CF4A-4C1F-BFE1-C830CFD4D44F" class="sect4">Creating Users and Assigning Roles for Fleet Patching and Provisioning Client Cluster Users</h4>
                  <div>
                     <div class="section">
                        <p>When you create a Fleet Patching and Provisioning Client with the <code class="codeph">rhpctl add client</code> command, you can use the <code class="codeph">-maproles</code> parameter to create users and assign roles to them. You can associate multiple users with roles, or you can assign a single user multiple roles with this command.
                        </p>
                        <p>After the client has been created, you can add and remove roles for users using the <code class="codeph">rhpctl grant role</code> command and the <code class="codeph">rhpctl revoke role</code>, respectively.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="CWADD93069"></a><div class="props_rev_3"><a id="GUID-8429C5C1-44B7-4FDF-8DCE-B5F536AA2054" name="GUID-8429C5C1-44B7-4FDF-8DCE-B5F536AA2054"></a><h4 id="CWADD-GUID-8429C5C1-44B7-4FDF-8DCE-B5F536AA2054" class="sect4">Managing the Fleet Patching and Provisioning Client Password</h4>
                  <div>
                     <div class="section">
                        <p>The <a id="d25134e10885" class="indexterm-anchor"></a>Fleet Patching and Provisioning Client uses a password stored internally to authenticate itself with the RHP server. You cannot query this password, however, if for some reason, you are required to reset this password, then you can do so, as follows, on the RHP server cluster:
                        </p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Run the following command on the Fleet Patching and Provisioning Server cluster to generate a new password and store it in the client credential:</span><div><pre class="oac_no_warn" dir="ltr">$ rhpctl modify client -client <span class="italic">client_name</span> -password
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Run the following command on the Fleet Patching and Provisioning Server cluster to generate a credential file:</span><div><pre class="oac_no_warn" dir="ltr">$ rhpctl export client -client <span class="italic">client_name</span> -clientdata <span class="italic">file_path</span>
</pre><p>For example, to generate a credential file for a Fleet Patching and Provisioning Client named <code class="codeph">mjk9394</code>:
                              </p><pre class="oac_no_warn" dir="ltr">$ rhpctl export client -client mjk9394 -clientdata /tmp/mjk9394.xml
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Continuing with the preceding example, transport the generated credential file securely to the Fleet Patching and Provisioning Client cluster and then run the following command on any node in the Fleet Patching and Provisioning Client cluster:</span><div><pre class="oac_no_warn" dir="ltr">$ srvctl modify rhpclient -clientdata <span class="italic">path_to_mjk9394.xml</span>
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Restart the Fleet Patching and Provisioning Client daemon by running the following commands on the Fleet Patching and Provisioning Client cluster:</span><div><pre class="oac_no_warn" dir="ltr">$ srvctl stop rhpclient
$ srvctl start rhpclient</pre></div>
                        </li>
                     </ol>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-A3D8F47A-688B-4404-BAC9-3AFD2DA124BE" name="GUID-A3D8F47A-688B-4404-BAC9-3AFD2DA124BE"></a><h3 id="CWADD-GUID-A3D8F47A-688B-4404-BAC9-3AFD2DA124BE" class="sect3">User-Defined Actions</h3>
               <div>
                  <p>You can create actions for various Fleet Patching and Provisioning operations, such as import image, add and delete working copy, and add, delete, move, and upgrade a software home.</p>
                  <div class="section">
                     <p>You can create actions for various Fleet Patching and Provisioning operations, such as import image, add and delete working copy of a gold image, and add, delete, move, and upgrade a software home. You can define different actions for each operation, which can be further differentiated by the type of image to which the operation applies. User-defined actions can be run before or after a given operation, and are run on the deployment on which the operation is run, whether it be a Fleet Patching and Provisioning Server, a Fleet Patching and Provisioning Client (12<span class="italic">c</span> release 2 (12.2), or later), or a target that is not running a Fleet Patching and Provisioning Client.
                     </p>
                     <p>User-defined actions are shell scripts which are stored on the Fleet Patching and Provisioning Server. When a script runs, it is given relevant information about the operation on the command line. Also, you can associate a file with the script. The Fleet Patching and Provisioning Server will copy that file to the same location on the Client or target where the script is run.</p>
                     <p>For example, perhaps you want to create user-defined actions that are run after a database upgrade, and you want to define different actions for Oracle Database 11<span class="italic">g</span> and 12<span class="italic">c</span>. This requires you to define new image types, as in the following example procedure.
                     </p>
                     <ol>
                        <li>
                           <p>Create a new image type, (<code class="codeph">DB11IMAGE</code>, for example), based on the ORACLEDBSOFTWARE image type, as follows:
                           </p><pre class="pre codeblock"><code>$ rhpctl add imagetype -imagetype DB11IMAGE -basetype ORACLEDBSOFTWARE</code></pre><p>When you add or import an Oracle Database 11<span class="italic">g</span> gold image, you specify the image type as <code class="codeph">DB11IMAGE</code>.
                           </p>
                        </li>
                        <li>
                           <p>Define a user action and associate it with the <code class="codeph">DB11IMAGE</code> image type and the upgrade operation. You can have different actions that are run before or after upgrade.
                           </p>
                        </li>
                        <li>
                           <div class="p">To define an action for Oracle Database 12<span class="italic">c</span>, create a new image type (<code class="codeph">DB12IMAGE</code>, for example) that is based on the ORACLEDBSOFTWARE image type, as in the preceding step, but with the <code class="codeph">DB12IMAGE</code> image type.
                              <div class="infoboxnote" id="GUID-A3D8F47A-688B-4404-BAC9-3AFD2DA124BE__GUID-6D2C5185-5278-4E25-9325-D5D2E1E68CC2">
                                 <p class="notep1">Note:</p>If you define user actions for the base type of a user-defined image type (in this case the base type is ORACLEDBSOFTWARE), then Fleet Patching and Provisioning performs those actions before the actions for the user-defined image type.
                              </div>
                           </div>
                        </li>
                     </ol>
                     <p>You can modify the image type of an image using the <code class="codeph">rhpctl modify image</code> command. Additionally, you can modify, add, and delete other actions. The following two tables, <a href="rapid-home-provisioning.html#GUID-A3D8F47A-688B-4404-BAC9-3AFD2DA124BE__GUID-8C76537B-0D99-4674-AB59-48B303BDB7EB" title="Lists various Fleet Patching and Provisioning operations that you can define, along with their associated parameters.">Table 5-4</a> and <a href="rapid-home-provisioning.html#GUID-A3D8F47A-688B-4404-BAC9-3AFD2DA124BE__GUID-E7885154-CB30-4E23-BE67-E6C835B1AD71" title="Lists and describes the parameters you can use with various user-defined operations">Table 5-5</a>, list the operations you can customize and the parameters you can use to define those operations, respectively.
                     </p>
                     <div class="tblformal" id="GUID-A3D8F47A-688B-4404-BAC9-3AFD2DA124BE__GUID-8C76537B-0D99-4674-AB59-48B303BDB7EB">
                        <p class="titleintable">Table 5-4 Fleet Patching and Provisioning User-Defined Operations</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="Fleet Patching and Provisioning User-Defined Operations" summary="Lists various Fleet Patching and Provisioning operations that you can define, along with their associated parameters." frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="20%" id="d25134e11136">Operation</th>
                                 <th align="left" valign="bottom" width="20%" id="d25134e11138">Parameter List</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11142" headers="d25134e11136 "><code class="codeph">IMPORT_IMAGE</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11142 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code>, <code class="codeph">RHP_PHASE</code>, <code class="codeph">RHP_PATH</code>, <code class="codeph">RHP_PATHOWNER</code>, <code class="codeph">RHP_PROGRESSLISTENERHOST</code>, <code class="codeph">RHP_PROGRESSLISTENERPORT</code>, <code class="codeph">RHP_IMAGE</code>, <code class="codeph">RHP_IMAGETYPE</code>, <code class="codeph">RHP_VERSION</code>, <code class="codeph">RHP_CLI</code>, <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11181" headers="d25134e11136 "><code class="codeph">ADD_WORKINGCOPY</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11181 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code>, <code class="codeph">RHP_PHASE</code>, <code class="codeph">RHP_WORKINGCOPY</code>, <code class="codeph">RHP_PATH</code>, <code class="codeph">RHP_STORAGETYPE</code>, <code class="codeph">RHP_USER</code>, <code class="codeph">RHP_NODES</code>, <code class="codeph">RHP_ORACLEBASE</code>, <code class="codeph">RHP_DBNAME</code>, <code class="codeph">RHP_PROGRESSLISTENERHOST</code>, <code class="codeph">RHP_PROGRESSLISTENERPORT</code>, <code class="codeph">RHP_IMAGE</code>, <code class="codeph">RHP_IMAGETYPE</code>, <code class="codeph">RHP_VERSION</code>, <code class="codeph">RHP_CLI</code>, <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11236" headers="d25134e11136 "><code class="codeph">ADD_DATABASE</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11236 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code>, <code class="codeph">RHP_PHASE</code>, <code class="codeph">RHP_WORKINGCOPY</code>, <code class="codeph">RHP_CLIENT</code>, <code class="codeph">RHP_DBNAME</code>, <code class="codeph">RHP_PROGRESSLISTENERHOST</code>, <code class="codeph">RHP_PROGRESSLISTENERPORT</code>, <code class="codeph">RHP_IMAGE</code>, <code class="codeph">RHP_IMAGETYPE</code>, <code class="codeph">RHP_VERSION</code>, <code class="codeph">RHP_CLI</code>, <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11278" headers="d25134e11136 "><code class="codeph">DELETE_WORKINGCOPY</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11278 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code>, <code class="codeph">RHP_PHASE</code>, <code class="codeph">RHP_WORKINGCOPY</code>, <code class="codeph">RHP_CLIENT</code>, <code class="codeph">RHP_PATH</code>, <code class="codeph">RHP_PROGRESSLISTENERHOS</code>, <code class="codeph">RHP_PROGRESSLISTENERPORT</code>, <code class="codeph">RHP_IMAGE</code>, <code class="codeph">RHP_IMAGETYPE</code>, <code class="codeph">RHP_VERSION</code>, <code class="codeph">RHP_CLI</code>, <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11320" headers="d25134e11136 "><code class="codeph">DELETE_DATABASE</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11320 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code>, <code class="codeph">RHP_PHASE</code>, <code class="codeph">RHP_WORKINGCOPY</code>, <code class="codeph">RHP_CLIENT</code>, <code class="codeph">RHP_DBNAME</code>, <code class="codeph">RHP_PROGRESSLISTENERHOST</code>, <code class="codeph">RHP_PROGRESSLISTENERPORT</code>, <code class="codeph">RHP_IMAGE</code>, <code class="codeph">RHP_IMAGETYPE</code>, <code class="codeph">RHP_VERSION</code>, <code class="codeph">RHP_CLI</code>, <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11362" headers="d25134e11136 "><code class="codeph">MOVE_GIHOME</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11362 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code>, <code class="codeph">RHP_PHASE</code>, <code class="codeph">RHP_SOURCEWC</code>, <code class="codeph">RHP_SOURCEPATH</code>, <code class="codeph">RHP_DESTINATIONWC</code>, <code class="codeph">RHP_DESTINATIONPATH</code>, <code class="codeph">RHP_IMAGE</code>, <code class="codeph">RHP_IMAGETYPE</code>, <code class="codeph">RHP_PROGRESSLISTENERHOS</code>, <code class="codeph">RHP_PROGRESSLISTENERPORT</code>, <code class="codeph">RHP_VERSION</code>, <code class="codeph">RHP_CL</code>, <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11408" headers="d25134e11136 "><code class="codeph">MOVE_DATABASE</code><p>This user action is run for each database involved in a patching operation.</p>
                                    <p>If the run scope is set to <code class="codeph">ALLNODES</code>, then the script is run for each database on every cluster node.
                                    </p>
                                    <p>If the run scope is set to <code class="codeph">ONENODE</code>, then the script is run for each database on the node on which the patch was applied to the database.
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11408 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code>, <code class="codeph">RHP_PHASE</code>, <code class="codeph">RHP_SOURCEWC</code>, <code class="codeph">RHP_SOURCEPATH</code>, <code class="codeph">RHP_DESTINATIONWC</code>, <code class="codeph">RHP_DESTINATIONPATH</code>, <code class="codeph">RHP_DBNAME</code>, <code class="codeph">RHP_IMAGE</code>, <code class="codeph">RHP_IMAGETYPE</code>, <code class="codeph">RHP_PROGRESSLISTENERHOST</code>, <code class="codeph">RHP_PROGRESSLISTENERPORT</code>, <code class="codeph">RHP_VERSION</code>, <code class="codeph">RHP_CLI</code>, <code class="codeph">RHP_DATAPATCH</code>, <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11472" headers="d25134e11136 "><code class="codeph">UPGRADE_GIHOME</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11472 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code>, <code class="codeph">RHP_PHASE</code>, <code class="codeph">RHP_SOURCEWC</code>, <code class="codeph">RHP_SOURCEPATH</code>, <code class="codeph">RHP_DESTINATIONWC</code>, <code class="codeph">RHP_DESTINATIONPATH</code>, <code class="codeph">RHP_IMAGE</code>, <code class="codeph">RHP_IMAGETYPE</code>, <code class="codeph">RHP_PROGRESSLISTENERHOST</code>, <code class="codeph">RHP_PROGRESSLISTENERPORT</code>, <code class="codeph">RHP_VERSION</code>, <code class="codeph">RHP_CLI</code>, <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11518" headers="d25134e11136 "><code class="codeph">UPGRADE_DATABASE</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11518 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code>, <code class="codeph">RHP_PHASE</code>, <code class="codeph">RHP_SOURCEWC</code>, <code class="codeph">RHP_SOURCEPATH</code>, <code class="codeph">RHP_DESTINATIONWC</code>, <code class="codeph">RHP_DESTINATIONPATH</code>, <code class="codeph">RHP_DBNAME</code>, <code class="codeph">RHP_IMAGE</code>, <code class="codeph">RHP_IMAGETYPE</code>, <code class="codeph">RHP_PROGRESSLISTENERHOST</code>, <code class="codeph">RHP_PROGRESSLISTENERPORT</code>, <code class="codeph">RHP_VERSION</code>, <code class="codeph">RHP_CLI</code>, <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11567" headers="d25134e11136 "><code class="codeph">ADDNODE_DATABASE</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11567 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code>, <code class="codeph">RHP_PHASE</code>, <code class="codeph">RHP_WORKINGCOPY</code>, <code class="codeph">RHP_CLIENT</code>, <code class="codeph">RHP_DBNAME</code>, <code class="codeph">RHP_PROGRESSLISTENERHOST</code>, <code class="codeph">RHP_PROGRESSLISTENERPORT</code>, <code class="codeph">RHP_IMAGE</code>, <code class="codeph">RHP_IMAGETYPE</code>, <code class="codeph">RHP_VERSION</code>, <code class="codeph">RHP_CLI</code>, <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11609" headers="d25134e11136 "><code class="codeph">DELETENODE_DATABASE</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11609 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code>, <code class="codeph">RHP_PHASE</code>, <code class="codeph">RHP_WORKINGCOPY</code>, <code class="codeph">RHP_CLIENT</code>, <code class="codeph">RHP_DBNAME</code>, <code class="codeph">RHP_PROGRESSLISTENERHOST</code>, <code class="codeph">RHP_PROGRESSLISTENERPORT</code>, <code class="codeph">RHP_IMAGE</code>, <code class="codeph">RHP_IMAGETYPE</code>, <code class="codeph">RHP_VERSION</code>, <code class="codeph">RHP_CLI</code>, <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11652" headers="d25134e11136 "><code class="codeph">ADDNODE_GIHOME</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11652 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code>, <code class="codeph">RHP_PHASE</code>, <code class="codeph">RHP_WORKINGCOPY</code>, <code class="codeph">RHP_CLIENT</code>, <code class="codeph">RHP_PATH</code>, <code class="codeph">RHP_PROGRESSLISTENERHOST</code>, <code class="codeph">RHP_PROGRESSLISTENERPORT</code>, <code class="codeph">RHP_IMAGE</code>, <code class="codeph">RHP_IMAGETYPE</code>, <code class="codeph">RHP_VERSION</code>, <code class="codeph">RHP_CLI</code>, <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11694" headers="d25134e11136 "><code class="codeph">DELETENODE_GIHOME</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11694 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code>, <code class="codeph">RHP_PHASE</code>, <code class="codeph">RHP_WORKINGCOPY</code>, <code class="codeph">RHP_CLIENT</code>, <code class="codeph">RHP_PATH</code>, <code class="codeph">RHP_PROGRESSLISTENERHOST</code>, <code class="codeph">RHP_PROGRESSLISTENERPORT</code>, <code class="codeph">RHP_IMAGE</code>, <code class="codeph">RHP_IMAGETYPE</code>, <code class="codeph">RHP_VERSION</code>, <code class="codeph">RHP_CLI</code>, <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11736" headers="d25134e11136 "><code class="codeph">ADDNODE_WORKINGCOPY</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11736 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code>, <code class="codeph">RHP_PHASE</code>, <code class="codeph">RHP_WORKINGCOPY</code>, <code class="codeph">RHP_CLIENT</code>, <code class="codeph">RHP_PATH</code>, <code class="codeph">RHP_PROGRESSLISTENERHOST</code>, <code class="codeph">RHP_PROGRESSLISTENERPORT</code>, <code class="codeph">RHP_IMAGE</code>, <code class="codeph">RHP_IMAGETYPE</code>, <code class="codeph">RHP_VERSION</code>, <code class="codeph">RHP_CLI</code>, <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11778" headers="d25134e11136 "><code class="codeph">ZDTUPGRADE_DATABASE</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11778 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code>, <code class="codeph">RHP_PHASE</code>, <code class="codeph">RHP_SOURCEWC</code>, <code class="codeph">RHP_SOURCEPATH</code>, <code class="codeph">RHP_DESTINATIONWC</code>, <code class="codeph">RHP_DESTINATIONPATH</code>, <code class="codeph">RHP_SRCGGWC</code>, <code class="codeph">RHP_SRCGGPATH</code>, <code class="codeph">RHP_DSTGGWC</code>, <code class="codeph">RHP_DSTGGPATH</code>, <code class="codeph">RHP_DBNAME</code>, <code class="codeph">RHP_IMAGE</code>, <code class="codeph">RHP_IMAGETYPE</code>, <code class="codeph">RHP_PROGRESSLISTENERHOST</code>, <code class="codeph">RHP_PROGRESSLISTENERPORT</code>, <code class="codeph">RHP_VERSION</code>, <code class="codeph">RHP_CLI</code>, <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11839" headers="d25134e11136 "><code class="codeph">ZDTUPGRADE_DATABASE_SNAPDB</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11839 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code>, <code class="codeph">RHP_PHASE</code>, <code class="codeph">RHP_SOURCEWC</code>, <code class="codeph">RHP_SOURCEPATH</code>, <code class="codeph">RHP_DESTINATIONWC</code>, <code class="codeph">RHP_DESTINATIONPATH</code>, <code class="codeph">RHP_SRCGGWC</code>, <code class="codeph">RHP_SRCGGPATH</code>, <code class="codeph">RHP_DSTGGWC</code>, <code class="codeph">RHP_DSTGGPATH</code>, <code class="codeph">RHP_DBNAME</code>, <code class="codeph">RHP_IMAGE</code>, <code class="codeph">RHP_IMAGETYPE</code>, <code class="codeph">RHP_PROGRESSLISTENERHOST</code>, <code class="codeph">RHP_PROGRESSLISTENERPORT</code>, <code class="codeph">RHP_VERSION</code>, <code class="codeph">RHP_CLI</code>, <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11900" headers="d25134e11136 "><code class="codeph">ZDTUPGRADE_DATABASE_DBUA</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11900 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code>, <code class="codeph">RHP_PHASE</code>, <code class="codeph">RHP_SOURCEWC</code>, <code class="codeph">RHP_SOURCEPATH</code>, <code class="codeph">RHP_DESTINATIONWC</code>, <code class="codeph">RHP_DESTINATIONPATH</code>, <code class="codeph">RHP_SRCGGWC</code>, <code class="codeph">RHP_SRCGGPATH</code>, <code class="codeph">RHP_DSTGGWC</code>, <code class="codeph">RHP_DSTGGPATH</code>, <code class="codeph">RHP_DBNAME</code>, <code class="codeph">RHP_IMAGE</code>, <code class="codeph">RHP_IMAGETYPE</code>, <code class="codeph">RHP_PROGRESSLISTENERHOST</code>, <code class="codeph">RHP_PROGRESSLISTENERPORT</code>, <code class="codeph">RHP_VERSION</code>, <code class="codeph">RHP_CLI</code>, <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e11961" headers="d25134e11136 "><code class="codeph">ZDTUPGRADE_DATABASE_SWITCHBACK</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e11961 d25134e11138 ">
                                    <p><code class="codeph">RHP_OPTYPE</code>, <code class="codeph">RHP_PHASE</code>, <code class="codeph">RHP_SOURCEWC</code>, <code class="codeph">RHP_SOURCEPATH</code>, <code class="codeph">RHP_DESTINATIONWC</code>, <code class="codeph">RHP_DESTINATIONPATH</code>, <code class="codeph">RHP_SRCGGWC</code>, <code class="codeph">RHP_SRCGGPATH</code>, <code class="codeph">RHP_DSTGGWC</code>, <code class="codeph">RHP_DSTGGPATH</code>, <code class="codeph">RHP_DBNAME</code>, <code class="codeph">RHP_IMAGE</code>, <code class="codeph">RHP_IMAGETYPE</code>, <code class="codeph">RHP_PROGRESSLISTENERHOST</code>, <code class="codeph">RHP_PROGRESSLISTENERPORT</code>, <code class="codeph">RHP_VERSION</code>, <code class="codeph">RHP_CLI</code>, <code class="codeph">RHP_USERACTIONDATA</code></p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="tblformal" id="GUID-A3D8F47A-688B-4404-BAC9-3AFD2DA124BE__GUID-E7885154-CB30-4E23-BE67-E6C835B1AD71">
                        <p class="titleintable">Table 5-5 User-Defined Operations Parameters</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="User-Defined Operations Parameters" summary="Lists and describes the parameters you can use with various user-defined operations" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="20%" id="d25134e12031">Parameter</th>
                                 <th align="left" valign="bottom" width="20%" id="d25134e12033">Description</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12037" headers="d25134e12031 "><code class="codeph">RHP_OPTYPE</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12037 d25134e12033 ">
                                    <p>The operation type for which the user action is being executed, as listed in the previous table.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12044" headers="d25134e12031 "><code class="codeph">RHP_PHASE</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12044 d25134e12033 ">
                                    <p>This parameter indicates whether the user action is executed before or after the operation (is either PRE or POST).</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12051" headers="d25134e12031 "><code class="codeph">RHP_SOURCEWC</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12051 d25134e12033 ">
                                    <p>The source working copy name for a patch of upgrade operation.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12058" headers="d25134e12031 "><code class="codeph">RHP_SOURCEPATH</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12058 d25134e12033 ">
                                    <p>The path of the source working copy home.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12065" headers="d25134e12031 "><code class="codeph">RHP_DESTINATIONWC</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12065 d25134e12033 ">
                                    <p>The destination working copy name for a patch or upgrade operation.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12072" headers="d25134e12031 "><code class="codeph">RHP_DESTINATIONPATH</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12072 d25134e12033 ">
                                    <p>The path of the destination working copy home.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12079" headers="d25134e12031 "><code class="codeph">RHP_SRCGGWC</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12079 d25134e12033 ">
                                    <p>The name of the version of the Oracle GoldenGate working copy from which you want to upgrade.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12086" headers="d25134e12031 "><code class="codeph">RHP_SRCGGPATH</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12086 d25134e12033 ">
                                    <p>The absolute path of the version of the Oracle GoldenGate software home from which you want to upgrade.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12093" headers="d25134e12031 "><code class="codeph">RHP_DESTGGWC</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12093 d25134e12033 ">
                                    <p>The name of the version of the Oracle GoldenGate working copy to which you want to upgrade.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12100" headers="d25134e12031 "><code class="codeph">RHP_DESTGGPATH</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12100 d25134e12033 ">
                                    <p>The absolute path of the version of the Oracle GoldenGate software home to which you want to upgrade.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12107" headers="d25134e12031 "><code class="codeph">RHP_PATH</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12107 d25134e12033 ">
                                    <p>This is the path to the location of the software home. This parameter represents the path on the local node from where the RHPCTL command is being run for an <code class="codeph">IMPORT_IMAGE</code> operation. For all other operations, this path is present on the site where the operation is taking place.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12118" headers="d25134e12031 "><code class="codeph">RHP_PATHOWNER</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12118 d25134e12033 ">
                                    <p>The owner of the path for the gold image that is being imported.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12125" headers="d25134e12031 "><code class="codeph">RHP_PROGRESSLISTENERHOST</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12125 d25134e12033 ">
                                    <p>The host on which the progress listener is listening. You can use this parameter, together with a progress listener port, to create a TCP connection to print output to the console on which the RHPCTL command is being run.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12132" headers="d25134e12031 "><code class="codeph">RHP_PROGRESSLISTENERPORT</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12132 d25134e12033 ">
                                    <p>The port on which the progress listener host is listening. You can use this parameter, together with a progress listener host name, to create a TCP connection to print output to the console on which the RHPCTL command is being run.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12139" headers="d25134e12031 "><code class="codeph">RHP_IMAGE</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12139 d25134e12033 ">
                                    <p>The image associated with the operation. In the case of a move operation, it will reflect the name of the destination image.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12146" headers="d25134e12031 "><code class="codeph">RHP_IMAGETYPE</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12146 d25134e12033 ">
                                    <p>The image type of the image associated with the operation. In the case of a move operation, it will reflect the name of the destination image.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12153" headers="d25134e12031 "><code class="codeph">RHP_VERSION</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12153 d25134e12033 ">
                                    <p>The version of the Oracle Grid Infrastructure software running on the Fleet Patching and Provisioning Server.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12160" headers="d25134e12031 "><code class="codeph">RHP_CLI</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12160 d25134e12033 ">
                                    <p>The exact command that was run to invoke the operation.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12167" headers="d25134e12031 "><code class="codeph">RHP_STORAGETYPE</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12167 d25134e12033 ">
                                    <p>The type of storage for the home (either <code class="codeph">LOCAL</code> or <code class="codeph">RHP_MANAGED</code>)
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12180" headers="d25134e12031 "><code class="codeph">RHP_USER</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12180 d25134e12033 ">
                                    <p>The user for whom the operation is being performed.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12187" headers="d25134e12031 "><code class="codeph">RHP_NODES</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12187 d25134e12033 ">
                                    <p>The nodes on which a database will be created.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12194" headers="d25134e12031 "><code class="codeph">RHP_ORACLEBASE</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12194 d25134e12033 ">
                                    <p>The Oracle base location for the provisioned home.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12202" headers="d25134e12031 "><code class="codeph">RHP_DBNAME</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12202 d25134e12033 ">
                                    <p>The name of the database to be created.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12209" headers="d25134e12031 "><code class="codeph">RHP_CLIENT</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12209 d25134e12033 ">
                                    <p>The name of the client cluster.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12216" headers="d25134e12031 "><code class="codeph">RHP_DATAPATCH</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12216 d25134e12033 ">
                                    <p>This parameter is set to TRUE at the conclusion of the user action on the node where the SQL patch will be run after the move database operation is complete.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d25134e12223" headers="d25134e12031 "><code class="codeph">RHP_USERACTIONDATA</code></td>
                                 <td align="left" valign="top" width="20%" headers="d25134e12223 d25134e12033 ">
                                    <p>This parameter is present in all of the operations and is used to pass user-defined items to the user action as an argument during runtime.</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-A3D8F47A-688B-4404-BAC9-3AFD2DA124BE__GUID-BBE81842-CC48-4BD4-A912-BFB13E42C3D0">Example of User-Defined Action</p>
                     <p>Suppose there is an image type, <code class="codeph">APACHESW</code>, to use for provisioning and managing Apache deployments. Suppose, too, that there is a Gold Image of Apache named <code class="codeph">apacheinstall</code>. The following example shows how to create a user action that will run prior to provisioning any copy of our Apache Gold Image.
                     </p>
                     <p>The following is a sample user action script named <code class="codeph">addapache_useraction.sh</code>:
                     </p><pre class="pre codeblock"><code>$ cat /scratch/apacheadmin/addapache_useraction.sh
#!/bin/sh

#refer to arguments using argument names 
touch /tmp/SAMPLEOUT.txt;
for i in "$@"
do
    export $i
done

echo "OPTYPE = $RHP_OPTYPE" &gt;&gt; /tmp/SAMPLEOUT.txt;
echo "PHASE = $RHP_PHASE" &gt;&gt; /tmp/SAMPLEOUT.txt;
echo "WORKINGCOPY = $RHP_WORKINGCOPY" &gt;&gt; /tmp/SAMPLEOUT.txt;
echo "PATH = $RHP_PATH" &gt;&gt; /tmp/SAMPLEOUT.txt;
echo "STORAGETYPE = $RHP_STORAGETYPE" &gt;&gt; /tmp/SAMPLEOUT.txt;
echo "USER = $RHP_USER" &gt;&gt; /tmp/SAMPLEOUT.txt;
echo "NODES = $RHP_NODES" &gt;&gt; /tmp/SAMPLEOUT.txt;
echo "ORACLEBASE = $RHP_ORACLEBASE" &gt;&gt; /tmp/SAMPLEOUT.txt;
echo "DBNAME = $RHP_DBNAME" &gt;&gt; /tmp/SAMPLEOUT.txt;
echo "PROGRESSLISTENERHOST = $RHP_PROGRESSLISTENERHOST" &gt;&gt; /tmp/SAMPLEOUT.txt;
echo "PROGRESSLISTENERPORT = $RHP_PROGRESSLISTENERPORT" &gt;&gt; /tmp/SAMPLEOUT.txt;
echo "IMAGE = $RHP_IMAGE" &gt;&gt; /tmp/SAMPLEOUT.txt;
echo "IMAGETYPE = $RHP_IMAGETYPE" &gt;&gt; /tmp/SAMPLEOUT.txt;
echo "RHPVERSION = $RHP_VERSION" &gt;&gt; /tmp/SAMPLEOUT.txt;
echo "CLI = $RHP_CLI" &gt;&gt; /tmp/SAMPLEOUT.txt;
echo "USERACTIONDATA = $RHP_USERACTIONDATA" &gt;&gt; /tmp/SAMPLEOUT.txt;
$</code></pre><p>The script is registered to run at the start of <code class="codeph">rhpctl add workingcopy</code> commands. The add working copy operation aborts if the script fails.
                     </p>
                     <p>The following command creates a user action called addapachepre:</p><pre class="pre codeblock"><code>$ rhpctl add useraction -optype ADD_WORKINGCOPY -pre -onerror ABORT -useraction
  addapachepre -actionscript /scratch/apacheadmin/addapache_useraction.sh
  -runscope ONENODE</code></pre><p>The following command registers the user action for the <code class="codeph">APACHESW</code> image type:
                     </p><pre class="pre codeblock"><code>$ rhpctl modify imagetype -imagetype APACHESW -useractions addapachepre</code></pre><p>The registered user action is invoked automatically at the start of commands that deploy a working copy of any image of the APACHESW type, such as the following:</p><pre class="pre codeblock"><code>$ rhpctl add workingcopy -workingcopy apachecopy001 -image apacheinstall 
  -path /scratch/apacheadmin/apacheinstallloc -sudouser apacheadmin -sudopath
  /usr/local/bin/sudo -node targetnode003 -user apacheadmin -useractiondata "sample"</code></pre><p>The sample script creates the <code>/tmp/SAMPLEOUT.txt</code> output file. Based on the example command, the output file contains:
                     </p><pre class="pre codeblock"><code>$ cat /tmp/SAMPLEOUT.txt
OPTYPE = ADD_WORKINGCOPY
PHASE = PRE
WORKINGCOPY = apachecopy001
PATH = /scratch/apacheadmin/apacheinstallloc
STORAGETYPE =
USER = apacheadmin
NODES = targetnode003
ORACLEBASE =
DBNAME =
PROGRESSLISTENERHOST = mds11042003.my.company.com
PROGRESSLISTENERPORT = 58068
IMAGE = apacheinstall
IMAGETYPE = APACHESW
RHPVERSION = 12.2.0.1.0
CLI = rhpctl__add__workingcopy__-image__apacheinstall__-path__/scratch/apacheadmin
 /apacheinstallloc__-node__targetnode003__-useractiondata__sample__
 -sudopath__/usr/local/bin/sudo__-workingcopy__apachecopy__-user__apacheadmin__
 -sudouser__apacheadmin__USERACTIONDATA = sample
$</code></pre><div class="infoboxnote" id="GUID-A3D8F47A-688B-4404-BAC9-3AFD2DA124BE__GUID-929E539E-023C-4C7B-868D-D36A23FB1384">
                        <p class="notep1">Notes:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>In the preceding output example empty values terminate with an equals sign (<code class="codeph">=</code>).
                              </p>
                           </li>
                           <li>
                              <p>The spaces in the command-line value of the <code class="codeph">RHP_CLI</code> parameter are replaced by two underscore characters (<code class="codeph">__</code>) to differentiate this from other parameters.
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-56298658-5135-4FE1-AC94-31C9339B3A90" name="GUID-56298658-5135-4FE1-AC94-31C9339B3A90"></a><h3 id="CWADD-GUID-56298658-5135-4FE1-AC94-31C9339B3A90" class="sect3">Job Scheduler for Operations</h3>
               <div>
                  <p>The Fleet Patching and Provisioning job scheduler provides you with a mechanism to submit operations at a scheduled time instead of running the command immediately, querying the metadata of the job, and then deleting the job from the repository.</p>
                  <div class="p">The Fleet Patching and Provisioning job scheduler includes the following features:
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Enables you to schedule a command to run at a specific point in time by providing the time value</p>
                        </li>
                        <li>
                           <p>Performs the job and stores the metadata for the job, along with the current status of the job</p>
                        </li>
                        <li>
                           <p>Stores the logs for each of the jobs that have run or are running</p>
                        </li>
                        <li>
                           <p>Enables you to query job details ( for all jobs or for specific jobs, based on the user roles)</p>
                        </li>
                        <li>
                           <p>Deletes jobs</p>
                        </li>
                        <li>
                           <p>Authorizes the running, querying, and deleting of jobs, based on role-based access for users</p>
                        </li>
                     </ul>
                  </div>
                  <div class="p">Use the <code class="codeph">-schedule <span class="variable" translate="no">timer_value</span></code> command parameter with any of the following RHPCTL commands to schedule certain Rapid Hope Provisioning operations:
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><code class="codeph">rhpctl add workingcopy</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">rhpctl import image</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">rhpctl delete image</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">rhpctl add database</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">rhpctl move gihome</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">rhpctl move database</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">rhpctl upgrade database</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">rhpctl addnode database</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">rhpctl deletenode database</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">rhpctl delete workingcopy</code></p>
                        </li>
                     </ul>
                  </div>
                  <div class="p">For example:<pre class="pre codeblock"><code>$ rhpctl add workingcopy -workingcopy 18_3 -image 18_3_Base -oraclebase /u01/app/oracle -schedule 2016-12-21T19:13:17+05</code></pre></div>
                  <p>All commands are run in reference with the time zone of the server, according to the ISO-8601 value, and RHPCTL displays the command result by specifying the same time zone.</p>
                  <p><span class="bold">Command Results</span></p>
                  <p>RHPCTL stores any command that is run from the command queue on the Fleet Patching and Provisioning Server. When you query a command result by specifying the command identifier, then RHPCTL returns the path to the job output file, along with the results.</p>
                  <p><span class="bold">Job Operation</span></p>
                  <p>When you run an RHPCTL command with the <code class="codeph">-schedule</code> parameter, the operation creates a job with a unique job ID that you can query to obtain the status of the job.
                  </p>
                  <p><span class="bold">Job Status</span></p>
                  <div class="p">At any point in time, a job can be in any of the following states:<pre class="pre codeblock"><code>EXECUTED | TIMER_RUNNING | EXECUTING | UNKNOWN | TERMINATED</code></pre><ul style="list-style-type: disc;">
                        <li>
                           <p><code class="codeph">EXECUTED</code>: The job is complete.
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">TIMER_RUNNING</code>: The timer for the job is still running.
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">EXECUTING</code>: The timer for the job has expired and is running.
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">UNKNOWN</code>: There is an unexpected failure due to issues such as a target going down, nodes going down, or any resource failures.
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">TERMINATED</code>: There is an abrupt failure or the operation has stopped.
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-5E020245-CBE8-4B0E-AAD9-7D5305CDABDB" title="Deletes a specific scheduled job from the repository.">rhpctl delete job</a></li>
                        <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-37F19BE3-BE9C-4013-9C6D-F63BCF1BCBDD" title="Queries the current status of a scheduled job with a specific job ID.">rhpctl query job</a></li>
                     </ul>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-492BAB58-26A7-4968-98BC-2993DDCCA856" name="GUID-492BAB58-26A7-4968-98BC-2993DDCCA856"></a><h3 id="CWADD-GUID-492BAB58-26A7-4968-98BC-2993DDCCA856" class="sect3">Oracle Restart Patching and Upgrading</h3>
               <div>
                  <p>You can use Fleet Patching and Provisioning to patch and upgrade Oracle Restart using gold images.</p>
                  <p>You can move the target of single-node Oracle Restart to an Oracle home that you provision from a gold image that includes any patches. Fleet Patching and Provisioning ensures the copying of the configuration files, such as listener.ora, to the new Oracle home.</p>
                  <p>You can also use Fleet Patching and Provisioning to upgrade Oracle Restart using gold images. Upgrade the Oracle Restart environment by upgrading the Oracle home on the target Oracle home that you provision from a higher-level gold image. Fleet Patching and Provisioning updates the configuration and inventory settings.</p>
                  <div class="p">Use the RHPCTL utility similar to the following:<pre class="pre codeblock"><code>rhpctl add workingcopy -workingcopy <span class="variable" translate="no">Oracle_Restart_working_copy</span> -resposnefile <span class="variable" translate="no">Oracle_Restart_resposne_file</span> -targetnode <span class="variable" translate="no">node_on_which_Oracle_Restart_is_provisioned</span> {superuser credentials}</code></pre></div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-4A987DBE-1BBC-4FEE-B576-A06308AA05C8" name="GUID-4A987DBE-1BBC-4FEE-B576-A06308AA05C8"></a><h3 id="CWADD-GUID-4A987DBE-1BBC-4FEE-B576-A06308AA05C8" class="sect3">Fleet Patching and Provisioning Use Cases</h3>
               <div>
                  <p>Review these topics for step-by-step procedures to provision, patch, and upgrade your software using Fleet Patching and Provisioning. </p>
                  <p>Fleet Patching and Provisioning is a software lifecycle management solution and helps standardize patching, provisioning, and upgrade of your standard operating environment.</p>
               </div>
               <div class="sect3"><a id="GUID-576A8A2F-A7E2-4678-BD3F-ACF1E731B3A9" name="GUID-576A8A2F-A7E2-4678-BD3F-ACF1E731B3A9"></a><h4 id="CWADD-GUID-576A8A2F-A7E2-4678-BD3F-ACF1E731B3A9" class="sect4">Creating an Oracle Grid Infrastructure 12<span class="italic">c</span> Release 2 Deployment
                  </h4>
                  <div>
                     <p>Provision Oracle Grid Infrastructure software on two nodes that do not currently have a Grid home, and then configure Oracle Grid Infrastructure to form a multi-node Oracle Grid Infrastructure installation.</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-576A8A2F-A7E2-4678-BD3F-ACF1E731B3A9__GUID-D1463B9D-231A-4C20-8844-6138F87CAB0E">Before You Begin</p>
                        <p>Provide configuration details for storage, network, users and groups, and node information for installing Oracle Grid Infrastructure in a response file. You can store the response file in any location on the Fleet Patching and Provisioning Server. </p>
                        <p>You can provision an Oracle Standalone Cluster, Oracle Application Clusters, Oracle Domain Services Cluster, or Oracle Member Clusters. Ensure that the response file has the required cluster configuration details.</p>
                        <p>Ensure that you have storage, network, and operating system requirements configured as stated in the <cite>Oracle Grid Infrastructure Installation Guide</cite>.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-576A8A2F-A7E2-4678-BD3F-ACF1E731B3A9__GUID-A5F16808-85CE-4166-AD3F-269DFB04ADDC">Procedure</p>
                     </div>
                     <!-- class="section" -->
                     <ul>
                        <li class="stepexpand"><span>From the Fleet Patching and Provisioning Server, run the command:</span><div><pre class="pre codeblock"><code>$ rhpctl add workingcopy -workingcopy GI122 -image GI_HOME_12201 &#x2013;responsefile /u01/app/rhpinfo/GI_12201_install.rsp {<span class="variable" translate="no">authentication_option</span>}</code></pre><p><code class="codeph">GI122</code> is the working copy based on the image <code class="codeph">GI_HOME_12201</code></p>
                              <p><code class="codeph">/u01/app/rhpinfo/GI_12201_install.rsp</code> is the response file location. 
                              </p>
                           </div>
                           <div>Cluster Verification Utility checks for preinstallation configuration as per requirements. Fleet Patching and Provisioning configures Oracle Grid Infrastructure. </div>
                        </li>
                     </ul>
                     <div class="section">
                        <p>Oracle Grid Infrastructure 12<span class="italic">c</span> release 2 is provisioned as per the settings in the same response file.
                        </p>
                        <p>During provisioning, if an error occurs, the procedure stops and allows you to fix the error. After fixing the error, you can resume the provisioning operation from where it last stopped.</p>
                        <p>Watch a video
                           <div class="video-box">
                              <div id="18888" class="video-container"></div>
                           </div>
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-EE5A5ED3-5ACF-4745-AB9D-6A4D2E438D09" name="GUID-EE5A5ED3-5ACF-4745-AB9D-6A4D2E438D09"></a><h4 id="CWADD-GUID-EE5A5ED3-5ACF-4745-AB9D-6A4D2E438D09" class="sect4">Provisioning an Oracle Database Home and Creating a Database</h4>
                  <div>
                     <p>This procedure provisions Oracle Database 12<span class="italic">c</span> release 2 (12.2) software and creates Oracle Database instances.
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-EE5A5ED3-5ACF-4745-AB9D-6A4D2E438D09__GUID-67070765-F49B-4386-84D0-71BD0801F260">Procedure</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>From the Fleet Patching and Provisioning Server, provision the Oracle Database home software:</span><div><pre class="pre codeblock"><code>$ rhpctl add workingcopy -image db12201 -path /u01/app/dbusr/product/12.2.0/db12201
  -client client_001 -oraclebase /u01/app/dbusr/ -workingcopy db122 </code></pre></div>
                           <div>The command provisions the working copy <code class="codeph">db122</code> to the specified path on the cluster <code class="codeph">client_001</code>, from the image <code class="codeph">db12201</code> .
                           </div>
                        </li>
                        <li class="stepexpand"><span>Create the database instance:</span><div><pre class="pre codeblock"><code>$ rhpctl add database -workingcopy db122 -dbname db -dbtype RAC</code></pre></div>
                           <div>The command creates an Oracle RAC database instance <code class="codeph">db</code> . You can use the <code class="codeph">add database</code> command repeatedly to create more instances on the working copy.
                           </div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>Watch a video
                           <div class="video-box">
                              <div id="18874" class="video-container"></div>
                           </div>
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-8D0CCA76-0F80-4B64-9097-52B31C525DB4" name="GUID-8D0CCA76-0F80-4B64-9097-52B31C525DB4"></a><h4 id="CWADD-GUID-8D0CCA76-0F80-4B64-9097-52B31C525DB4" class="sect4">Provisioning a Pluggable Database</h4>
                  <div>
                     <p>You can provision a pluggable database (PDB) on an existing container database (CDB) running in a provisioned database working copy.</p>
                     <div class="p">After you create a working copy of a gold image, provision that working copy to a target, and create a database as a multitenant CDB, you can add a PDB to the CDB using the <code class="codeph">rhpctl addpdb database</code> command.
                     </div>
                     <!-- class="section" -->
                     <ul>
                        <li class="stepexpand"><span>The following command example creates a PDB called <code class="codeph">pdb183</code> on a CDB called <code class="codeph">raccdb183</code>, which is on a working copy called <code class="codeph">wc_db183</code>:</span><div><pre class="pre codeblock"><code>$ rhpctl addpdb database -workingcopy wc_db183 -cdbName raccdb183 -pdbName pdb183</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Use the <code class="codeph">rhpctl deletepdb database</code> command to delete a PDB from an existing CDB on a working copy.</span><div>The following command example deletes a PDB called <code class="codeph">pdb183</code> on a CDB called <code class="codeph">raccdb183</code>, which is on a working copy called <code class="codeph">wc_db183</code>:<pre class="pre codeblock"><code>$ rhpctl deletepdb database -workingcopy wc_db183 -cdbName raccdb183 -pdbName pdb183</code></pre></div>
                        </li>
                     </ul>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-018ACE1C-D873-45CF-A2D7-D7BD7B9C7AFA" name="GUID-018ACE1C-D873-45CF-A2D7-D7BD7B9C7AFA"></a><h4 id="CWADD-GUID-018ACE1C-D873-45CF-A2D7-D7BD7B9C7AFA" class="sect4">Upgrading to Oracle Grid Infrastructure 12<span class="italic">c</span> Release 2
                  </h4>
                  <div>
                     <p>This procedure uses Fleet Patching and Provisioning to upgrade your Oracle Grid Infrastructure cluster from 11<span class="italic">g</span> release 2 (11.2.0.4) to 12<span class="italic">c</span> release 2 (12.2).
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-018ACE1C-D873-45CF-A2D7-D7BD7B9C7AFA__GUID-69223C4E-E632-4BEA-BABD-CB362B699CDF">Before You Begin</p>
                        <p>To upgrade to Oracle Grid Infrastructure 12<span class="italic">c</span> release 2 (12.2.0.1), your source must be Oracle Grid Infrastructure 11<span class="italic">g</span> release 2 (11.2.0.3 or 11.2.0.4), or Oracle Grid Infrastructure 12<span class="italic">c</span> release 2 (12.1.0.2).
                        </p>
                        <p>Ensure that groups configured in the source home match those in the destination home.</p>
                        <p>Ensure that you have an image <code class="codeph">GI_HOME_12201</code> of the Oracle Grid Infrastructure 12<span class="italic">c</span> release 2 (12.2.0.1) software to provision your working copy.
                        </p>
                        <p><code class="codeph">GI_11204</code> is the active Grid Infrastructure home on the cluster being upgraded. It is a working copy because in this example, Fleet Patching and Provisioning provisioned the cluster. Fleet Patching and Provisioning can also upgrade clusters whose Grid Infrastructure homes are unmanaged that is, homes that Fleet Patching and Provisioning did not provision.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-018ACE1C-D873-45CF-A2D7-D7BD7B9C7AFA__GUID-82330B07-CACF-45E8-91B0-97AB411FF586">Procedure</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Provision a working copy of the Oracle Grid Infrastructure 12<span class="italic">c</span> release 2 (12.2.0.1) software:</span><div><pre class="pre codeblock"><code>$ rhpctl add workingcopy -workingcopy GI122 -image GI_HOME_12201 {<span class="variable" translate="no">authentication_option</span>}</code></pre><p><code class="codeph">GI122</code> is the working copy based on the image <code class="codeph">GI_HOME_12201</code>.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Upgrade your target cluster to the <code class="codeph">GI122</code> working copy:</span><div><pre class="pre codeblock"><code>rhpctl upgrade gihome -sourcewc GI11204 -destwc GI122</code></pre></div>
                           <div>Rapid Home Provisioning identifies the cluster to upgrade based on the name of the source working copy, and upgrades to the working copy <code class="codeph">GI122</code>.
                           </div>
                        </li>
                     </ol>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-01E1C53C-CD9E-4E96-BA2A-C061821768D2" name="GUID-01E1C53C-CD9E-4E96-BA2A-C061821768D2"></a><h4 id="CWADD-GUID-01E1C53C-CD9E-4E96-BA2A-C061821768D2" class="sect4">Patching Oracle Grid Infrastructure Without Changing the Grid Home Path</h4>
                  <div>
                     <p>This procedure explains how to patch Oracle Grid Infrastructure without changing the Grid home path.</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-01E1C53C-CD9E-4E96-BA2A-C061821768D2__GUID-71E75BA7-232A-42C3-920B-19F44B518800">Before You Begin</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Ensure that the gold image containing the Grid home is imported and exists on the Fleet Patching and Provisioning Server.</p>
                           </li>
                           <li>
                              <p>Ensure that the directory you provide in the <code class="codeph">­path</code> option is not an existing directory.
                              </p>
                           </li>
                           <li>
                              <p>The source Grid home must be a managed home (provisioned by Fleet Patching and Provisioning). It does not need to be an Oracle Layered File System (OLFS)-compliant home.</p>
                           </li>
                           <li>
                              <p>The Grid home must be Oracle Grid Infrastructure 12<span class="italic">c</span> (12.2.0.1) or later.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-01E1C53C-CD9E-4E96-BA2A-C061821768D2__GUID-7C8C0DFE-FA2E-4B56-A5EB-58CC934E3FFE">Procedure for Patching</p>
                     </div>
                     <!-- class="section" -->
                     <ul>
                        <li class="stepexpand"><span>To move a non-OLFS-compliant Grid home to an OLFS Grid home, from the Fleet Patching and Provisioning Server, run two commands similar to the following:</span><div><pre class="pre codeblock"><code>$ rhpctl add workingcopy -workingcopy GI_HOME_12201_PSU1 -aupath
  /u01/app/orabase/product/12.2.0.1/aupath -image <span class="variable" translate="no">image_name</span>
  -client <span class="variable" translate="no">client_name</span> -softwareonly</code></pre><pre class="pre codeblock"><code>$ rhpctl move gihome -srcwc GI_HOME_12201 -destwc GI_HOME_12201_PSU1 -agpath
  /u01/app/orabase/product/12.2.0.1/agpath -path
  /u01/app/orabase/product/12.2.0.1/grid</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>To move an OLFS-compliant Grid home to a patched version, run two commands similar to the following:</span><div><pre class="pre codeblock"><code>$ rhpctl add workingcopy -workingcopy gihome12201_psu1_lpm -aupath
  /u01/app/orabase/product/12.2.0.1/aupath -image <span class="variable" translate="no">image_name</span> -client
  <span class="variable" translate="no">client_name</span> -softwareonly</code></pre><pre class="pre codeblock"><code>$ rhpctl move gihome -sourcewc gihome12201_lpm -destwc gihome12201_psu1_lpm</code></pre></div>
                        </li>
                     </ul>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-4E6A7A57-BB3C-49A1-9C9F-820EA62D675A" name="GUID-4E6A7A57-BB3C-49A1-9C9F-820EA62D675A"></a><h4 id="CWADD-GUID-4E6A7A57-BB3C-49A1-9C9F-820EA62D675A" class="sect4">Patching Oracle Grid Infrastructure and Oracle Databases Simultaneously</h4>
                  <div>
                     <p>This procedure patches Oracle Grid Infrastructure and Oracle Databases on the cluster to the latest patch level without cluster downtime.</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-4E6A7A57-BB3C-49A1-9C9F-820EA62D675A__GUID-E146963D-CFFD-4015-82A2-17AE0A54F999">Before You Begin</p>
                        <p>In this procedure, Oracle Grid Infrastructure 12<span class="italic">c</span> release 2 (12.2.0.1) is running on the target cluster. Working copy <code class="codeph">GI_HOME_12201_WCPY</code> is the active Grid home on this cluster. Working copy <code class="codeph">DB_HOME_12201_WCPY</code> runs an Oracle RAC 12<span class="italic">c</span> release 2 (12.2.0.1) Database with running database instance <code class="codeph">db1</code>. Working copy <code class="codeph">DB_HOME_12102_WCPY</code> runs an Oracle RAC 12<span class="italic">c</span> release 1 (12.1.0.2) Database with running database instance <code class="codeph">db2</code></p>
                        <p>Ensure that you have images <code class="codeph">GI_HOME_12201_PSU1</code>, <code class="codeph">DB_HOME_12201_PSU1</code>, <code class="codeph">DB_HOME_12102_PSU5</code> with the required patches for Oracle Grid Infrastructure and Oracle RAC Database on the Fleet Patching and Provisioning Server. 
                        </p>
                        <p>The groups configured in the source home must match with those in the destination home.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-4E6A7A57-BB3C-49A1-9C9F-820EA62D675A__GUID-AA19B7B3-9919-4A3B-B996-7B15A4FEB610">Procedure</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Prepare target Oracle homes as follows:</span><ol type="a">
                              <li class="substepexpand"><span>Provision software-only Grid home on the cluster to be patched:</span><div><pre class="pre codeblock"><code>$ rhpctl add workingcopy -workingcopy GI_HOME_12201_PATCHED_WCPY 
  -image GI_HOME_12201_PSU1 &#x2013;client CLUSTER_005 -softwareonly</code></pre></div>
                              </li>
                              <li class="substepexpand"><span>Provision each release Database home, without database instances, to be patched:</span><div><pre class="pre codeblock"><code>$ rhpctl add workingcopy -workingcopy DB_HOME_12201_PATCHED_WCPY 
  -image DB_HOME_12201_PSU1
$ rhpctl add workingcopy -workingcopy DB_HOME_12102_PATCHED_WCPY 
  -image DB_HOME_12102_PSU5</code></pre></div>
                              </li>
                           </ol>
                        </li>
                        <li class="stepexpand"><span>Patch Oracle Grid Infrastructure and all Oracle RAC Databases on <code class="codeph">node1</code> as follows:</span><div><pre class="pre codeblock"><code>$ rhpctl move gihome -sourcewc GI_HOME_12201_WCPY -destwc GI_HOME_12201_PATCHED_WCPY -auto
  -dbhomes DB_HOME_12102_WCPY=DB_HOME_12102_PATCHED_WCPY,DB_HOME_12201_WCPY=DB_HOME_12201_PATCHED_WCPY  -targetnode node1 {<span class="variable" translate="no">authentication_option</span>}</code></pre><p>When you run the command, you move your active Oracle Grid Infrastructure from working copy <code class="codeph">GI_HOME_12201_WCPY</code> to <code class="codeph">GI_HOME_12201_PATCHED_WCPY</code>, Oracle RAC Database <code class="codeph">db1</code> from <code class="codeph">DB_HOME_12201_WCPY</code> to <code class="codeph">DB_HOME_12201_PATCHED_WCPY</code>, and Oracle RAC Database <code class="codeph">db2</code> from <code class="codeph">DB_HOME_12102_WCPY</code> to <code class="codeph">DB_HOME_12102_PATCHED_WCPY</code>.
                              </p>
                           </div>
                        </li>
                     </ol>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-666A28B6-66D5-48F6-AD2B-7606E300517E" name="GUID-666A28B6-66D5-48F6-AD2B-7606E300517E"></a><h4 id="CWADD-GUID-666A28B6-66D5-48F6-AD2B-7606E300517E" class="sect4">Patching Oracle Database 12<span class="italic">c</span> Release 1 Without Downtime
                  </h4>
                  <div>
                     <p>This procedure explains how to patch Oracle Database 12<span class="italic">c</span> release 1 (12.1.0.2) with the latest patching without bringing down the database.
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-666A28B6-66D5-48F6-AD2B-7606E300517E__GUID-D870EAE4-3315-4388-82B2-97D8597C1B44">Before You Begin</p>
                        <p>You have an Oracle Database <code class="codeph">db12102</code> that you want to patch to the latest patch level.
                        </p>
                        <p>Ensure that the working copy <code class="codeph">db12102_psu</code> based on the image <code class="codeph">DB12102_PSU</code> contains the latest patches and is available.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-666A28B6-66D5-48F6-AD2B-7606E300517E__GUID-FB9CBBC8-ED4A-4004-A01C-9C761A812215">Procedure</p>
                        <p>From the Fleet Patching and Provisioning Server, run one of the following commands as per your source and destination database:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>To patch an Oracle Database home managed by Fleet Patching and Provisioning, and there exist working copies of the source and destination databases, run:</span><div><pre class="pre codeblock"><code>rhpctl move database -sourcewc db12102 -patchedwc db12102_psu</code></pre><p><code class="codeph">db12102</code> is the source working copy of the database being patched
                              </p>
                              <p><code class="codeph">db12102_psu</code> is the working copy of the Oracle Database software with patches applied, based on the image <code class="codeph">DB12102_PSU</code>.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>To patch an unmanaged Oracle Database home (source working copy does not exist because the Oracle home is not managed by Fleet Patching and Provisioning), run:</span><div><pre class="pre codeblock"><code>rhpctl move database -sourcehome /u01/app/orabase/product/12.1.0.2/dbhome_1
 -patchedwc db12102_psu -targetnode node1</code></pre><p><code class="codeph">targetnode</code> specifies the node on which the database to be upgraded is running, because the source Oracle Database is on a 12.1.0.2 cluster.
                              </p>
                              <p><code class="codeph">/u01/app/orabase/product/12.1.0.2/dbhome_1</code> is the path of the database being patched
                              </p>
                              <p><code class="codeph">db12102_psu</code> is the working copy of the Oracle Database software with patches applied, based on the image <code class="codeph">DB12102_PSU</code>.
                              </p>
                           </div>
                           <div></div>
                           <div>Use the saved gold image for standardized patching of all your databases of release 12<span class="italic">c</span> release 1 to the same patch level.
                           </div>
                        </li>
                        <li class="stepexpand"><span>If for some reason, you want to rollback the patches applied to a managed Oracle Database home, run:</span><div><pre class="pre codeblock"><code>rhpctl move database -sourcewc db12102_psu 
-patchedwc db12102 -ignorewcpatches</code></pre><p><code class="codeph">db12102</code> is the working copy of the unpatched database to which you want to roll back.
                              </p>
                              <p><code class="codeph">db12102_psu</code> is the working copy of the Oracle Database software with patches applied, based on the image <code class="codeph">DB12102_PSU</code>.
                              </p>
                           </div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>For all Oracle Databases, you can also specify these additional options with the <code class="codeph">move database</code> command:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">-keepplacement</code>: For admin-managed Oracle RAC Databases (not Oracle RAC One Node Database), Fleet Patching and Provisioning retains the services on the same nodes after the move. 
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">-disconnect</code>: Disconnects all sessions before stopping or relocating services.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">-drain_timeout</code>: Specify the time, in seconds, allowed for resource draining to be completed for planned maintenance operations. During the draining period, all current client requests are processed, but new requests are not accepted. This option is available only with Oracle Database 12<span class="italic">c</span> release 2 (12.2) or later.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">-stopoption</code>: Stops the database.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">-nodatapatch</code>: Ensures <code class="codeph">datapatch</code> is not run for databases you are moving.
                              </p>
                           </li>
                        </ul>
                        <p>Watch a video
                           <div class="video-box">
                              <div id="18887" class="video-container"></div>
                           </div>
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-3C43BA78-B15B-4235-9088-81D65A13C497" name="GUID-3C43BA78-B15B-4235-9088-81D65A13C497"></a><h4 id="CWADD-GUID-3C43BA78-B15B-4235-9088-81D65A13C497" class="sect4">Upgrading to Oracle Database 12<span class="italic">c</span> Release 2
                  </h4>
                  <div>
                     <p>This procedure describes how to upgrade an Oracle database from Oracle Database 11<span class="italic">g</span> release 2 (11.2) to 12<span class="italic">c</span> release 2 with a single command, using Fleet Patching and Provisioning, both for managed and unmanaged Oracle homes.
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-3C43BA78-B15B-4235-9088-81D65A13C497__GUID-016AFE9C-C941-4BC9-A270-B73EA0CC8D90">Before you Begin</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>To upgrade to Oracle Database 12<span class="italic">c</span> release 2 (12.2.0.1), your source database must be either Oracle Database 11<span class="italic">g</span> release 2 (11.2.0.3 or 11.2.0.4), or Oracle Database 12<span class="italic">c</span> release 1 (12.1.0.2).
                              </p>
                           </li>
                           <li>
                              <p>Oracle Grid Infrastructure on which the pre-upgrade database is running must be of the same release or later than the database release to which you are upgrading.</p>
                           </li>
                           <li>
                              <p>The source Oracle home to be upgraded can be a managed working copy, that is an Oracle home provisioned using Fleet Patching and Provisioning, or an unmanaged home, that is, an Oracle home not provisioned using Fleet Patching and Provisioning. If you are upgrading an unmanaged Oracle home, provide the complete path of the database for upgrade.</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-3C43BA78-B15B-4235-9088-81D65A13C497__GUID-6405DCF0-4C37-4BC4-9824-BDC02D796DE4">Procedure to Upgrade Oracle Database using Fleet Patching and Provisioning</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>From the Fleet Patching and Provisioning Server, run one of the following commands as per your source and destination database:</span><ol type="a">
                              <li class="substepexpand"><span>To upgrade an Oracle home managed by Fleet Patching and Provisioning, and there exist working copies of the source and destination databases, run: </span><div><pre class="pre codeblock"><code>$ rhpctl upgrade database -dbname test_database -sourcewc db112 -destwc db122
  {<span class="variable" translate="no">authentication_option</span>}</code></pre><p><code class="codeph">test_database</code> is the name of the database being upgraded. 
                                    </p>
                                    <p><code class="codeph">db112</code> is the source working copy of the pre-upgrade database.
                                    </p>
                                    <p><code class="codeph">db122</code> is the working copy of the upgraded Oracle Database software.
                                    </p>
                                 </div>
                              </li>
                              <li class="substepexpand"><span>To upgrade an unmanaged Oracle home (source working copy does not exist because the Oracle home is not managed by Fleet Patching and Provisioning), run:</span><div><pre class="pre codeblock"><code>$ rhpctl move database -sourcehome /u01/app/orabase/product/11.2.0/dbhome_1
  -destwc db122 -targetnode node1 {<span class="variable" translate="no">authentication_option</span>}</code></pre><p><code class="codeph">/u01/app/orabase/product/11.2.0/dbhome_1</code> is the path of the database being upgraded.
                                    </p>
                                    <p><code class="codeph">db122</code> is the working copy of the upgraded Oracle Database software.
                                    </p>
                                    <p><code class="codeph">targetnode</code> specifies the node on which the database to be upgraded is running, because the source Oracle Database is on a 11.2.0.4 cluster.
                                    </p>
                                 </div>
                              </li>
                           </ol>
                           <div></div>
                        </li>
                     </ol>
                     <div class="section">The upgraded database is now managed by Fleet Patching and Provisioning. You can ensure that your database is patched to the latest level, using Fleet Patching and Provisioning.
                        <div class="infoboxnote" id="GUID-3C43BA78-B15B-4235-9088-81D65A13C497__GUID-E187BA50-88F6-4D33-8567-DC16F1FF03D6">
                           <p class="notep1">Note:</p> During upgrade, if an error occurs, the procedure stops and allows you to fix the error. After fixing the error, you can resume the upgrade operation from where it last stopped.
                        </div>
                        <p>Watch a video
                           <div class="video-box">
                              <div id="18886" class="video-container"></div>
                           </div>
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-926A4D78-0BAB-45EA-B5A4-B9B11BF77374" title="Upgrades a database to the version of the destination working copy.">rhpctl upgrade database</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-C10036DC-B091-40E1-B46B-8ACF38B20066" title="Moves one or more databases from a source working copy or any Oracle Database home to a patched working copy.">rhpctl move database</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-34F15203-2715-47CE-80EE-962355B61CAE" name="GUID-34F15203-2715-47CE-80EE-962355B61CAE"></a><h4 id="CWADD-GUID-34F15203-2715-47CE-80EE-962355B61CAE" class="sect4">Adding a Node to a Cluster and Scaling an Oracle RAC Database to the Node</h4>
                  <div>
                     <p>You can add a node to your two-node cluster by using Fleet Patching and Provisioning to add the node, and then extend an Oracle RAC database to the new node.</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-34F15203-2715-47CE-80EE-962355B61CAE__GUID-1AA5AE92-7E1D-4313-B884-904E59D80A04">Before You Begin</p>
                        <p>In this procedure, Oracle Grid Infrastructure 12<span class="italic">c</span> release 2 (12.2.0.1) is running on the cluster. Working copy <code class="codeph">GI_HOME_12202_WCPY</code> is the active Grid home on this cluster.
                        </p>
                        <p>The Oracle RAC database home runs on the working copy <code class="codeph">DB_HOME_12202_WCPY</code>.
                        </p>
                        <p>Ensure that you have storage, network, and operating system requirements configured for the new node as stated in <cite>Oracle Grid Infrastructure Installation Guide</cite>.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-34F15203-2715-47CE-80EE-962355B61CAE__GUID-D1E7F9DC-0CFF-4DBC-BC92-01AAD569C544">Procedure</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>From the Fleet Patching and Provisioning Server, run the following command to add a node to the existing Oracle Grid Infrastructure working copy:</span><div><pre class="pre codeblock"><code>rhpctl addnode gihome -workingcopy GI_HOME_12202_WCPY -newnodes n3:n3-vip {<span class="variable" translate="no">authentication_option</span>}</code></pre></div>
                           <div>The command extends the cluster by adding <code class="codeph">node3</code>.
                           </div>
                        </li>
                        <li class="stepexpand"><span>Add instances to the administrator-managed Oracle RAC database on the new node:</span><div><pre class="pre codeblock"><code>rhpctl addnode database -workingcopy DB_HOME_12202_WCPY -dbname db321 -node n3 {<span class="variable" translate="no">authentication_option</span>}</code></pre></div>
                           <div>The command extends the database home on the <code class="codeph">node3</code> and creates database <code class="codeph">db321</code> on this node.
                           </div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>Watch a video
                           <div class="video-box">
                              <div id="18899" class="video-container"></div>
                           </div>
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-808195B6-C75C-46F7-B81C-F975671FD924" title="Adds one or more nodes to an Oracle Grid Infrastructure installation.">rhpctl addnode gihome</a></li>
                           <li><a href="rapid-home-provisioning-and-server-control-command-reference.html#GUID-AF70BBF3-3FDD-4CCE-B73F-D19BE9C95A3B" title="Adds instances to an administrator-managed Oracle RAC database.">rhpctl addnode database</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-53F8804C-E900-4B92-A092-5C2EF4B61CEE" name="GUID-53F8804C-E900-4B92-A092-5C2EF4B61CEE"></a><h4 id="CWADD-GUID-53F8804C-E900-4B92-A092-5C2EF4B61CEE" class="sect4">Adding Gold Images for Fleet Patching and Provisioning</h4>
                  <div>
                     <p>Create gold images of software home and store them on the Fleet Patching and Provisioning Server, to use later to provision Oracle homes.</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-53F8804C-E900-4B92-A092-5C2EF4B61CEE__GUID-0F9E8554-EF44-4F80-8225-73C074DC778D">Before You Begin</p>
                        <p>The Oracle home to be used for creating the gold image can be on the Fleet Patching and Provisioning Server, or Fleet Patching and Provisioning Client, or any target machine that the Fleet Patching and Provisioning Server can communicate with.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-53F8804C-E900-4B92-A092-5C2EF4B61CEE__GUID-D8DFA4FB-DEBE-484E-8B44-6DF6260E4159">Procedure</p>
                        <p>Create gold images of Oracle homes in any of the following ways and store them on the Fleet Patching and Provisioning server:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Import an image from an installed Oracle home on the Fleet Patching and Provisioning Server:</span><div><pre class="pre codeblock"><code>rhpctl import image -image db12201 -path /share/software/122/dbhome -imagetype ORACLEDBSOFTWARE </code></pre><p>The gold image of <code class="codeph">imagetype</code> Oracle Database 12<span class="italic">c</span> release 2 software is created and stored on the Fleet Patching and Provisioning Server. 
                              </p>
                              <p>You can also create gold images of Oracle Grid Infrastructure or any other software by specifying <code class="codeph">-imagetype</code> as <code class="codeph">ORACLEGISOFTWARE</code>, <code class="codeph">ORACLEGGSOFTWARE</code>, or <code class="codeph">SOFTWARE</code> respectively.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Import an image from an installed Oracle home on a Fleet Patching and Provisioning Client by running the following command from the Fleet Patching and Provisioning Client:</span><div><pre class="pre codeblock"><code>rhpctl import image -image db12201 -path /u01/app/dbusr/product/12.2.0/</code></pre><p>The command creates and adds the image <code class="codeph">db12201</code> based on the local Oracle home installed in the specified path.
                              </p>
                           </div>
                        </li>
                     </ol>
                     <div class="section">
                        <div class="infoboxnote" id="GUID-53F8804C-E900-4B92-A092-5C2EF4B61CEE__GUID-9D279974-9A5E-43E3-B27A-33AE1971A20F">
                           <p class="notep1">Note:</p>You cannot directly use images as software homes. Use images to create working copies of software homes.
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-6F4210E7-F0E5-4A3E-A8B4-D4664286A0AA" name="GUID-6F4210E7-F0E5-4A3E-A8B4-D4664286A0AA"></a><h4 id="CWADD-GUID-6F4210E7-F0E5-4A3E-A8B4-D4664286A0AA" class="sect4">User Actions for Common Fleet Patching and Provisioning Tasks</h4>
                  <div>
                     <p>You can use Fleet Patching and Provisioning user actions to perform many tasks, such as installing and configuring any type of software and running scripts.</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-6F4210E7-F0E5-4A3E-A8B4-D4664286A0AA__GUID-DD3EAFF8-BD56-468A-822A-85173565651F">Deploying a Web Server</p>
                        <p>The following procedure demonstrates automated deployment of Apache Web Server using Fleet Patching and Provisioning:</p>
                        <ol id="GUID-6F4210E7-F0E5-4A3E-A8B4-D4664286A0AA__OL_JST_T1Y_XFB">
                           <li>Create a script to install Apache Web server, as follows:
                              <ol type="a" id="GUID-6F4210E7-F0E5-4A3E-A8B4-D4664286A0AA__OL_RGR_DGY_XFB">
                                 <li>On the Fleet Patching and Provisioning Server, download and extract the Apache Web server installation kit.</li>
                                 <li>Create the script to install, configure, and start the Apache Web server.</li>
                              </ol>
                           </li>
                           <li>Register the script as a user action with Fleet Patching and Provisioning by running the following command on the Fleet Patching and Provisioning Server:<pre class="pre codeblock"><code>rhpctl useraction -useraction apachestart 
-actionscript /user1/useractions/apacheinstall.sh 
-post -optype ADD_WORKINGCOPY -onerror ABORT</code></pre><p>The preceding command adds the <code class="codeph">apachestart</code> user action for the action script stored in the specified directory. As per the specified properties, the user action runs after the <code class="codeph">ADD_WORKINGCOPY</code> operation and aborts if there is any error.
                              </p>
                           </li>
                           <li>Create an image type and associate the user action with the image type, as follows:<pre class="pre codeblock"><code>rhpctl add imagetype -imagetype apachetype -basetype SOFTWARE 
-useraction "apachestart"</code></pre><p>The preceding command creates a new image type called <code class="codeph">apachetype</code>, a derivative of the basic image type, <code class="codeph">SOFTWARE</code>, with an associated user action <code class="codeph">apachestart</code>.
                              </p>
                           </li>
                           <li>Create a gold image of the image type, as follows:<pre class="pre codeblock"><code>rhpctl import image -image apacheinstall -path /user1/apache2219_kit/ 
-imagetype apachetype</code></pre><p>The preceding command creates a gold image, <code class="codeph">apacheinstall</code>, with the script for Apache Web server installation, in the specified path, based on the <code class="codeph">imagetype</code> you created earlier.
                              </p>
                              <p>To view the properties of this image, run the <code class="codeph">rhpctl query image -image apacheinstall</code> command.
                              </p>
                           </li>
                           <li>Deploy a working copy of the gold image on the target, as follows:<pre class="pre codeblock"><code>rhpctl add workingcopy -workingcopy apachecopy -image apacheinstall 
-path /user1/apacheinstallloc -sudouser user1 
-sudopath /usr/local/bin/sudo -node node1 -user user1 
-useractiondata "/user1/apachehome:1080:2.2.19"</code></pre><p>Fleet Patching and Provisioning provisions the software to the target and runs the <code class="codeph">apachestart</code> script specified in the user action. You can provide the Apache Web server configuration details such as port number with the <code class="codeph">useractiondata</code> option. If the target is a Fleet Patching and Provisioning Client, then you need not specify <code class="codeph">sudo</code> credentials.
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-6F4210E7-F0E5-4A3E-A8B4-D4664286A0AA__GUID-CB8A6D06-8CB1-44DF-8F2B-ADDEA37DFB1D">Registering Multiple Scripts Using a Single User Action</p>
                        <p>Run multiple scripts as part of a user action plug-in by registering a wrapper script and bundled custom scripts. The wrapper script extracts the bundled scripts, which are copied under the directory of the wrapper script, and then runs those extracted scripts as necessary, similar to the following procedure:</p>
                        <ol id="GUID-6F4210E7-F0E5-4A3E-A8B4-D4664286A0AA__OL_P25_Q5Y_XFB">
                           <li>The following command creates a user action called <code class="codeph">ohadd_ua</code>, and associates a wrapper script, <code class="codeph">wc_add.sh</code>, with a zip file containing other scripts:<pre class="pre codeblock"><code>rhpctl add useraction -useraction ohadd_ua -actionscript
/scratch/crsusr/wc_add.sh -actionfile /scratch/crsusr/pack.zip -pre -runscope
ALLNODES -optype ADD_WORKINGCOPY</code></pre><p>The wrapper script, <code class="codeph">wc_add.sh</code>, extracts the <code class="codeph">pack.zip</code> file into the script path, a temporary path to which the user action scripts are copied. The wrapper script can invoke any scripts contained in the file.
                              </p>
                           </li>
                           <li>The following command creates an image type, <code class="codeph">sw_ua</code>, for the <code class="codeph">ohadd_ua</code> user action:<pre class="pre codeblock"><code>rhpctl add imagetype -imagetype sw_ua -useractions ohadd_ua -basetype SOFTWARE</code></pre></li>
                           <li>The following command creates an image called <code class="codeph">swimgua</code> from the software specified in the path:<pre class="pre codeblock"><code>rhpctl import image -image swimgua -path /tmp/custom_sw -imagetype sw_ua</code></pre></li>
                           <li>The following command adds a working copy called <code class="codeph">wcua</code> and runs the <code class="codeph">wc_add.sh</code> script:<pre class="pre codeblock"><code>rhpctl add workingcopy -workingcopy wcua -image swimgua -client targetcluster</code></pre></li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>