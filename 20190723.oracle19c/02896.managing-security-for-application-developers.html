<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="A security policy for application developers should encompass areas such as password management and securing external procedures and application privileges.">
      <meta name="description" content="A security policy for application developers should encompass areas such as password management and securing external procedures and application privileges.">
      <title>Managing Security for Application&nbsp;Developers</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Security Guide ">
      <meta property="og:description" content="A security policy for application developers should encompass areas such as password management and securing external procedures and application privileges.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Security Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="database-security-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-02-28T14:57:12-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96299-04">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="part_2.html" title="Previous" type="text/html">
      <link rel="next" href="part_3.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Security Guide">
    <meta name="dcterms.isVersionOf" content="DBSEG">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="part_2.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="part_3.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Security Guide </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="part_2.html" property="item" typeof="WebPage"><span property="name">Application Development Security</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem"> Managing Security for Application&nbsp;Developers</li>
            </ol>
            <a id="GUID-245AF418-2349-4657-9010-8C8D7849FD05" name="GUID-245AF418-2349-4657-9010-8C8D7849FD05"></a><a id="DBSEG005"></a>
            
            <h2 id="DBSEG-GUID-245AF418-2349-4657-9010-8C8D7849FD05" class="sect2"><span class="enumeration_chapter">10 </span> Managing Security for Application&nbsp;Developers
            </h2>
         </header>
         <div class="ind"><script type="text/javascript">window.name='managing-security-for-application-developers'</script><script type="text/javascript">
    function footdisplay(footnum,footnote) {
    var msg = window.open('about:blank', 'NewWindow' + footnum,
        'directories=no,height=100,location=no,menubar=no,resizable=yes,' +
        'scrollbars=yes,status=no,toolbar=no,width=598');
    msg.document.open('text/html');
    msg.document.write('<!DOCTYPE html ');
    msg.document.write('PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" ');
    msg.document.write('"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">'); 
    msg.document.write('<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" dir="ltr"><head><title>');
   
    msg.document.write('Footnote&nbsp; ' + footnum);
    msg.document.write('<\/title><meta http-equiv="Content-Type" ');
    msg.document.write('content="text/html; charset=utf-8" />');
    msg.document.write('<meta http-equiv="Content-Script-Type" ');
    msg.document.write('content="text/javascript" />');
    msg.document.write('<style type="text/css"> <![CDATA[ ');
    msg.document.write('h1 {text-align: center; font-size: 14pt;}');
    msg.document.write('fieldset {border: none;}');
    msg.document.write('form {text-align: center;}');
    msg.document.write(' ]]\u003e <\/style>');
    msg.document.write('<\/head><body><div id="footnote"><h1>Footnote&nbsp; ' + footnum + '<\/h1><p>');
    msg.document.write(footnote);
    msg.document.write('<\/p><form action="" method="post"><fieldset>');
    msg.document.write('<input type="button" value="OK" ');
    msg.document.write('onclick="window.close();" />');
    msg.document.write('<\/fieldset><\/form><\/div><\/body><\/html>');
    msg.document.close();
    setTimeout(function() {
        var height = msg.document.getElementById('footnote').offsetHeight;
        msg.resizeTo(598, height + 100);
    }
    , 100);
    msg.focus();
}
            </script><noscript>
               <p>The script content on this page is for navigation purposes only and does not alter the content in any way.</p>
            </noscript>
            <div>
               <p>A security policy for application developers should encompass areas such as password management and securing external procedures and application privileges. </p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-1072A829-D2B4-4DFF-A69C-181ADDA7CA3A">About Application Security Policies</a><br>An application security policy is a list of application security requirements and rules that regulate user access to database objects.
                  </li>
                  <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-7C44B47F-DEA1-4529-A5C3-E992D2EDE5CF">Considerations for Using Application-Based Security</a><br>An application security implementation should consider both application and database users and whether to enforce security in the application or in the database.
                  </li>
                  <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-DE90CA6F-F37B-4337-B331-4FA0F7C7599A">Securing Passwords in Application Design</a><br>Oracle provides strategies for securely invoking password services, such as from scripts, and for applying these strategies to other sensitive data.
                  </li>
                  <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-EE267659-48F3-4AFA-BB06-D8C620F80696">Securing External Procedures</a><br>An external procedure is stored in a <code class="codeph">.dll</code> or an <code class="codeph">.so</code> file, separately from the database, and can be through a credential authentication. 
                  </li>
                  <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-8F585EBE-611D-4717-AD9F-CAC10A19B7E1">Securing LOBs with LOB Locator Signatures</a><br>You can secure large objects (LOB) by regenerating their LOB locator                 signatures.
                  </li>
                  <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-4C03768A-FA3D-4D41-84CF-FEA40D0D9AA9">Managing Application Privileges</a><br>Most database applications involve different privileges on different schema objects. 
                  </li>
                  <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-2D2FD12B-5953-4056-8488-2C70832559D9">Advantages of Using Roles to Manage Application Privileges</a><br>Grouping application privileges in a role aids privilege management.
                  </li>
                  <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-AF4D0F7A-D74E-444E-8D00-66B9FEFE8CD2">Creating Secure Application Roles to Control Access to Applications</a><br>A secure application role is only enabled through its associated PL/SQL package or procedure. 
                  </li>
                  <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-1FE77DE6-8950-493C-B10F-13E1A1A33155">Association of Privileges with User Database Roles</a><br>Ensure that users have only the privileges associated with the current database role.
                  </li>
                  <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-7B5B46D4-7547-421C-930E-A0C375B60F6D">Protecting Database Objects by Using Schemas</a><br>A schema is a security domain that can contain database objects. Privileges granted to users and roles control access to these database objects. 
                  </li>
                  <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-B6289F9C-B043-410B-A586-50A996F055B4">Object Privileges in an Application</a><br>When you design an application, consider the types of users and the level access they need.
                  </li>
                  <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-98EEE057-D2F9-4D97-A5B9-0295F5423E03">Parameters for Enhanced Security of Database Communication</a><br>Parameters can be used to manage security, such as handling bad packets from protocol errors or configuring the maximum number of authentication errors.
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>Parent topic:</strong> <a href="part_2.html" title="Part II describes how to manage application development security.">Application Development Security</a></p>
                  </div>
               </div>
            </div>
            <a id="DBSEG131"></a><div class="props_rev_3"><a id="GUID-1072A829-D2B4-4DFF-A69C-181ADDA7CA3A" name="GUID-1072A829-D2B4-4DFF-A69C-181ADDA7CA3A"></a><h3 id="DBSEG-GUID-1072A829-D2B4-4DFF-A69C-181ADDA7CA3A" class="sect3">About Application Security Policies</h3>
               <div>
                  <p>An application security policy is a list of application security requirements and rules that regulate user access to database objects.</p>
                  <p>Creating an application security policy is the first step to create a secure database application. You should draft security policies for each database application. For example, each database application should have one or more database roles that provide different levels of security when executing the application. You then can grant the database roles to other roles or directly to specific users.</p>
                  <p>Applications that can potentially allow unrestricted SQL statement processing (through tools such as SQL*Plus or SQL Developer) also need security policies that prevent malicious access to confidential or important schema objects. In particular, you must ensure that your applications handle passwords in a secure manner. </p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-245AF418-2349-4657-9010-8C8D7849FD05" title="A security policy for application developers should encompass areas such as password management and securing external procedures and application privileges.">Managing Security for Application&nbsp;Developers</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="DBSEG132"></a><div class="props_rev_3"><a id="GUID-7C44B47F-DEA1-4529-A5C3-E992D2EDE5CF" name="GUID-7C44B47F-DEA1-4529-A5C3-E992D2EDE5CF"></a><h3 id="DBSEG-GUID-7C44B47F-DEA1-4529-A5C3-E992D2EDE5CF" class="sect3">Considerations for Using Application-Based Security</h3>
               <div>
                  <p>An application security implementation should consider both application and database users and whether to enforce security in the application or in the database.</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-C68AFEFC-3BD2-4792-B189-878B02BC8DA4">Are Application Users Also Database Users?</a><br>Where possible, build applications in which application users are database users, so that you can use the intrinsic security mechanisms of the database. 
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-DDCEDE77-4E89-4059-A3BA-6F0E309B1910">Is Security Better Enforced in the Application or in the Database?</a><br>Oracle recommends that applications use the security enforcement mechanisms of the database as much as possible. 
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-245AF418-2349-4657-9010-8C8D7849FD05" title="A security policy for application developers should encompass areas such as password management and securing external procedures and application privileges.">Managing Security for Application&nbsp;Developers</a></p>
                     </div>
                  </div>
               </div>
               <a id="DBSEG134"></a><a id="DBSEG133"></a><div class="props_rev_3"><a id="GUID-C68AFEFC-3BD2-4792-B189-878B02BC8DA4" name="GUID-C68AFEFC-3BD2-4792-B189-878B02BC8DA4"></a><h4 id="DBSEG-GUID-C68AFEFC-3BD2-4792-B189-878B02BC8DA4" class="sect4">Are Application Users Also Database Users?</h4>
                  <div>
                     <p>Where possible, build applications in which application users are database users, so that you can use the intrinsic security mechanisms of the database. </p>
                     <p>For many commercial packaged applications, application users are not database users. For these applications, multiple users authenticate themselves to the application, and the application then connects to the database as a single, highly-privileged user. This is called the <span class="italic">One Big Application User</span> model.
                     </p>
                     <p>Applications built in this way generally cannot use many of the intrinsic security features of the database, because the identity of the user is not known to the database. However, you can use client identifiers to perform some types of tracking. For example, the <code class="codeph">OCI_ATTR_CLIENT_IDENTIFIER</code> attribute of the Oracle Call Interface method <code class="codeph">OCIAttrSet</code> can be used to enable auditing and monitoring of client connections. Client identifiers can be used to gather audit trail data on individual Web users, apply rules that restrict data access by Web users, and monitor and trace applications that each Web user users. 
                     </p>
                     <p><a href="managing-security-for-application-developers.html#GUID-C68AFEFC-3BD2-4792-B189-878B02BC8DA4__CJADGHFB" title="Features Limited by Using "One Big Application User"">Table 10-1</a> describes how the One Big Application User model affects various Oracle Database security features:
                     </p>
                     <div class="tblformal" id="GUID-C68AFEFC-3BD2-4792-B189-878B02BC8DA4__CJADGHFB">
                        <p class="titleintable">Table 10-1 Features Affected by the One Big Application User Model</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="Features Affected by the One Big Application User Model" summary="Features Limited by Using "One Big Application User"" width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="37%" id="d78229e643">Oracle Database Feature</th>
                                 <th align="left" valign="bottom" width="63%" id="d78229e646">Limitations of One Big Application User Model</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="37%" id="d78229e651" headers="d78229e643 ">
                                    <p>Auditing</p>
                                 </td>
                                 <td align="left" valign="top" width="63%" headers="d78229e651 d78229e646 ">
                                    <p>A basic principle of security is accountability through auditing. If One Big Application User performs all actions in the database, then database auditing cannot hold individual users accountable for their actions. The application must implement its own auditing mechanisms to capture individual user actions. </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="37%" id="d78229e658" headers="d78229e643 ">
                                    <p>Oracle strong authentication</p>
                                 </td>
                                 <td align="left" valign="top" width="63%" headers="d78229e658 d78229e646 ">
                                    <p>Strong forms of authentication (such as client authentication over SSL, tokens, and so on) cannot be used if the client authenticating to the database is the application, rather than an individual user. </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="37%" id="d78229e665" headers="d78229e643 ">
                                    <p>Roles</p>
                                 </td>
                                 <td align="left" valign="top" width="63%" headers="d78229e665 d78229e646 ">
                                    <p>Roles are assigned to database users. Enterprise roles are assigned to enterprise users who, though not created in the database, are known to the database. If application users are not database users, then the usefulness of roles is diminished. Applications must then craft their own mechanisms to distinguish between the privileges which various application users need to access data within the application. </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="37%" id="d78229e672" headers="d78229e643 ">
                                    <p>Enterprise user management </p>
                                 </td>
                                 <td align="left" valign="top" width="63%" headers="d78229e672 d78229e646 ">
                                    <p>The Enterprise user management feature enables an Oracle database to use the Oracle Identity Management Infrastructure by securely storing and managing user information and authorizations in an LDAP-based directory such as Oracle Internet Directory. While enterprise users do not need to be created in the database, they do need to be known to the database. The One Big Application User model cannot take advantage of Oracle Identity Management.</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-7C44B47F-DEA1-4529-A5C3-E992D2EDE5CF" title="An application security implementation should consider both application and database users and whether to enforce security in the application or in the database.">Considerations for Using Application-Based Security</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG135"></a><div class="props_rev_3"><a id="GUID-DDCEDE77-4E89-4059-A3BA-6F0E309B1910" name="GUID-DDCEDE77-4E89-4059-A3BA-6F0E309B1910"></a><h4 id="DBSEG-GUID-DDCEDE77-4E89-4059-A3BA-6F0E309B1910" class="sect4">Is Security Better Enforced in the Application or in the Database?</h4>
                  <div>
                     <p>Oracle recommends that applications use the security enforcement mechanisms of the database as much as possible. </p>
                     <p>Applications, whose users are also database users, can either build security into the application, or rely on intrinsic database security mechanisms such as granular privileges, virtual private databases (fine-grained access control with application context), roles, stored procedures, and auditing (including fine-grained auditing).</p>
                     <p>When security is enforced in the database itself, rather than in the application, it cannot be bypassed. The main shortcoming of application-based security is that security is bypassed if the user bypasses the application to access data. For example, a user who has SQL*Plus access to the database can execute queries without going through the Human Resources application. The user, therefore, bypasses all of the security measures in the application. </p>
                     <p>Applications that use the One Big Application User model must build security enforcement into the application rather than use database security mechanisms. Because it is the application, and not the database, that recognizes users; the application itself must enforce security measures for each user.</p>
                     <p>This approach means that each application that accesses data must re-implement security. Security becomes expensive, because organizations must implement the same security policies in multiple applications, and each new application requires an expensive reimplementation. </p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="configuring-privilege-and-role-authorization.html#GUID-71168BFD-3E87-4F68-AA51-13ED3A292688" title="Ad hoc tools can pose problems if malicious users have access to such tools.">Potential Security Problems of Using Ad Hoc Tools</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-7C44B47F-DEA1-4529-A5C3-E992D2EDE5CF" title="An application security implementation should consider both application and database users and whether to enforce security in the application or in the database.">Considerations for Using Application-Based Security</a></p>
                        </div>
                     </div>
                  </div>
               </div>
            </div><a id="DBSEG50053"></a><div class="props_rev_3"><a id="GUID-DE90CA6F-F37B-4337-B331-4FA0F7C7599A" name="GUID-DE90CA6F-F37B-4337-B331-4FA0F7C7599A"></a><h3 id="DBSEG-GUID-DE90CA6F-F37B-4337-B331-4FA0F7C7599A" class="sect3">Securing Passwords in Application Design</h3>
               <div>
                  <p>Oracle provides strategies for securely invoking password services, such as from scripts, and for applying these strategies to other sensitive data.</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-CB9B67C2-C70E-4B51-9456-20E17CD337F7">General Guidelines for Securing Passwords in Applications</a><br>Guidelines for securing passwords in applications cover areas such as platform-specific security threats. 
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-CF37E37E-111A-43DE-84F8-C4A35B1F1C24">Use of an External Password Store to Secure Passwords</a><br>You can store password credentials for connecting to a database by using a client-side Oracle wallet. 
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-15F1BBB1-F807-41D4-AA23-7F05AE3CDE4E">Securing Passwords Using the ORAPWD Utility</a><br><code class="codeph">SYSDBA</code> or <code class="codeph">SYSOPER</code> users can use password files to connect to an application over a network. 
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-5B905E9F-AE4E-49A2-BF57-549EA6BB324C">Example: Java Code for Reading Passwords</a><br>You can create Java packages that can be used to read passwords. 
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-245AF418-2349-4657-9010-8C8D7849FD05" title="A security policy for application developers should encompass areas such as password management and securing external procedures and application privileges.">Managing Security for Application&nbsp;Developers</a></p>
                     </div>
                  </div>
               </div>
               <a id="DBSEG136"></a><div class="props_rev_3"><a id="GUID-CB9B67C2-C70E-4B51-9456-20E17CD337F7" name="GUID-CB9B67C2-C70E-4B51-9456-20E17CD337F7"></a><h4 id="DBSEG-GUID-CB9B67C2-C70E-4B51-9456-20E17CD337F7" class="sect4">General Guidelines for Securing Passwords in Applications</h4>
                  <div>
                     <p>Guidelines for securing passwords in applications cover areas such as platform-specific security threats. </p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-D6594978-F380-45D2-831E-365ECAE817F3">Platform-Specific Security Threats</a><br>You should be aware of potential security threats, which may not be obvious. 
                        </li>
                        <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-648FC0DB-CA41-46C2-ACA6-207ADDA38D72">Guidelines for Designing Applications to Handle Password Input</a><br>Oracle provides guidelines for designing applications to handle password input.
                        </li>
                        <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-E5A783A1-20A0-4359-B5BB-E262D96CAC37">Guidelines for Configuring Password Formats and Behavior</a><br>Oracle Database provides guidelines for configuring password formats and behavior.
                        </li>
                        <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-D74E4185-1F3F-41B7-8590-0C44507ACEF3">Guidelines for Handling Passwords in SQL Scripts</a><br>Oracle provides guidelines for handling passwords in SQL scripts.
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-DE90CA6F-F37B-4337-B331-4FA0F7C7599A" title="Oracle provides strategies for securely invoking password services, such as from scripts, and for applying these strategies to other sensitive data.">Securing Passwords in Application Design</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="DBSEG137"></a><div class="props_rev_3"><a id="GUID-D6594978-F380-45D2-831E-365ECAE817F3" name="GUID-D6594978-F380-45D2-831E-365ECAE817F3"></a><h5 id="DBSEG-GUID-D6594978-F380-45D2-831E-365ECAE817F3" class="sect5">Platform-Specific Security Threats</h5>
                     <div>
                        <p>You should be aware of potential security threats, which may not be obvious. </p>
                        <p>These security threats are as follows:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="bold">On UNIX and Linux platforms, command parameters are available for viewing by all operating system users on the same host computer.</span> As a result, passwords entered on the command line could be exposed to other users. However, do not assume that non-UNIX and Linux platforms are safe from this threat.
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">On some UNIX platforms, such as HP Tru64 and IBM AIX, environment variables for all processes are available for viewing by all operating system users.</span> However, do not assume that non-UNIX and Linux platforms are safe from this threat.
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">On Microsoft Windows, the command recall feature (the Up arrow) remembers user input across command invocations.</span> For example, if you use the <code class="codeph">CONNECT SYSTEM/</code><span class="italic"><code class="codeph">password</code></span> notation in SQL*Plus, exit, and then press the Up arrow to repeat the <code class="codeph">CONNECT</code> command, the command recall feature reveals the connect string and displays the password. In addition, do not assume that non-Microsoft Windows platforms are safe from this threat. 
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-CB9B67C2-C70E-4B51-9456-20E17CD337F7" title="Guidelines for securing passwords in applications cover areas such as platform-specific security threats.">General Guidelines for Securing Passwords in Applications</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG138"></a><div class="props_rev_3"><a id="GUID-648FC0DB-CA41-46C2-ACA6-207ADDA38D72" name="GUID-648FC0DB-CA41-46C2-ACA6-207ADDA38D72"></a><h5 id="DBSEG-GUID-648FC0DB-CA41-46C2-ACA6-207ADDA38D72" class="sect5">Guidelines for Designing Applications to Handle Password Input</h5>
                     <div>
                        <p>Oracle provides guidelines for designing applications to handle password input.</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="bold">Design applications to interactively prompt for passwords.</span> For command-line utilities, do not force users to expose passwords at a command prompt.
                              </p>
                              <p>Check the APIs for the programming language you use to design applications for the best way to handle passwords from users. For an example of Java code that handles this functionality, see <a href="managing-security-for-application-developers.html#GUID-5B905E9F-AE4E-49A2-BF57-549EA6BB324C" title="You can create Java packages that can be used to read passwords.">Example: Java Code for Reading Passwords</a>. 
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">Protect your database against code injection attacks.</span> Code injection attacks most commonly occur in the client application tool that sends SQL to the database (for example, SQL*Plus, or any Oracle Call Interface (OCI) or JDBC application. This includes database drivers that are built using these tools. A SQL injection attack causes SQL statements to behave in a manner that is not intended by the PL/SQL application. The injection attack takes place before the statement is sent to the database. For example, an intruder can bypass password authentication by setting a <code class="codeph">WHERE</code> clause to <code class="codeph">TRUE</code>. 
                              </p>
                              <p>To address the problem of SQL injection attacks, use bind variable arguments or create validation checks. If you cannot use bind variables, then consider using the <code class="codeph">DBMS_ASSERT</code> PL/SQL package to validate the properties of input values. <a href="../arpls/DBMS_ASSERT.html#ARPLS231" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> describes the <code class="codeph">DBMS_ASSERT</code> package in detail. You also should review any grants to roles such as <code class="codeph">PUBLIC</code>. 
                              </p>
                              <p>Note that client applications users may not always associate SQL injection with PL/SQL, because the injection could occur before the statement is sent to the database.</p>
                              <p>See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/dbseg&amp;id=LNPLS01109" target="_blank"><span><cite>Oracle Database PL/SQL Language Reference</cite></span></a> for more information about preventing SQL injection. 
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">If possible, design your applications to defer authentication.</span> For example: 
                              </p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>Use certificates for logins. </p>
                                 </li>
                                 <li>
                                    <p>Authenticate users by using facilities provided by the operating system. For example, applications on Microsoft Windows can use domain authentication.</p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p><span class="bold">Mask or encrypt passwords.</span> If you must store passwords, then mask or encrypt them. For example, you can mask passwords in log files and encrypt passwords in recovery files. 
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">Authenticate each connection.</span> For example, if schema A exists in database 1, then do not assume that schema A in database 2 is the same user. Similarly, the local operating system user <code class="codeph">psmith</code> is not necessarily the same person as remote user <code class="codeph">psmith</code>. 
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">Do not store clear text passwords in files or repositories.</span> Storing passwords in files increases the risk of an intruder accessing them. 
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">Use a single master password.</span> For example:
                              </p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>You can grant a single database user proxy authentication to act as other database users. In this case, only a single database password is needed. See <a href="configuring-authentication.html#GUID-06D3D47D-C491-483B-9372-1F17D7A4FF0A" title="The CREATE USER statement enables you to create the several types of user accounts, all of which can be used as proxy accounts.">Proxy User Accounts and the Authorization of Users to Connect Through Them</a> for more information.
                                    </p>
                                 </li>
                                 <li>
                                    <p>You can create a password wallet, which can be opened by the master password. The wallet then contains the other passwords. See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/dbseg&amp;id=DBIMI160" target="_blank"><span><cite>Oracle Database Enterprise User Security Administrator's Guide</cite></span></a> for more information about Wallet Manager. 
                                    </p>
                                 </li>
                              </ul>
                           </li>
                        </ul>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-CB9B67C2-C70E-4B51-9456-20E17CD337F7" title="Guidelines for securing passwords in applications cover areas such as platform-specific security threats.">General Guidelines for Securing Passwords in Applications</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG139"></a><div class="props_rev_3"><a id="GUID-E5A783A1-20A0-4359-B5BB-E262D96CAC37" name="GUID-E5A783A1-20A0-4359-B5BB-E262D96CAC37"></a><h5 id="DBSEG-GUID-E5A783A1-20A0-4359-B5BB-E262D96CAC37" class="sect5">Guidelines for Configuring Password Formats and Behavior</h5>
                     <div>
                        <p>Oracle Database provides guidelines for configuring password formats and behavior.</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="bold">Limit the lifetime for passwords.</span> You can set a password lifetime, after which the password expires and must be changed before the user can log in to the account. See <a href="configuring-authentication.html#GUID-B0D624CE-F316-46F9-892F-141DFBB8E08E" title="You can specify a password lifetime, after which the password expires.">About Controlling Password Aging and Expiration</a> for parameters you can use to control the lifetime of a password.
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">Limit the ability of users to reuse old passwords.</span> See <a href="configuring-authentication.html#GUID-F311F283-B00B-4FA1-B1DE-402A4A1B6D85" title="You can ensure that users do not reuse previous passwords for an amount of time or for a number of password changes.">Controlling the User Ability to Reuse Previous Passwords</a> for more information.
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">Force users to create strong, secure passwords.</span> See <a href="keeping-your-oracle-database-secure.html#GUID-451679EB-8676-47E6-82A6-DF025FD65156" title="Oracle provides guidelines for securing passwords.">Guidelines for Securing Passwords</a> for advice on creating strong passwords. <a href="configuring-authentication.html#GUID-A39E191B-4A06-442D-94C7-5882B73DDCFA" title="Complexity verification checks that each password is complex enough to protect against intruders who try to guess user passwords.">About Password Complexity Verification</a> explains how you can customize password requirements. 
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">Enable case sensitivity in passwords.</span> See <a href="configuring-authentication.html#GUID-36BC62D5-277A-4B38-AB6C-2F20A843651F" title="You can manage the password case sensitivity for passwords from user accounts from previous releases.">Managing Password Case Sensitivity</a> for more information. 
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>Related Topics</strong></p>
                           <ul>
                              <li><a href="configuring-authentication.html#GUID-AA1AA635-1CD5-422E-B8CA-681ED7C253CA" title="Oracle provides a set of minimum requirements for passwords.">Minimum Requirements for Passwords</a></li>
                              <li><a href="configuring-authentication.html#GUID-A39E191B-4A06-442D-94C7-5882B73DDCFA" title="Complexity verification checks that each password is complex enough to protect against intruders who try to guess user passwords.">About Password Complexity Verification</a></li>
                           </ul>
                        </div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-CB9B67C2-C70E-4B51-9456-20E17CD337F7" title="Guidelines for securing passwords in applications cover areas such as platform-specific security threats.">General Guidelines for Securing Passwords in Applications</a></p>
                           </div>
                        </div>
                     </div>
                  </div><a id="DBSEG140"></a><div class="props_rev_3"><a id="GUID-D74E4185-1F3F-41B7-8590-0C44507ACEF3" name="GUID-D74E4185-1F3F-41B7-8590-0C44507ACEF3"></a><h5 id="DBSEG-GUID-D74E4185-1F3F-41B7-8590-0C44507ACEF3" class="sect5">Guidelines for Handling Passwords in SQL Scripts</h5>
                     <div>
                        <p>Oracle provides guidelines for handling passwords in SQL scripts.</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="bold">Do not invoke SQL*Plus with a password on the command line, either in programs or scripts.</span> If a password is required but omitted, SQL*Plus prompts the user for it and then automatically disables the echo feature so that the password is not displayed. 
                              </p>
                              <p>The following examples are secure because passwords are not exposed on the command line. Oracle Database also automatically encrypts these passwords over the network. </p><pre class="oac_no_warn" dir="ltr">$ sqlplus system
Enter password: <span class="italic">password</span>

SQL&gt; CONNECT SYSTEM
Enter password: <span class="italic">password</span>
</pre><p>The following example exposes the password to other operating system users:</p><pre class="oac_no_warn" dir="ltr">sqlplus system/<span class="italic">password</span>
</pre><p>The next example poses two security risks. First, it exposes the password to other users who may be watching over your shoulder. Second, on some platforms, such as Microsoft Windows, it makes the password vulnerable to a command line recall attack.</p><pre class="oac_no_warn" dir="ltr">$ sqlplus /nolog
SQL&gt; CONNECT SYSTEM/<span class="italic">password</span>
</pre></li>
                           <li>
                              <p><span class="bold">For SQL scripts that require passwords or secret keys, for example, to create an account or to log in as an account, do not use positional parameters, such as substitution variables &amp;1, &amp;2, and so on.</span> Instead, design the script to prompt the user for the value. You should also disable the echo feature, which displays output from a script or if you are using spool mode. To disable the echo feature, use the following setting:
                              </p><pre class="oac_no_warn" dir="ltr">SET ECHO OFF
</pre><p>A good practice is to ensure that the script makes the purpose of the value clear. For example, it should be clear whether or not the value will establish a new value, such as an account or a certificate, or if the value will authenticate, such as logging in to an existing account.</p>
                              <p>The following example is secure because it prevents users from invoking the script in a manner that poses security risks: It does not echo the password; it does not record the password in a spool file. </p><pre class="oac_no_warn" dir="ltr">SET VERIFY OFF
 ACCEPT user CHAR PROMPT ‘Enter user to connect to: ‘ 
 ACCEPT password CHAR PROMPT ‘Enter the password for that user: ' HIDE 
 CONNECT &amp;user/&amp;password </pre><p>In this example:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><code class="codeph">SET VERIFY OFF</code> prevents the password from being displayed. (<code class="codeph">SET VERIFY</code> lists each line of the script before and after substitution.) Combining the <code class="codeph">SET VERIFY OFF</code> command with the <code class="codeph">HIDE</code> command is a useful technique for hiding passwords and other sensitive input data. 
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">ACCEPT password CHAR PROMPT</code> includes the <code class="codeph">HIDE</code> option for the <code class="codeph">ACCEPT password</code> prompt, which prevents the input password from being echoed.
                                    </p>
                                 </li>
                              </ul>
                              <p>The next example, which uses positional parameters, poses security risks because a user may invoke the script by passing the password on the command line. If the user does not enter a password and instead is prompted, the danger lies in that whatever the user types is echoed to the screen and to a spool file if spooling is enabled. </p><pre class="oac_no_warn" dir="ltr">CONNECT &amp;1/&amp;2
</pre></li>
                           <li>
                              <p><span class="bold">Control the log in times for batch scripts.</span> For batch scripts that require passwords, configure the account so that the script can only log in during the time in which it is supposed to run. For example, suppose you have a batch script that runs for an hour each evening starting at 8 p.m. Set the account so that the script can only log in during this time. If an intruder manages to gain access, then he or she has less of a chance of exploiting any compromised accounts.
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">Be careful when using DML or DDL SQL statements that prompt for passwords.</span> In this case, sensitive information is passed in clear text over the network. You can remedy this problem by using Oracle strong authentication. 
                              </p>
                              <p>The following example of altering a password is secure because the password is not exposed: </p><pre class="oac_no_warn" dir="ltr">password psmith
Changing password for psmith
New password: <span class="italic">password</span>
Retype new password: <span class="italic">password</span>
</pre><p>This example poses a security risk because the password is exposed both at the command line and on the network: </p><pre class="oac_no_warn" dir="ltr">ALTER USER psmith IDENTIFIED BY <span class="italic">password</span> </pre></li>
                        </ul>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-CB9B67C2-C70E-4B51-9456-20E17CD337F7" title="Guidelines for securing passwords in applications cover areas such as platform-specific security threats.">General Guidelines for Securing Passwords in Applications</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div><a id="DBSEG141"></a><div class="props_rev_3"><a id="GUID-CF37E37E-111A-43DE-84F8-C4A35B1F1C24" name="GUID-CF37E37E-111A-43DE-84F8-C4A35B1F1C24"></a><h4 id="DBSEG-GUID-CF37E37E-111A-43DE-84F8-C4A35B1F1C24" class="sect4">Use of an External Password Store to Secure Passwords</h4>
                  <div>
                     <p>You can store password credentials for connecting to a database by using a client-side Oracle wallet. </p>
                     <p>An Oracle wallet is a secure software container that stores the authentication and signing credentials needed for a user to log in. </p>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-CF37E37E-111A-43DE-84F8-C4A35B1F1C24__GUID-BDE1A9B5-7774-4EAF-8DFF-7834BCDB4903">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="configuring-authentication.html#GUID-803496D2-19C7-4F02-94EC-C13EDD8FB17B" title="The secure external password store is a client-side wallet that is used to store password credentials.">Managing the Secure External Password Store for Password Credentials</a> for more information about the secure external password store
                              </p>
                           </li>
                           <li>
                              <p><a href="../dbimi/introducing-enterprise-user-security.html#DBIMI152" target="_blank"><span class="italic">Oracle Database Enterprise User Security Administrator's Guide</span></a> for information about using Oracle Wallet Manager to configure Oracle wallets
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-DE90CA6F-F37B-4337-B331-4FA0F7C7599A" title="Oracle provides strategies for securely invoking password services, such as from scripts, and for applying these strategies to other sensitive data.">Securing Passwords in Application Design</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG142"></a><div class="props_rev_3"><a id="GUID-15F1BBB1-F807-41D4-AA23-7F05AE3CDE4E" name="GUID-15F1BBB1-F807-41D4-AA23-7F05AE3CDE4E"></a><h4 id="DBSEG-GUID-15F1BBB1-F807-41D4-AA23-7F05AE3CDE4E" class="sect4">Securing Passwords Using the ORAPWD Utility</h4>
                  <div>
                     <p><code class="codeph">SYSDBA</code> or <code class="codeph">SYSOPER</code> users can use password files to connect to an application over a network. 
                     </p>
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>To create the password file, use the <code class="codeph">ORAPWD</code> utility.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-15F1BBB1-F807-41D4-AA23-7F05AE3CDE4E__GUID-806D7E72-DF05-4A4A-9A07-1E0E012ABF11">
                        <p class="notep1">See Also:</p>
                        <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/dbseg&amp;id=ADMIN10241" target="_blank"><span><cite>Oracle Database Administrator’s Guide</cite></span></a> for more information about creating and maintaining a password file
                        </p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-DE90CA6F-F37B-4337-B331-4FA0F7C7599A" title="Oracle provides strategies for securely invoking password services, such as from scripts, and for applying these strategies to other sensitive data.">Securing Passwords in Application Design</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG144"></a><a id="DBSEG143"></a><div class="props_rev_3"><a id="GUID-5B905E9F-AE4E-49A2-BF57-549EA6BB324C" name="GUID-5B905E9F-AE4E-49A2-BF57-549EA6BB324C"></a><h4 id="DBSEG-GUID-5B905E9F-AE4E-49A2-BF57-549EA6BB324C" class="sect4">Example: Java Code for Reading Passwords</h4>
                  <div>
                     <p>You can create Java packages that can be used to read passwords. </p>
                     <p><a href="managing-security-for-application-developers.html#GUID-5B905E9F-AE4E-49A2-BF57-549EA6BB324C__CJAGIFIG">Example 10-1</a> demonstrates how to create a Java package that can be used to read passwords.
                     </p>
                     <div class="example" id="GUID-5B905E9F-AE4E-49A2-BF57-549EA6BB324C__CJAGIFIG">
                        <p class="titleinexample">Example 10-1 Java Code for Reading Passwords</p><pre class="oac_no_warn" dir="ltr">// Change the following line to a name for your version of this package
package passwords.sysman.emSDK.util.signing;

import java.io.IOException;
import java.io.PrintStream;
import java.io.PushbackInputStream;
import java.util.Arrays;
 
/**
 * The static readPassword method in this class issues a password prompt
 * on the console output and returns the char array password
 * entered by the user on the console input.
 */
public final class ReadPassword {
  //----------------------------------
  /**
   * Test driver for readPassword method.
   * @param args the command line args
   */
  public static void main(String[] args) {
    char[] pass = ReadPassword.readPassword("Enter password: ");
    System.out.println("The password just entered is \""
      + new String(pass) + "\"");
    System.out.println("The password length is " + pass.length);
  }
   * Issues a password prompt on the console output and returns
   * the char array password entered by the user on the console input.
   * The password is not displayed on the console (chars are not echoed).
   * As soon as the returned char array is not needed,
   * it should be erased for security reasons (Arrays.fill(charArr, ' '));
   * A password should never be stored as a java String.
   *
   * Note that Java 6 has a Console class with a readPassword method,
   * but there is no equivalent in Java 5 or Java 1.4.
   * The readPassword method here is based on Sun's suggestions at
   * http://java.sun.com/developer/technicalArticles/Security/pwordmask.
   *
   * @param prompt the password prompt to issue
   * @return new char array containing the password
   * @throws RuntimeException if some error occurs
   */
  public static final char[] readPassword(String prompt)
  throws RuntimeException {
    try {
      StreamMasker masker = new StreamMasker(System.out, prompt);
      Thread threadMasking = new Thread(masker);
      int firstByte = -1;
      PushbackInputStream inStream = null;
      try {
        threadMasking.start();
        inStream = new PushbackInputStream(System.in);
        firstByte = inStream.read();
      } finally {
        masker.stopMasking();
      }
      try {
        threadMasking.join();
      } catch (InterruptedException e) {
        throw new RuntimeException("Interrupt occurred when reading password");
      }
      if (firstByte == -1) {
        throw new RuntimeException("Console input ended unexpectedly");
      }
      if (System.out.checkError()) {
        throw new RuntimeException("Console password prompt output error");
      }
      inStream.unread(firstByte);
      return readLineSecure(inStream);
    }
    catch (IOException e) {
      throw new RuntimeException("I/O error occurred when reading password");
    }
  }
  //----------------------------------
  /**
   * Reads one line from an input stream into a char array in a secure way
   * suitable for reading a password.
   * The char array will never contain a '\n' or '\r'.
   *
   * @param inStream the pushback input stream
   * @return line as a char array, not including end-of-line-chars;
   *  never null, but may be zero length array
   * @throws RuntimeException if some error occurs
   */
  private static final char[] readLineSecure(PushbackInputStream inStream)
  throws RuntimeException {
    if (inStream == null) {
      throw new RuntimeException("readLineSecure inStream is null");
    }
    try {
      char[] buffer = null;
      try {
        buffer = new char[128];
        int offset = 0;
        // EOL is '\n' (unix), '\r\n' (windows), '\r' (mac)
        loop:
        while (true) {
          int c = inStream.read();
          switch (c) {
          case -1:
          case '\n':
            break loop;
          case '\r':
            int c2 = inStream.read();
            if ((c2 != '\n') &amp;&amp; (c2 != -1))
              inStream.unread(c2);
            break loop;
          default:
            buffer = checkBuffer(buffer, offset);
            buffer[offset++] = (char) c;
            break;
          }
        }
        char[] result = new char[offset];
        System.arraycopy(buffer, 0, result, 0, offset);
        return result;
      }
      finally {
        if (buffer != null)
          Arrays.fill(buffer, ' ');
      }
    }
    catch (IOException e) {
      throw new RuntimeException("I/O error occurred when reading password");
    }
  }
  //----------------------------------
  /**
   * This is a helper method for readLineSecure.
   *
   * @param buffer the current char buffer
   * @param offset the current position in the buffer
   * @return the current buffer if it is not yet full;
   *  otherwise return a larger buffer initialized with a copy
   *  of the current buffer and then erase the current buffer
   * @throws RuntimeException if some error occurs
   */
  private static final char[] checkBuffer(char[] buffer, int offset)
  throws RuntimeException
  {
    if (buffer == null)
      throw new RuntimeException("checkBuffer buffer is null");
    if (offset &lt; 0)
      throw new RuntimeException("checkBuffer offset is negative");
    if (offset &lt; buffer.length)
      return buffer;
    else {
      try {
        char[] bufferNew = new char[offset + 128];
        System.arraycopy(buffer, 0, bufferNew, 0, buffer.length);
        return bufferNew;
      } finally {
        Arrays.fill(buffer, ' ');
      }
    }
  }
  //----------------------------------
  /**
   * This private class prints a one line prompt
   * and erases reply chars echoed to the console.
   */
  private static final class StreamMasker
  extends Thread {
    private static final String BLANKS = StreamMasker.repeatChars(' ', 10);
    private String m_promptOverwrite;
    private String m_setCursorToStart;
    private PrintStream m_out;
    private volatile boolean m_doMasking;
    //----------------------------------
    /**
     * Constructor.
     * @throws RuntimeException if some error occurs
     */
    public StreamMasker(PrintStream outPrint, String prompt)
    throws RuntimeException {
      if (outPrint == null)
        throw new RuntimeException("StreamMasker outPrint is null");
      if (prompt == null)
        throw new RuntimeException("StreamMasker prompt is null");
      if (prompt.indexOf('\r') != -1)
        throw new RuntimeException("StreamMasker prompt contains a CR");
      if (prompt.indexOf('\n') != -1)
        throw new RuntimeException("StreamMasker prompt contains a NL");
      m_out = outPrint;
      m_setCursorToStart = StreamMasker.repeatChars('\010',
        prompt.length() + BLANKS.length());
      m_promptOverwrite = m_setCursorToStart + prompt + BLANKS
        + m_setCursorToStart + prompt;
    }
    //----------------------------------
    /**
     * Begin masking until asked to stop.
     * @throws RuntimeException if some error occurs
     */
    public void run()
    throws RuntimeException {
      int priorityOriginal = Thread.currentThread().getPriority();
      Thread.currentThread().setPriority(Thread.MAX_PRIORITY);
      try {
        m_doMasking = true;
        while (m_doMasking) {
          m_out.print(m_promptOverwrite);
          if (m_out.checkError())
            throw new RuntimeException("Console output error writing prompt");
          try {
            Thread.currentThread().sleep(1);
          } catch (InterruptedException ie) {
            Thread.currentThread().interrupt();
            return;
          }
        }
        m_out.print(m_setCursorToStart);
      } finally {
        Thread.currentThread().setPriority(priorityOriginal);
      }
    }
    //----------------------------------
    /**
     * Instructs the thread to stop masking.
     */
    public void stopMasking() {
      m_doMasking = false;
    }
    //----------------------------------
    /**
     * Returns a repeated char string.
     *
     * @param c the char to repeat
     * @param length the number of times to repeat the char
     * @throws RuntimeException if some error occurs
     */
    private static String repeatChars(char c, int length)
    throws RuntimeException {
      if (length &lt; 0)
        throw new RuntimeException("repeatChars length is negative");
      StringBuffer sb = new StringBuffer(length);
      for (int i = 0; i &lt; length; i++)
        sb.append(c);
      return sb.toString();
    }
  }
}</pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-DE90CA6F-F37B-4337-B331-4FA0F7C7599A" title="Oracle provides strategies for securely invoking password services, such as from scripts, and for applying these strategies to other sensitive data.">Securing Passwords in Application Design</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="DBSEG656"></a><div class="props_rev_3"><a id="GUID-EE267659-48F3-4AFA-BB06-D8C620F80696" name="GUID-EE267659-48F3-4AFA-BB06-D8C620F80696"></a><h3 id="DBSEG-GUID-EE267659-48F3-4AFA-BB06-D8C620F80696" class="sect3">Securing External Procedures</h3>
               <div>
                  <p>An external procedure is stored in a <code class="codeph">.dll</code> or an <code class="codeph">.so</code> file, separately from the database, and can be through a credential authentication. 
                  </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-21BD6FC0-1D78-4986-9E2D-5B01F1A3B749">About Securing External Procedures</a><br>For safety reasons, Oracle external procedures run in a process that is physically separate from the database. 
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-652EA198-77D4-4071-84AD-E73FBF3CB4D9">General Process for Configuring extproc for a Credential Authentication</a><br>For better security, you can configure the <code class="codeph">extproc</code> process to be authenticated through a credential.
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-B281685F-2E5F-47F9-A385-A9BACD5030B7">extproc Process Authentication and Impersonation Expected Behaviors</a><br>The <span class="apiname" translate="no">extproc</span> process has a set of behaviors for authentication and impersonation.
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-22CE5260-59B3-41DB-BD65-9E36D7514FFE">Configuring Authentication for External Procedures</a><br>To configure a credential for <code class="codeph">extproc</code> processes, you can use the <code class="codeph">DBMS_CREDENTIAL</code> PL/SQL package. 
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-6E8B4C38-FEB0-45F5-9D3E-BA1CD6537596">External Procedures for Legacy Applications</a><br>For maximum security, set the <code class="codeph">ENFORCE_CREDENTIAL</code> environment variable to <code class="codeph">TRUE</code>. 
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-245AF418-2349-4657-9010-8C8D7849FD05" title="A security policy for application developers should encompass areas such as password management and securing external procedures and application privileges.">Managing Security for Application&nbsp;Developers</a></p>
                     </div>
                  </div>
               </div>
               <a id="DBSEG755"></a><div class="props_rev_3"><a id="GUID-21BD6FC0-1D78-4986-9E2D-5B01F1A3B749" name="GUID-21BD6FC0-1D78-4986-9E2D-5B01F1A3B749"></a><h4 id="DBSEG-GUID-21BD6FC0-1D78-4986-9E2D-5B01F1A3B749" class="sect4">About Securing External Procedures</h4>
                  <div>
                     <p>For safety reasons, Oracle external procedures run in a process that is physically separate from the database. </p>
                     <p>In most cases, you configure this process to execute as a user other than the Oracle software account. When your application invokes this external procedure—such as when a library of <code class="codeph">.dll</code> or <code class="codeph">.so</code> files must be accessed—then Oracle Database creates an operating system process called <code class="codeph">extproc</code>. By default, the <code class="codeph">extproc</code> process communicates directly through your server process. In other words, if you do not use a credential, then Oracle Database creates an <code class="codeph">extproc</code> process for you in the default Oracle Database server configuration, and runs <code class="codeph">extproc</code> as the <code class="codeph">oracle</code> software account. Alternatively, it can communicate through the Oracle Database listener. 
                     </p>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-21BD6FC0-1D78-4986-9E2D-5B01F1A3B749__GUID-BD8B347C-7E76-4936-A05B-639207E0C803">
                        <p class="notep1">See Also:</p>
                        <p><a href="keeping-your-oracle-database-secure.html#GUID-C1D3B5AE-173C-4B3D-89ED-B3E27AF3698F" title="The ENFORCE_CREDENTIAL environment variable controls how an extproc process authenticates user credentials and callout functions.">Guideline for Securing External Procedures</a></p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-EE267659-48F3-4AFA-BB06-D8C620F80696" title="An external procedure is stored in a .dll or an .so file, separately from the database, and can be through a credential authentication.">Securing External Procedures</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="props_rev_3"><a id="GUID-652EA198-77D4-4071-84AD-E73FBF3CB4D9" name="GUID-652EA198-77D4-4071-84AD-E73FBF3CB4D9"></a><h4 id="DBSEG-GUID-652EA198-77D4-4071-84AD-E73FBF3CB4D9" class="sect4">General Process for Configuring extproc for a Credential Authentication</h4>
                  <div>
                     <p>For better security, you can configure the <code class="codeph">extproc</code> process to be authenticated through a credential.
                     </p>
                     <p>The general process is as follows: </p>
                     <ol>
                        <li>
                           <p>You create a credential.</p>
                           <p>The credential is in an encrypted container. Both public and private synonyms can refer to this credential. <a href="managing-security-for-application-developers.html#GUID-22CE5260-59B3-41DB-BD65-9E36D7514FFE" title="To configure a credential for extproc processes, you can use the DBMS_CREDENTIAL PL/SQL package.">Configuring Authentication for External Procedures</a> describes how to create this credential and configure your database to use it. 
                           </p>
                        </li>
                        <li>
                           <p>You make your initial connection to the database, which you are running in either a dedicated server or a shared server process. </p>
                        </li>
                        <li>
                           <p>Your application makes a call to an external procedure. </p>
                           <p>If this is the first call, then Oracle Database creates an <code class="codeph">extproc</code> process. Note that if you want to use a credential for <code class="codeph">extproc</code>, then you cannot use the Oracle listener to spawn the <code class="codeph">extproc</code> process.
                           </p>
                        </li>
                        <li>
                           <p>The <code class="codeph">extproc</code> process impersonates (that is, it runs on behalf of your supplied credential), loads the requisite <code class="codeph">.dll</code>, <code class="codeph">.so</code>, <code class="codeph">.sl</code>, or <code class="codeph">.a</code> file, and then sends your data between SQL and C. 
                           </p>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-EE267659-48F3-4AFA-BB06-D8C620F80696" title="An external procedure is stored in a .dll or an .so file, separately from the database, and can be through a credential authentication.">Securing External Procedures</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG756"></a><div class="props_rev_3"><a id="GUID-B281685F-2E5F-47F9-A385-A9BACD5030B7" name="GUID-B281685F-2E5F-47F9-A385-A9BACD5030B7"></a><h4 id="DBSEG-GUID-B281685F-2E5F-47F9-A385-A9BACD5030B7" class="sect4">extproc Process Authentication and Impersonation Expected Behaviors</h4>
                  <div>
                     <p>The <span class="apiname" translate="no">extproc</span> process has a set of behaviors for authentication and impersonation.
                     </p>
                     <p><a href="managing-security-for-application-developers.html#GUID-B281685F-2E5F-47F9-A385-A9BACD5030B7__CIHIFBGH" title="Extproc Behaviors">Table 10-2</a> describes the expected behaviors of an <code class="codeph">extproc</code> process based on possible authentication and impersonation scenarios. 
                     </p>
                     <div class="tblformalwide" id="GUID-B281685F-2E5F-47F9-A385-A9BACD5030B7__CIHIFBGH">
                        <p class="titleintable">Table 10-2 Expected Behaviors for extproc Process Authentication and Impersonation Settings</p>
                        <table cellpadding="4" cellspacing="0" class="FormalWide" title="Expected Behaviors for extproc Process Authentication and Impersonation Settings" summary="Extproc Behaviors" width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="22%" id="d78229e2944">ENFORCE_CREDENTIAL Environment Variable Setting</th>
                                 <th align="left" valign="bottom" width="12%" id="d78229e2947">PL/SQL Library with Credential?</th>
                                 <th align="left" valign="bottom" width="36%" id="d78229e2950">GLOBAL_EXTPROC_CREDENTIAL Credential Existence(1)</th>
                                 <th align="left" valign="bottom" width="30%" id="d78229e2970">Expected Behavior</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="22%" id="d78229e2975" headers="d78229e2944 ">
                                    <p><code class="codeph">FALSE</code></p>
                                 </td>
                                 <td align="left" valign="top" width="12%" headers="d78229e2975 d78229e2947 ">
                                    <p>No</p>
                                 </td>
                                 <td align="left" valign="top" width="36%" headers="d78229e2975 d78229e2950 ">
                                    <p>No</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d78229e2975 d78229e2970 ">
                                    <p>Uses the pre-release 12c authentication, which authenticates by operating system privilege of the owners of the Oracle listener or Oracle server process. </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="22%" id="d78229e2989" headers="d78229e2944 ">
                                    <p><code class="codeph">FALSE</code></p>
                                 </td>
                                 <td align="left" valign="top" width="12%" headers="d78229e2989 d78229e2947 ">
                                    <p>No</p>
                                 </td>
                                 <td align="left" valign="top" width="36%" headers="d78229e2989 d78229e2950 ">
                                    <p>Yes</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d78229e2989 d78229e2970 ">
                                    <p>Authenticates and impersonates with the Oracle instance-wide supplied <code class="codeph">GLOBAL_EXTPROC_CREDENTIAL</code> (<a id="fn_2" name="fn_2" href="#fn_2" onclick="footdisplay(2, "If only the GLOBAL_EXTPROC_CREDENTIAL credential is in use, then the EXECUTE privilege on this global credential is automatically granted to all users implicitly.")"><sup>Foot&nbsp;2</sup></a>)
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="22%" id="d78229e3016" headers="d78229e2944 ">
                                    <p><code class="codeph">FALSE</code></p>
                                 </td>
                                 <td align="left" valign="top" width="12%" headers="d78229e3016 d78229e2947 ">
                                    <p>Yes</p>
                                 </td>
                                 <td align="left" valign="top" width="36%" headers="d78229e3016 d78229e2950 ">
                                    <p>No</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d78229e3016 d78229e2970 ">
                                    <p>Authenticates and impersonates with the credential defined in the PL/SQL library</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="22%" id="d78229e3030" headers="d78229e2944 ">
                                    <p><code class="codeph">FALSE</code></p>
                                 </td>
                                 <td align="left" valign="top" width="12%" headers="d78229e3030 d78229e2947 ">
                                    <p>Yes</p>
                                 </td>
                                 <td align="left" valign="top" width="36%" headers="d78229e3030 d78229e2950 ">
                                    <p>Yes</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d78229e3030 d78229e2970 ">
                                    <p>Authenticates and impersonates (<a id="fn_3" name="fn_3" href="#fn_3" onclick="footdisplay(3, "If both the PL/SQL library and the GLOBAL_EXTPROC_CREDENTIAL settings have credentials defined, then the credential of the PL/SQL library takes precedence.")"><sup>Foot&nbsp;3</sup></a>)
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="22%" id="d78229e3051" headers="d78229e2944 ">
                                    <p><code class="codeph">TRUE</code></p>
                                 </td>
                                 <td align="left" valign="top" width="12%" headers="d78229e3051 d78229e2947 ">
                                    <p>No</p>
                                 </td>
                                 <td align="left" valign="top" width="36%" headers="d78229e3051 d78229e2950 ">
                                    <p>No</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d78229e3051 d78229e2970 ">
                                    <p>Returns error <code class="codeph">ORA-28575: unable to open RPC connection to external procedure agent</code> <a id="d78229e3067" class="indexterm-anchor"></a><a id="d78229e3069" class="indexterm-anchor"></a></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="22%" id="d78229e3074" headers="d78229e2944 ">
                                    <p><code class="codeph">TRUE</code></p>
                                 </td>
                                 <td align="left" valign="top" width="12%" headers="d78229e3074 d78229e2947 ">
                                    <p>No</p>
                                 </td>
                                 <td align="left" valign="top" width="36%" headers="d78229e3074 d78229e2950 ">
                                    <p>Yes</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d78229e3074 d78229e2970 ">
                                    <p>Authenticates and impersonates with the Oracle system-wide supplied <code class="codeph">GLOBAL_EXTPROC_CREDENTIAL</code> (footnote 1)
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="22%" id="d78229e3091" headers="d78229e2944 ">
                                    <p><code class="codeph">TRUE</code></p>
                                 </td>
                                 <td align="left" valign="top" width="12%" headers="d78229e3091 d78229e2947 ">
                                    <p>Yes</p>
                                 </td>
                                 <td align="left" valign="top" width="36%" headers="d78229e3091 d78229e2950 ">
                                    <p>No</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d78229e3091 d78229e2970 ">
                                    <p>Authenticates and impersonates with the credential defined in the PL/SQL library</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="22%" id="d78229e3105" headers="d78229e2944 ">
                                    <p><code class="codeph">TRUE</code></p>
                                 </td>
                                 <td align="left" valign="top" width="12%" headers="d78229e3105 d78229e2947 ">
                                    <p>Yes</p>
                                 </td>
                                 <td align="left" valign="top" width="36%" headers="d78229e3105 d78229e2950 ">
                                    <p>Yes</p>
                                 </td>
                                 <td align="left" valign="top" width="30%" headers="d78229e3105 d78229e2970 ">
                                    <p>Authenticates and impersonates (footnote 2)</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p class="tablefootnote"><sup class="tablefootnote">Footnote&nbsp;1 </sup>GLOBAL_EXTPROC_CREDENTIAL is a reserved credential name for the default credential if the credential is not explicitly specified and the ENFORCE_CREDENTIAL environment variable is set to TRUE. Therefore, Oracle strongly recommends that you create a credential by the that name if ENFORCE_CREDENTIAL is set to TRUE.
                     </p>
                     <p class="tablefootnote"><sup class="tablefootnote">Footnote&nbsp;2 </sup></p><p>If only the <code class="codeph">GLOBAL_EXTPROC_CREDENTIAL</code> credential is in use, then the <code class="codeph">EXECUTE</code> privilege on this global credential is automatically granted to all users implicitly.
                        </p>
                     <p></p>
                     <p class="tablefootnote"><sup class="tablefootnote">Footnote&nbsp;3 </sup></p><p>If both the PL/SQL library and the <code class="codeph">GLOBAL_EXTPROC_CREDENTIAL</code> settings have credentials defined, then the credential of the PL/SQL library takes precedence.
                        </p>
                     <p></p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-EE267659-48F3-4AFA-BB06-D8C620F80696" title="An external procedure is stored in a .dll or an .so file, separately from the database, and can be through a credential authentication.">Securing External Procedures</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG757"></a><div class="props_rev_3"><a id="GUID-22CE5260-59B3-41DB-BD65-9E36D7514FFE" name="GUID-22CE5260-59B3-41DB-BD65-9E36D7514FFE"></a><h4 id="DBSEG-GUID-22CE5260-59B3-41DB-BD65-9E36D7514FFE" class="sect4">Configuring Authentication for External Procedures</h4>
                  <div>
                     <p>To configure a credential for <code class="codeph">extproc</code> processes, you can use the <code class="codeph">DBMS_CREDENTIAL</code> PL/SQL package. 
                     </p>
                     <ol>
                        <li class="stepexpand"><span>Log in to SQL*Plus as a user who has been granted the <code class="codeph">CREATE CREDENTIAL</code> or <code class="codeph">CREATE ANY CREDENTIAL</code> privilege. </span><div><pre class="oac_no_warn" dir="ltr">sqlplus psmith
Enter password: <span class="italic">password</span>
Connected.
</pre><p>In a multitenant environment, you must connect to the appropriate pluggable database (PDB). For example: </p><pre class="oac_no_warn" dir="ltr">sqlplus psmith@hpdb
Enter password: <span class="italic">password</span>
Connected.
</pre><p>In addition, ensure that you also have the <code class="codeph">CREATE LIBRARY</code> or <code class="codeph">CREATE ANY LIBRARY</code> privilege, and the <code class="codeph">EXECUTE</code> object privilege on the library that contains the external calls. 
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Using the <code class="codeph">DBMS_CREDENTIAL</code> PL/SQL package, create a new credential.</span><div>
                              <p>For example:</p><pre class="oac_no_warn" dir="ltr">BEGIN
  DBMS_CREDENTIAL.CREATE_CREDENTIAL (
    credential_name   =&gt; 'smith_credential', 
    user_name         =&gt; 'tjones',
    password          =&gt; '<span class="italic">password</span>')
END;
/</pre><p>In this example: </p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><code class="codeph">credential_name</code>: Enter the name of the credential. Optionally, prefix it with the name of a schema (for example, <code class="codeph">psmith.smith_credential</code>). If the <code class="codeph">ENFORCE_CREDENTIAL</code> environment variable is set to <code class="codeph">TRUE</code>, then you should create a credential with credential_name  <code class="codeph">GLOBAL_EXTPROC_CREDENTIAL</code>.
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">user_name</code>: Enter a valid operating system user name to be to used to run as the user.
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">password</code>: Enter the password for the <code class="codeph">user_name</code> user. 
                                    </p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Associate the credential with a PL/SQL library. </span><div>
                              <p>For example: </p><pre class="oac_no_warn" dir="ltr">CREATE OR REPLACE LIBRARY ps_lib  
 AS 'smith_lib.so' IN DLL_LOC
 CREDENTIAL smith_credential;
</pre><p>In this example, <code class="codeph">DLL_LOC</code> is a directory object that points to the <code class="codeph">$ORACLE_HOME/bin</code> directory. Oracle does not recommend using absolute paths to the DLL. 
                              </p>
                              <p>When the PL/SQL library is loaded by an external procedure call through the <code class="codeph">extproc</code> process, <code class="codeph">extproc</code> now can authenticate and impersonate on behalf of the defined <code class="codeph">smith_credential</code> credential.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Register the external procedure by creating a PL/SQL procedure or function that tells PL/SQL how to call the external procedure and what arguments to pass to it. </span><div>
                              <p>For example, to create a function that registers an external procedure that was written in C, only use the <code class="codeph">AS LANGUAGE C</code>, <code class="codeph">LIBRARY</code>, and <code class="codeph">NAME</code> clauses of the <code class="codeph">CREATE FUNCTION</code> statement, as follows:
                              </p><pre class="oac_no_warn" dir="ltr">CREATE OR REPLACE FUNCTION getInt (x VARCHAR2, y BINARY_INTEGER)
RETURN BINARY_INTEGER
AS LANGUAGE C
LIBRARY ps_lib
NAME "get_int_vals"
PARAMETERS (x STRING, y int);</pre></div>
                        </li>
                     </ol>
                     <div class="section"></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-22CE5260-59B3-41DB-BD65-9E36D7514FFE__GUID-D008E079-A7C7-48E6-9DF2-0DD202061B77">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="keeping-your-oracle-database-secure.html#GUID-C1D3B5AE-173C-4B3D-89ED-B3E27AF3698F" title="The ENFORCE_CREDENTIAL environment variable controls how an extproc process authenticates user credentials and callout functions.">Guideline for Securing External Procedures</a></p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/dbseg&amp;id=ARPLS73499" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a>, for information about the <code class="codeph">DBMS_CREDENTIAL</code> package
                              </p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/dbseg&amp;id=LNOCI00099" target="_blank"><span><cite>Oracle Call Interface Programmer's Guide</cite></span></a> for information about the <code class="codeph">extproc</code> agent
                              </p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/dbseg&amp;id=NETAG0132" target="_blank"><span><cite>Oracle Database Net Services Administrator's Guide</cite></span></a> for detailed information about the <code class="codeph">extproc.ora</code> file
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-EE267659-48F3-4AFA-BB06-D8C620F80696" title="An external procedure is stored in a .dll or an .so file, separately from the database, and can be through a credential authentication.">Securing External Procedures</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG758"></a><div class="props_rev_3"><a id="GUID-6E8B4C38-FEB0-45F5-9D3E-BA1CD6537596" name="GUID-6E8B4C38-FEB0-45F5-9D3E-BA1CD6537596"></a><h4 id="DBSEG-GUID-6E8B4C38-FEB0-45F5-9D3E-BA1CD6537596" class="sect4">External Procedures for Legacy Applications</h4>
                  <div>
                     <p>For maximum security, set the <code class="codeph">ENFORCE_CREDENTIAL</code> environment variable to <code class="codeph">TRUE</code>. 
                     </p>
                     <p>However, if you must accommodate backward compatibility, then set <code class="codeph">ENFORCE_CREDENTIAL</code> to <code class="codeph">FALSE</code>. <code class="codeph">FALSE</code> enables the <code class="codeph">extproc</code> process to authenticate, impersonate, and perform user-defined callout functions on behalf of the supplied credential when either of the following occurs: 
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>The credential is defined with a PL/SQL library.</p>
                        </li>
                        <li>
                           <p>The credential is not defined but the <code class="codeph">GLOBAL_EXTPROC_CREDENTIAL</code> credential exists. 
                           </p>
                        </li>
                     </ul>
                     <p>If neither of these credential definitions is in place, then setting the <code class="codeph">ENFORCE_CREDENTIAL</code> parameter to <code class="codeph">FALSE</code> sets the <code class="codeph">extproc</code> process to be authenticated by the operating system privilege of the owners of the Oracle listener or Oracle server process. 
                     </p>
                     <p>For legacy applications that run on top of <code class="codeph">extproc</code> processes, ideally you should change the legacy application code to associate all alias libraries with credentials. If you cannot do this, then Oracle Database uses the <code class="codeph">GLOBAL_EXTPROC_CREDENTIAL</code> credential to determine how authentication will be handled. If the <code class="codeph">GLOBAL_EXTPROC_CREDENTIAL</code> credential is not defined, then the <code class="codeph">extproc</code> process is authenticated by the operating system privilege of the owners of the Oracle listener or Oracle server process.
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-EE267659-48F3-4AFA-BB06-D8C620F80696" title="An external procedure is stored in a .dll or an .so file, separately from the database, and can be through a credential authentication.">Securing External Procedures</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
            <div class="sect2"><a id="GUID-8F585EBE-611D-4717-AD9F-CAC10A19B7E1" name="GUID-8F585EBE-611D-4717-AD9F-CAC10A19B7E1"></a><h3 id="DBSEG-GUID-8F585EBE-611D-4717-AD9F-CAC10A19B7E1" class="sect3">Securing LOBs with LOB Locator
                Signatures</h3>
               <div>
                  <p>You can secure large objects (LOB) by regenerating their LOB locator
                signatures.</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-D4FA0565-3CFF-4E94-B173-676971323904">About Securing LOBs with LOB Locator Signatures</a><br>A LOB locator, which is a pointer to the actual location of a large object (LOB) value, can be assigned a signature, which can be used to secure the LOB. 
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-5DC42FA1-09BE-4E2E-B631-BD7335C8A09E">Managing the Encryption of a LOB Locator Signature Key</a><br>You can use the <code class="codeph">ALTER DATABASE DICTIONARY</code> SQL statement to         encrypt a LOB locator signature key. 
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-245AF418-2349-4657-9010-8C8D7849FD05" title="A security policy for application developers should encompass areas such as password management and securing external procedures and application privileges.">Managing Security for Application&nbsp;Developers</a></p>
                     </div>
                  </div>
               </div>
               
               <div class="sect3"><a id="GUID-D4FA0565-3CFF-4E94-B173-676971323904" name="GUID-D4FA0565-3CFF-4E94-B173-676971323904"></a><h4 id="DBSEG-GUID-D4FA0565-3CFF-4E94-B173-676971323904" class="sect4">About Securing LOBs with LOB
        Locator Signatures</h4>
                  <div>
                     <p>A LOB locator, which is a pointer to the actual location of a large object (LOB) value, can be assigned a signature, which can be used to secure the LOB. </p>
                     <p>When you create a LOB, Oracle Database automatically assigns a signature to the LOB
            locator. Oracle Database verifies the signature matches when it receives a locator from
            a client to ensure that the locator has not been tampered with. Signature-based security
            can be used for both persistent and temporary LOB locators. It is also used for
            distributed CLOBs, BLOBs, and NBLOBs that come from index organized table (IOT)
            locators. </p>
                     <p>In an Oracle Real Applications Clusters (Oracle RAC) environment, all instances will
            share the same signature key, which is persisted in the database. In a multitenant
            environment, each pluggable database (PDB) will have its own signature key. If a LOB
            locator has been tampered with, the signature verification rejects the LOB and raises an
                <code class="codeph">ORA-64219: invalid LOB locator encountered</code> error.
                     </p>
                     <p>You can encrypt, rekey, and delete the LOB signature key that was used to generate
            LOB signature for LOB locators that are sent from a standalone database or PDB to a
            client. If you plan to encrypt the signature key, then the database (or PDB) in which
            the key resides must have an open TDE keystore.</p>
                     <p>To enable the LOB signature feature, you must set the
                <code class="codeph">LOB_SIGNATURE_ENABLE</code> initialization parameter to
                <code class="codeph">TRUE</code>. By default, <code class="codeph">LOB_SIGNATURE_ENABLE</code> is set to
                <code class="codeph">FALSE</code> for Oracle Database release 19c. 
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-8F585EBE-611D-4717-AD9F-CAC10A19B7E1" title="You can secure large objects (LOB) by regenerating their LOB locator signatures.">Securing LOBs with LOB Locator Signatures</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-5DC42FA1-09BE-4E2E-B631-BD7335C8A09E" name="GUID-5DC42FA1-09BE-4E2E-B631-BD7335C8A09E"></a><h4 id="DBSEG-GUID-5DC42FA1-09BE-4E2E-B631-BD7335C8A09E" class="sect4">Managing the Encryption of a LOB Locator
        Signature Key</h4>
                  <div>
                     <p>You can use the <code class="codeph">ALTER DATABASE DICTIONARY</code> SQL statement to
        encrypt a LOB locator signature key. 
                     </p>
                     <ol>
                        <li class="stepexpand"><span>Log in to the database as a user who has <code class="codeph">ALTER DATABASE DICTIONARY</code> privileges.</span></li>
                        <li class="stepexpand"><span>If necessary, enable the LOB signature key feature by setting the
                        <code class="codeph">LOB_SIGNATURE_ENABLE</code> initialization parameter to
                        <code class="codeph">TRUE</code>. </span><div>
                              <pre class="oac_no_warn" dir="ltr">ALTER SYSTEM SET LOB_SIGNATURE_ENABLE = TRUE;</pre>
                              </div>
                           <div>Alternatively, you can set the <code class="codeph">LOB_SIGNATURE_ENABLE</code> parameter
                    in the <code class="codeph">init.ora</code> initialization file before a database restart.
                    This enables the LOB signature key feature for all PDBs. 
                           </div>
                        </li>
                        <li class="stepexpand"><span>If you plan to encrypt the signature key, then ensure that the database or PDB
                    has an open TDE keystore. </span><div>You must have the <code class="codeph">SYSKM</code> administrative privilege to create a
                    TDE keystore.
                           </div>
                           <div>For example, to create and open a software TDE
                    keystore:<pre class="oac_no_warn" dir="ltr">ADMINISTER KEY MANAGEMENT CREATE KEYSTORE '/etc/ORACLE/WALLETS/orcl' IDENTIFIED BY <span class="italic">password</span>;
ADMINISTER KEY MANAGEMENT SET KEYSTORE OPEN IDENTIFIED BY <span class="italic">password</span>;</pre></div>
                        </li>
                        <li class="stepexpand"><span>Execute the <code class="codeph">ALTER DATABASE DICTIONARY</code> statement to set the LOB
                    signature key configuration.</span><ul>
                              <li>To encrypt the LOB locator signature key instead of
                        obfuscating it, execute the following statement:
                        <pre class="oac_no_warn" dir="ltr">ALTER DATABASE DICTIONARY ENCRYPT CREDENTIALS;</pre></li>
                              <li>To regenerate the LOB locator signature key for LOB
                        locators that will be sent to a client, use the following statement. If the
                        database is in restricted mode, then Oracle Database regenerates a new LOB
                        signature key to encrypt the regenerated signature key. If the database is
                        in non-restricted mode, then a new signature key is not regenerated but
                        instead, Oracle Database uses a new encryption key to encrypt the existing
                        LOB signature key. Oracle recommends that a database administrator or PDB
                        administrator run this statement in restricted mode on a periodic basis,
                        preferably during database down time.
                        <pre class="oac_no_warn" dir="ltr">ALTER DATABASE DICTIONARY REKEY CREDENTIALS;</pre></li>
                              <li>To delete the encrypted LOB locator signature key and then
                        regenerate a new LOB signature key in obfuscated form instead of encrypted
                        form, execute the following statement:
                        <pre class="oac_no_warn" dir="ltr">ALTER DATABASE DICTIONARY DELETE CREDENTIALS;</pre></li>
                           </ul>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/dbseg&amp;id=ASOAG-GUID-C5D20EAE-3369-411F-9A7E-13AB14139F1D" target="_blank">Configuring Transparent Data Encryption</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-8F585EBE-611D-4717-AD9F-CAC10A19B7E1" title="You can secure large objects (LOB) by regenerating their LOB locator signatures.">Securing LOBs with LOB Locator Signatures</a></p>
                        </div>
                     </div>
                  </div>
               </div>
            </div><a id="DBSEG145"></a><div class="props_rev_3"><a id="GUID-4C03768A-FA3D-4D41-84CF-FEA40D0D9AA9" name="GUID-4C03768A-FA3D-4D41-84CF-FEA40D0D9AA9"></a><h3 id="DBSEG-GUID-4C03768A-FA3D-4D41-84CF-FEA40D0D9AA9" class="sect3">Managing Application Privileges</h3>
               <div>
                  <p>Most database applications involve different privileges on different schema objects. </p>
                  <div class="section">
                     <p>Keeping track of the privileges that are required for each application can be complex. In addition, authorizing users to run an application can involve many <code class="codeph">GRANT</code> operations.
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>To simplify application privilege management, create a role for each application and grant that role all the privileges a user must run the application. </p>
                           <p>In fact, an application can have several roles, each granted a specific subset of privileges that allow greater or lesser capabilities while running the application.</p>
                        </li>
                     </ul>
                     <p>For example, suppose every administrative assistant uses the Vacation application to record the vacation taken by members of the department. To best manage this application, you should:</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li><span>Create a <code class="codeph">VACATION</code> role.</span></li>
                     <li><span>Grant all privileges required by the Vacation application to the <code class="codeph">VACATION</code> role.</span></li>
                     <li><span>Grant the <code class="codeph">VACATION</code> role to all administrative assistants. Better yet, create a role that defines the privileges the administrative assistants have, and then grant the <code class="codeph">VACATION</code> role to that role. </span></li>
                  </ol>
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-4C03768A-FA3D-4D41-84CF-FEA40D0D9AA9__GUID-6A0AC1E8-2D10-499A-A16F-8B5E30B6761B">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="configuring-privilege-and-role-authorization.html#GUID-89CE989D-C97F-4CFD-941F-18203090A1AC" title="Privilege and role authorization controls the permissions that users have to perform day-to-day tasks.">Configuring Privilege and Role Authorization</a>, for a complete discussion of creating, enabling, and disabling roles, and granting and revoking privileges
                           </p>
                        </li>
                        <li>
                           <p><a href="configuring-privilege-and-role-authorization.html#GUID-157F644B-124B-4ACC-98D8-43C911370B50" title="You can use special queries to find information about various types of privilege and role grants.">User Privilege and Role Data Dictionary Views</a> for more information about the security uses of the <code class="codeph">ROLE_TAB_PRIVS</code>, <code class="codeph">ROLE_SYS_PRIVS</code>, and <code class="codeph">DBA_ROLE_PRIVS</code> data dictionary views
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-245AF418-2349-4657-9010-8C8D7849FD05" title="A security policy for application developers should encompass areas such as password management and securing external procedures and application privileges.">Managing Security for Application&nbsp;Developers</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-2D2FD12B-5953-4056-8488-2C70832559D9" name="GUID-2D2FD12B-5953-4056-8488-2C70832559D9"></a><h3 id="DBSEG-GUID-2D2FD12B-5953-4056-8488-2C70832559D9" class="sect3">Advantages of Using Roles to Manage Application Privileges</h3>
               <div>
                  <p>Grouping application privileges in a role aids privilege management.</p>
                  <p>Consider the following administrative options:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>You can grant the role, rather than many individual privileges, to those users who run the application. Then, as employees change jobs, you need to grant or revoke only one role, rather than many privileges.</p>
                     </li>
                     <li>
                        <p>You can change the privileges associated with an application by modifying only the privileges granted to the role, rather than the privileges held by all users of the application.</p>
                     </li>
                     <li>
                        <p>You can determine the privileges that are necessary to run a particular application by querying the <code class="codeph">ROLE_TAB_PRIVS</code> and <code class="codeph">ROLE_SYS_PRIVS</code> data dictionary views.
                        </p>
                     </li>
                     <li>
                        <p>You can determine which users have privileges on which applications by querying the <code class="codeph">DBA_ROLE_PRIVS</code> data dictionary view.
                        </p>
                     </li>
                  </ul>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-245AF418-2349-4657-9010-8C8D7849FD05" title="A security policy for application developers should encompass areas such as password management and securing external procedures and application privileges.">Managing Security for Application&nbsp;Developers</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="DBSEG30399"></a><div class="props_rev_3"><a id="GUID-AF4D0F7A-D74E-444E-8D00-66B9FEFE8CD2" name="GUID-AF4D0F7A-D74E-444E-8D00-66B9FEFE8CD2"></a><h3 id="DBSEG-GUID-AF4D0F7A-D74E-444E-8D00-66B9FEFE8CD2" class="sect3">Creating Secure Application Roles to Control Access to Applications</h3>
               <div>
                  <p>A secure application role is only enabled through its associated PL/SQL package or procedure. </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-283FDA5C-F8C9-440F-A3AB-73B87AC3A680">Step 1: Create the Secure Application Role</a><br>The <code class="codeph">CREATE</code> <code class="codeph">ROLE</code> statement with the <code class="codeph">IDENTIFIED USING</code> clause creates a secure application role. 
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-7D39957F-31DC-4C7D-9BFB-93FB2C631E25">Step 2: Create a PL/SQL Package to Define the Access Policy for the Application</a><br>You can create a PL/SQL package that defines the access policy for your application. 
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-245AF418-2349-4657-9010-8C8D7849FD05" title="A security policy for application developers should encompass areas such as password management and securing external procedures and application privileges.">Managing Security for Application&nbsp;Developers</a></p>
                     </div>
                  </div>
               </div>
               <a id="DBSEG146"></a><div class="props_rev_3"><a id="GUID-283FDA5C-F8C9-440F-A3AB-73B87AC3A680" name="GUID-283FDA5C-F8C9-440F-A3AB-73B87AC3A680"></a><h4 id="DBSEG-GUID-283FDA5C-F8C9-440F-A3AB-73B87AC3A680" class="sect4">Step 1: Create the Secure Application Role</h4>
                  <div>
                     <p>The <code class="codeph">CREATE</code> <code class="codeph">ROLE</code> statement with the <code class="codeph">IDENTIFIED USING</code> clause creates a secure application role. 
                     </p>
                     <div class="section">
                        <p>You must have the <code class="codeph">CREATE ROLE</code> system privilege to execute this statement. 
                        </p>
                        <p>For example, to create a secure application role called <code class="codeph">hr_admin</code> that is associated with the <code class="codeph">sec_mgr.hr_admin</code> package:
                        </p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Create the security application role as follows: </span><div><pre class="oac_no_warn" dir="ltr">CREATE ROLE hr_admin IDENTIFIED USING sec_mgr.hr_admin_role_check;
</pre><p>This statement indicates the following:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>The role <code class="codeph">hr_admin</code> to be created is a secure application role.
                                    </p>
                                 </li>
                                 <li>
                                    <p>The role can only be enabled by modules defined inside the PL/SQL procedure <code class="codeph">sec_mgr</code>.<code class="codeph">hr_admin_role_check</code>. At this stage, this procedure does not need to exist; <a href="managing-security-for-application-developers.html#GUID-7D39957F-31DC-4C7D-9BFB-93FB2C631E25" title="You can create a PL/SQL package that defines the access policy for your application.">Step 2: Create a PL/SQL Package to Define the Access Policy for the Application</a> explains how to create the package or procedure. 
                                    </p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Grant the security application role the privileges you would normally associate with this role. </span><div>
                              <p>For example, to grant the <code class="codeph">hr_admin</code> role <code class="codeph">SELECT</code>, <code class="codeph">INSERT</code>, <code class="codeph">UPDATE</code>, and <code class="codeph">DELETE</code> privileges on the <code class="codeph">HR.EMPLOYEES</code> table, you enter the following statement:   
                              </p><pre class="oac_no_warn" dir="ltr">GRANT SELECT, INSERT, UPDATE, DELETE ON HR.EMPLOYEES TO hr_admin;
</pre><p>Do not grant the role directly to the user. The PL/SQL procedure or package does that for you, assuming the user passes its security policies. </p>
                           </div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-AF4D0F7A-D74E-444E-8D00-66B9FEFE8CD2" title="A secure application role is only enabled through its associated PL/SQL package or procedure.">Creating Secure Application Roles to Control Access to Applications</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG147"></a><div class="props_rev_3"><a id="GUID-7D39957F-31DC-4C7D-9BFB-93FB2C631E25" name="GUID-7D39957F-31DC-4C7D-9BFB-93FB2C631E25"></a><h4 id="DBSEG-GUID-7D39957F-31DC-4C7D-9BFB-93FB2C631E25" class="sect4">Step 2: Create a PL/SQL Package to Define the Access Policy for the Application</h4>
                  <div>
                     <p>You can create a PL/SQL package that defines the access policy for your application. </p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-C9506707-F602-47D7-8B2E-C837CEFD63B6">About Creating a PL/SQL Package to Define the Access Policy for an Application</a><br>To enable or disable the secure application role, you must create the security policies of the role within a PL/SQL package. 
                        </li>
                        <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-AA09D0FE-7B88-43E8-B76D-7A6C50AA99E8">Creating a PL/SQL Package or Procedure to Define the Access Policy for an Application</a><br>The PL/SQL package or procedure that you create must use invoker’s rights to define the access policy.
                        </li>
                        <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-B143E13B-BC5C-47D9-800B-924AD76D360D">Testing the Secure Application Role</a><br>As a user who has been granted the secure application role, try performing an action that requires the privileges the role grants. 
                        </li>
                     </ul>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-AF4D0F7A-D74E-444E-8D00-66B9FEFE8CD2" title="A secure application role is only enabled through its associated PL/SQL package or procedure.">Creating Secure Application Roles to Control Access to Applications</a></p>
                        </div>
                     </div>
                  </div>
                  <a id="DBSEG597"></a><div class="props_rev_3"><a id="GUID-C9506707-F602-47D7-8B2E-C837CEFD63B6" name="GUID-C9506707-F602-47D7-8B2E-C837CEFD63B6"></a><h5 id="DBSEG-GUID-C9506707-F602-47D7-8B2E-C837CEFD63B6" class="sect5">About Creating a PL/SQL Package to Define the Access Policy for an Application</h5>
                     <div>
                        <p>To enable or disable the secure application role, you must create the security policies of the role within a PL/SQL package. </p>
                        <p>You also can create an individual procedure to do this, but a package lets you group a set of procedures together. This lets you group a set of policies that, used together, present a solid security strategy to protect your applications. For users (or potential intruders) who fail the security policies, you can add auditing checks to the package to record the failure. Typically, you create this package in the schema of the security administrator. </p>
                        <p>The package or procedure must accomplish the following:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="bold">It must use invoker's rights to enable the role.</span>To create the package using invoker's rights, you must set the <code class="codeph">AUTHID</code> property to <code class="codeph">CURRENT_USER</code>. You cannot create the package by using definer's rights.
                              </p>
                              <p>For more information about invoker's rights and definer's rights, see <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/dbseg&amp;id=LNPLS00809" target="_blank"><span><cite>Oracle Database PL/SQL Language Reference</cite></span></a>.
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">It must include one or more security checks to validate the user.</span> One way to validate users is to use the <code class="codeph">SYS_CONTEXT</code> SQL function. See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/dbseg&amp;id=SQLRF06117" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for more information about <code class="codeph">SYS_CONTEXT</code>. To find session information for a user, you can use <code class="codeph">SYS_CONTEXT</code> with an application context. See <a href="using-application-contexts-to-retrieve-user-information.html#GUID-51C9D5FA-6787-4F05-82EF-A5968BEDC5A0" title="An application context stores user identification that can enable or prevent a user from accessing data in the database.">Using Application Contexts to&nbsp;Retrieve&nbsp;User&nbsp;Information</a>, for details.
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">It must issue a SET ROLE SQL statement or DBMS_SESSION.SET_ROLE procedure when the user passes the security checks.</span> Because you create the package using invoker's rights, you must set the role by issuing the <code class="codeph">SET ROLE</code> SQL statement or the <code class="codeph">DBMS_SESSION.SET_ROLE</code> procedure. (However, you cannot use the <code class="codeph">SET ROLE ALL</code> statement for this type of role enablement.) The PL/SQL embedded SQL syntax does not support the <code class="codeph">SET ROLE</code> statement, but you can invoke <code class="codeph">SET ROLE</code> by using dynamic SQL (for example, with <code class="codeph">EXECUTE IMMEDIATE</code>). 
                              </p>
                              <p>For more information about <code class="codeph">EXECUTE IMMEDIATE</code>, see <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/dbseg&amp;id=LNPLS01115" target="_blank"><span><cite>Oracle Database PL/SQL Language Reference</cite></span></a>. 
                              </p>
                           </li>
                        </ul>
                        <p>Because of the way that you must create this package or procedure, you cannot use a logon trigger to enable or disable a secure application role. Instead, invoke the package directly from the application when the user logs in, before the user must use the privileges granted by the secure application role.</p>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-7D39957F-31DC-4C7D-9BFB-93FB2C631E25" title="You can create a PL/SQL package that defines the access policy for your application.">Step 2: Create a PL/SQL Package to Define the Access Policy for the Application</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG702"></a><div class="props_rev_3"><a id="GUID-AA09D0FE-7B88-43E8-B76D-7A6C50AA99E8" name="GUID-AA09D0FE-7B88-43E8-B76D-7A6C50AA99E8"></a><h5 id="DBSEG-GUID-AA09D0FE-7B88-43E8-B76D-7A6C50AA99E8" class="sect5">Creating a PL/SQL Package or Procedure to Define the Access Policy for an Application</h5>
                     <div>
                        <p>The PL/SQL package or procedure that you create must use invoker’s rights to define the access policy.</p>
                        <div class="section">
                           <p>For example, suppose you wanted to restrict anyone using the <code class="codeph">hr_admin</code> role to employees who are on site (that is, using certain terminals) and between the hours of 8 a.m. and 5 p.m. As the system or security administrator, you can create a procedure that defines the access policy for the application. 
                           </p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Create the procedure as follows:</span><div><pre class="pre codeblock"><code>CREATE OR REPLACE PROCEDURE hr_admin_role_check
 AUTHID CURRENT_USER 
 AS 
 BEGIN 
  IF (SYS_CONTEXT ('userenv','ip_address') 
    BETWEEN '192.0.2.10' and '192.0.2.20'
     AND
    TO_CHAR (SYSDATE, 'HH24') BETWEEN 8 AND 17)
  THEN
    EXECUTE IMMEDIATE 'SET ROLE hr_admin'; 
  END IF;
 END;
/</code></pre><p>In this example:</p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p><code class="codeph">AUTHID CURRENT_USER</code> sets the AUTHID property to CURRENT_USER so that invoker's rights can be used.
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">IF (SYS_CONTEXT ('userenv','ip_address')</code> validates the user by using the SYS_CONTEXT SQL function to retrieve the user session information.
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">BETWEEN ... TO_CHAR</code> creates a test to grant or deny access. The test restricts access to users who are on site (that is, using certain terminals) and working between the hours of 8:00 a.m. and 5:00 p.m. If the user passes this check, the <code class="codeph">hr_admin</code> role is granted.
                                       </p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">THEN... EXECUTE</code> grants the role to the user by issuing the <code class="codeph">SET ROLE</code> statement using the <code class="codeph">EXECUTE IMMEDIATE</code> command, assuming the user passes the test.
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Grant <code class="codeph">EXECUTE</code> permissions for the <code class="codeph">hr_admin_role_check</code> procedure to any user who was assigned it. </span><div>
                                 <p>For example:</p><pre class="oac_no_warn" dir="ltr">GRANT EXECUTE ON hr_admin_role_check TO psmith;</pre></div>
                           </li>
                        </ol>
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-7D39957F-31DC-4C7D-9BFB-93FB2C631E25" title="You can create a PL/SQL package that defines the access policy for your application.">Step 2: Create a PL/SQL Package to Define the Access Policy for the Application</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div><a id="DBSEG767"></a><div class="props_rev_3"><a id="GUID-B143E13B-BC5C-47D9-800B-924AD76D360D" name="GUID-B143E13B-BC5C-47D9-800B-924AD76D360D"></a><h5 id="DBSEG-GUID-B143E13B-BC5C-47D9-800B-924AD76D360D" class="sect5">Testing the Secure Application Role</h5>
                     <div>
                        <p>As a user who has been granted the secure application role, try performing an action that requires the privileges the role grants. </p>
                        <div class="section">
                           <p>When you log in as a user who has been granted the secure application role, the role is then enabled. </p>
                           <ol>
                              <li>
                                 <p>Log in to the database session as the user. </p>
                                 <p>For example:</p><pre class="oac_no_warn" dir="ltr">CONNECT PSMITH@hrpdb
Enter password: <span class="italic">password</span>
</pre></li>
                              <li>
                                 <p>Perform an action that requires the privileges the secure application role grants. </p>
                                 <p>For example, if the role grants the <code class="codeph">EXECUTE</code> privilege for a procedure called <code class="codeph">sec_admin.hr_admin_role_check</code>:
                                 </p><pre class="oac_no_warn" dir="ltr">
EXECUTE sec_admin.hr_admin_role_check;
</pre></li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <div class="familylinks">
                           <div class="parentlink">
                              <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-7D39957F-31DC-4C7D-9BFB-93FB2C631E25" title="You can create a PL/SQL package that defines the access policy for your application.">Step 2: Create a PL/SQL Package to Define the Access Policy for the Application</a></p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
            </div><a id="DBSEG148"></a><div class="props_rev_3"><a id="GUID-1FE77DE6-8950-493C-B10F-13E1A1A33155" name="GUID-1FE77DE6-8950-493C-B10F-13E1A1A33155"></a><h3 id="DBSEG-GUID-1FE77DE6-8950-493C-B10F-13E1A1A33155" class="sect3">Association of Privileges with User Database Roles</h3>
               <div>
                  <p>Ensure that users have only the privileges associated with the current database role.</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-7DE124D3-67E6-4A69-B4C6-CF058E2623C4">Why Users Should Only Have the Privileges of the Current Database Role</a><br>A single user can use many applications and associated roles. 
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-D9D4B3DB-DD1E-4BCE-BC9B-86968AD1CEC6">Use of the SET ROLE Statement to Automatically Enable or Disable Roles</a><br>You can use a <code class="codeph">SET</code> <code class="codeph">ROLE</code> statement at the beginning of each application to automatically enable its associated role and to disable all others.
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-245AF418-2349-4657-9010-8C8D7849FD05" title="A security policy for application developers should encompass areas such as password management and securing external procedures and application privileges.">Managing Security for Application&nbsp;Developers</a></p>
                     </div>
                  </div>
               </div>
               <a id="DBSEG149"></a><div class="props_rev_3"><a id="GUID-7DE124D3-67E6-4A69-B4C6-CF058E2623C4" name="GUID-7DE124D3-67E6-4A69-B4C6-CF058E2623C4"></a><h4 id="DBSEG-GUID-7DE124D3-67E6-4A69-B4C6-CF058E2623C4" class="sect4">Why Users Should Only Have the Privileges of the Current Database Role</h4>
                  <div>
                     <p>A single user can use many applications and associated roles. </p>
                     <p>However, you should ensure that the user has only the privileges associated with the current database role. </p>
                     <p>Consider the following scenario:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>The <code class="codeph">ORDER</code> role (for an application called Order) contains the <code class="codeph">UPDATE</code> privilege for the <code class="codeph">INVENTORY</code> table.
                           </p>
                        </li>
                        <li>
                           <p>The <code class="codeph">INVENTORY</code> role (for an application called Inventory) contains the <code class="codeph">SELECT</code> privilege for the <code class="codeph">INVENTORY</code> table.
                           </p>
                        </li>
                        <li>
                           <p>Several order entry clerks were granted both the <code class="codeph">ORDER</code> and <code class="codeph">INVENTORY</code> roles.
                           </p>
                        </li>
                     </ul>
                     <p>In this scenario, an order entry clerk who was granted both roles can use the privileges of the <code class="codeph">ORDER</code> role when running the <code class="codeph">INVENTORY</code> application to update the <code class="codeph">INVENTORY</code> table. The problem is that updating the <code class="codeph">INVENTORY</code> table is not an authorized action for the <code class="codeph">INVENTORY</code> application. It is an authorized action for the <code class="codeph">ORDER</code> application. To avoid this problem, use the <code class="codeph">SET</code> <code class="codeph">ROLE</code> statement as explained in the following section. 
                     </p>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-1FE77DE6-8950-493C-B10F-13E1A1A33155" title="Ensure that users have only the privileges associated with the current database role.">Association of Privileges with User Database Roles</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG150"></a><div class="props_rev_3"><a id="GUID-D9D4B3DB-DD1E-4BCE-BC9B-86968AD1CEC6" name="GUID-D9D4B3DB-DD1E-4BCE-BC9B-86968AD1CEC6"></a><h4 id="DBSEG-GUID-D9D4B3DB-DD1E-4BCE-BC9B-86968AD1CEC6" class="sect4">Use of the SET ROLE Statement to Automatically Enable or Disable Roles</h4>
                  <div>
                     <p>You can use a <code class="codeph">SET</code> <code class="codeph">ROLE</code> statement at the beginning of each application to automatically enable its associated role and to disable all others.
                     </p>
                     <p>This way, each application dynamically enables particular privileges for a user only when required. The <code class="codeph">SET</code> <code class="codeph">ROLE</code> statement simplifies privilege management. You control what information users can access and when they can access it. The <code class="codeph">SET</code> <code class="codeph">ROLE</code> statement also keeps users operating in a well-defined privilege domain. If a user obtains privileges only from roles, then the user cannot combine these privileges to perform unauthorized operations.
                     </p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="configuring-privilege-and-role-authorization.html#GUID-DAE35DE7-E9AE-4FB5-BD0B-BC0B206F8782" title="Privilege grants and the SET ROLE statement affect when and how grants and revokes take place.">How Grants and Revokes Work with SET ROLE and Default Role Settings</a></li>
                           <li><a href="configuring-privilege-and-role-authorization.html#GUID-1193F744-B6D7-40DF-AF11-00DBF50E72B7" title="Depending on the privilege that is granted or revoked, a grant or revoke takes effect at different times.">When Grants and Revokes Take Effect</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-1FE77DE6-8950-493C-B10F-13E1A1A33155" title="Ensure that users have only the privileges associated with the current database role.">Association of Privileges with User Database Roles</a></p>
                        </div>
                     </div>
                  </div>
               </div>
            </div><a id="DBSEG151"></a><div class="props_rev_3"><a id="GUID-7B5B46D4-7547-421C-930E-A0C375B60F6D" name="GUID-7B5B46D4-7547-421C-930E-A0C375B60F6D"></a><h3 id="DBSEG-GUID-7B5B46D4-7547-421C-930E-A0C375B60F6D" class="sect3">Protecting Database Objects by Using Schemas</h3>
               <div>
                  <p>A schema is a security domain that can contain database objects. Privileges granted to users and roles control access to these database objects. </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-C3B77A98-D37A-4375-AD73-A3D34A7DB47E">Protecting Database Objects in a Unique Schema</a><br>Think of most schemas as user names: the accounts that enable users to connect to a database and access the database objects. 
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-FE6286D8-6449-4591-984D-494C9EBD3562">Protection of Database Objects in a Shared Schema</a><br>For many applications, users only need access to an application schema; they do not need their own accounts or schemas in the database. 
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-245AF418-2349-4657-9010-8C8D7849FD05" title="A security policy for application developers should encompass areas such as password management and securing external procedures and application privileges.">Managing Security for Application&nbsp;Developers</a></p>
                     </div>
                  </div>
               </div>
               <a id="DBSEG152"></a><div class="props_rev_3"><a id="GUID-C3B77A98-D37A-4375-AD73-A3D34A7DB47E" name="GUID-C3B77A98-D37A-4375-AD73-A3D34A7DB47E"></a><h4 id="DBSEG-GUID-C3B77A98-D37A-4375-AD73-A3D34A7DB47E" class="sect4">Protecting Database Objects in a Unique Schema</h4>
                  <div>
                     <p>Think of most schemas as user names: the accounts that enable users to connect to a database and access the database objects. </p>
                     <div class="section">
                        <p>However, a <span class="italic">unique schema</span> does not allow connections to the database, but is used to contain a related set of objects. Schemas of this sort are created as typical users, and yet are not granted the <code class="codeph">CREATE</code> <code class="codeph">SESSION</code> system privilege (either explicitly or through a role). 
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>To protect the objects, temporarily grant the <code class="codeph">CREATE</code> <code class="codeph">SESSION</code> and <code class="codeph">RESOURCE</code> privilege to a unique schema if you want to use the <code class="codeph">CREATE</code> <code class="codeph">SCHEMA</code> statement to create multiple tables and views in a single transaction.
                              </p>
                           </li>
                        </ul>
                        <p>For example, a given schema might own the schema objects for a specific application. If application users have the privileges to do so, then they can connect to the database using typical database user names and use the application and the corresponding objects. However, no user can connect to the database using the schema set up for the application. This configuration prevents access to the associated objects through the schema, and provides another layer of protection for schema objects. In this case, the application could issue an <code class="codeph">ALTER SESSION SET CURRENT_SCHEMA</code> statement to connect the user to the correct application schema.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-7B5B46D4-7547-421C-930E-A0C375B60F6D" title="A schema is a security domain that can contain database objects. Privileges granted to users and roles control access to these database objects.">Protecting Database Objects by Using Schemas</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG153"></a><div class="props_rev_3"><a id="GUID-FE6286D8-6449-4591-984D-494C9EBD3562" name="GUID-FE6286D8-6449-4591-984D-494C9EBD3562"></a><h4 id="DBSEG-GUID-FE6286D8-6449-4591-984D-494C9EBD3562" class="sect4">Protection of Database Objects in a Shared Schema</h4>
                  <div>
                     <p>For many applications, users only need access to an application schema; they do not need their own accounts or schemas in the database. </p>
                     <p>For example, users John, Firuzeh, and Jane are all users of the Payroll application, and they need access to the <code class="codeph">payroll</code> schema on the <code class="codeph">finance</code> database. None of them need to create their own objects in the database. They need to only access the <code class="codeph">payroll</code> objects. To address this issue, Oracle Database provides the enterprise users, which are schema-independent users.
                     </p>
                     <p>Enterprise users, users managed in a directory service, do not need to be created as database users because they use a shared database schema. To reduce administration costs, you can create an enterprise user once in the directory, and point the user at a shared schema that many other enterprise users can also access. </p>
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-FE6286D8-6449-4591-984D-494C9EBD3562__GUID-6B8F7339-3FB1-44F0-A453-29DA9F9E54BB">
                        <p class="notep1">See Also:</p>
                        <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/dbseg&amp;id=DBIMI152" target="_blank"><span><cite>Oracle Database Enterprise User Security Administrator's Guide</cite></span></a> for more information about managing enterprise users
                        </p>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-7B5B46D4-7547-421C-930E-A0C375B60F6D" title="A schema is a security domain that can contain database objects. Privileges granted to users and roles control access to these database objects.">Protecting Database Objects by Using Schemas</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="DBSEG154"></a><div class="props_rev_3"><a id="GUID-B6289F9C-B043-410B-A586-50A996F055B4" name="GUID-B6289F9C-B043-410B-A586-50A996F055B4"></a><h3 id="DBSEG-GUID-B6289F9C-B043-410B-A586-50A996F055B4" class="sect3">Object Privileges in an Application</h3>
               <div>
                  <p>When you design an application, consider the types of users and the level access they need.</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-65467219-D4AE-427D-A807-D8CC68B4FF08">What Application Developers Must Know About Object Privileges</a><br>Object privileges enable end users to perform actions on objects such as tables, views, sequences, procedures, functions, or packages.
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-0424B3DB-93CE-470E-9FBD-6A652DF0F9CB">SQL Statements Permitted by Object Privileges</a><br>As you implement and test your application, you should create each necessary role.
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-245AF418-2349-4657-9010-8C8D7849FD05" title="A security policy for application developers should encompass areas such as password management and securing external procedures and application privileges.">Managing Security for Application&nbsp;Developers</a></p>
                     </div>
                  </div>
               </div>
               <a id="DBSEG156"></a><a id="DBSEG155"></a><div class="props_rev_3"><a id="GUID-65467219-D4AE-427D-A807-D8CC68B4FF08" name="GUID-65467219-D4AE-427D-A807-D8CC68B4FF08"></a><h4 id="DBSEG-GUID-65467219-D4AE-427D-A807-D8CC68B4FF08" class="sect4">What Application Developers Must Know About Object Privileges</h4>
                  <div>
                     <p>Object privileges enable end users to perform actions on objects such as tables, views, sequences, procedures, functions, or packages.</p>
                     <p><a href="managing-security-for-application-developers.html#GUID-65467219-D4AE-427D-A807-D8CC68B4FF08__G1009122" title="This table lists how object privileges (ALTER, DELETE, EXECUTE, INDEX, INSERT, REFERENCES, SELECT, and UPDATE) apply to tables, views, sequences, and procedures.">Table 10-3</a> summarizes the object privileges available for each type of object.
                     </p>
                     <div class="tblformal" id="GUID-65467219-D4AE-427D-A807-D8CC68B4FF08__G1009122">
                        <p class="titleintable">Table 10-3 How Privileges Relate to Schema Objects</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="How Privileges Relate to Schema Objects" summary="This table lists how object privileges (ALTER, DELETE, EXECUTE, INDEX, INSERT, REFERENCES, SELECT, and UPDATE) apply to tables, views, sequences, and procedures." width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="24%" id="d78229e6709">Object Privilege</th>
                                 <th align="left" valign="bottom" width="15%" id="d78229e6712">Applies to Table?</th>
                                 <th align="left" valign="bottom" width="14%" id="d78229e6715">Applies to View?</th>
                                 <th align="left" valign="bottom" width="21%" id="d78229e6718">Applies to Sequence?</th>
                                 <th align="left" valign="bottom" width="26%" id="d78229e6721">Applies to Procedure?(4)</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="24%" id="d78229e6729" headers="d78229e6709 ">
                                    <p><code class="codeph">ALTER</code></p>
                                 </td>
                                 <td align="left" valign="top" width="15%" headers="d78229e6729 d78229e6712 ">
                                    <p>Yes</p>
                                 </td>
                                 <td align="left" valign="top" width="14%" headers="d78229e6729 d78229e6715 ">
                                    <p>No</p>
                                 </td>
                                 <td align="left" valign="top" width="21%" headers="d78229e6729 d78229e6718 ">
                                    <p> Yes</p>
                                 </td>
                                 <td align="left" valign="top" width="26%" headers="d78229e6729 d78229e6721 ">
                                    <p>No</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="24%" id="d78229e6746" headers="d78229e6709 ">
                                    <p><code class="codeph">DELETE</code></p>
                                 </td>
                                 <td align="left" valign="top" width="15%" headers="d78229e6746 d78229e6712 ">
                                    <p>Yes</p>
                                 </td>
                                 <td align="left" valign="top" width="14%" headers="d78229e6746 d78229e6715 ">
                                    <p>Yes</p>
                                 </td>
                                 <td align="left" valign="top" width="21%" headers="d78229e6746 d78229e6718 ">
                                    <p>No</p>
                                 </td>
                                 <td align="left" valign="top" width="26%" headers="d78229e6746 d78229e6721 ">
                                    <p>No</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="24%" id="d78229e6763" headers="d78229e6709 ">
                                    <p><code class="codeph">EXECUTE</code></p>
                                 </td>
                                 <td align="left" valign="top" width="15%" headers="d78229e6763 d78229e6712 ">
                                    <p>No</p>
                                 </td>
                                 <td align="left" valign="top" width="14%" headers="d78229e6763 d78229e6715 ">
                                    <p>No</p>
                                 </td>
                                 <td align="left" valign="top" width="21%" headers="d78229e6763 d78229e6718 ">
                                    <p>No</p>
                                 </td>
                                 <td align="left" valign="top" width="26%" headers="d78229e6763 d78229e6721 ">
                                    <p>Yes</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="24%" id="d78229e6780" headers="d78229e6709 ">
                                    <p><code class="codeph">INDEX</code></p>
                                 </td>
                                 <td align="left" valign="top" width="15%" headers="d78229e6780 d78229e6712 ">
                                    <p id="GUID-65467219-D4AE-427D-A807-D8CC68B4FF08__G1010358">Yes<a id="fn_5" name="fn_5" href="#fn_5" onclick="footdisplay(5, "Privilege that cannot be granted to a role")"><sup>Foot&nbsp;5</sup></a></p>
                                 </td>
                                 <td align="left" valign="top" width="14%" headers="d78229e6780 d78229e6715 ">
                                    <p>No</p>
                                 </td>
                                 <td align="left" valign="top" width="21%" headers="d78229e6780 d78229e6718 ">
                                    <p>No</p>
                                 </td>
                                 <td align="left" valign="top" width="26%" headers="d78229e6780 d78229e6721 ">
                                    <p>No</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="24%" id="d78229e6800" headers="d78229e6709 ">
                                    <p><code class="codeph">INSERT</code></p>
                                 </td>
                                 <td align="left" valign="top" width="15%" headers="d78229e6800 d78229e6712 ">
                                    <p>Yes</p>
                                 </td>
                                 <td align="left" valign="top" width="14%" headers="d78229e6800 d78229e6715 ">
                                    <p>Yes</p>
                                 </td>
                                 <td align="left" valign="top" width="21%" headers="d78229e6800 d78229e6718 ">
                                    <p>No</p>
                                 </td>
                                 <td align="left" valign="top" width="26%" headers="d78229e6800 d78229e6721 ">
                                    <p>No</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="24%" id="d78229e6817" headers="d78229e6709 ">
                                    <p><code class="codeph">REFERENCES</code></p>
                                 </td>
                                 <td align="left" valign="top" width="15%" headers="d78229e6817 d78229e6712 ">
                                    <p>Yes<a href="managing-security-for-application-developers.html#GUID-65467219-D4AE-427D-A807-D8CC68B4FF08__G1010358">Yes(5)</a></p>
                                 </td>
                                 <td align="left" valign="top" width="14%" headers="d78229e6817 d78229e6715 ">
                                    <p>No</p>
                                 </td>
                                 <td align="left" valign="top" width="21%" headers="d78229e6817 d78229e6718 ">
                                    <p>No</p>
                                 </td>
                                 <td align="left" valign="top" width="26%" headers="d78229e6817 d78229e6721 ">
                                    <p>No</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="24%" id="d78229e6836" headers="d78229e6709 ">
                                    <p><code class="codeph">SELECT</code></p>
                                 </td>
                                 <td align="left" valign="top" width="15%" headers="d78229e6836 d78229e6712 ">
                                    <p>Yes</p>
                                 </td>
                                 <td align="left" valign="top" width="14%" headers="d78229e6836 d78229e6715 ">
                                    <p>Yes<a id="fn_6" name="fn_6" href="#fn_6" onclick="footdisplay(6, "Can also be granted for snapshots")"><sup>Foot&nbsp;6</sup></a></p>
                                 </td>
                                 <td align="left" valign="top" width="21%" headers="d78229e6836 d78229e6718 ">
                                    <p> Yes</p>
                                 </td>
                                 <td align="left" valign="top" width="26%" headers="d78229e6836 d78229e6721 ">
                                    <p>No</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="24%" id="d78229e6856" headers="d78229e6709 ">
                                    <p><code class="codeph">UPDATE</code></p>
                                 </td>
                                 <td align="left" valign="top" width="15%" headers="d78229e6856 d78229e6712 ">
                                    <p>Yes</p>
                                 </td>
                                 <td align="left" valign="top" width="14%" headers="d78229e6856 d78229e6715 ">
                                    <p>Yes</p>
                                 </td>
                                 <td align="left" valign="top" width="21%" headers="d78229e6856 d78229e6718 ">
                                    <p>No</p>
                                 </td>
                                 <td align="left" valign="top" width="26%" headers="d78229e6856 d78229e6721 ">
                                    <p>No</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p class="tablefootnote"><sup class="tablefootnote">Footnote&nbsp;4 </sup>Standalone stored procedures, functions, and public package constructs
                     </p>
                     <p class="tablefootnote"><sup class="tablefootnote">Footnote&nbsp;5 </sup></p><p>Privilege that cannot be granted to a role</p>
                     <p></p>
                     <p class="tablefootnote"><sup class="tablefootnote">Footnote&nbsp;6 </sup></p><p>Can also be granted for snapshots</p>
                     <p></p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="configuring-audit-policies.html#GUID-12B6375C-25F7-46A9-BA03-4714BFAC6056" title="You can use the CREATE AUDIT POLICY statement to audit object actions.">Auditing Object Actions</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-B6289F9C-B043-410B-A586-50A996F055B4" title="When you design an application, consider the types of users and the level access they need.">Object Privileges in an Application</a></p>
                        </div>
                     </div>
                  </div>
               </div><a id="DBSEG158"></a><a id="DBSEG157"></a><div class="props_rev_3"><a id="GUID-0424B3DB-93CE-470E-9FBD-6A652DF0F9CB" name="GUID-0424B3DB-93CE-470E-9FBD-6A652DF0F9CB"></a><h4 id="DBSEG-GUID-0424B3DB-93CE-470E-9FBD-6A652DF0F9CB" class="sect4">SQL Statements Permitted by Object Privileges</h4>
                  <div>
                     <p>As you implement and test your application, you should create each necessary role.</p>
                     <p>Test the usage scenario for each role to ensure that the users of your application will have proper access to the database. After completing your tests, coordinate with the administrator of the application to ensure that each user is assigned the proper roles.</p>
                     <p><a href="managing-security-for-application-developers.html#GUID-0424B3DB-93CE-470E-9FBD-6A652DF0F9CB__G1009180" title="This table lists the SQL statements that are permitted by the following database object privileges: ALTER, DELETE, EXECUTE, INDEX, INSERT, REFERENCES, and SELECT.">Table 10-4</a> lists the SQL statements permitted by the object privileges shown in <a href="managing-security-for-application-developers.html#GUID-65467219-D4AE-427D-A807-D8CC68B4FF08__G1009122" title="This table lists how object privileges (ALTER, DELETE, EXECUTE, INDEX, INSERT, REFERENCES, SELECT, and UPDATE) apply to tables, views, sequences, and procedures.">Table 10-3</a>. 
                     </p>
                     <div class="tblformal" id="GUID-0424B3DB-93CE-470E-9FBD-6A652DF0F9CB__G1009180">
                        <p class="titleintable">Table 10-4 SQL Statements Permitted by Database Object Privileges</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="SQL Statements Permitted by Database Object Privileges" summary="This table lists the SQL statements that are permitted by the following database object privileges: ALTER, DELETE, EXECUTE, INDEX, INSERT, REFERENCES, and SELECT." width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="31%" id="d78229e7044">Object Privilege</th>
                                 <th align="left" valign="bottom" width="69%" id="d78229e7047">SQL Statements Permitted</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d78229e7052" headers="d78229e7044 ">
                                    <p><code class="codeph">ALTER</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d78229e7052 d78229e7047 ">
                                    <p><code class="codeph">ALTER</code> object (table or sequence) 
                                    </p>
                                    <p><code class="codeph">CREATE</code> <code class="codeph">TRIGGER</code> <code class="codeph">ON</code> object (tables only)
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d78229e7072" headers="d78229e7044 ">
                                    <p><code class="codeph">DELETE</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d78229e7072 d78229e7047 ">
                                    <p><code class="codeph">DELETE</code> <code class="codeph">FROM</code> object (table, view, or synonym)
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d78229e7085" headers="d78229e7044 ">
                                    <p><code class="codeph">EXECUTE</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d78229e7085 d78229e7047 ">
                                    <p><code class="codeph">EXECUTE</code> object (procedure or function) 
                                    </p>
                                    <p>References to public package variables</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d78229e7097" headers="d78229e7044 ">
                                    <p><code class="codeph">INDEX</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d78229e7097 d78229e7047 ">
                                    <p><code class="codeph">CREATE</code> <code class="codeph">INDEX</code> <code class="codeph">ON</code> object (table, view, or synonym)
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d78229e7113" headers="d78229e7044 ">
                                    <p><code class="codeph">INSERT</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d78229e7113 d78229e7047 ">
                                    <p><code class="codeph">INSERT</code> <code class="codeph">INTO</code> object (table, view, or synonym)
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d78229e7126" headers="d78229e7044 ">
                                    <p><code class="codeph">REFERENCES</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d78229e7126 d78229e7047 ">
                                    <p><code class="codeph">CREATE</code> or <code class="codeph">ALTER</code> <code class="codeph">TABLE</code> statement defining a <code class="codeph">FOREIGN</code> <code class="codeph">KEY</code> integrity constraint on object (tables only)
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d78229e7148" headers="d78229e7044 ">
                                    <p><code class="codeph">SELECT</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d78229e7148 d78229e7047 ">
                                    <p><code class="codeph">SELECT</code>...<code class="codeph">FROM</code> object (table, view, synonym, or snapshot)
                                    </p>
                                    <p>SQL statements using a sequence</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="configuring-privilege-and-role-authorization.html#GUID-1D92E7C3-FA55-401F-98FA-86357D98C031" title="Authorization permits only certain users to access, process, or alter data; it also creates limitations on user access or actions.">About Privileges and Roles</a></li>
                           <li><a href="configuring-audit-policies.html#GUID-12B6375C-25F7-46A9-BA03-4714BFAC6056" title="You can use the CREATE AUDIT POLICY statement to audit object actions.">Auditing Object Actions</a></li>
                        </ul>
                     </div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-B6289F9C-B043-410B-A586-50A996F055B4" title="When you design an application, consider the types of users and the level access they need.">Object Privileges in an Application</a></p>
                        </div>
                     </div>
                  </div>
               </div>
            </div><a id="DBSEG0058"></a><div class="props_rev_3"><a id="GUID-98EEE057-D2F9-4D97-A5B9-0295F5423E03" name="GUID-98EEE057-D2F9-4D97-A5B9-0295F5423E03"></a><h3 id="DBSEG-GUID-98EEE057-D2F9-4D97-A5B9-0295F5423E03" class="sect3">Parameters for Enhanced Security of Database Communication</h3>
               <div>
                  <p>Parameters can be used to manage security, such as handling bad packets from protocol errors or configuring the maximum number of authentication errors.</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-682F7371-8760-438A-A3F6-BA1A1640E514">Bad Packets Received on the Database from Protocol Errors</a><br>The <code class="codeph">SEC_PROTOCOL_ERROR_TRACE_ACTION</code> initialization parameter controls how trace files are managed when protocol errors are generated.
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-FB898BD6-9F21-4BD7-8EA7-9EABBEB5146F">Controlling Server Execution After Receiving a Bad Packet</a><br>The <code class="codeph">SEC_PROTOCOL_ERROR_FURTHER_ACTION</code> initialization parameter controls server execution after the server receives a bad packet.
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-994A09FB-7D7A-44BC-9757-EAA6232CC3BA">Configuration of the Maximum Number of Authentication Attempts</a><br>The <code class="codeph">SEC_MAX_FAILED_LOGIN_ATTEMPTS</code> initialization parameter sets the number of authentication attempts before the database will drop a failed connection.
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-414D9E66-F458-4C81-AC8D-CCA251396970">Configuring the Display of the Database Version Banner</a><br>The <code class="codeph">SEC_RETURN_SERVER_RELEASE_BANNER</code> initialization parameter can be used to prevent the display of detailed product information during authentication. 
                     </li>
                     <li class="ulchildlink"><a href="managing-security-for-application-developers.html#GUID-DF21EC92-B86A-4431-852B-CF37F75AF26F">Configuring Banners for Unauthorized Access and Auditing User Actions</a><br>The <code class="codeph">SEC_USER_UNAUTHORIZED_ACCESS_BANNER</code> and <code class="codeph">SEC_USER_AUDIT_ACTION_BANNER</code> initialization parameters control the display of banners for unauthorized access and for auditing users.
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-245AF418-2349-4657-9010-8C8D7849FD05" title="A security policy for application developers should encompass areas such as password management and securing external procedures and application privileges.">Managing Security for Application&nbsp;Developers</a></p>
                     </div>
                  </div>
               </div>
               <a id="DBSEG159"></a><div class="props_rev_3"><a id="GUID-682F7371-8760-438A-A3F6-BA1A1640E514" name="GUID-682F7371-8760-438A-A3F6-BA1A1640E514"></a><h4 id="DBSEG-GUID-682F7371-8760-438A-A3F6-BA1A1640E514" class="sect4">Bad Packets Received on the Database from Protocol Errors</h4>
                  <div>
                     <p>The <code class="codeph">SEC_PROTOCOL_ERROR_TRACE_ACTION</code> initialization parameter controls how trace files are managed when protocol errors are generated.
                     </p>
                     <p>Networking communication utilities such as Oracle Call Interface (OCI) or Two-Task Common (TTC) can generate a large disk file containing the stack trace and heap dump when the server receives a bad packet, out-of-sequence packet, or a private or an unused remote procedure call.</p>
                     <p>Typically, this disk file can grow quite large. An intruder can potentially cripple a system by repeatedly sending bad packets to the server, which can result in disk flooding and Denial of Service (DOS) attacks. An unauthenticated client can also mount this type of attack. </p>
                     <p>You can prevent these attacks by setting the <code class="codeph">SEC_PROTOCOL_ERROR_TRACE_ACTION</code> initialization parameter to one of the following values: 
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><code class="codeph">None</code>: Configures the server to ignore the bad packets and does not generate any trace files or log messages. Use this setting if the server availability is overwhelmingly more important than knowing that bad packets are being received. 
                           </p>
                           <p>For example: </p><pre class="oac_no_warn" dir="ltr">SEC_PROTOCOL_ERROR_TRACE_ACTION = None
</pre></li>
                        <li>
                           <p><code class="codeph">Trace</code> (default setting): Creates the trace files, but it is useful for debugging purposes, for example, when a network client is sending bad packets as a result of a bug. 
                           </p>
                           <p>For example: </p><pre class="oac_no_warn" dir="ltr">SEC_PROTOCOL_ERROR_TRACE_ACTION = Trace
</pre></li>
                        <li>
                           <p><code class="codeph">Log</code>: Writes a short, one-line message to the server trace file. This choice balances some level of auditing with system availability. 
                           </p>
                           <p>For example:</p><pre class="oac_no_warn" dir="ltr">SEC_PROTOCOL_ERROR_TRACE_ACTION = Log
</pre></li>
                        <li>
                           <p><code class="codeph">Alert</code>: Sends an alert message to a database administrator or monitoring console.
                           </p>
                           <p>For example: </p><pre class="oac_no_warn" dir="ltr">SEC_PROTOCOL_ERROR_TRACE_ACTION = Alert</pre></li>
                     </ul>
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-98EEE057-D2F9-4D97-A5B9-0295F5423E03" title="Parameters can be used to manage security, such as handling bad packets from protocol errors or configuring the maximum number of authentication errors.">Parameters for Enhanced Security of Database Communication</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG160"></a><div class="props_rev_3"><a id="GUID-FB898BD6-9F21-4BD7-8EA7-9EABBEB5146F" name="GUID-FB898BD6-9F21-4BD7-8EA7-9EABBEB5146F"></a><h4 id="DBSEG-GUID-FB898BD6-9F21-4BD7-8EA7-9EABBEB5146F" class="sect4">Controlling Server Execution After Receiving a Bad Packet</h4>
                  <div>
                     <p>The <code class="codeph">SEC_PROTOCOL_ERROR_FURTHER_ACTION</code> initialization parameter controls server execution after the server receives a bad packet.
                     </p>
                     <div class="section">After Oracle Database detects a client or server protocol error, it must continue execution. However, this could subject the server to further bad packets, which could lead to disk flooding or denial-of-service attacks. </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>To control the further execution of a server process when it is receiving bad packets from a potentially malicious client, set the <code class="codeph">SEC_PROTOCOL_ERROR_FURTHER_ACTION</code> initialization parameter to one of the following values: 
                              </p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><code class="codeph">Continue</code>: Continues the server execution. However, be aware that the server may be subject to further attacks. 
                                    </p>
                                    <p>For example: </p><pre class="oac_no_warn" dir="ltr">SEC_PROTOCOL_ERROR_FURTHER_ACTION = Continue
</pre></li>
                                 <li>
                                    <p><code class="codeph">(Delay,</code><span class="italic"><code class="codeph">m</code></span><code class="codeph">)</code>: Delays the client <span class="italic"><code class="codeph">m</code></span> seconds before the server can accept the next request from the same client connection. This setting prevents malicious clients from excessively using server resources while legitimate clients experience a degradation in performance but can continue to function. When you enter this setting, enclose it in parentheses.
                                    </p>
                                    <p>For example: </p><pre class="oac_no_warn" dir="ltr">SEC_PROTOCOL_ERROR_FURTHER_ACTION = (Delay,3)</pre><p>If you are setting <code class="codeph">SEC_PROTOCOL_ERROR_FURTHER_ACTION</code> by using the <code class="codeph">ALTER SYSTEM</code> or <code class="codeph">ALTER SESSION</code> SQL statement, then you must enclose the <code class="codeph">Delay</code> setting in either single or double quotation marks.
                                    </p><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM SEC_PROTOCOL_ERROR_FURTHER_ACTION = '(Delay,3)';</pre></li>
                                 <li>
                                    <p><code class="codeph">(Drop,</code><span class="italic"><code class="codeph">n</code></span><code class="codeph">)</code>: Forcefully terminates the client connection after <span class="italic"><code class="codeph">n</code></span> bad packets. This setting enables the server to protect itself at the expense of the client, for example, loss of a transaction. However, the client can still reconnect, and attempt the same operation again. Enclose this setting in parentheses. The default value of <code class="codeph">SEC_PROTOCOL_ERROR_FURTHER_ACTION</code> is <code class="codeph">(Drop,3)</code>.
                                    </p>
                                    <p>For example:</p><pre class="oac_no_warn" dir="ltr">SEC_PROTOCOL_ERROR_FURTHER_ACTION = (Drop,10)</pre><p>Similar to the <code class="codeph">Delay</code> setting, you must enclose the <code class="codeph">Drop</code> setting in single or double quotation marks if you are using <code class="codeph">ALTER SYSTEM</code> or <code class="codeph">ALTER SESSION</code> to change this setting.
                                    </p>
                                 </li>
                              </ul>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-98EEE057-D2F9-4D97-A5B9-0295F5423E03" title="Parameters can be used to manage security, such as handling bad packets from protocol errors or configuring the maximum number of authentication errors.">Parameters for Enhanced Security of Database Communication</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG161"></a><div class="props_rev_3"><a id="GUID-994A09FB-7D7A-44BC-9757-EAA6232CC3BA" name="GUID-994A09FB-7D7A-44BC-9757-EAA6232CC3BA"></a><h4 id="DBSEG-GUID-994A09FB-7D7A-44BC-9757-EAA6232CC3BA" class="sect4">Configuration of the Maximum Number of Authentication Attempts</h4>
                  <div>
                     <p>The <code class="codeph">SEC_MAX_FAILED_LOGIN_ATTEMPTS</code> initialization parameter sets the number of authentication attempts before the database will drop a failed connection.
                     </p>
                     <p>As part of connection creation, the listener starts the server process and attaches it to the client. Using this physical connection, the client is this able to authenticate the connection. After a server process starts, client authenticates with this server process. An intruder could start a server process, and then issue an unlimited number of authenticated requests with different user names and passwords in an attempt to gain access to the database. </p>
                     <p>You can limit the number of failed login attempts for application connections by setting the <code class="codeph">SEC_MAX_FAILED_LOGIN_ATTEMPTS</code> initialization parameter to restrict the number of authentication attempts on a connection. After the specified number of authentication attempts fail, the database process drops the connection and the server process is terminated. By default, <code class="codeph">SEC_MAX_FAILED_LOGIN_ATTEMPTS</code> is set to <code class="codeph">3</code>.
                     </p>
                     <p>Remember that the <code class="codeph">SEC_MAX_FAILED_LOGIN_ATTEMPTS</code> initialization parameter is designed to prevent potential intruders from attacking your applications, as well as valid users who have forgotten their passwords. The <code class="codeph">sqlnet.ora</code> <code class="codeph">INBOUND_CONNECT_TIMEOUT</code> parameter and the <code class="codeph">FAILED_LOGIN_ATTEMPTS</code> profile parameter also restrict failed logins, but the difference is that these two parameters only apply to valid user accounts. 
                     </p>
                     <p>For example, to limit the maximum attempts to 5, set <code class="codeph">SEC_MAX_FAILED_LOGIN_ATTEMPTS</code> as follows in the <code class="codeph">init</code><span class="italic"><code class="codeph">sid</code></span><code class="codeph">.ora</code> initialization parameter file: 
                     </p><pre class="oac_no_warn" dir="ltr">SEC_MAX_FAILED_LOGIN_ATTEMPTS = 5</pre></div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-98EEE057-D2F9-4D97-A5B9-0295F5423E03" title="Parameters can be used to manage security, such as handling bad packets from protocol errors or configuring the maximum number of authentication errors.">Parameters for Enhanced Security of Database Communication</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG162"></a><div class="props_rev_3"><a id="GUID-414D9E66-F458-4C81-AC8D-CCA251396970" name="GUID-414D9E66-F458-4C81-AC8D-CCA251396970"></a><h4 id="DBSEG-GUID-414D9E66-F458-4C81-AC8D-CCA251396970" class="sect4">Configuring the Display of the Database Version Banner</h4>
                  <div>
                     <p>The <code class="codeph">SEC_RETURN_SERVER_RELEASE_BANNER</code> initialization parameter can be used to prevent the display of detailed product information during authentication. 
                     </p>
                     <div class="section">
                        <p>Detailed product version information should not be accessible before a client connection (including an Oracle Call Interface client) is authenticated. An intruder could use the database version to find information about security vulnerabilities that may be present in the database software. </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>To restrict the display of the database version banner to unauthenticated clients, set the <code class="codeph">SEC_RETURN_SERVER_RELEASE_BANNER</code> initialization parameter in the <code class="codeph">init</code><span class="italic"><code class="codeph">sid</code></span><code class="codeph">.ora</code> initialization parameter file to either <code class="codeph">TRUE</code> or <code class="codeph">FALSE</code>. 
                              </p>
                              <p>By default, <code class="codeph">SEC_RETURN_SERVER_RELEASE_BANNER</code> is set to <code class="codeph">FALSE</code>. 
                              </p>
                           </li>
                        </ul>
                        <p>For example, if you set it to <code class="codeph">TRUE</code>, then Oracle Database displays the full correct database version. For example, for Release 19.1.0.0: 
                        </p><pre class="oac_no_warn" dir="ltr">Oracle Database 19c Enterprise Edition Release 19.1.0.0 - Production
</pre><p>If a release number uses point release notation (for example, Oracle Database Release 19.1.0.1), then the banner displays as follows:</p><pre class="oac_no_warn" dir="ltr">Oracle Database 19c Enterprise Edition Release 19.1.0.1 - Production
</pre><p>However, if in that same release, you set it to <code class="codeph">NO</code>, then Oracle Database restricts the banner to display the following fixed text starting with Release 19.1, which instead of 19.1.0.1 is 19.1.0.0.0: 
                        </p><pre class="oac_no_warn" dir="ltr">Oracle Database 19c Release 19.1.0.0.0 - Production</pre></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-98EEE057-D2F9-4D97-A5B9-0295F5423E03" title="Parameters can be used to manage security, such as handling bad packets from protocol errors or configuring the maximum number of authentication errors.">Parameters for Enhanced Security of Database Communication</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="DBSEG163"></a><div class="props_rev_3"><a id="GUID-DF21EC92-B86A-4431-852B-CF37F75AF26F" name="GUID-DF21EC92-B86A-4431-852B-CF37F75AF26F"></a><h4 id="DBSEG-GUID-DF21EC92-B86A-4431-852B-CF37F75AF26F" class="sect4">Configuring Banners for Unauthorized Access and Auditing User Actions</h4>
                  <div>
                     <p>The <code class="codeph">SEC_USER_UNAUTHORIZED_ACCESS_BANNER</code> and <code class="codeph">SEC_USER_AUDIT_ACTION_BANNER</code> initialization parameters control the display of banners for unauthorized access and for auditing users.
                     </p>
                     <div class="section">
                        <p>You should create and configure banners to warn users against unauthorized access and possible auditing of user actions. The notices are available to the client application when it logs into the database. </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>To configure these banners to display, set the following <code class="codeph">sqlnet.ora</code> parameters on the database server side to point to a text file that contains the banner information: 
                              </p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><code class="codeph">SEC_USER_UNAUTHORIZED_ACCESS_BANNER</code>. For example: 
                                    </p><pre class="oac_no_warn" dir="ltr">SEC_USER_UNAUTHORIZED_ACCESS_BANNER = /opt/Oracle/12c/dbs/unauthaccess.txt
</pre></li>
                                 <li>
                                    <p><code class="codeph">SEC_USER_AUDIT_ACTION_BANNER</code>. For example: 
                                    </p><pre class="oac_no_warn" dir="ltr">SEC_USER_AUDIT_ACTION_BANNER = /opt/Oracle/12c/dbs/auditactions.txt
</pre></li>
                              </ul>
                           </li>
                        </ul>
                        <p>By default, these parameters are not set. In addition, be aware that there is a 512-byte limitation for the number of characters used for the banner text. </p>
                        <p>After you set these parameters, the Oracle Call Interface application must use the appropriate OCI APIs to retrieve these banners and present them to the end user. </p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="managing-security-for-application-developers.html#GUID-98EEE057-D2F9-4D97-A5B9-0295F5423E03" title="Parameters can be used to manage security, such as handling bad packets from protocol errors or configuring the maximum number of authentication errors.">Parameters for Enhanced Security of Database Communication</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
         </div>
      </article>
   </body>
</html>