<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="The default control of access to the Oracle Database semantic data store is at the model level: the owner of a model can grant select, delete, and insert privileges on the model to other users by granting appropriate privileges on the view named RDFM_<model_name&gt;. However, for applications with stringent security requirements, you can enforce a fine-grained access control mechanism by using the Oracle Label Security option of Oracle Database.">
      <meta name="description" content="The default control of access to the Oracle Database semantic data store is at the model level: the owner of a model can grant select, delete, and insert privileges on the model to other users by granting appropriate privileges on the view named RDFM_<model_name&gt;. However, for applications with stringent security requirements, you can enforce a fine-grained access control mechanism by using the Oracle Label Security option of Oracle Database.">
      <title>Fine-Grained Access Control for RDF Data</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="RDF Knowledge Graph Developer's Guide ">
      <meta property="og:description" content="The default control of access to the Oracle Database semantic data store is at the model level: the owner of a model can grant select, delete, and insert privileges on the model to other users by granting appropriate privileges on the view named RDFM_<model_name&gt;. However, for applications with stringent security requirements, you can enforce a fine-grained access control mechanism by using the Oracle Label Security option of Oracle Database.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="RDF Knowledge Graph Developer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="spatial-and-graph-rdf-knowledge-graph-developers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-10T10:56:26-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="2005, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E94798-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="semantic-indexing-documents.html" title="Previous" type="text/html">
      <link rel="next" href="rdf-suipport-for-apache-jena.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Spatial and Graph RDF Knowledge Graph Developer's Guide">
    <meta name="dcterms.isVersionOf" content="RDFRM">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="semantic-indexing-documents.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="rdf-suipport-for-apache-jena.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">RDF Knowledge Graph Developer's Guide </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="part-concept-usage.html" property="item" typeof="WebPage"><span property="name"> Conceptual and Usage Information </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Fine-Grained Access Control for RDF Data </li>
            </ol>
            <a id="GUID-7F7007CB-F6CA-4AD4-B30D-4AC9EF4DB8D8" name="GUID-7F7007CB-F6CA-4AD4-B30D-4AC9EF4DB8D8"></a><a id="RDFRM99956"></a><a id="RDFRM99941"></a>
            
            <h2 id="RDFRM-GUID-7F7007CB-F6CA-4AD4-B30D-4AC9EF4DB8D8" class="sect2"><span class="enumeration_chapter">5 </span>Fine-Grained Access Control for RDF Data 
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>The default control of access to the Oracle Database semantic data store is at the model level: the owner of a model can grant select, delete, and insert privileges on the model to other users by granting appropriate privileges on the view named RDFM_<span class="italic">&lt;model_name&gt;</span>. However, for applications with stringent security requirements, you can enforce a fine-grained access control mechanism by using the Oracle Label Security option of Oracle Database.
               </p>
               <p>Oracle Label Security (OLS) for RDF data allows sensitivity labels to be associated with individual triples stored in an RDF model. For each query, access to specific triples is granted by comparing their labels with the user's session labels. This triple-level security option provides a thin layer of RDF-specific capabilities on top of the Oracle Database native support for label security.</p>
               <p>For information about using OLS, see <a href="../olsag/index.html" target="_blank"><span class="italic">Oracle Label Security Administrator's Guide</span></a>. 
               </p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="fine-grained-access-control-rdf.html#GUID-3514B1AC-B47C-4AE6-A7A1-C2D57C22E4B7">Triple-Level Security</a><br>The triple-level security option provides a thin layer of RDF-specific capabilities on top of the Oracle Database native support for label security.
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>Parent topic:</strong> <a href="part-concept-usage.html#GUID-FC153F2D-D51D-4498-A6E1-30B80D540FD6">Conceptual and Usage Information</a></p>
                  </div>
               </div>
            </div>
            <a id="RDFRM232"></a><div class="props_rev_3"><a id="GUID-3514B1AC-B47C-4AE6-A7A1-C2D57C22E4B7" name="GUID-3514B1AC-B47C-4AE6-A7A1-C2D57C22E4B7"></a><h3 id="RDFRM-GUID-3514B1AC-B47C-4AE6-A7A1-C2D57C22E4B7" class="sect3"><span class="enumeration_section">5.1 </span>Triple-Level Security
               </h3>
               <div>
                  <p>The triple-level security option provides a thin layer of RDF-specific capabilities on top of the Oracle Database native support for label security.</p>
                  <p>To use triple-level security, specify <code class="codeph">SEM_RDFSA.TRIPLE_LEVEL_ONLY</code> as the <code class="codeph">rdfsa_options</code> parameter value when you execute the <a href="SEM_RDFSA-reference.html#GUID-FBF39A4D-A2AC-45B6-B81C-B5F09FD47454">SEM_RDFSA.APPLY_OLS_POLICY</a> procedure. For example:
                  </p><pre class="oac_no_warn" dir="ltr">EXECUTE sem_rdfsa.apply_ols_policy('defense', <span class="bold">SEM_RDFSA.TRIPLE_LEVEL_ONLY</span>, network_owner=&gt;'FGAC_ADMIN', network_name=&gt;'OLS_NET');</pre><p>Do not specify any of the other available parameters for the <a href="SEM_RDFSA-reference.html#GUID-FBF39A4D-A2AC-45B6-B81C-B5F09FD47454">SEM_RDFSA.APPLY_OLS_POLICY</a> procedure.
                  </p>
                  <p>When you use triple-level security, OLS is applied to each semantic model in the network. That is, label security is applied to the relevant internal tables and to all the application tables; there is no need to manually apply policies to the application tables of existing semantic models. However, if you need to create additional models after applying the OLS policy, you must use the <a href="SEM_OLS-reference.html#GUID-37AC9E4E-7B0E-4868-80ED-1897DC1BA1ED">SEM_OLS.APPLY_POLICY_TO_APP_TAB</a> procedure to apply OLS to the application table before creating the model. Similarly, if you have dropped a semantic model and you no longer need to protect the application table, you can use the <a href="SEM_OLS-reference.html#GUID-35FE7319-0165-452B-8D59-FD230F2937D6">SEM_OLS.REMOVE_POLICY_FROM_APP_TAB</a> procedure. (These procedures are described in <a href="SEM_OLS-reference.html#GUID-4A79F61D-9101-4291-980A-7D46A030116B" title="The SEM_OLS package contains subprograms (functions and procedures) related to triple-level security to RDF data, using Oracle Label Security (OLS)."> SEM_OLS Package Subprograms</a>.)
                  </p>
                  <p>With triple-level security, duplicate triples with different labels can be inserted in the semantic model. (Such duplicates are not allowed with resource-level security.) For example, assume that you have a triple with a very sensitive label, such as:</p><pre class="oac_no_warn" dir="ltr">(&lt;urn:X&gt;,&lt;urn:P&gt;,&lt;urn:Y&gt;, "TOPSECRET")
</pre><p>This does not prevent a low-privileged (<code class="codeph">UNCLASSIFIED</code>) user from inserting the triple <code class="codeph">(&lt;urn:X&gt;,&lt;urn:P&gt;,&lt;urn:Y&gt;, "UNCLASSIFIED")</code>. Because SPARQL and SEM_MATCH do not return label information, a query will return both rows (assuming the user has appropriate privileges), and it will not be easy to distinguish between the <code class="codeph">TOPSECRET</code> and <code class="codeph">UNCLASSIFIED</code> triples.
                  </p>
                  <p>To filter out such low-security triples when querying the semantic models, you can one or more the following options with SEM_MATCH:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><code class="codeph">POLICY_NAME</code> specifies the OLS policy name.
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">MIN_LABEL</code> specifies the minimum label for triples that are included in the query
                        </p>
                     </li>
                  </ul>
                  <p>In other words, every triple that contains a label that is strictly dominated by <code class="codeph">MIN_LABEL</code> is not included in the query. For example, to filter out the "UNCLASSIFIED" triple, you could use the following query (assuming the OLS policy name is <code class="codeph">DEFENSE</code> and that the query user has read privileges over <code class="codeph">UNCLASSIFIED</code> and <code class="codeph">TOPSECRET</code> triples):
                  </p><pre class="oac_no_warn" dir="ltr">SELECT s,p,y FROM table(sem_match('{?s ?p ?y}' , 
  sem_models(TEST'), null, null, null, null, 
  'MIN_LABEL=TOPSECRET POLICY_NAME=DEFENSE',
  null, null, ‘FGAC_ADMIN’, 'OLS_NET'));
</pre><p>Note that the filtering in the preceding example occurs in addition to the security checks performed by the native OLS software.</p>
                  <p>After a triple has been inserted, you can view and update the label information through the <code class="codeph">CTXT1</code> column in the application table for the semantic model (assuming that you have the <code class="codeph">WRITEUP</code> and <code class="codeph">WRITEDOWN</code> privileges to modify the labels).
                  </p>
                  <p>There are no restrictions on who can perform inference or bulk loading with triple-level security; all of the inferred or bulk loaded triples are inserted with the user's session row label. Note that you can change the session labels by using the SA_UTL package. (For more information about SA_UTL, see <a href="../olsag/oracle-label-security-pl-sql-packages.html#OLSAG072" target="_blank"><span class="italic">Oracle Label Security Administrator's Guide</span></a>.)
                  </p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="fine-grained-access-control-rdf.html#GUID-25AB7D8D-3691-405B-8785-B3F8DD459034">Fine-Grained Security for Inferred Data and Ladder-Based Inference (LBI)</a><br></li>
                     <li class="ulchildlink"><a href="fine-grained-access-control-rdf.html#GUID-B0E89A2D-1509-468E-ACD4-4534FF2E2C70">Extended Example: Applying OLS Triple-Level Security on Semantic Data</a><br></li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="fine-grained-access-control-rdf.html#GUID-7F7007CB-F6CA-4AD4-B30D-4AC9EF4DB8D8" title="The default control of access to the Oracle Database semantic data store is at the model level: the owner of a model can grant select, delete, and insert privileges on the model to other users by granting appropriate privileges on the view named RDFM_<model_name&gt;. However, for applications with stringent security requirements, you can enforce a fine-grained access control mechanism by using the Oracle Label Security option of Oracle Database.">Fine-Grained Access Control for RDF Data</a></p>
                     </div>
                  </div>
               </div>
               <a id="RDFRM453"></a><a id="RDFRM454"></a><a id="RDFRM452"></a><div class="props_rev_3"><a id="GUID-25AB7D8D-3691-405B-8785-B3F8DD459034" name="GUID-25AB7D8D-3691-405B-8785-B3F8DD459034"></a><h4 id="RDFRM-GUID-25AB7D8D-3691-405B-8785-B3F8DD459034" class="sect4"><span class="enumeration_section">5.1.1 </span>Fine-Grained Security for Inferred Data and Ladder-Based Inference (LBI)
                  </h4>
                  <div>
                     <p>When triple-level security is turned on for RDF data stored in Oracle Database, asserted facts are tagged with data labels to enforce mandatory access control. In addition, when a user invokes the forward-chaining based inference function through the <a href="SEM_APIS-reference.html#GUID-BF52CEC0-1BD9-4908-9EF1-F001B0527257">SEM_APIS.CREATE_ENTAILMENT</a> procedure, the newly inferred relationships will be tagged with the current row label (<code class="codeph">SA_UTL.NUMERIC_ROW_LABEL</code>).
                     </p>
                     <p>These newly inferred relationships are derived solely based on the information that the user is allowed to access. These relationships do, however, share the same data label. This is understandable because a <a href="SEM_APIS-reference.html#GUID-BF52CEC0-1BD9-4908-9EF1-F001B0527257">SEM_APIS.CREATE_ENTAILMENT</a> call can be viewed as a three-step process: read operation, followed by a logical inference computation, followed by a write operation. The read operation gathers information upon which inference computation is based, and it is restricted by access privileges, the user's label, and the data labels; the logical inference computation step is purely mathematical; and the final write of inferred information into the entailed graph is no different from the same user asserting some new facts (which happen to be calculated by the previous step).
                     </p>
                     <p>Having all inferred assertions tagged with a single label is sufficient if a user only owns a single label. It is, however, not fine-grained enough when there are multiple labels owned by the same user, which is a common situation in a multitenancy setup.</p>
                     <p>For example, assume a user sets its user label and data label as <code class="codeph">TopSecret</code>, invokes <a href="SEM_APIS-reference.html#GUID-BF52CEC0-1BD9-4908-9EF1-F001B0527257">SEM_APIS.CREATE_ENTAILMENT</a>, switches to a weaker label named <code class="codeph">Secret</code>, and finally performs a SPARQL query. The query will not be able to see any of those newly inferred relationships because they were all tagged with the <code class="codeph">TopSecret</code> label. However, if the user switches back to the <code class="codeph">TopSecret</code> label, now every single inferred relationship is visible. It is "all or nothing" (that is, all visible or nothing visible) as far as inferred relationships are concerned. 
                     </p>
                     <p>When multiple labels are available for use by a given user, you normally want to assign different labels to different inferred relationships. There are two ways to achieve this goal:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="fine-grained-access-control-rdf.html#GUID-25AB7D8D-3691-405B-8785-B3F8DD459034__CIHGHBBF">Invoking SEM_APIS.CREATE_ENTAILMENT Multiple Times</a></p>
                        </li>
                        <li>
                           <p><a href="fine-grained-access-control-rdf.html#GUID-25AB7D8D-3691-405B-8785-B3F8DD459034__CIHDBBBC">Using Ladder-Based Inference (LBI)</a></p>
                        </li>
                     </ul>
                     <p>Ladder-based inference, effective with Oracle Database 12<span class="italic">c</span> Release 1 (12.1), is probably the simpler and more convenient of the two approaches.
                     </p>
                     <div class="section" id="GUID-25AB7D8D-3691-405B-8785-B3F8DD459034__CIHGHBBF">
                        <p class="subhead3" id="GUID-25AB7D8D-3691-405B-8785-B3F8DD459034__GUID-74D8E2DC-0393-45FB-957A-4448F6F405C0">Invoking SEM_APIS.CREATE_ENTAILMENT Multiple Times</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>Assume a security policy named DEFENSE, a user named SCOTT, and a sequence of user labels Label1, Label2,..., Label<span class="italic">n</span> owned by SCOTT. The following call by SCOTT sets the label as Label1, runs the inference for the first time, and tags the newly inferred triples with Label1:
                        </p><pre class="oac_no_warn" dir="ltr">EXECUTE sa_utl.set_label('defense',char_to_label('defense','Label1'));
EXECUTE sa_utl.set_row_label('defense',char_to_label('defense','Label1'));
EXECUTE sem_apis.create_entailment('inf', sem_models('contracts'), sem_rulebases('owlprime'), SEM_APIS.REACH_CLOSURE, null,'',network_owner=&gt;'FGAC_ADMIN',network_name=&gt;'OLS_NET');
</pre><p>Now, SCOTT switches the label to Label2, runs the inference a second time, and tags the newly inferred triples with Label2. Obviously, if Label2 is dominated by Label1, then no new triples will be inferred because Label2 cannot see anything beyond what Label1 is allowed to see. If Label2 is not dominated by Label1, the read step of the inference process will probably see a different set of triples, and consequently the inference call can produce some new triples, which will in turn be tagged with Label2.</p>
                        <p>For the purpose of this example, assume the following condition holds true: for any 1 &lt;= <span class="italic">i</span> &lt;<span class="italic"> j </span>&lt;= <span class="italic">n</span>, Label<span class="italic">j</span> is not dominated by Label<span class="italic">i</span>.
                        </p><pre class="oac_no_warn" dir="ltr">EXECUTE sa_utl.set_label('defense',char_to_label('defense','Label2'));
EXECUTE sa_utl.set_row_label('defense',char_to_label('defense','Label2'));
EXECUTE sem_apis.create_entailment('inf', sem_models('contracts'), sem_rulebases('owlprime'), SEM_APIS.REACH_CLOSURE, null, 'ENTAIL_ANYWAY=T', network_owner=&gt;'FGAC_ADMIN', network_name=&gt;'OLS_NET');
</pre><p>SCOTT continues the preceding actions using the rest of the labels in the label sequence: Label1, Label2, ..., Label<span class="italic">n</span>. The last step will be as follows:
                        </p><pre class="oac_no_warn" dir="ltr">EXECUTE sa_utl.set_label('defense',char_to_label('defense','Labeln'));
EXECUTE sa_utl.set_row_label('defense',char_to_label('defense','Labeln'));
EXECUTE sem_apis.create_entailment('inf', sem_models('contracts'), sem_rulebases('owlprime'), SEM_APIS.REACH_CLOSURE, null, 'ENTAIL_ANYWAY=T', network_owner=&gt;'FGAC_ADMIN', network_name=&gt;'OLS_NET');
</pre><p>After all these actions are performed, the inference graph probably consists of triples tagged with various different labels.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section" id="GUID-25AB7D8D-3691-405B-8785-B3F8DD459034__CIHDBBBC">
                        <p class="subhead3" id="GUID-25AB7D8D-3691-405B-8785-B3F8DD459034__GUID-0185DBD6-98BA-47E7-AEF3-65ADED72E76E">Using Ladder-Based Inference (LBI)</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>Basically, ladder-based inference (LBI) wraps in one API call all the actions described in the <a href="fine-grained-access-control-rdf.html#GUID-25AB7D8D-3691-405B-8785-B3F8DD459034__CIHGHBBF">Invoking SEM_APIS.CREATE_ENTAILMENT Multiple Times</a> approach. Visually, those actions are like climbing up a ladder. When proceeding from one label to the next, more asserted facts become visible or accessible (assuming the new label is not dominated by any of the previous ones), and therefore new relationships can be inferred.
                        </p>
                        <p>The syntax to invoke LBI is shown in the following example. </p><pre class="oac_no_warn" dir="ltr">EXECUTE sem_apis.create_entailment('inf',
  sem_models('contracts'),
  sem_rulebases('owlprime'),
  SEM_APIS.REACH_CLOSURE,
  null,
  null,
  ols_ladder_inf_lbl_seq=&gt;'numericLabel1 numericLabel2 numericLabel3 numericLabel4',
  network_owner=&gt;'FGAC_ADMIN',
  network_name=&gt;'OLS_NET'
);
</pre><p>The parameter <code class="codeph">ols_ladder_inf_lbl_seq</code> specifies a sequence of labels. This sequence is provided as a list of numeric labels delimited by spaces. When using LBI, it is a good practice to arrange the sequence of labels so that weaker labels are put before stronger labels. This will reduce the size of the inferred graph. (If labels do not dominate each other, they can be specified in any order.)
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="fine-grained-access-control-rdf.html#GUID-3514B1AC-B47C-4AE6-A7A1-C2D57C22E4B7" title="The triple-level security option provides a thin layer of RDF-specific capabilities on top of the Oracle Database native support for label security.">Triple-Level Security</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="RDFRM412"></a><div class="props_rev_3"><a id="GUID-B0E89A2D-1509-468E-ACD4-4534FF2E2C70" name="GUID-B0E89A2D-1509-468E-ACD4-4534FF2E2C70"></a><h4 id="RDFRM-GUID-B0E89A2D-1509-468E-ACD4-4534FF2E2C70" class="sect4"><span class="enumeration_section">5.1.2 </span>Extended Example: Applying OLS Triple-Level Security on Semantic Data
                  </h4>
                  <div>
                     <p>This section presents an extended example illustrating how to apply OLS triple-level security to semantic data. It assumes that OLS has been configured and enabled. The examples are very simplified, and do not reflect recommended practices regarding user names and passwords.</p>
                     <p>Unless otherwise indicated, perform the steps while connected AS SYSDBA.</p>
                     <ol>
                        <li>
                           <p>Perform some necessary setup steps.</p>
                           <ol type="a">
                              <li>
                                 <p>As SYSDBA, create database users named A, B, and C.</p><pre class="oac_no_warn" dir="ltr">create user a identified by <span class="italic">&lt;password-for-a&gt;</span>;
grant connect, unlimited tablespace, resource to a;
create user b identified by <span class="italic">&lt;password-for-b&gt;</span>;
grant connect, unlimited tablespace, resource to b;
create user c identified by <span class="italic">&lt;password-for-c&gt;</span>;
grant connect, unlimited tablespace, resource to c;
</pre></li>
                              <li>
                                 <p>As SYSDBA, create a security administrator and grant privileges.</p><pre class="oac_no_warn" dir="ltr">CREATE USER fgac_admin identified by &lt;password-for-fgac_admin&gt;; 
GRANT connect, unlimited tablespace,resource to fgac_admin;

-- Needed to administer OLS on a shared schema-private network
GRANT execute on MDSYS.SEM_RDFSA to fgac_admin;
GRANT exempt access policy to fgac_admin;

-- Needed to administer an OLS policy
GRANT EXECUTE ON sa_components TO fgac_admin;
GRANT EXECUTE ON sa_user_admin TO fgac_admin;
GRANT EXECUTE ON sa_label_admin TO fgac_admin;
GRANT EXECUTE ON sa_policy_admin TO fgac_admin;
GRANT EXECUTE ON sa_sysdba to fgac_admin;
GRANT EXECUTE ON TO_LBAC_DATA_LABEL to fgac_admin;
GRANT lbac_dba to fgac_admin;
</pre></li>
                              <li>
                                 <p>Connect as SYSTEM and create a schema-private semantic network owned by the security administrator with sharing privileges.</p><pre class="oac_no_warn" dir="ltr">CONNECT system/&lt;password-for-system&gt;;
EXECUTE sem_apis.create_sem_network('tbs_3',network_owner=&gt;'FGAC_ADMIN',network_name=&gt;'OLS_NET');
EXECUTE sem_apis.grant_network_sharing_privs('FGAC_ADMIN');
</pre></li>
                              <li>
                                 <p>Connect as the security administrator and set up network sharing for users a, b, and c.</p><pre class="oac_no_warn" dir="ltr">CONNECT fgac_admin/&lt;password-for- fgac_admin&gt;;
EXECUTE sem_apis.enable_network_sharing(network_owner=&gt;'FGAC_ADMIN',network_name=&gt;'OLS_NET');
EXECUTE sem_apis.grant_network_access_privs(network_owner=&gt;'FGAC_ADMIN',network_name=&gt;'OLS_NET', network_user=&gt;'A');
EXECUTE sem_apis.grant_network_access_privs(network_owner=&gt;'FGAC_ADMIN',network_name=&gt;'OLS_NET', network_user=&gt;'B');
EXECUTE sem_apis.grant_network_access_privs(network_owner=&gt;'FGAC_ADMIN',network_name=&gt;'OLS_NET', network_user=&gt;'C');
</pre></li>
                              <li>
                                 <p>Connect as the security administrator and create a policy named defense.</p><pre class="oac_no_warn" dir="ltr">CONNECT fgac_admin/&lt;password-for-fgac_admin&gt;;
EXECUTE SA_SYSDBA.CREATE_POLICY('defense','ctxt1');
</pre></li>
                              <li>
                                 <p>Create three security levels (For simplicity, compartments and groups are omitted.)</p><pre class="oac_no_warn" dir="ltr">EXECUTE SA_COMPONENTS.CREATE_LEVEL('defense',3000,'TS','TOP SECRET');
EXECUTE SA_COMPONENTS.CREATE_LEVEL('defense',2000,'SE','SECRET');
EXECUTE SA_COMPONENTS.CREATE_LEVEL('defense',1000,'UN','UNCLASSIFIED');
</pre></li>
                              <li>
                                 <p>Create three labels.</p><pre class="oac_no_warn" dir="ltr">EXECUTE SA_LABEL_ADMIN.CREATE_LABEL('defense',1000,'UN');
EXECUTE SA_LABEL_ADMIN.CREATE_LABEL('defense',1500,'SE');
EXECUTE SA_LABEL_ADMIN.CREATE_LABEL('defense',3100,'TS');
</pre></li>
                              <li>
                                 <p>Assign labels and privileges.</p><pre class="oac_no_warn" dir="ltr">EXECUTE SA_USER_ADMIN.SET_USER_LABELS('defense','A','UN');
EXECUTE SA_USER_ADMIN.SET_USER_LABELS('defense','B','SE');
EXECUTE SA_USER_ADMIN.SET_USER_LABELS('defense','C','TS');
EXECUTE SA_USER_ADMIN.SET_USER_LABELS('defense','fgac_admin','TS');
EXECUTE SA_USER_ADMIN.SET_USER_PRIVS('defense','FGAC_ADMIN', 'full');
</pre></li>
                           </ol>
                        </li>
                        <li>
                           <p>Create a semantic model.</p>
                           <ol type="a">
                              <li>
                                 <p>Create a model and share it with some other users.</p><pre class="oac_no_warn" dir="ltr">CONNECT a/&lt;password-for-a&gt;
CREATE TABLE project_tpl (triple sdo_rdf_triple_s) compress for oltp;
EXECUTE sem_apis.create_sem_model('project', 'project_tpl', 'triple' ,network_owner=&gt;'FGAC_ADMIN',network_name=&gt;'OLS_NET');
GRANT select on fgac_admin.ols_net#rdfm_project to B;
GRANT select on fgac_admin.ols_net#rdfm_project to C;
GRANT select, insert, update, delete on project_tpl to B, C;
</pre></li>
                              <li>
                                 <p>Ensure that the bulk loading API can be executed.</p><pre class="oac_no_warn" dir="ltr">GRANT insert on project_tpl to fgac_admin;
</pre></li>
                           </ol>
                        </li>
                        <li>
                           <p>Apply the OLS policy for RDF.</p><pre class="oac_no_warn" dir="ltr">CONNECT fgac_admin/&lt;password-for-fgac_admin&gt;
BEGIN
  sem_rdfsa.apply_ols_policy('defense', sem_rdfsa.TRIPLE_LEVEL_ONLY,network_owner=&gt;'FGAC_ADMIN',network_name=&gt;'OLS_NET');
END;
/

/</pre><p>Note that the application table now has an extra column named CTXT1:</p><pre class="oac_no_warn" dir="ltr">CONNECT a/&lt;password-for-a&gt;
DESCRIBE project_tpl;
Name                                      Null?    Type
----------------------------------------- -------- --------------------------
 TRIPLE                                             PUBLIC.SDO_RDF_TRIPLE_S
 CTXT1                                              NUMBER(10)
</pre></li>
                        <li>
                           <p>Add data to the semantic model.</p><pre class="oac_no_warn" dir="ltr">-- User A uses incremental APIs to add semantic data
connect a/&lt;password-for-a&gt; 
INSERT INTO project_tpl(triple) values      (sdo_rdf_triple_s('project','&lt;urn:A&gt;','&lt;urn:hasManager&gt;','&lt;urn:B&gt;','FGAC_ADMIN','OLS_NET')); 
INSERT INTO project_tpl(triple) values      (sdo_rdf_triple_s('project','&lt;urn:B&gt;','&lt;urn:hasManager&gt;','&lt;urn:C&gt;','FGAC_ADMIN','OLS_NET'));
INSERT INTO project_tpl(triple) values       (sdo_rdf_triple_s('project','&lt;urn:A&gt;','&lt;urn:expenseReportAmount&gt;','"100"','FGAC_ADMIN','OLS_NET'));
INSERT INTO project_tpl(triple) values       (sdo_rdf_triple_s('project','&lt;urn:expenseReportAmount&gt;','rdfs:subPropertyOf','&lt;urn:projExp&gt;','FGAC_ADMIN','OLS_NET'));
COMMIT;


-- User B uses bulk API to add semantic data 
connect b/&lt;password-for-b&gt;
CREATE TABLE  project_stab(RDF$STC_GRAPH varchar2(4000),
RDF$STC_sub varchar2(4000),
RDF$STC_pred varchar2(4000),
RDF$STC_obj varchar2(4000)) compress;
GRANT select on project_stab to fgac_admin;

-- For simplicity, data types are omitted.
INSERT INTO project_stab values(null, '&lt;urn:B&gt;','&lt;urn:expenseReportAmount&gt;','"200"'); 
INSERT INTO project_stab values(null, '&lt;urn:proj1&gt;','&lt;urn:deadline&gt;','"2012-12-25"');
EXECUTE sem_apis.bulk_load_from_staging_table('project','b','project_stab' ,network_owner=&gt;'FGAC_ADMIN',network_name=&gt;'OLS_NET');

-- As User B, check the contents in the application table
 connect b/&lt;password-for-b&gt; 
SELECT * from a.project_tpl order by ctxt1;
 
SDO_RDF_TRIPLE_S(8.5963E+18, 7, 1.4711E+18, 2.0676E+18, 8.5963E+18)    1000
SDO_RDF_TRIPLE_S(5.1676E+18, 7, 8.5963E+18, 2.0676E+18, 5.1676E+18)    1000
SDO_RDF_TRIPLE_S(2.3688E+18, 7, 1.4711E+18, 4.6588E+18, 2.3688E+18)    1000
SDO_RDF_TRIPLE_S(7.6823E+18, 7, 4.6588E+18, 1.1911E+18, 7.6823E+18)    1000
SDO_RDF_TRIPLE_S(6.6322E+18, 7, 8.5963E+18, 4.6588E+18, 6.6322E+18)    1500
SDO_RDF_TRIPLE_S(8.4800E+18, 7, 6.2294E+18, 5.4118E+18, 8.4800E+18)    1500
 
6 rows selected.
SELECT count(1) from fgac_admin.ols_net#rdfm_project;
6
 
-- As User A, check the contents in the application table
-- As expected, A can only see 4 triples
SQL&gt; conn a/&lt;password&gt;
SQL&gt; select * from a.project_tpl order by ctxt1;
SDO_RDF_TRIPLE_S(8.5963E+18, 7, 1.4711E+18, 2.0676E+18, 8.5963E+18)    1000
 
SDO_RDF_TRIPLE_S(5.1676E+18, 7, 8.5963E+18, 2.0676E+18, 5.1676E+18)    1000
 
SDO_RDF_TRIPLE_S(2.3688E+18, 7, 1.4711E+18, 4.6588E+18, 2.3688E+18)    1000
 
SDO_RDF_TRIPLE_S(7.6823E+18, 7, 4.6588E+18, 1.1911E+18, 7.6823E+18)    1000
 
SQL&gt; select count(1) fromfgac_admin.ols_net#rdfm_project;
4
 
-- User C uses incremental APIs to add semantic data including 2 quads 
connect c/&lt;password-for-c&gt;
INSERT INTO a.project_tpl(triple) values      (sdo_rdf_triple_s('project','&lt;urn:C&gt;','&lt;urn:expenseReportAmount&gt;','"400"','FGAC_ADMIN','OLS_NET'));
INSERT INTO a.project_tpl(triple) values      (sdo_rdf_triple_s('project','&lt;urn:proj1&gt;','&lt;urn:hasBudget&gt;','"10000"','FGAC_ADMIN','OLS_NET'));
INSERT INTO a.project_tpl(triple) values      (sdo_rdf_triple_s('project:&lt;urn:proj2&gt;','&lt;urn:proj2&gt;','&lt;urn:hasBudget&gt;','"20000"','FGAC_ADMIN','OLS_NET'));
INSERT INTO a.project_tpl(triple) values      (sdo_rdf_triple_s('project:&lt;urn:proj2&gt;','&lt;urn:proj2&gt;','&lt;urn:dependsOn&gt;','&lt;urn:proj1&gt;','FGAC_ADMIN','OLS_NET'));
COMMIT;
</pre></li>
                        <li>
                           <p>Query the data as different users using the default label.</p><pre class="oac_no_warn" dir="ltr">-- Now as user A, B, C, execute the following query 
select lpad(nvl(g, ' '), 20) || ' ' || s || ' ' || p || ' ' || o from table(sem_match('select * where { graph ?g { ?s ?p ?o }}',
sem_models('project'),
null,
null,
null,
null,
'GRAPH_MATCH_UNNAMED=T',
null,
null,
'FGAC_ADMIN',
'OLS_NET'))
    order by g, s, p, o;
 
connect  a/&lt;password-for-a&gt;
-- Repeat the preceding query
SQL&gt; /
 
urn:A urn:expenseReportAmount 100
urn:A urn:hasManager urn:B
urn:B urn:hasManager urn:C
urn:expenseReportAmount http://www.w3.org/2000/01/rdf-schema#subPropertyOf urn:projExp
SQL&gt; connect  b/&lt;password-for-b&gt;
SQL&gt; /
 
urn:A urn:expenseReportAmount 100
urn:A urn:hasManager urn:B
urn:B urn:expenseReportAmount 200
urn:B urn:hasManager urn:C
urn:expenseReportAmount http://www.w3.org/2000/01/rdf-schema#subPropertyOf urn:projExp
urn:proj1 urn:deadline 2012-12-25
SQL&gt; connect  c/&lt;password-for-c&gt;
SQL&gt; /
 
urn:proj2 urn:proj2 urn:dependsOn urn:proj1
urn:proj2 urn:proj2 urn:hasBudget 20000
urn:A urn:expenseReportAmount 100
urn:A urn:hasManager urn:B
urn:B urn:expenseReportAmount 200
urn:B urn:hasManager urn:C
urn:C urn:expenseReportAmount 400
urn:expenseReportAmount http://www.w3.org/2000/01/rdf-schema#subPropertyOf urn:projExp
urn:proj1 urn:deadline 2012-12-25
urn:proj1 urn:hasBudget 10000
</pre><p>As expected, different users (with different labels) can see different sets of triples in the project RDF graph.</p>
                        </li>
                        <li>
                           <div class="p">Query the same data as user C using different labels.<pre class="oac_no_warn" dir="ltr">exec sa_utl.set_label('defense',char_to_label('defense','SE'));
exec sa_utl.set_row_label('defense',char_to_label('defense','SE'));
</pre></div>
                           <p>The same query used in the preceding step produces just 6 matches with label set to SE:</p><pre class="oac_no_warn" dir="ltr">urn:A urn:expenseReportAmount 100
urn:A urn:hasManager urn:B
urn:B urn:expenseReportAmount 200
urn:B urn:hasManager urn:C
urn:expenseReportAmount http://www.w3.org/2000/01/rdf-schema#subPropertyOf urn:projExp
urn:proj1 urn:deadline 2012-12-25

6 rows selected.
</pre><p>If user C picks the weakest label ("unclassified"), then user C sees even less</p><pre class="oac_no_warn" dir="ltr">exec sa_utl.set_label('defense',char_to_label('defense','UN'));
exec sa_utl.set_row_label('defense',char_to_label('defense','UN'));
</pre><p>The same query used in the preceding step produces just 4 matches:</p><pre class="oac_no_warn" dir="ltr">urn:A urn:expenseReportAmount 100
urn:A urn:hasManager urn:B
urn:B urn:hasManager urn:C
urn:expenseReportAmount http://www.w3.org/2000/01/rdf-schema#subPropertyOf urn:projExp
</pre><p>If user C wants to run the query only against triples/quads with data label that dominates "Secret":</p><pre class="oac_no_warn" dir="ltr">-- First set the label back
exec sa_utl.set_label('defense',char_to_label('defense','TS')); 
exec sa_utl.set_row_label('defense',char_to_label('defense','TS'));

select lpad(nvl(g, ' '), 20) || ' ' || s || ' ' || p || ' ' || o
from table(sem_match('select * where { graph ?g { ?s ?p ?o }}',
sem_models('project'),
null,
null,
null,
null,
'MIN_LABEL=SE POLICY_NAME=DEFENSE GRAPH_MATCH_UNNAMED=T',
null,
null,
'FGAC_ADMIN',
'OLS_NET'))
order by g, s, p, o;
</pre><p>The query response excludes those assertions made by user A:</p><pre class="oac_no_warn" dir="ltr">urn:proj2 urn:proj2 urn:dependsOn urn:proj1
urn:proj2 urn:proj2 urn:hasBudget 20000
urn:B urn:expenseReportAmount 200
urn:C urn:expenseReportAmount 400
urn:proj1 urn:deadline 2012-12-25
urn:proj1 urn:hasBudget 10000
 
6 rows selected.
</pre><p>The same query can be executed as User A. However, no matches are returned, as expected.</p>
                        </li>
                     </ol>
                     <p>You can delete semantic data when OLS is enabled for RDF. In the following example, assume that <a href="SEM_RDFSA-reference.html#GUID-FBF39A4D-A2AC-45B6-B81C-B5F09FD47454">SEM_RDFSA.APPLY_OLS_POLICY</a> has been executed successfully, and that the same user setup and label designs are used as in the preceding example.
                     </p><pre class="oac_no_warn" dir="ltr">-- First, create a test model as user A and grant access to users B and C
connect a/&lt;password-for-a&gt;
 
create table test_tpl (triple sdo_rdf_triple_s) compress for oltp;
grant select, insert, update, delete on test_tpl to B, C;
 
-- The following will fail with an error message
-- "Error while creating triggers: If OLS
-- is enabled,  you have to apply table policy
-- before creating an OLS-enabled model"
--
EXECUTE sem_apis.create_sem_model('test', 'test_tpl', 'triple',network_owner=&gt;'FGAC_ADMIN',network_name=&gt;'OLS_NET');

-- Grant select on the model view to users B and C
grant select on fgac_admin.ols_net#rdfm_test to B,C;

-- You need to run this API first
 
connect fgac_admin/&lt;password-for-fgac_admin&gt;
 
EXECUTE sem_ols.apply_policy_to_app_tab('defense', 'A', 'TEST_TPL',network_owner=&gt;'FGAC_ADMIN',network_name=&gt;'OLS_NET');

-- Now model creation (after OLS policy has been applied) can go through
connect a/&lt;password-for-a&gt;
EXECUTE sem_apis.create_sem_model('test', 'test_tpl', 'triple',network_owner=&gt;'FGAC_ADMIN',network_name=&gt;'OLS_NET');

-- Add a triple as User A
INSERT INTO test_tpl(triple) values
(sdo_rdf_triple_s('test','&lt;urn:A&gt;','&lt;urn:p&gt;','&lt;urn:B&gt;','FGAC_ADMIN','OLS_NET'));
COMMIT;
 
-- Add the same triple as User B
connect b/&lt;password-for-b&gt;
INSERT INTO a.test_tpl(triple) values
(sdo_rdf_triple_s('test','&lt;urn:A&gt;','&lt;urn:p&gt;','&lt;urn:B&gt;','FGAC_ADMIN','OLS_NET'));
COMMIT;

 
-- Now User B can see both triples in the application table as well as the model view
set numwidth 20
SELECT * from a.test_tpl;
 
SDO_RDF_TRIPLE_S(8596269297967065604, 19, 1471072612573670395, 28121856352072361
78, 8596269297967065604)
                1000
 
SDO_RDF_TRIPLE_S(8596269297967065604, 19, 1471072612573670395, 28121856352072361
78, 8596269297967065604)
                1500
 
SELECT count(1) from fgac_admin.ols_net#rdfm_test;
                   2
 
-- User A can only see one triple due to A's label assignment, as expected.
 
SELECT * from a.test_tpl;
 
SDO_RDF_TRIPLE_S(8596269297967065604, 19, 1471072612573670395, 28121856352072361
78, 8596269297967065604)
                1000
 
SELECT count(1) from fgac_admin.ols_net#rdfm_test;
                   1
 
 
-- User A issues a delete to remove A's assertions
SQL&gt; delete from a.test_tpl;
1 row deleted.
 
COMMIT;
Commit complete.
 
 
-- Now user A has no assertions left.
 
SELECT * from a.test_tpl;
no rows selected
 
SELECT count(1) from fgac_admin.ols_net#rdfm_test;
                   0
 
-- Note that the preceding delete does not affect the same assertion made by B.
connect b/&lt;password-for-b&gt;
SELECT * from a.test_tpl;
 
SDO_RDF_TRIPLE_S(8596269297967065604, 19, 1471072612573670395, 28121856352072361
78, 8596269297967065604)
                1500
 
SELECT count(1) from fgac_admin.ols_net#rdfm_test;
                   1
 
-- User B can remove this assertion using a DELETE statement.
-- The following DELETE statement uses the oracle_orardf_res2vid function
-- to narrow down the scope to triples with a particular subject.
DELETE FROM a.test_tpl app_tab
       where app_tab.triple.rdf_s_id =
             sem_apis.res2vid('FGAC_ADMIN.OLS_NET#RDF_VALUE$','&lt;urn:A&gt;');
 
1 row deleted.
</pre></div>
                  <div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="fine-grained-access-control-rdf.html#GUID-3514B1AC-B47C-4AE6-A7A1-C2D57C22E4B7" title="The triple-level security option provides a thin layer of RDF-specific capabilities on top of the Oracle Database native support for label security.">Triple-Level Security</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div>
         </div>
      </article>
   </body>
</html>