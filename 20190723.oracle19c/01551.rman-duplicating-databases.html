<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="This chapter describes how to use the DUPLICATE command to create an independently functioning database copy.">
      <meta name="description" content="This chapter describes how to use the DUPLICATE command to create an independently functioning database copy.">
      <title>Duplicating Databases</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Backup and Recovery User's Guide">
      <meta property="og:description" content="This chapter describes how to use the DUPLICATE command to create an independently functioning database copy.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Backup and Recovery User's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="database-backup-and-recovery-users-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-09T05:20:45-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="2003, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96241-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="part-transfering-data-rman.html" title="Previous" type="text/html">
      <link rel="next" href="rman-duplicating-databases-advanced.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Backup and Recovery User's Guide">
    <meta name="dcterms.isVersionOf" content="BRADV">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="part-transfering-data-rman.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="rman-duplicating-databases-advanced.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Backup and Recovery User's Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="part-transfering-data-rman.html" property="item" typeof="WebPage"><span property="name"> Transferring Data with RMAN</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Duplicating Databases</li>
            </ol>
            <a id="GUID-F31F9FCE-B610-49EB-B9DB-44B9AA4E838F" name="GUID-F31F9FCE-B610-49EB-B9DB-44B9AA4E838F"></a><a id="BRADV010"></a>
            
            <h2 id="BRADV-GUID-F31F9FCE-B610-49EB-B9DB-44B9AA4E838F" class="sect2"><span class="enumeration_chapter">25 </span>Duplicating Databases
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>This chapter describes how to use the <code class="codeph">DUPLICATE</code> command to create an independently functioning database copy.
               </p>
               <p>This chapter contains the following topics:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="rman-duplicating-databases.html#GUID-D8CFCA95-85F7-4824-B2CC-32C37A42F9FF" title="Database duplication is the use of the DUPLICATE command to copy all or a subset of the data in a source database. The duplicate database (the copied database) functions entirely independently from the source database (the database being copied).">Overview of RMAN Database Duplication</a></p>
                  </li>
                  <li>
                     <p><a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="Before duplicating a database, you must make some decisions about the duplication process.">Planning to Duplicate a Database</a></p>
                  </li>
                  <li>
                     <p><a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN uses an auxiliary instance to create the duplicate database. You must prepare the auxiliary instance before you begin the duplication.">Preparing the Auxiliary Instance</a></p>
                  </li>
                  <li>
                     <p><a href="rman-duplicating-databases.html#GUID-9AA25E86-888F-4E72-B0BC-E3849F39B76A" title="Use the DUPLICATE command to duplicate databases.You can duplicate specified tablespaces within a source database.The steps to duplicate an Oracle Real Application Clusters (Oracle RAC) database contain minor variations from the ones used to duplicate databases.The duplication process for a sparse database begins with an implicit restore and then completes duplicating the database containing sparse data files. The primary job of database duplication is performed by RMAN channels. Each channel corresponds to an Oracle Database server session that performs the duplication tasks. Depending on the duplication technique, RMAN uses either auxiliary channels or target channels.For backup-based duplication, the principal work of the duplication is performed by the auxiliary channels. An auxiliary channel corresponds to a server session on the auxiliary instance on the destination host. RMAN uses the channels to restore backups in the auxiliary instance.With active database duplication, you need not change your source database channel configuration or configure auxiliary channels. However, you may want to increase the parallelism setting of the source database disk channels so that RMAN copies files over the network in parallel.If RMAN is connected to the source database as TARGET, then the source database must be in a proper state for duplication. You must start the RMAN client and connect to the database instances as required by the chosen duplication technique. The RMAN client can be located on any host so long as it can connect to the necessary databases over the network.RMAN provides multiple options for duplicating databases by using the DUPLICATE command.">Duplicating a Database</a></p>
                  </li>
                  <li>
                     <p><a href="rman-duplicating-databases.html#GUID-D95D9275-5882-4D5B-846F-1A03304BC307" title="Use the DUPLICATE command to duplicate CDBs, one or more PDBs, sparse CDBs, and sparse PDBs. The steps to duplicate CDBs and PDBs are similar to those of duplicating non-CDBs with minor variations to the procedure for duplicating a non-CDB. This section describes how to duplicate CDBs and PDBs.">Duplicating CDBs and PDBs</a></p>
                  </li>
                  <li>
                     <p><a href="rman-duplicating-databases.html#GUID-4A9A4F04-0D65-4BC0-AE4B-EFBD453D017F" title="RMAN automatically optimizes a DUPLICATE command that is a repeat of a previously failed DUPLICATE command.">Restarting DUPLICATE After a Failure</a></p>
                  </li>
                  <li>
                     <p><a href="rman-duplicating-databases.html#GUID-EA6E8219-56BF-471C-AC5A-DFC55E760806" title="This section contains examples on duplicating databases by using different duplication techniques.">Examples: Duplicating Databases</a></p>
                  </li>
                  <li>
                     <p><a href="rman-duplicating-databases.html#GUID-D65799A8-0921-4DFE-B407-21715911DA21" title="This example shows how to use a script to automate the process of duplicating a target database.">Example: Script to Duplicate a Database Using Backup-based Duplication</a></p>
                  </li>
               </ul>
            </div>
            <div class="sect2"><a id="GUID-D8CFCA95-85F7-4824-B2CC-32C37A42F9FF" name="GUID-D8CFCA95-85F7-4824-B2CC-32C37A42F9FF"></a><h3 id="BRADV-GUID-D8CFCA95-85F7-4824-B2CC-32C37A42F9FF" class="sect3"><span class="enumeration_section">25.1 </span>Overview of RMAN Database Duplication
               </h3>
               <div>
                  <p>Database duplication is the use of the <code class="codeph">DUPLICATE</code> command to copy all or a subset of the data in a source database. The duplicate database (the copied database) functions entirely independently from the source database (the database being copied).
                  </p>
                  <p>This section contains the following topics:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-BBCD4E68-DC14-4D24-BE74-9BAE7684C6ED" title="A duplicate database is useful for a variety of purposes, most of which involve testing.">Purpose of Database Duplication</a></p>
                     </li>
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-3C3A10DE-A843-4F48-AB34-E6D0064FDE9F" title="You must understand some basic concepts before duplicating a database.">Basic Concepts of Database Duplication</a></p>
                     </li>
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-F700603C-44EF-422F-8770-E7AA5BE33C87" title="RMAN enables you to perform two main types of database duplication.">Types of Database Duplication</a></p>
                     </li>
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-DC0A075D-82E3-4EC9-9FCF-51DB99F3EA03" title="RMAN performs a set of automated steps to duplicate a database.">How RMAN Duplicates a Database</a></p>
                     </li>
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-0667FB47-1E7D-42E8-9342-7E1DE3FF150F" title="A duplicate database can include the same contents as the source database or only a subset of the tablespaces in the source database.">Contents of a Duplicate Database</a></p>
                     </li>
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-89053F52-4EAF-424E-B106-3ABFA076521C" title="RMAN creates the duplicate database on the specified destination host. The destination host can be the same as the source host or different.">About the Destination Host for Database Duplication</a></p>
                     </li>
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-102FF47A-63D1-45CA-8C9F-4257E16BCA52" title="Depending on the destination host used and your duplication scenario, the duplicate database files can either use the same names as the source database or different names. The database files include the data file, control files, online redo log files, and temp files.">About Duplicate Database File Names</a></p>
                     </li>
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-7154AD5C-A192-4502-B3AC-FCD6DB3CDEAD" title="You can use clauses in the DUPLICATE command to duplicate a database to a past point in time.">About Duplicating a Database to a Past Point-in-Time</a></p>
                     </li>
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="The prerequisites depend on the type of database duplication being performed. Some prerequisites are common to all types of duplication and others are specific to a particular type of duplication.">Prerequisites for Duplicating a Database</a></p>
                     </li>
                  </ul>
               </div>
               <div class="sect3"><a id="GUID-BBCD4E68-DC14-4D24-BE74-9BAE7684C6ED" name="GUID-BBCD4E68-DC14-4D24-BE74-9BAE7684C6ED"></a><h4 id="BRADV-GUID-BBCD4E68-DC14-4D24-BE74-9BAE7684C6ED" class="sect4"><span class="enumeration_section">25.1.1 </span>Purpose of Database Duplication
                  </h4>
                  <div>
                     <p>A duplicate database is useful for a variety of purposes, most of which involve testing. </p>
                     <p>You can perform the following tasks in a duplicate database:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Test backup and recovery procedures</p>
                           <p>For example, you can duplicate the production database on <code class="codeph">host1</code> to <code class="codeph">host2</code>, and then use the duplicate database on <code class="codeph">host2</code> to practice restoring and recovering this database while the production database on <code class="codeph">host1</code> operates as usual.
                           </p>
                        </li>
                        <li>
                           <p>Test an upgrade to a new release of Oracle Database</p>
                        </li>
                        <li>
                           <p>Test the effect of applications on database performance</p>
                        </li>
                        <li>
                           <p>Create a standby database</p>
                           <p></p>
                           <p>You can create a physical standby database or an Oracle Data Guard far sync instance. A standby database is a copy of the primary database that you update continually with archived redo log files from the primary database. If the primary database is inaccessible, then you can fail over to the standby database, which becomes the new primary database. A database copy, however, cannot be used in this way: it is not intended for failover scenarios and does <span class="italic">not</span> support the various standby recovery and failover options.
                           </p>
                        </li>
                        <li>
                           <p>Generate reports</p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-BBCD4E68-DC14-4D24-BE74-9BAE7684C6ED__GUID-823A74B2-F731-4C30-877B-37B5E205C80F">
                        <p class="notep1">See Also:</p>
                        <p><span class="italic"><a href="../sbydb/creating-data-guard-standby-database-using-RMAN.html#SBYDB-GUID-C713FD5C-3375-45E4-A78F-4063006DAC5B" target="_blank">Oracle Data Guards Concepts and Administration</a></span> to learn how to create a standby database with the <code class="codeph">DUPLICATE</code> command
                        </p>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-3C3A10DE-A843-4F48-AB34-E6D0064FDE9F" name="GUID-3C3A10DE-A843-4F48-AB34-E6D0064FDE9F"></a><h4 id="BRADV-GUID-3C3A10DE-A843-4F48-AB34-E6D0064FDE9F" class="sect4"><span class="enumeration_section">25.1.2 </span>Basic Concepts of Database Duplication
                  </h4>
                  <div>
                     <p>You must understand some basic concepts before duplicating a database.</p>
                     <p>The source host is the computer that hosts the source database. The <span class="bold">source database instance</span> is the instance that is associated with the source database.
                     </p>
                     <p>The destination host is the computer that hosts the duplicate database. The source host and destination host can be the same or different computers.</p>
                     <p>For the duplication process, the database instance that is associated with the duplicate database is called the auxiliary instance.</p>
                     <p>RMAN must perform database point-in-time recovery, even when no explicit point in time is provided for duplication. Point-in-time recovery is required because the online redo log files in the source database are not backed up and cannot be applied to the duplicate database. The farthest point of recovery of the duplicate database is the most recent redo log file archived by the source database.</p>
                     <p>RMAN assigns a new DBID to the duplicate database (except when a standby database is created, in which case the source DBID is retained). You can then register the duplicate database in the same recovery catalog as the source database.</p>
                     <p>If you copy a database with operating system utilities rather than the <code class="codeph">DUPLICATE</code> command, then the DBID of the copied database remains the same as the original database. To register the copied database in the same recovery catalog with the original, you must change the DBID with the DBNEWID utility.
                     </p>
                     <div class="infoboxnotealso" id="GUID-3C3A10DE-A843-4F48-AB34-E6D0064FDE9F__GUID-B3C40074-07E7-4A7D-9CD8-2AF364040EF8">
                        <p class="notep1">See Also:</p>
                        <p><span><cite>Oracle Database Utilities</cite></span></p>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-31F759B9-862C-4B97-B14B-843E82926074" name="GUID-31F759B9-862C-4B97-B14B-843E82926074"></a><h5 id="BRADV-GUID-31F759B9-862C-4B97-B14B-843E82926074" class="sect5"><span class="enumeration_section">25.1.2.1 </span>Initialization Parameters for the Auxiliary Instance
                     </h5>
                     <div>
                        <p>Certain mandatory initialization parameters must be set for the auxiliary instance.</p>
                        <div class="section">
                           <p>The following table describes a subset of the possible initialization parameters for the auxiliary instance.</p>
                           <div class="tblformal" id="GUID-31F759B9-862C-4B97-B14B-843E82926074__GUID-F322CB44-D43D-4B1C-894B-30A4D80C1F1D">
                              <p class="titleintable">Table 25-1 Auxiliary Instance Initialization Parameters</p>
                              <table cellpadding="4" cellspacing="0" class="Formal" title="Auxiliary Instance Initialization Parameters" summary="This table describes the initialization parameters that are set for the auxiliary instance." frame="hsides" border="1" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" id="d109284e286"><span class="bold">Initialization Parameter</span></th>
                                       <th align="left" valign="bottom" id="d109284e289"><span class="bold">Value</span></th>
                                       <th align="left" valign="bottom" id="d109284e292"><span class="bold">Status</span></th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d109284e297" headers="d109284e286 ">
                                          <p><code class="codeph">DB_NAME</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e297 d109284e289 ">
                                          <p>The same name used in the <code class="codeph">DUPLICATE</code> command. If you use the <code class="codeph">DUPLICATE</code> command to create a standby database, then the name must be the same as the primary database.
                                          </p>
                                          <p>The <code class="codeph">DB_NAME</code> initialization parameter for the duplicate database must be unique among databases in its Oracle home.
                                          </p>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e297 d109284e292 ">
                                          <p>Required</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d109284e319" headers="d109284e286 ">
                                          <p><code class="codeph">CONTROL_FILES</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e319 d109284e289 ">
                                          <p>Control file locations .</p>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e319 d109284e292 ">
                                          <p>Required</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d109284e330" headers="d109284e286 ">
                                          <p><code class="codeph">DB_BLOCK_SIZE</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e330 d109284e289 ">
                                          <p>The block size for the duplicate database. This block size must match the block size of the source database. If the source database parameter file contains a value for the <code class="codeph">DB_BLOCK_SIZE</code> initialization parameter, then you must specify the same value for the auxiliary instance. However, if no <code class="codeph">DB_BLOCK_SIZE</code> parameter is specified in the source database initialization parameter file, then do not specify <code class="codeph">DB_BLOCK_SIZE</code> parameter in the auxiliary instance.
                                          </p>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e330 d109284e292 ">
                                          <p>Required, if this initialization parameter is set in the source database</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d109284e350" headers="d109284e286 ">
                                          <p><code class="codeph">DB_FILE_NAME_CONVERT</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e350 d109284e289 ">
                                          <p>Pairs of strings for converting the names of data files and temp files. You can also specify <code class="codeph">DB_FILE_NAME_CONVERT</code> parameter on the <code class="codeph">DUPLICATE</code> command itself. See <span class="q">"<a href="rman-duplicating-databases-advanced.html#GUID-086A9599-15DB-4441-8E02-A939CBC5FF96" title="In addition to using the SET NEWNAME or CONFIGURE AUXNAME commands, you can use the DB_FILE_NAME_CONVERT parameter to transform target file names. You can either specify the DB_FILE_NAME_CONVERT option in the DUPLICATE command or you can set it in the initialization parameter file of the auxiliary instance.">Using the DB_FILE_NAME_CONVERT Parameter to Generate Names for Non-OMF or ASM Data Files</a>"</span>.
                                          </p>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e350 d109284e292 ">
                                          <p>Optional</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d109284e389" headers="d109284e286 ">
                                          <p><code class="codeph">LOG_FILE_NAME_CONVERT</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e389 d109284e289 ">
                                          <p>Pairs of strings for naming online redo log files. See <span class="q">"<a href="rman-duplicating-databases-advanced.html#GUID-A11B8766-5078-433F-927E-D77314236755" title="If the LOG_FILE clause has been omitted and none of the OMF initialization parameters DB_CREATE_FILE_DEST, DB_CREATE_ONLINE_DEST_n, or DB_RECOVERY_FILE_DEST are specified, then the LOG_FILE_NAME_CONVERT parameter can transform target file names. This works in the same way that the DB_FILE_NAME_CONVERT parameter does to transform target file names from log_* to duplog_*.">Using the LOG_FILE_NAME_CONVERT Parameter to Generate Names for Non-OMF or ASM Log Files</a>"</span>.
                                          </p>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e389 d109284e292 ">
                                          <p>Optional</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d109284e432" headers="d109284e286 ">
                                          <p><code class="codeph">DB_CREATE_FILE_DEST</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e432 d109284e289 ">
                                          <p>Location for Oracle managed data files.</p>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e432 d109284e292 ">
                                          <p>Optional</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d109284e443" headers="d109284e286 ">
                                          <p><code class="codeph">DB_CREATE_ONLINE_LOG_DEST_</code><span class="italic">n</span></p>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e443 d109284e289 ">
                                          <p>Location for Oracle managed online redo log files.</p>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e443 d109284e292 ">
                                          <p>Optional</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d109284e456" headers="d109284e286 ">
                                          <p><code class="codeph">DB_RECOVERY_FILE_DEST</code></p>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e456 d109284e289 ">
                                          <p>Location for fast recovery area.</p>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e456 d109284e292 ">
                                          <p>Optional</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d109284e467" headers="d109284e286 ">
                                          <div class="p">Oracle Real Application Cluster (Oracle RAC) parameters:
                                             <ul style="list-style-type: disc;">
                                                <li>
                                                   <p><code class="codeph"><span class="codeinlineitalic">&lt;INSTANCESIDn&gt;</span>.INSTANCE_NAME</code></p>
                                                </li>
                                                <li>
                                                   <p><code class="codeph"><span class="codeinlineitalic">&lt;INSTANCESIDn&gt;</span>.INSTANCE_NUMBER</code></p>
                                                </li>
                                                <li>
                                                   <p><code class="codeph"><span class="codeinlineitalic">&lt;INSTANCESIDn&gt;</span>.THREAD</code></p>
                                                </li>
                                                <li>
                                                   <p><code class="codeph"><span class="codeinlineitalic">&lt;INSTANCESIDn</span>&gt;.UNDO_TABLESPACE</code></p>
                                                </li>
                                                <li>
                                                   <p><code class="codeph"><span class="codeinlineitalic">&lt;INSTANCESIDn</span>&gt;.LOCAL_LISTENER</code></p>
                                                </li>
                                             </ul>
                                          </div>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e467 d109284e289 ">
                                          <p>Set these parameters for each instance of the Oracle RAC database.</p>
                                       </td>
                                       <td align="left" valign="top" headers="d109284e467 d109284e292 ">
                                          <p>Required for Oracle RAC configuration </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                           <div class="infoboxnotealso" id="GUID-31F759B9-862C-4B97-B14B-843E82926074__GUID-DBDEA9A7-DAD6-4B7A-878E-1E208F90D09B">
                              <p class="notep1">See Also:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><a href="../refrn/index.html" target="_blank"><span><cite>Oracle Database Reference</cite></span></a> for more information about initialization parameters for the auxiliary instance
                                    </p>
                                 </li>
                                 <li>
                                    <p><a href="rman-duplicating-databases-advanced.html#GUID-30331FAC-15B0-4316-8FAF-C0E1C1E01D65__GUID-9E492CBE-B861-4ACB-AA35-89E96B264B97" title="This table describes the formats available for naming duplicate database files">Table 26-1</a> to learn about options for naming duplicate files
                                    </p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-556C92BF-807D-483C-9CAB-A0E7B3ACA6A8" name="GUID-556C92BF-807D-483C-9CAB-A0E7B3ACA6A8"></a><h5 id="BRADV-GUID-556C92BF-807D-483C-9CAB-A0E7B3ACA6A8" class="sect5"><span class="enumeration_section">25.1.2.2 </span>About Parallelizing Backup Set Creation During Active Database Duplication
                     </h5>
                     <div>
                        <p>RMAN multisection backups provide faster backup performance by backing up very large data files in parallel. Multiple backup pieces are created, with a separate channel writing to each backup piece. Starting with Oracle Database 12<span class="italic">c</span> Release 1 (12.1), you can use multisection backup sets to transfer the source files that are required to perform active database duplication. 
                        </p>
                        <p>Use the <code class="codeph">SECTION SIZE</code> option in the <code class="codeph">DUPLICATE</code> command to create multisection backup sets. The following command creates multisection backup sets, with the size of each backup piece being 400MB. Assume that the connection to the target database and auxiliary instance has been made by using net service names.
                        </p><pre class="pre codeblock"><code>DUPLICATE TARGET DATABASE TO dup_db
FROM ACTIVE DATABASE
PASSWORD FILE
SECTION SIZE 400M;</code></pre></div>
                  </div>
                  <div class="sect4"><a id="GUID-73681CB6-5AEB-40FA-923F-D59DF1A40EAF" name="GUID-73681CB6-5AEB-40FA-923F-D59DF1A40EAF"></a><h5 id="BRADV-GUID-73681CB6-5AEB-40FA-923F-D59DF1A40EAF" class="sect5"><span class="enumeration_section">25.1.2.3 </span>About Encrypting Backup Sets During Active Database Duplication
                     </h5>
                     <div>
                        <p>RMAN can use backup sets to transfer the source database files that need to be duplicated. The backup sets are transferred over the network to the auxiliary database. Backup sets can be encrypted for additional security. Use the <code class="codeph">SET ENCRYPTION ALGORITHM</code> command before the <code class="codeph">DUPLICATE</code> command to specify the encryption algorithm.
                        </p>
                        <p>Before you perform active database duplication, use one of the following techniques to ensure that the encryption is successful:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>If the source database uses transparent encryption, then you must share the Oracle software keystore that contains the encryption key between the source database and the auxiliary instance, as described in <a href="rman-duplicating-databases.html#GUID-E016C2DC-1774-4057-8EAF-3F69E9A6322A" title="If transparent encryption is configured on the source database, then you must ensure that the Oracle software keystore from the source database is available to the auxiliary instance. Manually copy the keystore from the source database to the destination host.">Making the Oracle Keystore Available to the Destination Host</a>.
                              </p>
                           </li>
                           <li>
                              <p>If the source database uses password encryption, then you must specify the password used to encrypt backups.</p>
                              <div class="p">The following command sets the encryption password  (where <code class="codeph"><span class="codeinlineitalic">password</span></code> is a placeholder for the actual password that you enter):<pre class="pre codeblock"><code>SET ENCRYPTION ON IDENTIFIED BY <span class="italic">password</span>;</code></pre></div>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-DE4FBE49-E93B-4A47-9D47-19C1378D827F" name="GUID-DE4FBE49-E93B-4A47-9D47-19C1378D827F"></a><h5 id="BRADV-GUID-DE4FBE49-E93B-4A47-9D47-19C1378D827F" class="sect5"><span class="enumeration_section">25.1.2.4 </span>About Compressing Backup Sets During Active Database Duplication
                     </h5>
                     <div>
                        <p>When backup sets are used to perform active database duplication, RMAN can use backup compression to minimize the size of the backup sets that are used to transfer files from the source database to the destination host. Thus, compression can enhance the performance of the duplication process.</p>
                        <p>Compressing backup sets used for active database duplication is supported starting with Oracle Database 12<span class="italic">c</span> Release 1 (12.1).
                        </p>
                        <p>Use the <code class="codeph">USING COMPRESSED BACKUPSET</code> clause of the <code class="codeph">DUPLICATE</code> command to compress the backup sets that contain data which is required to perform active database duplication. The following command performs active database duplication by using compressed backup sets. Assume that the connection to the target database and auxiliary instance has been made using net service names.
                        </p><pre class="pre codeblock"><code>DUPLICATE TARGET DATABASE TO dup_db
FROM ACTIVE DATABASE
PASSWORD FILE
USING COMPRESSED BACKUPSET;</code></pre></div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-F700603C-44EF-422F-8770-E7AA5BE33C87" name="GUID-F700603C-44EF-422F-8770-E7AA5BE33C87"></a><h4 id="BRADV-GUID-F700603C-44EF-422F-8770-E7AA5BE33C87" class="sect4"><span class="enumeration_section">25.1.3 </span>Types of Database Duplication
                  </h4>
                  <div>
                     <p>RMAN enables you to perform two main types of database duplication.</p>
                     <div class="p">They include the following:
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Backup-based duplication</p>
                              <p>The duplicate database is created by using preexisting RMAN backups or copies of the source database. You can use different techniques to duplicate a database by using backup-based duplication.</p>
                           </li>
                           <li>
                              <p>Active database duplication</p>
                              <p>The duplicate database is created by copying the live source database over the network to the auxiliary instance. The duplication can be performed by using backup sets or image copies.</p>
                           </li>
                        </ul>
                     </div>
                     <p>You can use any type of duplication to duplicate a database either to the local host or to a remote host.</p>
                     <div class="infoboxnotealso" id="GUID-F700603C-44EF-422F-8770-E7AA5BE33C87__GUID-B6ADE955-33CE-4A37-89DD-E077DEEDBBC0">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="rman-duplicating-databases.html#GUID-5E066C8F-80C2-4C2D-911B-31E4CFC5B462" title="Multiple techniques are available for performing backup-based duplication.">Techniques for Performing Backup-Based Duplication</a></p>
                           </li>
                           <li>
                              <p><a href="rman-duplicating-databases.html#GUID-61834C69-9BC4-44D7-A8CC-437A2673BC32" title="Multiple techniques are available for performing active database duplication.">Techniques for Performing Active Database Duplication</a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-5D9CDA5A-203F-4E95-90A8-96898A2C95F1" name="GUID-5D9CDA5A-203F-4E95-90A8-96898A2C95F1"></a><h5 id="BRADV-GUID-5D9CDA5A-203F-4E95-90A8-96898A2C95F1" class="sect5"><span class="enumeration_section">25.1.3.1 </span>Overview of Backup-Based Duplication
                     </h5>
                     <div>
                        <p>In backup-based duplication, preexisting RMAN backups of the source database are used to create the duplicate database. A combination of full and incremental backups can be used. RMAN determines which backups and archived redo log files must be used based on the <code class="codeph">UNTIL</code> condition.
                        </p>
                        <p>In backup-based duplication, the primary work of duplicating the database is performed by auxiliary channels. You can configure additional channels as described in <a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="The primary job of database duplication is performed by RMAN channels. Each channel corresponds to an Oracle Database server session that performs the duplication tasks. Depending on the duplication technique, RMAN uses either auxiliary channels or target channels.">Configuring RMAN Channels for Use in Duplication</a>.
                        </p>
                        <p>Backup-based duplication can be used in the following scenarios:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>A connection to the source database is not available, but backups of the source database are available.</p>
                           </li>
                           <li>
                              <p>Network bandwidth between the source host and the destination host is a constraint.</p>
                              <p>When network bandwidth between the source host and destination host is limited, using active database duplication may result in reduced performance. For example, the source host and the destination host are in different geographical locations and are connected over a WAN. In such cases, it may be preferable to use backup-based duplication.</p>
                              <div class="infoboxnotealso" id="GUID-5D9CDA5A-203F-4E95-90A8-96898A2C95F1__GUID-49153C64-207E-4B38-A099-3E0FE49059D9">
                                 <p class="notep1">See Also:</p>
                                 <p><a href="rman-duplicating-databases.html#GUID-2D2ED1CD-2582-4B4E-8363-681C59DB331F" title="Active database duplication does not require backups of the source database. It duplicates the live source database to the destination host by copying the database files over the network to the auxiliary instance. RMAN can copy the required files as image copies or backup sets.">Overview of Active Database Duplication</a> for details of scenarios in which active database duplication is preferred.
                                 </p>
                              </div>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-5E066C8F-80C2-4C2D-911B-31E4CFC5B462" name="GUID-5E066C8F-80C2-4C2D-911B-31E4CFC5B462"></a><h5 id="BRADV-GUID-5E066C8F-80C2-4C2D-911B-31E4CFC5B462" class="sect5"><span class="enumeration_section">25.1.3.2 </span>Techniques for Performing Backup-Based Duplication
                     </h5>
                     <div>
                        <p>Multiple techniques are available for performing backup-based duplication.</p>
                        <p>Use one of the following mutually-exclusive techniques to perform backup-based duplication:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="rman-duplicating-databases.html#GUID-0497F367-261D-4863-912B-91138A72A6B0" title="In this method, you must connect as TARGET to the source database and as AUXILIARY to the auxiliary instance.">Backup-Based Duplication with a Target Connection</a></p>
                           </li>
                           <li>
                              <p><a href="rman-duplicating-databases.html#GUID-D38B96D6-72C5-4760-8253-7D5C474C7914" title="In this method, you connect as CATALOG to the recovery catalog database and as AUXILIARY to the auxiliary instance.">Backup-Based Duplication Without a Target Connection</a></p>
                           </li>
                           <li>
                              <p><a href="rman-duplicating-databases.html#GUID-75463819-F48F-442F-904B-1B4CDB3711CC" title="In this method, there is no connection to either the source database or the recovery catalog.">Backup-Based Duplication Without a Target Database and Recovery Catalog Connection</a></p>
                           </li>
                        </ul>
                     </div>
                     <div class="sect5"><a id="GUID-0497F367-261D-4863-912B-91138A72A6B0" name="GUID-0497F367-261D-4863-912B-91138A72A6B0"></a><h6 id="BRADV-GUID-0497F367-261D-4863-912B-91138A72A6B0" class="sect6"><span class="enumeration_section">25.1.3.2.1 </span>Backup-Based Duplication with a Target Connection
                        </h6>
                        <div>
                           <p>In this method, you must connect as <code class="codeph">TARGET</code> to the source database and as <code class="codeph">AUXILIARY</code> to the auxiliary instance. 
                           </p>
                           <p><a href="rman-duplicating-databases.html#GUID-0497F367-261D-4863-912B-91138A72A6B0__GUID-ED0E87AC-91FE-4E74-91A0-C8EC3F26A7E2">Figure 25-1</a> below illustrates backup-based duplication <span class="italic">with</span> a target connection. You may connect to a recovery catalog but it is not mandatory (not in figure). RMAN uses the metadata in the control file of the source database to determine which backups or copies must be used to perform the duplication.
                           </p>
                           <p>The destination host must have access to the RMAN backups that are required to create the duplicate database.</p>
                           <div class="figure" id="GUID-0497F367-261D-4863-912B-91138A72A6B0__GUID-ED0E87AC-91FE-4E74-91A0-C8EC3F26A7E2">
                              <p class="titleinfigure">Figure 25-1 Backup-Based Duplication with a Target Connection</p><img src="img/bradv047.gif" alt="Description of Figure 25-1 follows" title="Description of Figure 25-1 follows" longdesc="img_text/bradv047.html"><br><a href="img_text/bradv047.html">Description of "Figure 25-1 Backup-Based Duplication with a Target Connection"</a></div>
                           <!-- class="figure" -->
                        </div>
                     </div>
                     <div class="sect5"><a id="GUID-D38B96D6-72C5-4760-8253-7D5C474C7914" name="GUID-D38B96D6-72C5-4760-8253-7D5C474C7914"></a><h6 id="BRADV-GUID-D38B96D6-72C5-4760-8253-7D5C474C7914" class="sect6"><span class="enumeration_section">25.1.3.2.2 </span>Backup-Based Duplication Without a Target Connection
                        </h6>
                        <div>
                           <p>In this method, you connect as <code class="codeph">CATALOG</code> to the recovery catalog database and as <code class="codeph">AUXILIARY</code> to the auxiliary instance. 
                           </p>
                           <p><a href="rman-duplicating-databases.html#GUID-D38B96D6-72C5-4760-8253-7D5C474C7914__GUID-4A630386-8BE8-43AE-89BA-A0A2A3155F9A">Figure 25-2</a> illustrates backup-based duplication <span class="italic">without</span> a target connection. RMAN uses the metadata in the recovery catalog to determine which backups or copies are required to perform the duplication.
                           </p>
                           <p>The destination host must have access to the RMAN backups required to create the duplicate database.</p>
                           <div class="figure" id="GUID-D38B96D6-72C5-4760-8253-7D5C474C7914__GUID-4A630386-8BE8-43AE-89BA-A0A2A3155F9A">
                              <p class="titleinfigure">Figure 25-2 Backup-Based Duplication Without a Target Connection</p><img src="img/bradv046.gif" alt="Description of Figure 25-2 follows" title="Description of Figure 25-2 follows" longdesc="img_text/bradv046.html"><br><a href="img_text/bradv046.html">Description of "Figure 25-2 Backup-Based Duplication Without a Target Connection"</a></div>
                           <!-- class="figure" -->
                        </div>
                     </div>
                     <div class="sect5"><a id="GUID-75463819-F48F-442F-904B-1B4CDB3711CC" name="GUID-75463819-F48F-442F-904B-1B4CDB3711CC"></a><h6 id="BRADV-GUID-75463819-F48F-442F-904B-1B4CDB3711CC" class="sect6"><span class="enumeration_section">25.1.3.2.3 </span>Backup-Based Duplication Without a Target Database and Recovery Catalog Connection
                        </h6>
                        <div>
                           <p>In this method, there is no connection to either the source database or the recovery catalog.</p>
                           <p><a href="rman-duplicating-databases.html#GUID-75463819-F48F-442F-904B-1B4CDB3711CC__GUID-713F546E-5F30-492B-8464-02EEFC94BD2F">Figure 25-3</a> illustrates backup-based duplication <span class="italic">without</span> connections to the target or to the recovery catalog database instance. You perform duplication by connecting to the auxiliary instance and using backups or copies of the source database that are stored in a disk location on the destination host. RMAN obtains metadata about where the backups and copies reside from the <code class="codeph">BACKUP LOCATION</code> clause of the <code class="codeph">DUPLICATE</code> command.
                           </p>
                           <p>A disk backup location containing all the backups or copies required for duplication must be available to the destination host.</p>
                           <div class="infoboxnote" id="GUID-75463819-F48F-442F-904B-1B4CDB3711CC__GUID-EAE3ABC8-5F7C-4E35-AFCA-480DBE1607BB">
                              <p class="notep1">Note:</p>
                              <p>This method is not supported for backups that are stored on tape devices.</p>
                           </div>
                           <div class="figure" id="GUID-75463819-F48F-442F-904B-1B4CDB3711CC__GUID-713F546E-5F30-492B-8464-02EEFC94BD2F">
                              <p class="titleinfigure">Figure 25-3 Backup-Based Duplication Without a Target Connection or Recovery Catalog Connection</p><img src="img/bradv048.gif" alt="Description of Figure 25-3 follows" title="Description of Figure 25-3 follows" longdesc="img_text/bradv048.html"><br><a href="img_text/bradv048.html">Description of "Figure 25-3 Backup-Based Duplication Without a Target Connection or Recovery Catalog Connection"</a></div>
                           <!-- class="figure" -->
                        </div>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-2D2ED1CD-2582-4B4E-8363-681C59DB331F" name="GUID-2D2ED1CD-2582-4B4E-8363-681C59DB331F"></a><h5 id="BRADV-GUID-2D2ED1CD-2582-4B4E-8363-681C59DB331F" class="sect5"><span class="enumeration_section">25.1.3.3 </span>Overview of Active Database Duplication
                     </h5>
                     <div>
                        <p>Active database duplication does not require backups of the source database. It duplicates the live source database to the destination host by copying the database files over the network to the auxiliary instance. RMAN can copy the required files as image copies or backup sets.</p>
                        <p>For active database duplication, the duplication technique used determines which channel performs the principal work. When active database duplication is performed using backup sets, the principal work of duplication is performed by the auxiliary channels. When image copies are used, the primary work is performed by the target channels.</p>
                        <p>To perform active database duplication, a connection to the target database is required. Oracle recommends that you use active database duplication in general, unless network bandwidth between the source host and the destination host is a constraint. Active database duplication requires minimal setup and is simpler to perform.</p>
                        <div class="infoboxnote" id="GUID-2D2ED1CD-2582-4B4E-8363-681C59DB331F__GUID-145E22B6-1F08-4551-917B-A14459D5F571">
                           <p class="notep1">Note:</p>
                           <p>For active database duplication, the source database must use a server parameter file.</p>
                        </div>
                        <div class="p">Some of the scenarios in which active database duplication using backup sets may be preferred over using image copies are:
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>You want to use multisection backups, compression, or encryption while duplicating your database.</p>
                              </li>
                              <li>
                                 <p>The source database does not have sufficient network resources to transfer the required database files to the duplicate database. </p>
                              </li>
                              <li>
                                 <p>You want to minimize the resources used by the duplication process.</p>
                                 <p>Active database duplication with backup sets uses minimal resources on the source database.</p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-61834C69-9BC4-44D7-A8CC-437A2673BC32" name="GUID-61834C69-9BC4-44D7-A8CC-437A2673BC32"></a><h5 id="BRADV-GUID-61834C69-9BC4-44D7-A8CC-437A2673BC32" class="sect5"><span class="enumeration_section">25.1.3.4 </span>Techniques for Performing Active Database Duplication
                     </h5>
                     <div>
                        <p>Multiple techniques are available for performing active database duplication.</p>
                        <p>Use one of the two mutually-exclusive methods to perform active database duplication:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="rman-duplicating-databases.html#GUID-F446FBAC-3BEE-474A-B421-1BE1F926BB9A" title="In this method, RMAN connects as TARGET to the source database and as AUXILIARY to the auxiliary instance. The source database then transfers the required database files over the network to the auxiliary instance. This method is referred to as the push-based method of active database duplication.">Active Database Duplication Using Image Copies</a></p>
                           </li>
                           <li>
                              <p><a href="rman-duplicating-databases.html#GUID-685561E7-C3A5-4428-93F1-75846459CC74" title="Using backup sets to perform active database duplication is also known as the pull-based method of active database duplication.">Active Database Duplication Using Backup Sets</a></p>
                           </li>
                        </ul>
                     </div>
                     <div class="sect5"><a id="GUID-F446FBAC-3BEE-474A-B421-1BE1F926BB9A" name="GUID-F446FBAC-3BEE-474A-B421-1BE1F926BB9A"></a><h6 id="BRADV-GUID-F446FBAC-3BEE-474A-B421-1BE1F926BB9A" class="sect6"><span class="enumeration_section">25.1.3.4.1 </span>Active Database Duplication Using Image Copies
                        </h6>
                        <div>
                           <p>In this method, RMAN connects as <code class="codeph">TARGET</code> to the source database and as <code class="codeph">AUXILIARY</code> to the auxiliary instance. The source database then transfers the required database files over the network to the auxiliary instance. This method is referred to as the <span class="bold">push-based method</span> of active database duplication.
                           </p>
                           <p><a href="rman-duplicating-databases.html#GUID-F446FBAC-3BEE-474A-B421-1BE1F926BB9A__GUID-36527810-FCA2-45AC-B739-B9F142F48C37">Figure 25-4</a> illustrates active database duplication using image copies. Using image copies for active database duplication may require additional resources on the source database. You can configure additional target channels to improve the duplication performance as described in <a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="The primary job of database duplication is performed by RMAN channels. Each channel corresponds to an Oracle Database server session that performs the duplication tasks. Depending on the duplication technique, RMAN uses either auxiliary channels or target channels.">Configuring RMAN Channels for Use in Duplication</a>.
                           </p>
                           <div class="figure" id="GUID-F446FBAC-3BEE-474A-B421-1BE1F926BB9A__GUID-36527810-FCA2-45AC-B739-B9F142F48C37">
                              <p class="titleinfigure">Figure 25-4 Active Database Duplication Using Image Copies</p><img src="img/bradv045.gif" alt="Description of Figure 25-4 follows" title="Description of Figure 25-4 follows" longdesc="img_text/bradv045.html"><br><a href="img_text/bradv045.html">Description of "Figure 25-4 Active Database Duplication Using Image Copies"</a></div>
                           <!-- class="figure" -->
                        </div>
                     </div>
                     <div class="sect5"><a id="GUID-685561E7-C3A5-4428-93F1-75846459CC74" name="GUID-685561E7-C3A5-4428-93F1-75846459CC74"></a><h6 id="BRADV-GUID-685561E7-C3A5-4428-93F1-75846459CC74" class="sect6"><span class="enumeration_section">25.1.3.4.2 </span>Active Database Duplication Using Backup Sets
                        </h6>
                        <div>
                           <p>Using backup sets to perform active database duplication is also known as the <span class="bold">pull-based method</span> of active database duplication.
                           </p>
                           <p> In this method, RMAN connects as <code class="codeph">TARGET</code> to the source database and as <code class="codeph">AUXILIARY</code> to the auxiliary instance. The auxiliary instance then connects to the source database through Oracle Net Services and retrieves the required database files, over the network, from the source database. <a href="rman-duplicating-databases.html#GUID-685561E7-C3A5-4428-93F1-75846459CC74__GUID-9CB71F93-1C8F-4C89-846A-4CBA251172CB">Figure 25-5</a> illustrates active database duplication using backup sets.
                           </p>
                           <div class="figure" id="GUID-685561E7-C3A5-4428-93F1-75846459CC74__GUID-9CB71F93-1C8F-4C89-846A-4CBA251172CB">
                              <p class="titleinfigure">Figure 25-5 Active Database Duplication Using Backup Sets</p><img src="img/bradv045a.gif" alt="Description of Figure 25-5 follows" title="Description of Figure 25-5 follows" longdesc="img_text/bradv045a.html"><br><a href="img_text/bradv045a.html">Description of "Figure 25-5 Active Database Duplication Using Backup Sets"</a></div>
                           <!-- class="figure" -->
                           <div class="infoboxnote" id="GUID-685561E7-C3A5-4428-93F1-75846459CC74__GUID-F75B6170-09B6-411F-B9D5-73665F610975">
                              <p class="notep1">Note:</p>
                              <p>Performing active database duplication using backup sets is available starting Oracle Database 12<span class="italic">c</span> Release 1 (12.1).
                              </p>
                           </div>
                           <p>Using backup sets for active database duplication provides the following advantages:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>RMAN can use unused block compression, thus reducing the size of backups that must be transported over the network.</p>
                              </li>
                              <li>
                                 <p>Backup sets can be created in parallel, on the source database, by using multisection backups.</p>
                              </li>
                              <li>
                                 <p>Backup sets created on the source database can be encrypted.</p>
                              </li>
                           </ul>
                           <div class="infoboxnotealso" id="GUID-685561E7-C3A5-4428-93F1-75846459CC74__GUID-986939CE-F105-4D41-80D0-70BD993768C6">
                              <p class="notep1">See Also:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><a href="rman-duplicating-databases.html#GUID-DE4FBE49-E93B-4A47-9D47-19C1378D827F" title="When backup sets are used to perform active database duplication, RMAN can use backup compression to minimize the size of the backup sets that are used to transfer files from the source database to the destination host. Thus, compression can enhance the performance of the duplication process.">About Compressing Backup Sets During Active Database Duplication</a></p>
                                 </li>
                                 <li>
                                    <p><a href="rman-duplicating-databases.html#GUID-556C92BF-807D-483C-9CAB-A0E7B3ACA6A8" title="RMAN multisection backups provide faster backup performance by backing up very large data files in parallel. Multiple backup pieces are created, with a separate channel writing to each backup piece. Starting with Oracle Database 12c Release 1 (12.1), you can use multisection backup sets to transfer the source files that are required to perform active database duplication.">About Parallelizing Backup Set Creation During Active Database Duplication</a></p>
                                 </li>
                                 <li>
                                    <p><a href="rman-duplicating-databases.html#GUID-73681CB6-5AEB-40FA-923F-D59DF1A40EAF" title="RMAN can use backup sets to transfer the source database files that need to be duplicated. The backup sets are transferred over the network to the auxiliary database. Backup sets can be encrypted for additional security. Use the SET ENCRYPTION ALGORITHM command before the DUPLICATE command to specify the encryption algorithm.">About Encrypting Backup Sets During Active Database Duplication</a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-22CBD826-566F-4E3A-9FBE-538585CB9D6A" name="GUID-22CBD826-566F-4E3A-9FBE-538585CB9D6A"></a><h5 id="BRADV-GUID-22CBD826-566F-4E3A-9FBE-538585CB9D6A" class="sect5"><span class="enumeration_section">25.1.3.5 </span>Factors that Determine Whether Backup Sets or Image Copies Are Used for Active Database Duplication
                     </h5>
                     <div>
                        <p>RMAN can use backup sets or image copies to perform active database duplication.</p>
                        <div class="p">RMAN uses backup sets to perform active database duplication when the connection to the target database is established using a net service name and any one of the following conditions is satisfied:
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>The <code class="codeph">DUPLICATE ... FROM ACTIVE DATABASE</code> command contains either the <code class="codeph">USING BACKUPSET</code>, <code class="codeph">USING COMPRESSED BACKUPSET</code>, or <code class="codeph">SECTION SIZE</code> clause.
                                 </p>
                              </li>
                              <li>
                                 <p>The number of auxiliary channels allocated is equal to or greater than the number of target channels allocated.</p>
                              </li>
                           </ul>
                        </div>
                        <p>Otherwise, RMAN uses image copies to perform active database duplication.</p>
                        <div class="infoboxnote" id="GUID-22CBD826-566F-4E3A-9FBE-538585CB9D6A__GUID-FB4DF220-EF91-4C48-B589-C5C0617985E6">
                           <p class="notep1">Note:</p>
                           <p>Oracle recommends that you use backup sets to perform active database duplication.</p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-DC0A075D-82E3-4EC9-9FCF-51DB99F3EA03" name="GUID-DC0A075D-82E3-4EC9-9FCF-51DB99F3EA03"></a><h4 id="BRADV-GUID-DC0A075D-82E3-4EC9-9FCF-51DB99F3EA03" class="sect4"><span class="enumeration_section">25.1.4 </span>How RMAN Duplicates a Database
                  </h4>
                  <div>
                     <p>RMAN performs a set of automated steps to duplicate a database.</p>
                     <div class="section">The steps include the following:</div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Create a default server parameter file for the auxiliary instance, if the following conditions are true:</span><div>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>Duplication does not involve a standby database</p>
                                 </li>
                                 <li>
                                    <p>Server parameter files are not being duplicated</p>
                                 </li>
                                 <li>
                                    <p>The auxiliary instance was not started with a server parameter file</p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Restores from backup or copies from the active database the latest control file that satisfies the <code class="codeph">UNTIL</code> clause requirements.</span></li>
                        <li class="stepexpand"><span>Mounts the auxiliary instance by using the restored control file or the backup control file that is copied from the active database.</span></li>
                        <li class="stepexpand"><span>Use metadata in the RMAN repository to select the backups that are used to restore the data files to the auxiliary instance. This step applies to backup-based duplication.</span></li>
                        <li class="stepexpand"><span>Copy the duplicate database files to the destination host and restores them to a noncurrent point in time by using incremental backups and archived redo log files.</span></li>
                        <li class="stepexpand"><span>Shut down and restarts the auxiliary database instance on the destination host in <code class="codeph">NOMOUNT</code> mode.</span></li>
                        <li class="stepexpand"><span>Create a new control file, which then creates and stores the new DBID in the data files.</span></li>
                        <li class="stepexpand"><span>Open the duplicate database with the <code class="codeph">RESETLOGS</code> option and creates the online redo log for the new database. If you do not want to open the duplicate database, use the <code class="codeph">NOOPEN</code> clause in the <code class="codeph">DUPLICATE</code> statement, as described in <a href="rman-duplicating-databases.html#GUID-608FAE46-DC28-43F3-83F6-0DEB73BB59ED" title="When you use the RMAN DUPLICATE command, the duplicate database is created and opened in RESETLOGS mode. You can use the NOOPEN clause in the DUPLICATE command to specify that the duplicate database must not be opened.">Deciding the State of the Duplicate Database</a>.</span></li>
                     </ol>
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-DC0A075D-82E3-4EC9-9FCF-51DB99F3EA03__GUID-17F569C9-534E-4733-B101-0F736C307FCC">
                           <p class="notep1">See Also:</p>
                           <p>The <code class="codeph">DUPLICATE</code> entry in <a href="../rcmrf/DUPLICATE.html#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a> for a complete list of which files are copied to the duplicate database
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-0667FB47-1E7D-42E8-9342-7E1DE3FF150F" name="GUID-0667FB47-1E7D-42E8-9342-7E1DE3FF150F"></a><h4 id="BRADV-GUID-0667FB47-1E7D-42E8-9342-7E1DE3FF150F" class="sect4"><span class="enumeration_section">25.1.5 </span>Contents of a Duplicate Database
                  </h4>
                  <div>
                     <p>A duplicate database can include the same contents as the source database or only a subset of the tablespaces in the source database. </p>
                     <p>For example, you can use the <code class="codeph">TABLESPACE</code> option of the <code class="codeph">DUPLICATE</code> command to duplicate only specified tablespaces, or the <code class="codeph">SKIP READONLY</code> option to exclude read-only tablespaces from the duplicate database.
                     </p>
                  </div>
                  <div class="sect4"><a id="GUID-9B731309-38CC-4B56-8CB7-35BD7F1CE9B5" name="GUID-9B731309-38CC-4B56-8CB7-35BD7F1CE9B5"></a><h5 id="BRADV-GUID-9B731309-38CC-4B56-8CB7-35BD7F1CE9B5" class="sect5"><span class="enumeration_section">25.1.5.1 </span>About Duplicating a Subset of the Source Database
                     </h5>
                     <div>
                        <p>The <code class="codeph">DUPLICATE</code> command contains clauses that enable you to duplicate a subset of the entire source database.
                        </p>
                        <p>It is not always necessary to duplicate all tablespaces of a database. For example, you may plan to generate reports that require only a subset of tablespaces from your source database.</p>
                        <div class="p">The following table explains the <code class="codeph">DUPLICATE</code> command options to specify subsets of tablespaces for the duplicate database:
                           <div class="tblformal" id="GUID-9B731309-38CC-4B56-8CB7-35BD7F1CE9B5__GUID-CE423060-0BD9-4152-9025-A4EC4B9DE3A2">
                              <p class="titleintable">Table 25-2 Options to Specify Subsets of Tablespaces for the Duplicate Database</p>
                              <table cellpadding="4" cellspacing="0" class="Formal" title="Options to Specify Subsets of Tablespaces for the Duplicate Database" summary="This table describes the options used to duplicate a subset of the source database files" frame="hsides" border="1" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" id="d109284e1211"><span class="bold">DUPLICATE Options</span></th>
                                       <th align="left" valign="bottom" id="d109284e1214"><span class="bold">Explanation</span></th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d109284e1219" headers="d109284e1211 "><code class="codeph">SKIP READONLY</code></td>
                                       <td align="left" valign="top" headers="d109284e1219 d109284e1214 ">Excludes the data files of read-only tablespaces from the duplicate database.</td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d109284e1225" headers="d109284e1211 "><code class="codeph">SKIP TABLESPACE <span class="codeinlineitalic">'tablespace_name ', ...</span></code></td>
                                       <td align="left" valign="top" headers="d109284e1225 d109284e1214 ">Excludes the specified tablespaces from the duplicate database. You cannot exclude the <code class="codeph">SYSTEM</code> and <code class="codeph">SYSAUX</code> tablespaces, tablespaces with <code class="codeph">SYS</code> objects, undo tablespaces, tablespaces with undo segments, tablespaces with materialized views, or tablespaces in such a way that the duplicated tablespaces are not self-contained.
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d109284e1242" headers="d109284e1211 "><code class="codeph">TABLESPACE <span class="codeinlineitalic">'tablespace_name ', ...</span></code></td>
                                       <td align="left" valign="top" headers="d109284e1242 d109284e1214 ">Automatically includes the <code class="codeph">SYSTEM</code>, <code class="codeph">SYSAUX</code>, and undo tablespaces. The included tablespaces must be self-contained and the resulting skipped tablespaces must not contain <code class="codeph">SYS</code> objects or materialized views.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                        </div>
                        <div class="infoboxnote" id="GUID-9B731309-38CC-4B56-8CB7-35BD7F1CE9B5__GUID-252B8BA8-EA10-4206-ADC1-357E32F5ED1C">
                           <p class="notep1">Note:</p>
                           <p>When you exclude tablespaces in backup-based duplication <span class="italic">without</span> a target connection or <span class="italic">without</span> a target and a recovery catalog connection, RMAN has special prerequisites. See the Prerequisites section of the <code class="codeph">DUPLICATE</code> command in <a href="../rcmrf/DUPLICATE.html#GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a>for details.
                           </p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-89053F52-4EAF-424E-B106-3ABFA076521C" name="GUID-89053F52-4EAF-424E-B106-3ABFA076521C"></a><h4 id="BRADV-GUID-89053F52-4EAF-424E-B106-3ABFA076521C" class="sect4"><span class="enumeration_section">25.1.6 </span>About the Destination Host for Database Duplication
                  </h4>
                  <div>
                     <p>RMAN creates the duplicate database on the specified destination host. The destination host can be the same as the source host or different. </p>
                     <p>When the same computer is used as the source host and the destination host, the duplication is termed as duplicating to the local host. When the source host and the destination host are on different computers, the duplication is termed as duplicating to a remote host.</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-89053F52-4EAF-424E-B106-3ABFA076521C__GUID-27A19451-DF63-401C-B6EB-4DA5B4307866">About Duplicating a Database to the Local Host</p>
                        <p>When you duplicate a database to the local host, you must store the duplicate database files by using a directory structure that is different from that of the source database. For example, if the source database files are stored in the <code class="codeph">/disk1/oracle</code> directory, then the duplicate database files can be stored in the <code class="codeph">/disk2/oracle</code> directory. The duplicate database file names can be the same as those of the source database or different. The techniques for specifying alternate names for duplicate database files are described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-21627543-AD37-4144-9DEF-2C5AE9CC745C" title="Depending on the method that you choose, RMAN can either automatically generate file names or use specific names for the duplicate database files. The database files include the data files, control files, online redo log files, and temp files.">Methods of Generating Database File Names for the Duplicate Database</a>"</span>.
                        </p>
                        <p></p>
                        <div class="infoboxnote" id="GUID-89053F52-4EAF-424E-B106-3ABFA076521C__GUID-1B01EF0A-823B-45FE-A620-75E4DDEE6477">
                           <p class="notep1">Caution:</p>
                           <p>Using <code class="codeph">NOFILENAMECHECK</code> when duplicating to the local host overwrites the source database files.
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-89053F52-4EAF-424E-B106-3ABFA076521C__GUID-F7E90131-287B-46B1-8EEF-8435C2CAE36C">About Duplicating a Database to a Remote Host</p>
                        <div class="p">When you duplicate a database to a remote host, the duplicate database files can either use the same directory structure and file names as the source database or use a different directory structure and file names. If you choose to name duplicate database files differently, then you must use one the techniques described in <a href="rman-duplicating-databases.html#GUID-21627543-AD37-4144-9DEF-2C5AE9CC745C" title="Depending on the method that you choose, RMAN can either automatically generate file names or use specific names for the duplicate database files. The database files include the data files, control files, online redo log files, and temp files.">Methods of Generating Database File Names for the Duplicate Database</a> to specify how duplicate database files are named.
                           <div class="infoboxnote" id="GUID-89053F52-4EAF-424E-B106-3ABFA076521C__GUID-E94F55F0-A0D6-4D34-A48A-95FFACF69413">
                              <p class="notep1">Note:</p>
                              <p>Duplication to a remote host requires a password file and an Oracle Net Services connection to the auxiliary instance.</p>
                           </div>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-102FF47A-63D1-45CA-8C9F-4257E16BCA52" name="GUID-102FF47A-63D1-45CA-8C9F-4257E16BCA52"></a><h4 id="BRADV-GUID-102FF47A-63D1-45CA-8C9F-4257E16BCA52" class="sect4"><span class="enumeration_section">25.1.7 </span>About Duplicate Database File Names
                  </h4>
                  <div>
                     <p>Depending on the destination host used and your duplication scenario, the duplicate database files can either use the same names as the source database or different names. The database files include the data file, control files, online redo log files, and temp files.</p>
                     <p>If you choose to name duplicate database files differently, you must specify a strategy for naming these files.</p>
                     <div class="infoboxnotealso" id="GUID-102FF47A-63D1-45CA-8C9F-4257E16BCA52__GUID-DAD5663C-5666-45C5-966D-A62BAEF95A8B">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="rman-duplicating-databases.html#GUID-5293AB47-97AA-45A2-9D64-BA1287D3F7B9" title="When you duplicate a database, RMAN generates names for the database files in the duplicate database. This includes the control files, data files, temp files, and online redo log files.">Choosing a Strategy for Naming Duplicate Database Files</a></p>
                           </li>
                           <li>
                              <p><a href="rman-duplicating-databases.html#GUID-89053F52-4EAF-424E-B106-3ABFA076521C" title="RMAN creates the duplicate database on the specified destination host. The destination host can be the same as the source host or different.">About the Destination Host for Database Duplication</a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-7154AD5C-A192-4502-B3AC-FCD6DB3CDEAD" name="GUID-7154AD5C-A192-4502-B3AC-FCD6DB3CDEAD"></a><h4 id="BRADV-GUID-7154AD5C-A192-4502-B3AC-FCD6DB3CDEAD" class="sect4"><span class="enumeration_section">25.1.8 </span>About Duplicating a Database to a Past Point-in-Time
                  </h4>
                  <div>
                     <p>You can use clauses in the <code class="codeph">DUPLICATE</code> command to duplicate a database to a past point in time.
                     </p>
                     <div class="p">By default, the <code class="codeph">DUPLICATE</code> command creates the duplicate database by using the most recent backups of the target database and then performs recovery to the most recent consistent point contained in the incremental backups and archived redo logs. However, you can recover the duplicate database to a past point in time by using one of the following methods:
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">DUPLICATE  UNTIL</code> command
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">SET UNTIL</code> command before the <code class="codeph">DUPLICATE</code> command
                              </p>
                           </li>
                        </ul>
                        <div class="infoboxnotealso" id="GUID-7154AD5C-A192-4502-B3AC-FCD6DB3CDEAD__GUID-A8702034-6E19-48A2-97BC-F134DA79E99C">
                           <p class="notep1">See Also:</p>
                           <p><a href="../rcmrf/DUPLICATE.html#RCMRF-GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a> for an example of duplicating a database to a past point in time
                           </p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" name="GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25"></a><h4 id="BRADV-GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" class="sect4"><span class="enumeration_section">25.1.9 </span>Prerequisites for Duplicating a Database
                  </h4>
                  <div>
                     <p>The prerequisites depend on the type of database duplication being performed. Some prerequisites are common to all types of duplication and others are specific to a particular type of duplication.</p>
                     <div class="p">
                        <div class="infoboxnotealso" id="GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25__GUID-160E5FB7-EA34-49CD-A005-4A7424C0EB01">
                           <p class="notep1">See Also:</p>
                           <p><a href="../rcmrf/DUPLICATE.html#RCMRF-GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a> for details about prerequisites for each duplication technique
                           </p>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" name="GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B"></a><h3 id="BRADV-GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" class="sect3"><span class="enumeration_section">25.2 </span>Planning to Duplicate a Database
               </h3>
               <div>
                  <p>Before duplicating a database, you must make some decisions about the duplication process.</p>
                  <p>Planning to duplicate a database includes the following tasks:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-B01ED820-3E01-4044-87A1-C156E27E02E4" title="Your business requirements and the database environment determine which duplication technique is best for your situation.">Choosing a Duplication Technique</a></p>
                     </li>
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-5293AB47-97AA-45A2-9D64-BA1287D3F7B9" title="When you duplicate a database, RMAN generates names for the database files in the duplicate database. This includes the control files, data files, temp files, and online redo log files.">Choosing a Strategy for Naming Duplicate Database Files</a></p>
                     </li>
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-CB32BB0E-5E76-4D18-8D93-0227344A8652" title="When the source and destination host are different, you must install the Oracle Database software on the destination host, so that the auxiliary instance can be created.">Installing the Oracle Database Software on the Destination Host</a></p>
                     </li>
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-608FAE46-DC28-43F3-83F6-0DEB73BB59ED" title="When you use the RMAN DUPLICATE command, the duplicate database is created and opened in RESETLOGS mode. You can use the NOOPEN clause in the DUPLICATE command to specify that the duplicate database must not be opened.">Deciding the State of the Duplicate Database</a></p>
                     </li>
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-08282A88-3810-4C70-91D6-5C7582D5787D" title="Names of the backups used during duplication are stored in the RMAN repository or control file.">Making Backups Accessible to the Duplicate Instance</a></p>
                     </li>
                  </ul>
               </div>
               <div class="sect3"><a id="GUID-B01ED820-3E01-4044-87A1-C156E27E02E4" name="GUID-B01ED820-3E01-4044-87A1-C156E27E02E4"></a><h4 id="BRADV-GUID-B01ED820-3E01-4044-87A1-C156E27E02E4" class="sect4"><span class="enumeration_section">25.2.1 </span>Choosing a Duplication Technique
                  </h4>
                  <div>
                     <p>Your business requirements and the database environment determine which duplication technique is best for your situation. </p>
                     <div class="section">Consider the following questions:
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Are you familiar with the prerequisites for each duplication technique?</p>
                              <p>Review the Prerequisites section of the <code class="codeph">DUPLICATE</code> command description in <span class="italic">Oracle Database Backup and Recovery Reference</span><span class="italic"> </span>for a complete list.
                              </p>
                              <p>Some prerequisites are specific and depend on the duplication technique. For example, active duplication requires that the source and auxiliary instances use the same password as the source database, whereas backup-based duplication without connections to the target database and recovery catalog requires only that all backups and database copies reside in a single location.</p>
                           </li>
                           <li>
                              <p>Do backups of the source database exist?</p>
                              <p>The principal advantage of active database duplication is that it does not require source database backups. Active duplication copies mounted or online database files over a network to the auxiliary instance. One disadvantage of this technique is the negative performance effect on the network. Another disadvantage is that the source database is running processes required to transfer the files to the auxiliary host, thereby affecting the source database and production workload.</p>
                              <p>If the source database backups exist, and if the effect on the network is unacceptable, then backup-based duplication may be a better option. You can copy backups to temporary storage and transfer them manually to the destination host. If duplication is made with a connection to the target or the recovery catalog, then the backup files on the destination host must have the same file specification as they had on the source host. Otherwise, this is not a requirement.</p>
                           </li>
                           <li>
                              <p>Is a recovery catalog available?</p>
                              <p>If a recovery catalog exists, then you can perform backup-based duplication without connecting RMAN as TARGET to the source database. This technique is advantageous where network connections from the auxiliary host to the source database are restricted or prone to intermittent disruptions. When you perform duplication without using a target connection, the source database is unaffected by the duplication.</p>
                           </li>
                           <li>
                              <p>How much disk space is available on the destination host?</p>
                              <p>When you perform duplication by using disk backups, disk space on the destination host can be an issue. For example, if the source database is 1 terabyte (TB), and if you duplicate the database from disk backups <span class="italic">without</span> using shared disk or network file system (NFS), then you must have at least 2 terabytes (TB) of space available on the destination host. In some environments, manual transfer of backups is necessary because NFS performance is a bottleneck.
                              </p>
                           </li>
                           <li>
                              <p>Are the source and destination hosts connected by a LAN or a WAN?</p>
                              <p>Performance of active database duplication is probably slower on a wide area network (WAN) than on a local area network (LAN). If the performance degradation on a WAN is unacceptable, then backup-based duplication may be the only viable option.</p>
                           </li>
                           <li>
                              <p>When do you plan to duplicate the database?</p>
                              <p>If you must duplicate the database during a period of high user activity, then the loss of network throughput caused by active duplication may be a problem, making backup-based duplication a better choice. Also, in active database duplication, the RMAN channels that are required for copying files to the auxiliary host can affect performance.</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-5293AB47-97AA-45A2-9D64-BA1287D3F7B9" name="GUID-5293AB47-97AA-45A2-9D64-BA1287D3F7B9"></a><h4 id="BRADV-GUID-5293AB47-97AA-45A2-9D64-BA1287D3F7B9" class="sect4"><span class="enumeration_section">25.2.2 </span>Choosing a Strategy for Naming Duplicate Database Files
                  </h4>
                  <div>
                     <p>When you duplicate a database, RMAN generates names for the database files in the duplicate database. This includes the control files, data files, temp files, and online redo log files.</p>
                     <div class="section">
                        <p>Depending on your duplication scenario, you can name the duplicate database files by using one of the following techniques:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="rman-duplicating-databases.html#GUID-7D61A2DD-76EB-4DCE-A66B-C702A210A4AA" title="Certain conditions must be met to use the same names for files in the source and duplicate database.">Using the Same Names for Database Files in the Source Database and Duplicate Database</a></p>
                           </li>
                           <li>
                              <p><a href="rman-duplicating-databases.html#GUID-D4D17387-BC1D-4731-8BC3-50285847153A" title="If the source host and the destination host use different directory structures, or if they use the same directory structures but you want to name the database files differently, then you must specify how RMAN should generate names for the duplicate database files.">Using Different Names for the Database Files in the Source Database and Duplicate Database</a></p>
                           </li>
                        </ul>
                        <p></p>
                        <p>If you do not specify a strategy to generate names for duplicate database files, then RMAN uses the same file names and directory structure as the source database for the duplicate database. Only when duplicating to a remote host, use the <code class="codeph">NOFILENAMECHECK</code> clause to indicate that RMAN must not display an error when the names of the database files are the same in the source and duplicate database.
                        </p>
                        <p>Some of the methods used to specify alternate names for duplicate database files may generate file names that are the same as the ones used by the source database. This may happen if, for example, you used the <code class="codeph">SET NEWNAME</code> or the <code class="codeph">CONFIGURE AUXNAME</code> commands to specify names for the duplicate database files. Use caution when you specify the file names for the duplicate database, else you may mistakenly overwrite the source database files.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div><a id="BRADV298"></a><div class="sect4"><a id="GUID-7D61A2DD-76EB-4DCE-A66B-C702A210A4AA" name="GUID-7D61A2DD-76EB-4DCE-A66B-C702A210A4AA"></a><h5 id="BRADV-GUID-7D61A2DD-76EB-4DCE-A66B-C702A210A4AA" class="sect5"><span class="enumeration_section">25.2.2.1 </span>Using the Same Names for Database Files in the Source Database and Duplicate Database
                     </h5>
                     <div>
                        <p>Certain conditions must be met to use the same names for files in the source and duplicate database.</p>
                        <div class="section">
                           <p></p>
                           <p>The simplest duplication strategy is to configure the duplicate database to use the same directory structure and file names as the source database. You can use the same directory structure and names only when duplicating to a remote host.</p>
                           <div class="p">Using the same directory structure and file names means that your environment meets the following requirements:
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>If the source database uses ASM disk groups, then the duplicate database must use ASM disk groups with the same names.</p>
                                 </li>
                                 <li>
                                    <p>If the source database files are Oracle Managed Files, then the auxiliary instance must set the <code class="codeph">DB_CREATE_FILE_DEST</code> parameter to the same directory location as the source database. Although the directories are the same on the source and destination hosts, Oracle Database chooses the relative names for the duplicate files.
                                    </p>
                                 </li>
                                 <li>
                                    <p>If the names of the database files in the source database contain a path, then this path name must be the same in the duplicate database.</p>
                                 </li>
                                 <li>
                                    <p>For Oracle Real Application Clusters (RAC) environments, use the same value for the <code class="codeph">ORACLE_SID</code> parameter of the source and destination databases.
                                    </p>
                                 </li>
                              </ul>
                           </div>
                           <p>When you configure your environment as suggested, no additional configuration is required to name the duplicate files.</p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-D4D17387-BC1D-4731-8BC3-50285847153A" name="GUID-D4D17387-BC1D-4731-8BC3-50285847153A"></a><h5 id="BRADV-GUID-D4D17387-BC1D-4731-8BC3-50285847153A" class="sect5"><span class="enumeration_section">25.2.2.2 </span>Using Different Names for the Database Files in the Source Database and Duplicate Database
                     </h5>
                     <div>
                        <p>If the source host and the destination host use different directory structures, or if they use the same directory structures but you want to name the database files differently, then you must specify how RMAN should generate names for the duplicate database files.</p>
                        <div class="section">
                           <div class="infoboxnote" id="GUID-D4D17387-BC1D-4731-8BC3-50285847153A__GUID-3A853027-FDC4-4553-A7B5-8F00A879B0DC">
                              <p class="notep1">Note:</p>
                              <p>It is recommended that you use different names for the ASM disk groups in the source and duplicate database.</p>
                           </div>
                           <div class="infoboxnotealso" id="GUID-D4D17387-BC1D-4731-8BC3-50285847153A__GUID-1E8F91AE-0DDC-4EE0-B007-5F5D846662ED">
                              <p class="notep1">See Also:</p>
                              <p><a href="rman-duplicating-databases.html#GUID-21627543-AD37-4144-9DEF-2C5AE9CC745C" title="Depending on the method that you choose, RMAN can either automatically generate file names or use specific names for the duplicate database files. The database files include the data files, control files, online redo log files, and temp files.">Methods of Generating Database File Names for the Duplicate Database</a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-21627543-AD37-4144-9DEF-2C5AE9CC745C" name="GUID-21627543-AD37-4144-9DEF-2C5AE9CC745C"></a><h5 id="BRADV-GUID-21627543-AD37-4144-9DEF-2C5AE9CC745C" class="sect5"><span class="enumeration_section">25.2.2.3 </span>Methods of Generating Database File Names for the Duplicate Database
                     </h5>
                     <div>
                        <p>Depending on the method that you choose, RMAN can either automatically generate file names or use specific names for the duplicate database files. The database files include the data files, control files, online redo log files, and temp files.</p>
                        <div class="section">
                           <div class="p">Use one of the following methods, listed in the order of precedence, to generate file names for the duplicate database:
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><code class="codeph">SET NEWNAME</code> command
                                    </p>
                                    <p>Provides specific names for the duplicate database files. Based on your requirement, use the <code class="codeph">SET NEWNAME FOR DATABASE</code>, <code class="codeph">SET NEWNAME FOR DATAFILE</code>, <code class="codeph">SET NEWNAME FOR TABLESPACE</code>, or <code class="codeph">SET NEWNAME FOR TEMPFILE</code> command.
                                    </p>
                                    <p>For OMF and ASM database files, you must use the <code class="codeph">SET NEWNAME...TO NEW</code> comand and not explicitly provide names for the database files.
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">CONFIGURE AUXNAME</code> command
                                    </p>
                                    <p>Specifies non-OMF and non-ASM alternative names for duplicate database files.</p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">SPFILE</code> clause of the <code class="codeph">DUPLICATE</code> command
                                    </p>
                                    <p>Sets all the necessary initialization parameters that are related to duplicate database file names, with the exception of the <code class="codeph">DB_FILE_NAME_CONVERT</code> parameter.
                                    </p>
                                 </li>
                                 <li>
                                    <p>(Online redo log files only) <code class="codeph">LOGFILE</code> clause of the <code class="codeph">DUPLICATE</code> command
                                    </p>
                                    <p>Names online redo log files in the duplicate database. You cannot use this method while creating a standby database.</p>
                                    <div class="infoboxnote" id="GUID-21627543-AD37-4144-9DEF-2C5AE9CC745C__GUID-6F9F1620-401C-434E-969C-56AE421118F4">
                                       <p class="notep1">Note:</p>
                                       <p>When duplicating to the local host or to a remote host without the <code class="codeph">NOFILENAMECHECK</code> clause, ensure that you do not use the name of an online redo log file that is currently in use by the source database.
                                       </p>
                                    </div>
                                 </li>
                                 <li>
                                    <p><code class="codeph">DB_FILE_NAME_CONVERT</code> and <code class="codeph">LOG_FILE_NAME_CONVERT</code> initialization parameters 
                                    </p>
                                    <p>Specifies a rule for converting file names in the source database to names in the duplicate database. You can specify multiple conversion pairs.</p>
                                    <p>When you use the <code class="codeph">DB_FILE_NAME_CONVERT</code> parameter for ASM file names, only disk group name changes must be performed.
                                    </p>
                                    <div class="infoboxnote" id="GUID-21627543-AD37-4144-9DEF-2C5AE9CC745C__GUID-AC3A8CF0-D8CD-451C-AE19-A0757345D2E8">
                                       <p class="notep1">Note:</p>
                                       <p>If the source database uses Oracle Managed Files, then you cannot use this method to specify alternative names for duplicate database files.</p>
                                    </div>
                                 </li>
                                 <li>
                                    <p><code class="codeph">DB_CREATE_FILE_DEST</code> and <code class="codeph">DB_CREATE_ONLINE_LOG_DEST</code>_n parameters
                                    </p>
                                    <p>Creates Oracle Managed Files at the location specified by these parameters. This is the recommended method to specify alternative names for OMF and ASM.</p>
                                 </li>
                              </ul>
                           </div>
                           <p>If more than one method is used to specify alternate names for duplicate database files, then the order of precedence decides which technique is used to name files. Any files that are not renamed by a particular method are renamed by the method that follows it. For example, if two data files are not included in the <code class="codeph">SET NEWNAME</code> command, then these data files are renamed by using the <code class="codeph">DB_FILE_NAME_CONVERT</code> parameter.
                           </p>
                           <div class="infoboxnotealso" id="GUID-21627543-AD37-4144-9DEF-2C5AE9CC745C__GUID-4F1E3EEE-8115-45D4-BC98-99464FC03718">
                              <p class="notep1">See Also:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><a href="rman-duplicating-databases-advanced.html#GUID-2D8041F5-A322-452F-980C-5E81E1902D1C" title="If the source database and duplicate database do not use the same names for database files, then you must choose an alternative naming strategy for the duplicate files.">Specifying Alternative Names for Duplicate Database Files</a></p>
                                 </li>
                                 <li>
                                    <p>The <code class="codeph">DUPLICATE</code> command in <a href="../rcmrf/DUPLICATE.html#RCMRF-GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a> for the <code class="codeph">LOGFILE</code> and <code class="codeph">SPFILE</code> clauses
                                    </p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-21627543-AD37-4144-9DEF-2C5AE9CC745C__GUID-F05DAB01-423C-40CC-9E17-2719345AE2AB">Preventing File Name Checking During Database Duplication</p>
                           <p>It is possible for the <code class="codeph">CONFIGURE AUXNAME</code> command, the <code class="codeph">SET NEWNAME</code> command, or the <code class="codeph">DB_FILE_NAME_CONVERT</code> parameter to generate a name that is already in use in the target database. In this case, RMAN displays an error during duplication. When duplicating to a remote host, use the <code class="codeph">NOFILENAMECHECK</code> option to avoid this error message.
                           </p>
                           <p></p>
                           <div class="infoboxnote" id="GUID-21627543-AD37-4144-9DEF-2C5AE9CC745C__GUID-6F174AC1-4EA3-41DD-9011-7AE404673F87">
                              <p class="notep1">Note:</p>
                              <p>Using <code class="codeph">NOFILENAMECHECK</code> when duplicating to the local host overwrites the target database files.
                              </p>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3" id="GUID-21627543-AD37-4144-9DEF-2C5AE9CC745C__GUID-73411970-0B03-4758-80DE-B96D046CA70D">Generating Names for Control Files in the Duplicate Database</p>
                           <p>By default, RMAN creates the control file in the default location in the duplicate database. You can specify alternate files names and directory names to store the duplicate database control files. While choosing names for the control files, ensure that you do not mistakenly overwrite the control files of the source database.</p>
                           <div class="p">Use one of the following techniques, listed in the order of precedence, to specify the location of the duplicate database control files:
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>Set the <code class="codeph">CONTROL_FILES</code> initialization parameter in the auxiliary instance's initialization parameter file.
                                    </p>
                                 </li>
                                 <li>
                                    <div class="p">Create an OMF-based control file in a location which is determined by setting one of the following parameters:
                                       <ul style="list-style-type: disc;">
                                          <li>
                                             <p><code class="codeph">DB_CREATE_ONLINE_LOG_DEST_n</code></p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">DB_CREATE_FILE_DEST</code></p>
                                          </li>
                                          <li>
                                             <p><code class="codeph">DB_RECOVERY_FILE_DEST</code></p>
                                          </li>
                                       </ul>If more than one of these parameters is set, then the order of precedence used is the order in which these parameters are listed.
                                    </div>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-CB32BB0E-5E76-4D18-8D93-0227344A8652" name="GUID-CB32BB0E-5E76-4D18-8D93-0227344A8652"></a><h4 id="BRADV-GUID-CB32BB0E-5E76-4D18-8D93-0227344A8652" class="sect4"><span class="enumeration_section">25.2.3 </span>Installing the Oracle Database Software on the Destination Host
                  </h4>
                  <div>
                     <p>When the source and destination host are different, you must install the Oracle Database software on the destination host, so that the auxiliary instance can be created. </p>
                     <div class="section">
                        <div class="infoboxnote" id="GUID-CB32BB0E-5E76-4D18-8D93-0227344A8652__GUID-D47883B6-DA9F-4128-B4D3-B76981249C10">
                           <p class="notep1">Note:</p>
                           <p>Ensure that you install the same release of Oracle Database software, with the same patch level, on both the source and destination host. </p>
                        </div>
                        <p>Use one of the following techniques to install the software:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Perform a normal installation with Oracle Universal Installer (OUI).</p>
                              <p>Install an Oracle Database whose release number is the same as that of the source database. Do not create a database; install the software only. Apply any required patches.</p>
                           </li>
                           <li>
                              <p>Clone the source Oracle home.</p>
                              <p>Use OUI to clone the source Oracle home. This ensures that all patches applied to the source database are present in the duplicate database.</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-608FAE46-DC28-43F3-83F6-0DEB73BB59ED" name="GUID-608FAE46-DC28-43F3-83F6-0DEB73BB59ED"></a><h4 id="BRADV-GUID-608FAE46-DC28-43F3-83F6-0DEB73BB59ED" class="sect4"><span class="enumeration_section">25.2.4 </span>Deciding the State of the Duplicate Database
                  </h4>
                  <div>
                     <p>When you use the RMAN <code class="codeph">DUPLICATE</code> command, the duplicate database is created and opened in <code class="codeph">RESETLOGS</code> mode. You can use the <code class="codeph">NOOPEN</code> clause in the <code class="codeph">DUPLICATE</code> command to specify that the duplicate database must not be opened.
                     </p>
                     <div class="section">
                        <div class="p">You may not want to open the duplicate database immediately after creation in the following situations:
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Opening the duplicate database may cause errors.</p>
                              </li>
                              <li>
                                 <p>You need to modify the initialization parameters of the duplicate database.</p>
                                 <p>For example, you need to modify flashback database settings, configure fast incremental backups, or modify block change tracking.</p>
                              </li>
                              <li>
                                 <p>You are creating a new database as part of an upgrade procedure.</p>
                                 <p>During an upgrade you cannot open the database with the <code class="codeph">RESETLOGS</code> option. The <code class="codeph">NOOPEN</code> clause enables you to duplicate the database and then leave it in a state that is ready for opening in upgrade mode and for subsequent execution of upgrade scripts.
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV89931"></a><div class="sect3"><a id="GUID-08282A88-3810-4C70-91D6-5C7582D5787D" name="GUID-08282A88-3810-4C70-91D6-5C7582D5787D"></a><h4 id="BRADV-GUID-08282A88-3810-4C70-91D6-5C7582D5787D" class="sect4"><span class="enumeration_section">25.2.5 </span>Making Backups Accessible to the Duplicate Instance
                  </h4>
                  <div>
                     <p>Names of the backups used during duplication are stored in the RMAN repository or control file. </p>
                     <div class="section">
                        <div class="infoboxnote" id="GUID-08282A88-3810-4C70-91D6-5C7582D5787D__GUID-50A7E65F-FEBF-449A-A5DF-67ED1EAA50CD">
                           <p class="notep1">Note:</p>
                           <p>If you are performing active database duplication, then this step is not necessary.</p>
                        </div>
                        <p>When duplicating with a target connection and recovery catalog connection or with just a target connection, RMAN uses metadata in the RMAN repository to locate backups and archived redo log files that are required for duplication. If RMAN is connected to a recovery catalog, then RMAN obtains the backup metadata from the catalog. If RMAN is not connected to a catalog, as may be the case when you perform backup-based duplication <span class="italic">with</span> a target connection, then RMAN obtains metadata from the control file.
                        </p>
                        <p>Unless you are duplicating without a connection to the target and to the recovery catalog, the names of the backups must be available with the same names recorded in the RMAN repository. Ensure that auxiliary channels on the destination host can access all data file backups and archived redo log files. This is required to restore and recover the duplicate database to the desired point in time. If not, duplication fails. The archived redo log files can be available either as image copies or backup sets.</p>
                        <div class="infoboxnote" id="GUID-08282A88-3810-4C70-91D6-5C7582D5787D__GUID-DD34CF8D-D0E9-4707-8CA1-8C12860719BC">
                           <p class="notep1">Note:</p>
                           <p>The database backup need not have been generated with the <code class="codeph">BACKUP DATABASE</code> command. You can mix full and incremental backups of individual data files, but a full backup of every data file is required.
                           </p>
                        </div>
                        <div class="infoboxnotealso" id="GUID-08282A88-3810-4C70-91D6-5C7582D5787D__GUID-5961B30B-7838-44BE-8EA4-AF63A3B4E5A7">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="rman-duplicating-databases.html#GUID-0AA97FD4-9039-42AB-8BB9-15D2CC1D1323" title="The steps to make SBT backups accessible to the auxiliary instance are specific to your media manager configuration.">Making SBT Backups Accessible to the Auxiliary Instance</a></p>
                              </li>
                              <li>
                                 <p><a href="rman-duplicating-databases.html#GUID-28AA671E-C024-4DAD-B75A-6BD903C7E84A" title="When you make disk backups accessible to the auxiliary instance, your strategy depends on whether you duplicate the database while connected to the target or recovery catalog. If you do not connect to the target or recovery catalog, then you must designate a backup location for the duplication by using the BACKUP LOCATION clause.">Making Disk Backups Accessible to the Auxiliary Instance</a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div class="sect4"><a id="GUID-0AA97FD4-9039-42AB-8BB9-15D2CC1D1323" name="GUID-0AA97FD4-9039-42AB-8BB9-15D2CC1D1323"></a><h5 id="BRADV-GUID-0AA97FD4-9039-42AB-8BB9-15D2CC1D1323" class="sect5"><span class="enumeration_section">25.2.5.1 </span>Making SBT Backups Accessible to the Auxiliary Instance
                     </h5>
                     <div>
                        <p>The steps to make SBT backups accessible to the auxiliary instance are specific to your media manager configuration.</p>
                        <div class="section">
                           <p>To make SBT backups accessible to the auxiliary instance:</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>If necessary, install media management software on the destination host.</span></li>
                           <li class="stepexpand"><span>Make the tapes with the backups accessible to the destination host. Typically, you do one of the following:</span><div>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>Physically move the tapes to a drive attached to the remote host.</p>
                                    </li>
                                    <li>
                                       <p>Use a network-accessible tape server.</p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li class="stepexpand"><span>If necessary, inform the remote media management software about the existence of the tapes.</span></li>
                        </ol>
                     </div>
                  </div><a id="BRADV99993"></a><div class="sect4"><a id="GUID-28AA671E-C024-4DAD-B75A-6BD903C7E84A" name="GUID-28AA671E-C024-4DAD-B75A-6BD903C7E84A"></a><h5 id="BRADV-GUID-28AA671E-C024-4DAD-B75A-6BD903C7E84A" class="sect5"><span class="enumeration_section">25.2.5.2 </span>Making Disk Backups Accessible to the Auxiliary Instance
                     </h5>
                     <div>
                        <p>When you make disk backups accessible to the auxiliary instance, your strategy depends on whether you duplicate the database while connected to the target or recovery catalog. If you do not connect to the target or recovery catalog, then you must designate a backup location for the duplication by using the <code class="codeph">BACKUP LOCATION</code> clause.
                        </p>
                        <div class="section">
                           <p>When you use a backup location, the backups and copies can reside in a shared location or can be moved to the location on the destination host. In the latter case, you do not need to preserve the name or the original path of the backup or copy. The location specified in the <code class="codeph">BACKUP LOCATION</code> option must contain sufficient backup sets, image copies, and archived logs to restore all of the files that are being duplicated, and recover them to the desired point in time.
                           </p>
                           <p>It is not required that all of the backups be from the same point in time, or that they all be backup sets, or all image copies. Data file backups can be supplied as either image copies or backup sets. Archived logs can be supplied either in their normal format or as backup sets of archived logs.</p>
                           <p>When you use backups from different points in time, the backup location must contain archived logs covering the time from the start of the oldest backup until the desired recovery point.</p>
                           <p>If the backup location contains backup files from multiple databases, then the <code class="codeph">DATABASE</code> clause must specify the name of the database that is to be duplicated. If the backup location contains backup files from multiple databases having the same name, then the <code class="codeph">DATABASE</code> clause must specify both the name and <code class="codeph">DBID</code> of the database that is to be duplicated.
                           </p>
                           <p>The source database's Fast Recovery Area is particularly well suited for use as a backup location because it almost always contains all the files that are required for the duplication. To use a Fast Recovery Area as a backup location, you can either remotely access it from the destination system, or copy its contents to the destination system.</p>
                           <div class="p">When you are not using a backup location, your strategy depends on the following mutually exclusive scenarios:
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>Identical file systems for source and destination hosts</p>
                                    <div class="p">This scenario is the simplest and Oracle recommends it. For example, assume that the backups of the source database are stored in the <code class="codeph">/dsk1/bkp</code> directory. In this case, you can make disk backups accessible to the destination host in either of these ways:
                                       <ul style="list-style-type: disc;">
                                          <li>
                                             <p>Manually transfer backups from the source host to an identical path in the destination host. For example, if the backups are in the <code class="codeph">/dsk1/bkp</code> directory on the source host, then use FTP to transfer them to the <code class="codeph">/dsk1/bkp</code> directory on the destination host.
                                             </p>
                                          </li>
                                          <li>
                                             <p>Use NFS or shared disks and ensure that the same path is accessible in the destination host. For example, assuming that the source host can access the <code class="codeph">/dsk1/bkp</code> directory, use NFS to mount the <code class="codeph">/dsk1/bkp</code> directory on the destination host and use <code class="codeph">/dsk1/bkp</code> as the mount point name.
                                             </p>
                                          </li>
                                       </ul>
                                    </div>
                                 </li>
                                 <li>
                                    <p>Different file systems for source and destination hosts</p>
                                    <div class="p">In this case you <span class="italic">cannot</span> use the same directory name on the destination host as you use on the source host. You have the following options:
                                       <ul style="list-style-type: disc;">
                                          <li>
                                             <p>You can use shared disk to make backups available. This section explains the shared disk technique.</p>
                                          </li>
                                          <li>
                                             <p>You cannot use shared disk to make backups available. <a href="rman-duplicating-databases-advanced.html#GUID-C575132F-23DE-47E5-8FFD-01F986F6CD13" title="You can use the shared disk technique to make backups available to the auxiliary instance. When NFS or shared disk is not an option, then the path that stores the backups must exist on both the source and destination hosts, unless the BACKUP LOCATION option is used for the DUPLICATE command without a target or recovery catalog connection.">Making Disk Backups Accessible Without Shared Disk</a> describes this technique.
                                             </p>
                                          </li>
                                       </ul>Assume that you have two hosts, <code class="codeph">srchost</code> and <code class="codeph">dsthost</code>, and access to NFS or shared disk. The database on <code class="codeph">srchost</code> is called <code class="codeph">srcdb</code>. The backups of <code class="codeph">srcdb</code> reside in the <code class="codeph">/dsk1/bkp</code> directory on host <code class="codeph">srchost</code>. The directory <code class="codeph">/dsk1/bkp</code> is in use on the destination host, but the directory <code class="codeph">/dsk2/dup</code> is not in use on either host.
                                    </div>
                                 </li>
                              </ul>
                           </div>
                           <p><span class="bold">To transfer the backups from the source host to the destination host:</span></p>
                           <ol>
                              <li>
                                 <p>Create a backup storage directory in either the source or destination host.</p>
                                 <p>For this example, create backup directory <code class="codeph">/dsk2/dup</code> on the destination host.
                                 </p>
                              </li>
                              <li>
                                 <p>Mount the directory created in the previous step on the other host, ensuring that the directory and the mount point names are the same.</p>
                                 <p>For example, if you created the <code class="codeph">/dsk2/dup</code> directory on the destination host, then use NFS to mount this directory as <code class="codeph">/dsk2/dup</code> on the source host.
                                 </p>
                              </li>
                              <li>
                                 <div class="p">Make the backups available in the new location on the destination host. You can use either of the following techniques:
                                    <ul style="list-style-type: disc;">
                                       <li>
                                          <p>Connect RMAN to the source database as TARGET and use the <code class="codeph">BACKUP</code> command to back up the backups. For example, use the <code class="codeph">BACKUP COPY OF DATABASE</code> command to copy the backups in the <code class="codeph">/dsk1/bkp</code> directory on the source host to the <code class="codeph">/dsk2/dup</code> directory on the destination host. In this case, RMAN automatically catalogs the backups in the new location.
                                          </p>
                                          <p>If you are duplicating a PDB, then use the <code class="codeph">PLUGGABLE DATABASE</code> syntax of the <code class="codeph">BACKUP COPY OF</code> command to copy only the backups of the PDB.
                                          </p>
                                       </li>
                                       <li>
                                          <p>Use an operating system utility to transfer the backups to the new location. For example, use FTP to transfer the backups from the <code class="codeph">/dsk1/bkp</code> directory on the source host to the <code class="codeph">/dsk2/dup</code> directory on the destination host, or use the <code class="codeph">cp</code> command to copy the backups from the <code class="codeph">/dsk1/bkp</code> directory on the source host to the <code class="codeph">/dsk2/dup</code> directory on the destination host. Afterward, connect RMAN to the source database as TARGET and use the <code class="codeph">CATALOG</code> command to update the RMAN repository with the location of the manually transferred backups.
                                          </p>
                                       </li>
                                    </ul>
                                 </div>
                              </li>
                           </ol>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" name="GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A"></a><h3 id="BRADV-GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" class="sect3"><span class="enumeration_section">25.3 </span>Preparing the Auxiliary Instance
               </h3>
               <div>
                  <p>RMAN uses an auxiliary instance to create the duplicate database. You must prepare the auxiliary instance before you begin the duplication. </p>
                  <p>Depending on your duplication scenario, you need to perform either some or the tasks that are described in this section. Preparing the auxiliary instance includes the following tasks:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-2ECA94F4-E8EB-43D7-9934-39F2BE281700" title="On the destination host, you must create the directories that are used to store the duplicate database files on the destination host. This includes the directories that store the data files, control files, online redo log files, and temp files.">Creating Directories for the Duplicate Database</a></p>
                     </li>
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-57888C11-63C3-4A7A-8488-2E623033A359" title="Multiple methods are available to create the initialization parameter file that is required to start the auxiliary instance.">Creating an Initialization Parameter File for the Auxiliary Instance</a></p>
                     </li>
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-A338B143-E321-4329-A2ED-2467C70C03DC" title="Connections to the auxiliary instance can be established by using operating system authentication or password file authentication. For backup-based duplication, you can either create a password file or use operating system authentication to connect to the auxiliary instance. For active database duplication, you must use password file authentication.">Creating a Password File for the Auxiliary Instance</a></p>
                     </li>
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-460171C8-2E09-4D0E-9AC3-A4C28392A220" title="You must be able to establish a connection between the source database and auxiliary instance for certain forms of duplication.">Establishing Oracle Net Connectivity Between the Source Database and Auxiliary Instance</a></p>
                     </li>
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-7534941B-A211-4EA5-87AC-D657AE51839E" title="The initialization parameter file that you create is used to start the auxiliary instance.">Starting the Auxiliary Instance</a></p>
                     </li>
                     <li>
                        <p><a href="rman-duplicating-databases.html#GUID-E016C2DC-1774-4057-8EAF-3F69E9A6322A" title="If transparent encryption is configured on the source database, then you must ensure that the Oracle software keystore from the source database is available to the auxiliary instance. Manually copy the keystore from the source database to the destination host.">Making the Oracle Keystore Available to the Destination Host</a></p>
                     </li>
                  </ul>
               </div>
               <div class="sect3"><a id="GUID-2ECA94F4-E8EB-43D7-9934-39F2BE281700" name="GUID-2ECA94F4-E8EB-43D7-9934-39F2BE281700"></a><h4 id="BRADV-GUID-2ECA94F4-E8EB-43D7-9934-39F2BE281700" class="sect4"><span class="enumeration_section">25.3.1 </span>Creating Directories for the Duplicate Database
                  </h4>
                  <p>On the destination host, you must create the directories that are used to store the duplicate database files on the destination host. This includes the directories that store the data files, control files, online redo log files, and temp files.</p>
               </div><a id="BRADV167"></a><div class="sect3"><a id="GUID-57888C11-63C3-4A7A-8488-2E623033A359" name="GUID-57888C11-63C3-4A7A-8488-2E623033A359"></a><h4 id="BRADV-GUID-57888C11-63C3-4A7A-8488-2E623033A359" class="sect4"><span class="enumeration_section">25.3.2 </span>Creating an Initialization Parameter File for the Auxiliary Instance
                  </h4>
                  <div>
                     <p>Multiple methods are available to create the initialization parameter file that is required to start the auxiliary instance.</p>
                     <div class="section">Use one of the following methods to create the initialization parameter file:
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Create an initialization parameter file manually.</p>
                              <p>If the source database does not use a server parameter file, then you must set all the necessary parameters for the auxiliary instance in a text-based initialization parameter file.</p>
                           </li>
                           <li>
                              <p>Direct RMAN to use the initialization parameter file of the source database for the auxiliary instance.</p>
                              <p>This technique is applicable only if the source database uses a server parameter file. Copying the initialization parameter file from the source database is useful when the duplicate database must use the same parameter settings as the source.</p>
                              <div class="infoboxnote" id="GUID-57888C11-63C3-4A7A-8488-2E623033A359__GUID-7B58B4DC-8F3F-4A1F-AA41-70DAE13147B3">
                                 <p class="notep1">Note:</p>
                                 <p>It is recommended to use a server parameter file instead of a text-based initialization parameter file for duplication.</p>
                              </div>
                           </li>
                        </ul>
                        <p>The client-side parameter file for the auxiliary instance must reside on the same host as the RMAN client that performs the duplication.</p>
                        <p>It is recommended that you create the initialization parameter file in the default location on the auxiliary instance. On Windows, the default initialization parameter file is <span class="italic"><code class="codeph">ORACLE_HOME</code></span><code class="codeph">/dbs/init</code><span class="italic"><code class="codeph">ORACLE_SID</code></span><code class="codeph">.ora</code> and on Linux the file name is <span class="italic"><code class="codeph">ORACLE_HOME</code></span><code class="codeph">\database\inti</code><span class="italic"><code class="codeph">ORACLE_SID</code></span><code class="codeph">.ora</code>.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="rman-duplicating-databases.html#GUID-31F759B9-862C-4B97-B14B-843E82926074">Initialization Parameters for the Auxiliary Instance</a></li>
                           <li><a href="rman-duplicating-databases.html#GUID-13FE86AF-5D6B-4573-B0DF-D98CF57DB451">Steps to Create an Initialization Parameter File for the Auxiliary Instance</a></li>
                           <li><a href="rman-duplicating-databases.html#GUID-E7FCF631-6272-41FE-93A2-CFD7C1E0A2FE">Copying the Server Parameter File from the Source Database</a></li>
                        </ul>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-13FE86AF-5D6B-4573-B0DF-D98CF57DB451" name="GUID-13FE86AF-5D6B-4573-B0DF-D98CF57DB451"></a><h5 id="BRADV-GUID-13FE86AF-5D6B-4573-B0DF-D98CF57DB451" class="sect5"><span class="enumeration_section">25.3.2.1 </span>Steps to Create an Initialization Parameter File for the Auxiliary Instance
                     </h5>
                     <div>
                        <p>The initialization parameter file for the auxiliary instance must contain at least the <code class="codeph">DB_NAME</code> and <code class="codeph">DB_DOMAIN</code> initialization parameters. Additional parameters may be specified, if required. Ensure that the initialization parameter file is on the same host as the RMAN client that performs the duplication.
                        </p>
                        <div class="section">
                           <div class="p">To create the initialization parameter file for the auxiliary instance:
                              <ol>
                                 <li>
                                    <div class="p">Do one of the following:
                                       <ul style="list-style-type: disc;">
                                          <li>
                                             <p>Copy the initialization parameter file from the source host to the destination host, placing it in the operating system-specific default location, and then modify the <code class="codeph">DB_NAME</code> and <code class="codeph">DB_DOMAIN</code> initialization parameters. 
                                             </p>
                                             <p>If you are duplicating a CDB, ensure that the <code class="codeph">ENABLE_PLUGGABLE_DATABASE</code> parameter is present and set to <code class="codeph">TRUE</code>.
                                             </p>
                                             <p>See <a href="rman-duplicating-databases.html#GUID-E7FCF631-6272-41FE-93A2-CFD7C1E0A2FE" title="If the source database uses a server parameter file, then including the SPFILE option in the DUPLICATE command directs RMAN to use the server parameter file from the source database for the auxiliary instance.">Copying the Server Parameter File from the Source Database</a>.
                                             </p>
                                          </li>
                                          <li>
                                             <p>Complete these steps:</p>
                                             <ol type="a">
                                                <li>
                                                   <p>Using a text editor, create an empty file for use as a text-based initialization parameter file, and save it in the operating system-specific default location.</p>
                                                </li>
                                                <li>
                                                   <p>In the parameter file, set the <code class="codeph">DB_NAME</code> and <code class="codeph">DB_DOMAIN</code> initialization parameters. These are the only required parameters.
                                                   </p>
                                                   <p>Setting the <code class="codeph">DB_DOMAIN</code> parameter enables you to connect to the default database service when you connect with a net service name.
                                                   </p>
                                                </li>
                                                <li>
                                                   <div class="p">If the auxiliary instance is to be a CDB, then set the following parameter:<pre class="pre codeblock"><code>ENABLE_PLUGGABLE_DATABASE=TRUE</code></pre></div>
                                                </li>
                                             </ol>
                                          </li>
                                       </ul>
                                    </div>
                                 </li>
                                 <li>
                                    <p>Set the various location parameters such as <code class="codeph">CONTROL_FILES</code> and <code class="codeph">DB_RECOVERY_FILE_DEST</code>.
                                    </p>
                                 </li>
                                 <li>
                                    <p>If necessary, set other initialization parameters like those needed for Oracle Real Application Clusters.</p>
                                 </li>
                                 <li>
                                    <p>Set the required environment variables, such as <code class="codeph">ORACLE_HOME</code> and <code class="codeph">ORACLE_SID</code>.
                                    </p>
                                 </li>
                                 <li>
                                    <p>(Optional) Set initialization parameters that specify the location of the duplicate database files if one of the following conditions is satisfied:</p>
                                    <ul style="list-style-type: disc;">
                                       <li>
                                          <p>The source host and the destination host are the same (duplication to the local host).</p>
                                       </li>
                                       <li>
                                          <p>The duplicate database uses a directory structure that is different from that of the source host to store database files.</p>
                                       </li>
                                    </ul>
                                    <p>Depending on the technique used to specify alternate names for duplicate database files, include one or more of the following parameters in the initialization parameter file: <code class="codeph">CONTROL_FILES</code>, <code class="codeph">DB_FILE_NAME_CONVERT</code>, <code class="codeph">LOG_FILE_NAME_CONVERT</code>, <code class="codeph">DB_CREATE_FILE_DEST</code>, <code class="codeph">DB_CREATE_ONLINE_FILE_DEST</code>_<span class="italic"><code class="codeph">n</code></span>, and <code class="codeph">RECOVERY_FILE_DEST</code>.
                                    </p>
                                    <div class="infoboxnote" id="GUID-13FE86AF-5D6B-4573-B0DF-D98CF57DB451__GUID-B61AA093-479F-449D-A9C1-76708C38757C">
                                       <p class="notep1">Note:</p>
                                       <p>It is recommended that you verify that all paths specified are accessible to the destination host and to the server session of the auxiliary instance.</p>
                                    </div>
                                    <p>See <span class="italic">Methods of Generating Database File Names for the Duplicate Database</span> in <span><cite>Oracle Database Backup and Recovery Users Guide</cite></span>.
                                    </p>
                                 </li>
                                 <li>
                                    <div class="p">Start SQL*Plus and connect to the auxiliary instance as a user with <code class="codeph">SYSDBA</code> or <code class="codeph">SYSBACKUP</code> privileges. Start the auxiliary instance in <code class="codeph">NOMOUNT</code> mode. If the file is in the default location, no <code class="codeph">PFILE</code> parameter is required on the <code class="codeph">STARTUP</code> command.<pre class="pre codeblock"><code>SQL&gt; STARTUP NOMOUNT;</code></pre></div>
                                 </li>
                              </ol>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-13FE86AF-5D6B-4573-B0DF-D98CF57DB451__GUID-5C664925-287C-4BB7-A3B7-1E4F001EC2E9">
                           <p class="titleinexample">Example 25-1 <span class="bold">Sample Initialization Parameter File for the Auxiliary Instance</span></p><pre class="oac_no_warn" dir="ltr">DB_NAME=dupdb
CONTROL_FILES=(/dup/oracle/oradata/prod/control01.ctl,
                dup/oracle/oradata/prod/control02.ctl)
DB_FILE_NAME_CONVERT=(/oracle/oradata/prod/,/dup/oracle/oradata/prod/)
LOG_FILE_NAME_CONVERT=(/oracle/oradata/prod/redo,/dup/oracle/oradata/prod/redo)</pre></div>
                        <!-- class="example" -->
                     </div>
                     <div>
                        <div class="relinfo">
                           <p><strong>Related Topics</strong></p>
                           <ul>
                              <li><a href="rman-duplicating-databases.html#GUID-21627543-AD37-4144-9DEF-2C5AE9CC745C" title="Depending on the method that you choose, RMAN can either automatically generate file names or use specific names for the duplicate database files. The database files include the data files, control files, online redo log files, and temp files.">Methods of Generating Database File Names for the Duplicate Database</a></li>
                           </ul>
                        </div>
                     </div>
                     
                  </div>
                  <div class="sect4"><a id="GUID-E7FCF631-6272-41FE-93A2-CFD7C1E0A2FE" name="GUID-E7FCF631-6272-41FE-93A2-CFD7C1E0A2FE"></a><h5 id="BRADV-GUID-E7FCF631-6272-41FE-93A2-CFD7C1E0A2FE" class="sect5"><span class="enumeration_section">25.3.2.2 </span>Copying the Server Parameter File from the Source Database
                     </h5>
                     <div>
                        <p>If the source database uses a server parameter file, then including the <code class="codeph">SPFILE</code> option in the <code class="codeph">DUPLICATE</code> command directs RMAN to use the server parameter file from the source database for the auxiliary instance.
                        </p>
                        <div class="section">
                           <p> For backup-based duplication, the server parameter file is restored from backups. For active database duplication, the server parameter file is copied from the source database to the auxiliary instance.</p>
                           <p>When the source database uses a text-based initialization parameter file, use the <code class="codeph">PFILE</code> clause in the <code class="codeph">DUPLICATE</code> command to copy the source database's initialization parameter file to the auxiliary instance.
                           </p>
                           <p>You can modify the values that were copied or restored from the server parameter file of the source database by using the <code class="codeph">PARAMETER_VALUE_CONVERT</code> option of <code class="codeph">SPFILE</code> or the <code class="codeph">SET</code> clause of the <code class="codeph">DUPLICATE</code>. For example, you can use the <code class="codeph">SET</code> clause to change the value of the <code class="codeph">DB_FILE_NAME_CONVERT</code> parameter in the auxiliary instance's server parameter file.
                           </p>
                           <p>If the source database does not use a server parameter file or RMAN cannot restore a backup of the server parameter file, then you must manually create a text-based initialization parameter file, as described in <a href="rman-duplicating-databases.html#GUID-13FE86AF-5D6B-4573-B0DF-D98CF57DB451" title="The initialization parameter file for the auxiliary instance must contain at least the DB_NAME and DB_DOMAIN initialization parameters. Additional parameters may be specified, if required. Ensure that the initialization parameter file is on the same host as the RMAN client that performs the duplication.">Steps to Create an Initialization Parameter File for the Auxiliary Instance</a>.
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-A338B143-E321-4329-A2ED-2467C70C03DC" name="GUID-A338B143-E321-4329-A2ED-2467C70C03DC"></a><h4 id="BRADV-GUID-A338B143-E321-4329-A2ED-2467C70C03DC" class="sect4"><span class="enumeration_section">25.3.3 </span>Creating a Password File for the Auxiliary Instance
                  </h4>
                  <div>
                     <p>Connections to the auxiliary instance can be established by using operating system authentication or password file authentication. For backup-based duplication, you can either create a password file or use operating system authentication to connect to the auxiliary instance. For active database duplication, you must use password file authentication.</p>
                     <div class="section">
                        <p>To connect to a database by using password file authentication, you must create a password file for the database. When duplicating to a remote host, setting up a password file is mandatory. The default location for the password file is <code class="codeph"><span class="variable" translate="no">$ORACLE_BASE</span>\database</code> on Windows and <code class="codeph"><span class="variable" translate="no">$ORACLE_BASE</span>/dbs</code> on Linux and UNIX.
                        </p>
                        <div class="infoboxnote" id="GUID-A338B143-E321-4329-A2ED-2467C70C03DC__GUID-13448E53-D0C8-4EDF-BD4E-CBEAF504090D">
                           <p class="notep1">Note:</p>
                           <p>When you create a standby database by using RMAN duplication, password files are always copied. In all other cases, password files are copied only if you specify the <code class="codeph">PASSWORD FILE</code> option in the <code class="codeph">DUPLICATE</code> command.
                           </p>
                        </div>
                        <p>Use one of the following options to create a password file for the auxiliary instance on the destination host:</p>
                     </div>
                     <!-- class="section" -->
                     <ul>
                        <li class="stepexpand"><span>Use operating system-specific utilities to copy the source database password file to the destination host and then rename it to match the auxiliary instance name. This is applicable only if the source and destination hosts are on the same platform.</span></li>
                        <li class="stepexpand"><span>Create the password file manually. Ensure that the password for the <code class="codeph">SYSDBA</code> and <code class="codeph">SYSBACKUP</code> users are the same in the source database and auxiliary instance.</span></li>
                        <li class="stepexpand"><span>Create the password file with the <code class="codeph">orapwd</code> utility. The <code class="codeph">SYSBACKUP</code> option creates a <code class="codeph">SYSBACKUP</code> entry in the new password file.</span><div>
                              <p>The following example creates a password file in the 12.2 format names <code class="codeph">orapworcl</code> that is located in the default location in an operating system file:
                              </p><pre class="pre codeblock"><code>orapwd FILE='/u01/oracle/dbs/orapworcl' FORMAT=12.2</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Specify the <code class="codeph">PASSWORD FILE</code> option on the <code class="codeph">DUPLICATE... FROM ACTIVE DATABASE</code> command.</span><div>
                              <p>RMAN copies the source database password file to the destination host and overwrites any existing password file for the auxiliary instance. This technique is useful if the source database password file has multiple passwords to make available on the duplicate database.</p>
                              <p>When you use active database duplication, the password file must contain at least two passwords, for the <code class="codeph">SYS</code> user and the <code class="codeph">SYSBACKUP</code> user. These passwords must match the passwords in the source database.
                              </p>
                              <div class="infoboxnote" id="GUID-A338B143-E321-4329-A2ED-2467C70C03DC__GUID-A12FD4AE-8131-41DA-A65A-4998CA01C6D6">
                                 <p class="notep1">Note:</p>
                                 <p>If you create a standby database with the <code class="codeph">FROM ACTIVE DATABASE</code> option, then RMAN always copies the password file to the standby host.
                                 </p>
                              </div>
                           </div>
                        </li>
                     </ul>
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-A338B143-E321-4329-A2ED-2467C70C03DC__GUID-C03B686F-02AA-416E-A90C-B898CDD898A9">
                           <p class="notep1">See Also:</p>
                           <p><a href="../admin/getting-started-with-database-administration.html#ADMIN-GUID-26EC8D1B-7A2F-4F0A-9588-D92CBD610858" target="_blank"><span><cite>Oracle Database Administrators Guide</cite></span></a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-460171C8-2E09-4D0E-9AC3-A4C28392A220" name="GUID-460171C8-2E09-4D0E-9AC3-A4C28392A220"></a><h4 id="BRADV-GUID-460171C8-2E09-4D0E-9AC3-A4C28392A220" class="sect4"><span class="enumeration_section">25.3.4 </span>Establishing Oracle Net Connectivity Between the Source Database and Auxiliary Instance
                  </h4>
                  <div>
                     <p>You must be able to establish a connection between the source database and auxiliary instance for certain forms of duplication.</p>
                     <div class="section">If any of the following conditions is true, the auxiliary instance must be available through Oracle Net Services:
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>The RMAN client is run from a host other than the destination host</p>
                           </li>
                           <li>
                              <p>The duplication technique chosen is active database duplication</p>
                           </li>
                           <li>
                              <p>The destination host is different from the source host</p>
                           </li>
                        </ul>
                        <p>To perform active database duplication, you must connect to the auxiliary instance with <code class="codeph">SYSDBA</code> or <code class="codeph">SYSBACKUP</code> privilege and by using a net service name. The source database to which RMAN is connected as <code class="codeph">TARGET</code> uses this net service name to connect directly to the auxiliary database instance.
                        </p>
                        <p>To establish Oracle Net connectivity and set up a static listener:</p>
                     </div>
                     <!-- class="section" -->
                     <ul>
                        <li><span>Follow the instructions in <a href="configuring-rman-client-basic.html#GUID-30772A33-4C40-42D2-89AE-FDAC92DF44C9" target="_blank"><span><cite>Oracle Database Administrators Guide</cite></span></a> to configure a client for connection to a database and add static service information for the listener.</span></li>
                     </ul>
                     <div class="example" id="GUID-460171C8-2E09-4D0E-9AC3-A4C28392A220__GUID-A77B761E-5FE2-4EE5-9377-D1AF79EF92B5">
                        <p class="titleinexample">Example 25-2 Example: Establishing Oracle Net Connectivity Between the Source Database and Auxiliary Instance</p>
                        <p>Assume that the <code class="codeph">DB_NAME</code> of the source database is <code class="codeph">src</code> and the source host is <code class="codeph">src.example.com</code>. The <code class="codeph">DB_NAME</code> of the auxiliary instance is <code class="codeph">dup</code> and the auxiliary instance is created on the host <code class="codeph">dup.example.com</code>.
                        </p>
                        <div class="p">Use the following steps to establish Oracle Net connectivity between the source database and the auxiliary instance:
                           <ol>
                              <li>
                                 <div class="p">In the <code class="codeph">tnanames.ora</code> file of the source database, add the following entry that corresponds to the duplicate database:<pre class="pre codeblock"><code>dupdb = (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=dup.example.com)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=dup)))</code></pre></div>
                              </li>
                              <li>
                                 <div class="p">On the destination host, create the <code class="codeph">tnsnames.ora</code> file in the <code class="codeph">$</code><span class="italic"><code class="codeph">ORACLE_HOME</code></span><code class="codeph">/admin/network</code> folder. Add the following entry that corresponds to the source database.<pre class="pre codeblock"><code>srcdb = (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=src.example.com)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=src)))</code></pre></div>
                              </li>
                           </ol>
                        </div>
                     </div>
                     <!-- class="example" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-7534941B-A211-4EA5-87AC-D657AE51839E" name="GUID-7534941B-A211-4EA5-87AC-D657AE51839E"></a><h4 id="BRADV-GUID-7534941B-A211-4EA5-87AC-D657AE51839E" class="sect4"><span class="enumeration_section">25.3.5 </span>Starting the Auxiliary Instance
                  </h4>
                  <div>
                     <p>The initialization parameter file that you create is used to start the auxiliary instance.</p>
                     <div class="section">RMAN shuts down and restarts the auxiliary instance as part of the duplication. Hence, it is a good idea to create a server-side initialization parameter file for the auxiliary instance in the default location. If you do not have a server-side initialization parameter file in the default location, then you must specify the client-side initialization parameter file with the <code class="codeph">PFILE</code> parameter on the <code class="codeph">DUPLICATE</code> command. 
                        <div class="infoboxnote" id="GUID-7534941B-A211-4EA5-87AC-D657AE51839E__GUID-655893EB-4C9F-4F74-BD84-D56807691215">
                           <p class="notep1">Note:</p>
                           <p>Because the auxiliary instance does not yet have a control file, you can only start the instance in <code class="codeph">NOMOUNT</code> mode. Do not create a control file or try to mount or open the auxiliary instance.
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>To start the auxiliary instance:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Start RMAN.</span><div><pre class="pre codeblock"><code>% rman</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Connect to the auxiliary instance as a user with the <code class="codeph">SYSDBA</code> or <code class="codeph">SYSBACKUP</code> privilege. The following example uses password file authentication to connect to the auxiliary instance.</span><div><pre class="pre codeblock"><code>RMAN&gt; CONNECT SYS@dupdb AS SYSDBA;</code></pre><div class="p">The following example uses operating system authentication to connect to the auxiliary instance by using the <code class="codeph">SYSBACKUP</code> privilege.<pre class="pre codeblock"><code>RMAN&gt; CONNECT / AS SYSBACKUP;</code></pre></div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Start the auxiliary instance in <code class="codeph">NOMOUNT</code> mode.</span><div><pre class="pre codeblock"><code>RMAN &gt; STARTUP FORCE NOMOUNT;</code></pre></div>
                        </li>
                     </ol>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="rman-duplicating-databases.html#GUID-57888C11-63C3-4A7A-8488-2E623033A359" title="Multiple methods are available to create the initialization parameter file that is required to start the auxiliary instance.">Creating an Initialization Parameter File for the Auxiliary Instance</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div>
               <div class="sect3"><a id="GUID-E016C2DC-1774-4057-8EAF-3F69E9A6322A" name="GUID-E016C2DC-1774-4057-8EAF-3F69E9A6322A"></a><h4 id="BRADV-GUID-E016C2DC-1774-4057-8EAF-3F69E9A6322A" class="sect4"><span class="enumeration_section">25.3.6 </span>Making the Oracle Keystore Available to the Destination Host
                  </h4>
                  <div>
                     <p>If transparent encryption is configured on the source database, then you must ensure that the Oracle software keystore from the source database is available to the auxiliary instance. Manually copy the keystore from the source database to the destination host.</p>
                     <div class="section">
                        <p>The Oracle software keystore contains the TDE master key used to:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>decrypt encrypted backups when performing backup-based duplication.</p>
                           </li>
                           <li>
                              <p>decrypt database or tablespace data when performing active database duplication of TDE-encrypted databases or tablespaces.</p>
                           </li>
                        </ul>
                        <p>The following are the requirements for the keystore at the duplicate database:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>The keystore must be in the default location, or in the location indicated by the <code class="codeph">sqlnet.ora</code> file.
                              </p>
                           </li>
                           <li>
                              <p>Permissions on the Oracle keystore file must be set so that the database can access the file.</p>
                           </li>
                           <li>
                              <p>During duplication, the auxiliary instance is restarted thereby causing the Oracle software keystore to become unavailable. To ensure that the auxiliary instance has access to the keystore, set the <code class="codeph">ENCRYPTION_WALLET_LOCATION</code> parameter in the <code class="codeph">sqlnet.ora</code> file such that it points to the keystore location. 
                              </p>
                              <p></p>
                              <p>The <code class="codeph">ENCRYPTION_WALLET_LOCATION</code> <code class="codeph">sqlnet.ora</code> parameter is deprecated in Oracle Database Release 19c. Use the  <code class="codeph">WALLET_ROOT</code> initialization parameter with the <code class="codeph">TDE_CONFIGURATION</code> initialization parameter to configure the software keystore location.
                              </p>
                           </li>
                           <li>
                              <p>With Oracle Real Application Clusters (Oracle RAC), register the auxiliary instance statically with an Oracle Grid Infrastructure listener and use the <code class="codeph">ENVS</code> parameter in the <code class="codeph">sqlnet.ora</code> file of the Oracle Grid home to specify environment variables that set the keystore location and the unique name of the database.
                              </p>
                              <p>The following example sets the <code class="codeph">ENVS</code> parameter in <code class="codeph">sqlnet.ora</code> to specify the keystore location and unique database name:
                              </p><pre class="pre codeblock"><code> (ENVS="ORACLE_UNQNAME=cdbrptl, ENCRYPTION_WALLET_LOCATION=(SOURCE=(METHOD=FILE)(METHOD_DATA=(DIRECTORY=/etc/ORACLE/WALLETS/cdbrpt1)))")</code></pre></li>
                           <li>
                              <p></p>
                              <p>If the source database uses a password-based software keystore (not an auto-login software keystore), then you must provide the keystore password before you begin the duplication.</p>
                              <p>Use the <code class="codeph">SET</code> command with the <code class="codeph">DECRYPTION WALLET OPEN IDENTIFIED BY</code> clause to specify the password that must be used to open the keystore.
                              </p>
                              <div class="p">The following command specifies the password used to open the keystore (where <code class="codeph"><span class="variable" translate="no">password</span></code> is a placeholder for the actual password that you enter): <pre class="pre codeblock"><code>SET DECRYPTION WALLET OPEN IDENTIFIED BY <span class="variable" translate="no">password</span>;</code></pre></div>
                           </li>
                        </ul>
                        <div class="infoboxnotealso" id="GUID-E016C2DC-1774-4057-8EAF-3F69E9A6322A__GUID-2FA38F77-85FA-4D0C-AEF8-D17F4ABA1395">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="../asoag/using-sqlnet-ora-to-configure-tde-keystores.html#ASOAG-GUID-278422A5-1F77-4E82-B4A1-578F03AE30FD" target="_blank"><span><cite>Oracle Database Advanced Security Guide</cite></span></a> for information about specifying the Oracle keystore location in <code class="codeph">sqlnet.ora</code></p>
                              </li>
                              <li>
                                 <p><a href="../asoag/configuring-transparent-data-encryption.html#ASOAG-GUID-1FA85E9E-5666-4CF3-A3C7-1F8A9230B0C9" target="_blank"><span><cite>Oracle Database Advanced Security Guide</cite></span></a> for information about the default Oracle keystore location
                                 </p>
                              </li>
                              <li>
                                 <p><a href="../asoag/configuring-transparent-data-encryption.html#ASOAG-GUID-98BA94DA-571B-429C-8E7A-B6A1020E9420" target="_blank"><span><cite>Oracle Database Advanced Security Guide</cite></span></a> for information about converting a standard Oracle keystore to an auto-login keystore
                                 </p>
                              </li>
                              <li>
                                 <p><a href="../rcmrf/SET.html#RCMRF-GUID-BC501B5C-4CD0-485D-AA18-27E2894024C3" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a> for information about the <code class="codeph">SET</code> command
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="BRADV168"></a><div class="sect2"><a id="GUID-9AA25E86-888F-4E72-B0BC-E3849F39B76A" name="GUID-9AA25E86-888F-4E72-B0BC-E3849F39B76A"></a><h3 id="BRADV-GUID-9AA25E86-888F-4E72-B0BC-E3849F39B76A" class="sect3"><span class="enumeration_section">25.4 </span>Duplicating a Database
               </h3>
               <div>
                  <p>This section describes how to perform database duplication. The steps to duplicate CDBs and PDBs have minor variations from the steps used for non-CDBs.</p>
                  <div class="infoboxnote" id="GUID-9AA25E86-888F-4E72-B0BC-E3849F39B76A__GUID-32A1352A-6E24-40ED-8C9F-1E714099678B">
                     <p class="notep1">Note:</p>
                     <p>Performing simultaneous duplication operations using the same source database is not supported.</p>
                  </div>
                  <div class="infoboxnotealso" id="GUID-9AA25E86-888F-4E72-B0BC-E3849F39B76A__GUID-BA3FD858-271A-4E71-8FA6-543B27CED8CA">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-CAC32870-C67F-465F-9449-EC87AC95BF95" title="Use the DUPLICATE command to duplicate databases.">Duplicating the Whole Database</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-37957032-254D-4F4F-93AD-428C1073931F" title="You can duplicate specified tablespaces within a source database.">Duplicating a Subset of the Source Database Tablespaces</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-BCFE0E2F-5F5D-4D52-9749-2FC171F39BCF" title="The steps to duplicate an Oracle Real Application Clusters (Oracle RAC) database contain minor variations from the ones used to duplicate databases.">Duplicating an Oracle RAC Database</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-563EFE61-1CD4-4796-97B8-80D0239EF2A5" title="The duplication process for a sparse database begins with an implicit restore and then completes duplicating the database containing sparse data files.">Duplicating Sparse Databases</a></p>
                        </li>
                     </ul>
                  </div>
               </div><a id="BRADV89930"></a><div class="sect3"><a id="GUID-CAC32870-C67F-465F-9449-EC87AC95BF95" name="GUID-CAC32870-C67F-465F-9449-EC87AC95BF95"></a><h4 id="BRADV-GUID-CAC32870-C67F-465F-9449-EC87AC95BF95" class="sect4"><span class="enumeration_section">25.4.1 </span>Duplicating the Whole Database
                  </h4>
                  <div>
                     <p>Use the <code class="codeph"><code class="codeph">DUPLICATE</code></code> command to duplicate databases.
                     </p>
                     <div class="section">
                        <p><span class="bold"><span class="bold">To duplicate a database:</span></span></p>
                        <ol>
                           <li>
                              <p>Ensure that the prerequisites for the selected duplication technique are met.</p>
                              <p>See <a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="The prerequisites depend on the type of database duplication being performed. Some prerequisites are common to all types of duplication and others are specific to a particular type of duplication.">Prerequisites for Duplicating a Database</a>.
                              </p>
                           </li>
                           <li>
                              <p>Complete the required planning tasks before you begin database duplication. </p>
                              <p>See <a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="Before duplicating a database, you must make some decisions about the duplication process.">Planning to Duplicate a Database</a>.
                              </p>
                           </li>
                           <li>
                              <p>Prepare the auxiliary instance that is used when creating the duplicate database.</p>
                              <p>See <a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN uses an auxiliary instance to create the duplicate database. You must prepare the auxiliary instance before you begin the duplication.">Preparing the Auxiliary Instance</a>.
                              </p>
                           </li>
                           <li>
                              <p>Start RMAN and connect to required databases. Depending on your duplication technique, you may need to connect to one or more of the following: target database, auxiliary instance, or recovery catalog.</p>
                              <p>See <a href="rman-duplicating-databases.html#GUID-CF2871A5-C9F7-4EAF-A583-8A8966264B05" title="You must start the RMAN client and connect to the database instances as required by the chosen duplication technique. The RMAN client can be located on any host so long as it can connect to the necessary databases over the network.">Starting RMAN and Connecting to Databases</a>.
                              </p>
                           </li>
                           <li>
                              <p>Place the source database in a proper state (if necessary).</p>
                              <p>See <a href="rman-duplicating-databases.html#GUID-8204DB9C-2BEF-419A-B96E-1B1C977F5AFE" title="If RMAN is connected to the source database as TARGET, then the source database must be in a proper state for duplication.">Placing the Source Database in a Proper State</a>.
                              </p>
                           </li>
                           <li>
                              <p>(Optional) Configure RMAN channels to improve duplication performance. Channels perform the primary task of duplicating the database. .</p>
                              <p>See <a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="The primary job of database duplication is performed by RMAN channels. Each channel corresponds to an Oracle Database server session that performs the duplication tasks. Depending on the duplication technique, RMAN uses either auxiliary channels or target channels.">Configuring RMAN Channels for Use in Duplication</a>.
                              </p>
                           </li>
                           <li>
                              <p>Use the <code class="codeph">DUPLICATE</code> command to duplicate the source database. 
                              </p>
                              <p>See <a href="rman-duplicating-databases.html#GUID-571FD3C7-BF5A-4CF4-970A-9F8CAC3DF1F1" title="RMAN provides multiple options for duplicating databases by using the DUPLICATE command.">Using the DUPLICATE Command to Duplicate Databases</a>.
                              </p>
                           </li>
                        </ol>
                        <p>When you perform active database duplication, you can encrypt or compress the backup sets that are used to transfer files from the source database to the duplicate database. Additionally, you can create backup sets on the source database in parallel by using multisection backups.</p>
                        <div class="infoboxnotealso" id="GUID-CAC32870-C67F-465F-9449-EC87AC95BF95__GUID-B3B25CBC-B58A-4992-B57B-B966C6105808">
                           <p class="notep1">See Also:</p>
                           <p><a href="rman-duplicating-databases.html#GUID-3C3A10DE-A843-4F48-AB34-E6D0064FDE9F" title="You must understand some basic concepts before duplicating a database.">Basic Concepts of Database Duplication</a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-37957032-254D-4F4F-93AD-428C1073931F" name="GUID-37957032-254D-4F4F-93AD-428C1073931F"></a><h4 id="BRADV-GUID-37957032-254D-4F4F-93AD-428C1073931F" class="sect4"><span class="enumeration_section">25.4.2 </span>Duplicating a Subset of the Source Database Tablespaces
                  </h4>
                  <div>
                     <p>You can duplicate specified tablespaces within a source database.</p>
                     <div class="section">
                        <p><span class="bold">To duplicate some tablespaces in a database:</span></p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Ensure that the prerequisites for the selected duplication technique are met.</span><div>
                              <p>See <a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="The prerequisites depend on the type of database duplication being performed. Some prerequisites are common to all types of duplication and others are specific to a particular type of duplication.">Prerequisites for Duplicating a Database</a>.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Complete the required planning tasks before you begin database duplication. </span><div>
                              <p>See <a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="Before duplicating a database, you must make some decisions about the duplication process.">Planning to Duplicate a Database</a>.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Prepare the auxiliary instance that is used when creating the duplicate database.</span><div>
                              <p>See <a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN uses an auxiliary instance to create the duplicate database. You must prepare the auxiliary instance before you begin the duplication.">Preparing the Auxiliary Instance</a>.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Start RMAN and connect to required databases. Depending on your duplication technique, you may need to connect to one or more of the following: target database, auxiliary instance, or recovery catalog.</span><div>
                              <p>See <a href="rman-duplicating-databases.html#GUID-CF2871A5-C9F7-4EAF-A583-8A8966264B05" title="You must start the RMAN client and connect to the database instances as required by the chosen duplication technique. The RMAN client can be located on any host so long as it can connect to the necessary databases over the network.">Starting RMAN and Connecting to Databases</a>.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Place the source database in a proper state (if necessary).</span><div>
                              <p>See <a href="rman-duplicating-databases.html#GUID-8204DB9C-2BEF-419A-B96E-1B1C977F5AFE" title="If RMAN is connected to the source database as TARGET, then the source database must be in a proper state for duplication.">Placing the Source Database in a Proper State</a>.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>(Optional) Configure RMAN channels to improve duplication performance. Channels perform the primary task of duplicating the database.</span><div>
                              <p>See <a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="The primary job of database duplication is performed by RMAN channels. Each channel corresponds to an Oracle Database server session that performs the duplication tasks. Depending on the duplication technique, RMAN uses either auxiliary channels or target channels.">Configuring RMAN Channels for Use in Duplication</a>.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Run the <code class="codeph">DUPLICATE</code> command with one or more of the options in <a href="rman-duplicating-databases.html#GUID-31F759B9-862C-4B97-B14B-843E82926074__GUID-F322CB44-D43D-4B1C-894B-30A4D80C1F1D" title="This table describes the initialization parameters that are set for the auxiliary instance.">Table 25-1</a>. </span><div>
                              <p>Other factors that influence what tablespaces are copied include the <code class="codeph">OFFLINE NORMAL</code> option. When tablespaces are taken offline with the <code class="codeph">OFFLINE NORMAL</code> option before duplication, RMAN does not duplicate the associated data files, and issues <code class="codeph">DROP TABLESPACE</code> statement for these tablespaces on the duplicate database. Therefore, you do not have to specify options to exclude these tablespaces.
                              </p>
                              <div class="infoboxnote" id="GUID-37957032-254D-4F4F-93AD-428C1073931F__GUID-7133B89B-EBB0-415D-97BA-DF66F30B2B68">
                                 <p class="notep1">Note:</p>
                                 <p>RMAN does duplicate tablespaces that are taken offline with any other option besides <code class="codeph">NORMAL</code> (unless they are named in a <code class="codeph">SKIP TABLESPACE</code> option). Only <code class="codeph">OFFLINE NORMAL</code> tablespaces are skipped automatically. As with online tablespaces, RMAN requires a valid backup for these tablespaces when you use backup-based duplication.
                                 </p>
                              </div>
                           </div>
                        </li>
                     </ol>
                     <div class="example" id="GUID-37957032-254D-4F4F-93AD-428C1073931F__GUID-3A35DB46-6C61-4C86-8744-8DA83B847D7F">
                        <p class="titleinexample">Example 25-3 Excluding Read-Only Tablespaces</p>
                        <p>This example shows how to skip read-only tablespaces during database duplication</p><pre class="pre codeblock"><code>DUPLICATE TARGET DATABASE TO dupdb
FROM ACTIVE DATABASE
SKIP READONLY;
</code></pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-37957032-254D-4F4F-93AD-428C1073931F__GUID-9ACA5983-AB52-4B72-941C-AC63D0435AFE">
                        <p class="titleinexample">Example 25-4 Excluding Specified Tablespaces</p>
                        <p>This example shows how to skip a tablespace named <code class="codeph">tools</code> during database duplication.
                        </p><pre class="pre codeblock"><code>DUPLICATE TARGET DATABASE
 TO dupdb
FROM ACTIVE DATABASE
SKIP TABLESPACE tools;</code></pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-37957032-254D-4F4F-93AD-428C1073931F__GUID-FACF4A0C-2D1E-4CF1-9AB8-A4F51249E0CA">
                        <p class="titleinexample">Example 25-5 Including Specified Tablespaces</p>
                        <p>You can use the <code class="codeph">TABLESPACE</code> option to specify which tablespaces to include in the specified database. The remaining tablespaces are skipped. The duplicated subset of tablespaces must be self-contained. The resulting set of skipped tablespaces must not have undo segments or materialized views. 
                        </p>
                        <p>This example includes the <code class="codeph">users</code> tablespace, which is assumed to be self-contained, and all other tablespaces are excluded, except for <code class="codeph">SYSTEM</code> and <code class="codeph">SYSAUX</code> tablespaces and tablespaces with undo segments.
                        </p><pre class="pre codeblock"><code>DUPLICATE TARGET DATABASE
TO dupdb
FROM ACTIVE DATABASE
  TABLESPACE users;</code></pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-37957032-254D-4F4F-93AD-428C1073931F__GUID-2DD4743C-DB20-4F28-BFD3-60CF449EBF39">
                        <p class="titleinexample">Example 25-6 Including Specified Tablespaces with Undo Segments</p>
                        <p>This example performs backup-based duplication with a target connection, but without a recovery catalog connection. You want to specify a subset of tablespaces for duplication. If the target database is not open in this scenario, then RMAN has no way to obtain the names of the tablespaces with undo segments. Thus, you must specify the <code class="codeph">UNDO TABLESPACE</code> option for these tablespaces. The <code class="codeph">users</code> tablespace must be self-contained. The resulting set of skipped tablespaces must not have undo segments or materialized views. 
                        </p><pre class="pre codeblock"><code>DUPLICATE TARGET DATABASE TO dupdb
 TABLESPACE users
 UNDO TABLESPACE undotbs;</code></pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-BCFE0E2F-5F5D-4D52-9749-2FC171F39BCF" name="GUID-BCFE0E2F-5F5D-4D52-9749-2FC171F39BCF"></a><h4 id="BRADV-GUID-BCFE0E2F-5F5D-4D52-9749-2FC171F39BCF" class="sect4"><span class="enumeration_section">25.4.3 </span>Duplicating an Oracle RAC Database
                  </h4>
                  <div>
                     <p>The steps to duplicate an Oracle Real Application Clusters (Oracle RAC) database contain minor variations from the ones used to duplicate databases.</p>
                     <ol>
                        <li class="stepexpand"><span>Ensure that the prerequisites for the selected duplication technique are met.</span><div>
                              <p>See <a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="The prerequisites depend on the type of database duplication being performed. Some prerequisites are common to all types of duplication and others are specific to a particular type of duplication.">Prerequisites for Duplicating a Database</a>.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Complete the required planning tasks before you begin database duplication. </span><div>
                              <p>See <a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="Before duplicating a database, you must make some decisions about the duplication process.">Planning to Duplicate a Database</a>.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Prepare the auxiliary instance that is used when creating the duplicate database.</span><div>
                              <p>While duplicating an Oracle Real Application Clusters (Oracle RAC) database, set the <code class="codeph">CLUSTER_DATABASE</code> initialization parameter on the auxiliary database to FALSE. This parameter can be reset to TRUE after the duplication completes.
                              </p>
                              <p>See <a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN uses an auxiliary instance to create the duplicate database. You must prepare the auxiliary instance before you begin the duplication.">Preparing the Auxiliary Instance</a>.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Start RMAN and connect to required databases. Depending on your duplication technique, you may need to connect to one or more of the following: target database, auxiliary instance, or recovery catalog.</span><div>
                              <p>See <a href="rman-duplicating-databases.html#GUID-CF2871A5-C9F7-4EAF-A583-8A8966264B05" title="You must start the RMAN client and connect to the database instances as required by the chosen duplication technique. The RMAN client can be located on any host so long as it can connect to the necessary databases over the network.">Starting RMAN and Connecting to Databases</a>.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Place the source database in a proper state (if necessary).</span><div>
                              <p>See <a href="rman-duplicating-databases.html#GUID-8204DB9C-2BEF-419A-B96E-1B1C977F5AFE" title="If RMAN is connected to the source database as TARGET, then the source database must be in a proper state for duplication.">Placing the Source Database in a Proper State</a>.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>(Optional) Configure RMAN channels to improve duplication performance. Channels perform the primary task of duplicating the database.</span><div>
                              <p>See <a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="The primary job of database duplication is performed by RMAN channels. Each channel corresponds to an Oracle Database server session that performs the duplication tasks. Depending on the duplication technique, RMAN uses either auxiliary channels or target channels.">Configuring RMAN Channels for Use in Duplication</a>.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Use the <code class="codeph">DUPLICATE</code> command to duplicate the source database.</span><div>
                              <p>See <a href="rman-duplicating-databases.html#GUID-571FD3C7-BF5A-4CF4-970A-9F8CAC3DF1F1" title="RMAN provides multiple options for duplicating databases by using the DUPLICATE command.">Using the DUPLICATE Command to Duplicate Databases</a>.
                              </p> 
                              <p></p>
                              <div class="infoboxnote" id="GUID-BCFE0E2F-5F5D-4D52-9749-2FC171F39BCF__GUID-03E71DA9-74D6-4780-B98A-70070FDA1505">
                                 <p class="notep1">Note:</p>
                                 <p>For more information about duplicating an Oracle RAC database, refer to My Oracle Support Note 1617946.1 at <a href="https://support.oracle.com/rs?type=doc&amp;id=1617946.1" target="_blank"><code class="codeph">https://support.oracle.com/rs?type=doc&amp;id=1617946.1</code></a></p>
                              </div>
                           </div>
                        </li>
                     </ol>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-563EFE61-1CD4-4796-97B8-80D0239EF2A5" name="GUID-563EFE61-1CD4-4796-97B8-80D0239EF2A5"></a><h4 id="BRADV-GUID-563EFE61-1CD4-4796-97B8-80D0239EF2A5" class="sect4"><span class="enumeration_section">25.4.4 </span>Duplicating Sparse Databases
                  </h4>
                  <div>
                     <p>The duplication process for a sparse database begins with an implicit restore and then completes duplicating the database containing sparse data files. </p>
                     <div class="p">
                        <p>Ensure that the backing file of the sparse data file is available for duplication.</p>
                        <div class="infoboxnote" id="GUID-563EFE61-1CD4-4796-97B8-80D0239EF2A5__GUID-0A3623A6-B9BF-4306-A83C-C7FD06BBF163">
                           <p class="notep1">Note:</p>
                           <p>Active database duplication is not allowed for sparse databases.</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-563EFE61-1CD4-4796-97B8-80D0239EF2A5__GUID-054E30D5-5A34-4A1D-AA1F-29CFF98382ED">To duplicate a sparse database:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Ensure that the prerequisites for the selected duplication technique are met.</span><div>
                              <p>See <a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="The prerequisites depend on the type of database duplication being performed. Some prerequisites are common to all types of duplication and others are specific to a particular type of duplication.">Prerequisites for Duplicating a Database</a>.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Complete the required planning tasks before you begin database duplication. </span><div>
                              <p>See <a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="Before duplicating a database, you must make some decisions about the duplication process.">Planning to Duplicate a Database</a>.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Prepare the auxiliary instance that is used when creating the duplicate database.</span><div>
                              <p>While duplicating an Oracle Real Application Clusters (Oracle RAC) database, set the <code class="codeph">CLUSTER_DATABASE</code> initialization parameter on the auxiliary database to FALSE. This parameter can be reset to TRUE after the duplication completes.
                              </p>
                              <p>See <a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN uses an auxiliary instance to create the duplicate database. You must prepare the auxiliary instance before you begin the duplication.">Preparing the Auxiliary Instance</a>.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Start RMAN and connect to required databases. Depending on your duplication technique, you may need to connect to one or more of the following: target database, auxiliary instance, or recovery catalog.</span><div>
                              <p>See <a href="rman-duplicating-databases.html#GUID-CF2871A5-C9F7-4EAF-A583-8A8966264B05" title="You must start the RMAN client and connect to the database instances as required by the chosen duplication technique. The RMAN client can be located on any host so long as it can connect to the necessary databases over the network.">Starting RMAN and Connecting to Databases</a>.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Place the source database in a proper state (if necessary).</span><div>
                              <p>See <a href="rman-duplicating-databases.html#GUID-8204DB9C-2BEF-419A-B96E-1B1C977F5AFE" title="If RMAN is connected to the source database as TARGET, then the source database must be in a proper state for duplication.">Placing the Source Database in a Proper State</a>.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>(Optional) Configure RMAN channels to improve duplication performance. Channels perform the primary task of duplicating the database.</span><div>
                              <p>See <a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="The primary job of database duplication is performed by RMAN channels. Each channel corresponds to an Oracle Database server session that performs the duplication tasks. Depending on the duplication technique, RMAN uses either auxiliary channels or target channels.">Configuring RMAN Channels for Use in Duplication</a>.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Run the <code class="codeph">DUPLICATE</code> command for the sparse database.</span><div>The following command duplicates the sparse database <code class="codeph">db1</code> :<pre class="oac_no_warn" dir="ltr">DUPLICATE FROM SPARSE DATABASE 'DB1' TO 'DUP1';</pre><div class="infoboxnote" id="GUID-563EFE61-1CD4-4796-97B8-80D0239EF2A5__GUID-121B0C3B-6048-40A6-B9D5-20A88AFA7B43">
                                 <p class="notep1">Note:</p>
                                 <p>The base (read-only) data files in a sparse database are not encrypted. Ensure that the base data files are stored in a protected storage and accessed using secured communications.</p>
                              </div>
                           </div>
                        </li>
                     </ol>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" name="GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B"></a><h4 id="BRADV-GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" class="sect4"><span class="enumeration_section">25.4.5 </span>Configuring RMAN Channels for Use in Duplication
                  </h4>
                  <div>
                     <p>The primary job of database duplication is performed by RMAN channels. Each channel corresponds to an Oracle Database server session that performs the duplication tasks. Depending on the duplication technique, RMAN uses either auxiliary channels or target channels.</p>
                     <div class="section">
                        <p>Use one of the following methods to configure channels:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Automatically allocate channels by using the <code class="codeph">CONFIGURE</code> command
                              </p>
                           </li>
                           <li>
                              <p>Manually allocate channels by using the <code class="codeph">ALLOCATE</code> command
                              </p>
                           </li>
                        </ul>
                        <p>If no automatic channels are configured, then you can manually allocate at least one channel before you being the duplication. The <code class="codeph">ALLOCATE</code> command that allocates channels must be in the same <code class="codeph">RUN</code> block as the <code class="codeph">DUPLICATE</code> command.
                        </p>
                        <p>RMAN can use the same channel configurations on the source database for duplication on the destination host even if the source database channels do not specify the <code class="codeph">AUXILIARY</code> option.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B__GUID-D7AA490F-CBFE-40F0-A271-F3D4D25ADB43">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="rman-duplicating-databases.html#GUID-17D02072-3003-4003-AC6F-BE680B4F107D" title="For backup-based duplication, the principal work of the duplication is performed by the auxiliary channels. An auxiliary channel corresponds to a server session on the auxiliary instance on the destination host. RMAN uses the channels to restore backups in the auxiliary instance.">Configuring Channels for Backup-based Duplication</a></p>
                              </li>
                              <li>
                                 <p><a href="rman-duplicating-databases.html#GUID-922BBA95-FCCD-4BEB-A69D-96C662F468E6" title="With active database duplication, you need not change your source database channel configuration or configure auxiliary channels. However, you may want to increase the parallelism setting of the source database disk channels so that RMAN copies files over the network in parallel.">Configuring Channels for Active Database Duplication</a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div class="sect4"><a id="GUID-17D02072-3003-4003-AC6F-BE680B4F107D" name="GUID-17D02072-3003-4003-AC6F-BE680B4F107D"></a><h5 id="BRADV-GUID-17D02072-3003-4003-AC6F-BE680B4F107D" class="sect5"><span class="enumeration_section">25.4.5.1 </span>Configuring Channels for Backup-based Duplication
                     </h5>
                     <div>
                        <p>For backup-based duplication, the principal work of the duplication is performed by the auxiliary channels. An auxiliary channel corresponds to a server session on the auxiliary instance on the destination host. RMAN uses the channels to restore backups in the auxiliary instance.</p>
                        <div class="section">
                           <p>Configure additional auxiliary channels to improve the performance of the duplicate operation. If you do not explicitly configure auxiliary channels, then RMAN uses the same channel configurations on the source database for duplication on the destination host. RMAN can use these configurations even if the source database channels do not specify the <code class="codeph">AUXILIARY</code> option. 
                           </p>
                           <p>Note the following additional considerations:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>With disk-based backups, you can increase the speed of the duplication operation by allocating additional channels.</p>
                                 <p>With tape-based duplication, you can allocate only as many channels as the number of tape devices that are available.</p>
                              </li>
                              <li>
                                 <p>The channel type (DISK or sbt) of the auxiliary channel must match the backup media. In general, the more channels you allocate for disk backups, the faster the duplication. You cannot increase the speed of duplication after the disks reach their maximum read/write rate. For tape backups, limit the number of channels to the number of devices that are available.</p>
                              </li>
                              <li>
                                 <p>If the auxiliary channels need special parameters (for example, to point to a different media manager), then you can configure an automatic channel with the <code class="codeph">AUXILIARY</code> option of the <code class="codeph">CONFIGURE</code> command.
                                 </p>
                              </li>
                              <li>
                                 <p>When you perform duplication without a target connection and without a recovery catalog, only disk channels can be used. If no user-allocated channels are used, then only one channel initially restores the control file. After the control file is mounted, the number of allocated channels depends on the configuration in the restored control file. </p>
                              </li>
                              <li>
                                 <p>If you omit the <code class="codeph">USING BACKUPSET</code> clause from the <code class="codeph">DUPLICATE</code> command and the number of allocated auxiliary channels is greater than or equal to the number of target channels, then RMAN still uses active database duplication with backup sets.
                                 </p>
                              </li>
                              <li>
                                 <p>If the auxiliary channels cannot access backups of the required data files and archived redo log files, then the duplication fails.</p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-17D02072-3003-4003-AC6F-BE680B4F107D__GUID-88FB37C9-5671-4BE0-8B6B-27AAD9A6B626">
                           <p class="titleinexample">Example 25-7 Configuring Auxiliary Channels for Disk-based Backups</p>
                           <p>The following example allocates three auxiliary channels to duplicate a database to disk.</p><pre class="oac_no_warn" dir="ltr">run
{
ALLOCATE AUXILIARY CHANNEL c1 DEVICE TYPE disk;
ALLOCATE AUXILIARY CHANNEL c2 DEVICE TYPE disk;
ALLOCATE AUXILIARY CHANNEL c3 DEVICE TYPE disk;
. . .
DUPLICATE DATABASE . . . ;
}</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-922BBA95-FCCD-4BEB-A69D-96C662F468E6" name="GUID-922BBA95-FCCD-4BEB-A69D-96C662F468E6"></a><h5 id="BRADV-GUID-922BBA95-FCCD-4BEB-A69D-96C662F468E6" class="sect5"><span class="enumeration_section">25.4.5.2 </span>Configuring Channels for Active Database Duplication
                     </h5>
                     <div>
                        <p>With active database duplication, you need not change your source database channel configuration or configure auxiliary channels. However, you may want to increase the parallelism setting of the source database disk channels so that RMAN copies files over the network in parallel.</p>
                        <div class="section">
                           <p>The type of active database duplication technique used determines which channels perform the principal work of duplication. When image copies are used to perform active database duplication, the primary work is performed by the target channels. Configure multiple target channels on the source database to improve the duplication performance. When active database duplication is performed by using backup sets, the principal work of duplication is performed by the auxiliary channels. Therefore, it is recommended that you allocate additional auxiliary channels. The number of auxiliary channels must be greater than or equal to the number of target channels. Using backup sets for active duplication also enables parallelism, which can improve the speed of the duplication process.</p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-8204DB9C-2BEF-419A-B96E-1B1C977F5AFE" name="GUID-8204DB9C-2BEF-419A-B96E-1B1C977F5AFE"></a><h4 id="BRADV-GUID-8204DB9C-2BEF-419A-B96E-1B1C977F5AFE" class="sect4"><span class="enumeration_section">25.4.6 </span>Placing the Source Database in a Proper State
                  </h4>
                  <div>
                     <p>If RMAN is connected to the source database as <code class="codeph">TARGET</code>, then the source database must be in a proper state for duplication. 
                     </p>
                     <div class="section">
                        <div class="infoboxnote" id="GUID-8204DB9C-2BEF-419A-B96E-1B1C977F5AFE__GUID-DE741EB9-0DD8-4C44-9490-08D2E6FFCD9B">
                           <p class="notep1">Note:</p>
                           <p>If you are performing backup-based duplication without a target connection, then skip to <a href="rman-duplicating-databases.html#GUID-CF2871A5-C9F7-4EAF-A583-8A8966264B05" title="You must start the RMAN client and connect to the database instances as required by the chosen duplication technique. The RMAN client can be located on any host so long as it can connect to the necessary databases over the network.">Starting RMAN and Connecting to Databases</a>.
                           </p>
                        </div>
                        <p>To ensure that the source database is in a proper state:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>If the source database instance is not mounted or open, then mount or open it.</span></li>
                        <li class="stepexpand"><span>If you are performing active database duplication, then ensure that the following additional requirements are met:</span><div>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>If the source database is open, then archiving must be enabled. </p>
                                 </li>
                                 <li>
                                    <p>If the source database is not open, then the database does not require instance recovery.</p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                     </ol>
                  </div>
               </div><a id="BRADV299"></a><div class="sect3"><a id="GUID-CF2871A5-C9F7-4EAF-A583-8A8966264B05" name="GUID-CF2871A5-C9F7-4EAF-A583-8A8966264B05"></a><h4 id="BRADV-GUID-CF2871A5-C9F7-4EAF-A583-8A8966264B05" class="sect4"><span class="enumeration_section">25.4.7 </span>Starting RMAN and Connecting to Databases
                  </h4>
                  <div>
                     <p>You must start the RMAN client and connect to the database instances as required by the chosen duplication technique. The RMAN client can be located on any host so long as it can connect to the necessary databases over the network.</p>
                     <div class="section">
                        <p>To start RMAN and connect to the target and auxiliary instances:</p>
                        <ol>
                           <li>
                              <p>Start the RMAN client on any host that can connect to the necessary database instances.</p>
                              <p>For example, enter the following command at the operating system prompt on the destination host:</p>
                              <p><code class="codeph">% rman</code></p>
                           </li>
                           <li>
                              <p>At the RMAN prompt, run <code class="codeph">CONNECT</code> commands for the database instances that are required for your duplication technique.
                              </p>
                              <div class="infoboxnote" id="GUID-CF2871A5-C9F7-4EAF-A583-8A8966264B05__GUID-4C2BBDBE-B565-4927-A650-87EA297171E0">
                                 <p class="notep1">Note:</p>
                                 <p>When you duplicate a whole CDB or one or more PDBs, connect to the root of both instances.</p>
                              </div>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>For active database duplication using image copies, you must connect to the source database as <code class="codeph">TARGET</code> and to the auxiliary instance as <code class="codeph">AUXILIARY</code>. You must supply the net service name to connect to the <code class="codeph">AUXILIARY</code> instance. A recovery catalog connection is optional. On both instances, the password for the user performing the duplication must be the same. Any user with a <code class="codeph">SYSDBA</code> or <code class="codeph">SYSBACKUP</code> privilege can perform duplication. 
                                    </p>
                                 </li>
                                 <li>
                                    <p>For active database duplication using backup sets, you must connect to the source database as <code class="codeph">TARGET</code> by using a net service name. The auxiliary instance uses this net service name to connect to the source database and retrieve the backup sets that are required for the duplication. Connect to the auxiliary instance as <code class="codeph">AUXILIARY</code>. If you are connecting to the auxiliary instance remotely or intend to use the <code class="codeph">PASSWORD FILE</code> option of the <code class="codeph">DUPLICATE</code> command, then connect to the auxiliary instance with a net service name. On both instances, the password for the user performing the duplication must be the same. Any user with a <code class="codeph">SYSDBA</code> or <code class="codeph">SYSBACKUP</code> privilege can perform duplication. A recovery catalog connection is optional.
                                    </p>
                                 </li>
                                 <li>
                                    <p>For backup-based duplication <span class="italic">without</span> a target connection, you must connect to the auxiliary instance as <code class="codeph">AUXILIARY</code> and the recovery catalog as <code class="codeph">CATALOG</code>.
                                    </p>
                                 </li>
                                 <li>
                                    <p>For backup-based duplication <span class="italic">with</span> a target connection, you must connect to the source database as <code class="codeph">TARGET</code> and the auxiliary instance as <code class="codeph">AUXILIARY</code>. A recovery catalog is optional.
                                    </p>
                                 </li>
                                 <li>
                                    <p>For backup-based duplication without target and recovery catalog connections, you must connect to the auxiliary instance as <code class="codeph">AUXILIARY</code>.
                                    </p>
                                 </li>
                              </ul>
                              <div class="infoboxnote" id="GUID-CF2871A5-C9F7-4EAF-A583-8A8966264B05__GUID-897FB0DE-76F9-42F4-ABC2-169016C1596A">
                                 <p class="notep1">Note:</p>
                                 <p>You cannot connect as <code class="codeph">TARGET</code> to a standby database.
                                 </p>
                              </div>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-CF2871A5-C9F7-4EAF-A583-8A8966264B05__GUID-14BC625E-BDFA-4B9E-B02E-D90870128153">Example: Connecting to the Required Databases When Performing Active Database Duplication</p>
                        <p>In this example, a connection is established to the source database and the auxiliary instance using net service names. The Net Service name of the source database is <code class="codeph">srcdb</code> and that of the auxiliary instance is <code class="codeph">dupdb</code>.
                        </p>
                        <p>To connect to required databases from the destination host:</p>
                        <ol>
                           <li>
                              <p>Start the RMAN client on the destination host.</p>
                              <p><code class="codeph">% rman</code></p>
                           </li>
                           <li>
                              <p>Connect to the source database as <code class="codeph">TARGET</code>.
                              </p>
                              <p><code class="codeph">RMAN&gt; CONNECT TARGET sys@srcdb;</code></p>
                              <p>Enter the password for the <code class="codeph">SYS</code> user on the source database when prompted.
                              </p>
                           </li>
                           <li>
                              <p>Connect to the auxiliary instance as <code class="codeph">AUXILIARY</code>.
                              </p>
                              <p><code class="codeph">RMAN&gt; CONNECT AUXILIARY sys@dupdb;</code></p>
                              <p>Enter the password for the <code class="codeph">SYS</code> user on the auxiliary instance when prompted.
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-571FD3C7-BF5A-4CF4-970A-9F8CAC3DF1F1" name="GUID-571FD3C7-BF5A-4CF4-970A-9F8CAC3DF1F1"></a><h4 id="BRADV-GUID-571FD3C7-BF5A-4CF4-970A-9F8CAC3DF1F1" class="sect4"><span class="enumeration_section">25.4.8 </span>Using the DUPLICATE Command to Duplicate Databases
                  </h4>
                  <div>
                     <p>RMAN provides multiple options for duplicating databases by using the <code class="codeph">DUPLICATE</code> command.
                     </p>
                     <div class="section">Use one of the following options of the <code class="codeph">DUPLICATE</code> command:
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">DUPLICATE DATABASE</code> or <code class="codeph">DUPLICATE...ACTIVE DATABASE</code></p>
                              <p>Use these for duplicating non-CDBs and CDBs.</p>
                           </li>
                           <li>
                              <p><code class="codeph">DUPLICATE DATABASE ... FOR STANDBY</code></p>
                              <p>Use this to create a standby database by duplicating the source database.</p>
                              <p></p>
                              <p>Use the <code class="codeph">DUPLICATE DATABASE ... FOR FARSYNC</code> command to create an Oracle Data Guard far sync instance using duplication.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">DUPLICATE PLUGGABLE DATABASE</code></p>
                              <p>Use this to duplicate one or more PDBs while connected to the root.</p>
                           </li>
                        </ul>When you use the <code class="codeph">SET NEWNAME</code> command to specify alternate names for duplicate database files, ensure that you enclose the <code class="codeph">DUPLICATE</code> command and the <code class="codeph">SET NEWNAME</code> commands within a <code class="codeph">RUN</code> block.
                        <div class="infoboxnotealso" id="GUID-571FD3C7-BF5A-4CF4-970A-9F8CAC3DF1F1__GUID-B6E4B14E-402C-4FED-BDDE-ECAC3CC3FA89">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="rman-duplicating-databases.html#GUID-EA6E8219-56BF-471C-AC5A-DFC55E760806" title="This section contains examples on duplicating databases by using different duplication techniques.">Examples: Duplicating Databases</a></p>
                              </li>
                              <li>
                                 <p>The <code class="codeph">DUPLICATE</code> command in <a href="../rcmrf/DUPLICATE.html#RCMRF-GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a> for additional examples on duplication
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-D95D9275-5882-4D5B-846F-1A03304BC307" name="GUID-D95D9275-5882-4D5B-846F-1A03304BC307"></a><h3 id="BRADV-GUID-D95D9275-5882-4D5B-846F-1A03304BC307" class="sect3"><span class="enumeration_section">25.5 </span>Duplicating CDBs and PDBs
               </h3>
               <div>
                  <p>Use the <code class="codeph">DUPLICATE</code> command to duplicate CDBs, one or more PDBs, sparse CDBs, and sparse PDBs. The steps to duplicate CDBs and PDBs are similar to those of duplicating non-CDBs with minor variations to the procedure for duplicating a non-CDB. This section describes how to duplicate CDBs and PDBs.
                  </p>
                  <div class="infoboxnotealso" id="GUID-D95D9275-5882-4D5B-846F-1A03304BC307__GUID-6E38E8B0-FD32-497B-B9BD-F2FD3F240F42">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-1AE8E2DE-EC18-4EEE-95F9-F8068E490977" title="Use the DUPLICATE command to duplicate CDBs.">Duplicating CDBs</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-39518A32-0A6D-4D03-87B1-89EF864DEF54" title="Use the DUPLICATE command to duplicate sparse CDBs.">Duplicating Sparse CDBs</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-68742310-3B60-4246-9431-6671697AB516" title="You can duplicate a PDB to a new multitenant container database (CDB) or an existing CDB.">Duplicating PDBs</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-37931808-C740-4216-A3BC-5D0716F9D890" title="You can duplicate one or more tablespaces within a PDB to a new CDB by using the DUPLICATE command.">Duplicating Tablespaces Within a PDB to a New CDB</a></p>
                        </li>
                     </ul>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-1AE8E2DE-EC18-4EEE-95F9-F8068E490977" name="GUID-1AE8E2DE-EC18-4EEE-95F9-F8068E490977"></a><h4 id="BRADV-GUID-1AE8E2DE-EC18-4EEE-95F9-F8068E490977" class="sect4"><span class="enumeration_section">25.5.1 </span>Duplicating CDBs
                  </h4>
                  <div>
                     <p>Use the <code class="codeph">DUPLICATE</code> command to duplicate CDBs.
                     </p>
                     <div class="section">Duplicating a whole CDB or one or more PDBs requires only minimal adjustments to the procedure for duplicating a non-CDB, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-CAC32870-C67F-465F-9449-EC87AC95BF95" title="Use the DUPLICATE command to duplicate databases.">Duplicating the Whole Database</a>"</span>.
                        <p>To duplicate a CDB:</p>
                        <ol>
                           <li>
                              <p>Complete the planning tasks described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="Before duplicating a database, you must make some decisions about the duplication process.">Planning to Duplicate a Database</a>"</span> with the following change:
                              </p>
                              <p>In <span class="q">"<a href="rman-duplicating-databases.html#GUID-08282A88-3810-4C70-91D6-5C7582D5787D" title="Names of the backups used during duplication are stored in the RMAN repository or control file.">Making Backups Accessible to the Duplicate Instance</a>"</span> and <span class="q">"<a href="rman-duplicating-databases-advanced.html#GUID-C575132F-23DE-47E5-8FFD-01F986F6CD13" title="You can use the shared disk technique to make backups available to the auxiliary instance. When NFS or shared disk is not an option, then the path that stores the backups must exist on both the source and destination hosts, unless the BACKUP LOCATION option is used for the DUPLICATE command without a target or recovery catalog connection.">Making Disk Backups Accessible Without Shared Disk</a>"</span>, note the following adjustment:
                              </p>
                              <p>Use the <code class="codeph">PLUGGABLE DATABASE</code> syntax of the <code class="codeph">BACKUP</code> command to copy only the backups of a specific PDB.
                              </p>
                              <p>The following command transfers the backup files for the entire CDB:</p><pre class="pre codeblock"><code>BACKUP COPY OF DATABASE; </code></pre><p>The following command transfers only the backup files for the PDB <code class="codeph">pdb3</code>:
                              </p><pre class="pre codeblock"><code>BACKUP COPY OF PLUGGABLE DATABASE pdb3;</code></pre></li>
                           <li>
                              <p>Ensure that the prerequisites for the selected duplication technique are met, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="The prerequisites depend on the type of database duplication being performed. Some prerequisites are common to all types of duplication and others are specific to a particular type of duplication.">Prerequisites for Duplicating a Database</a>"</span>.
                              </p>
                           </li>
                           <li>
                              <p>Prepare the auxiliary instance, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN uses an auxiliary instance to create the duplicate database. You must prepare the auxiliary instance before you begin the duplication.">Preparing the Auxiliary Instance</a>"</span>, with the following changes:
                              </p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>You must create the auxiliary instance as a CDB. To do so, start the instance with the following declaration in the initialization parameter file:</p>
                                    <p><code class="codeph">enable_pluggable_database=TRUE</code></p>
                                 </li>
                                 <li>
                                    <p>When instructed to create an initialization parameter file for the auxiliary instance, you must copy the file from the source database. This ensures that the auxiliary instance is also a CDB. After you copy the file, perform the following steps:</p>
                                    <ul style="list-style-type: disc;">
                                       <li>
                                          <p>Modify the <code class="codeph">DB_NAME</code> parameter
                                          </p>
                                       </li>
                                       <li>
                                          <p>Modify the various destination or location parameters</p>
                                       </li>
                                    </ul>
                                 </li>
                                 <li>
                                    <p>When instructed to connect to the necessary instances, connect to the root as a user with <code class="codeph">SYSDBA</code> or <code class="codeph">SYSBACKUP</code> privilege. On both instances, the password for the user performing the duplication must be the same.
                                    </p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>Start RMAN and connect to the root as a user with the <code class="codeph">SYSDBA</code> or <code class="codeph">SYSBACKUP</code> privilege.
                              </p>
                              <p>On both the auxiliary instance and the target database, the password for the user performing the duplication must be the same.</p>
                           </li>
                           <li>
                              <p>Place source database in a proper state, if necessary, as described in  <span class="q">"<a href="rman-duplicating-databases.html#GUID-8204DB9C-2BEF-419A-B96E-1B1C977F5AFE" title="If RMAN is connected to the source database as TARGET, then the source database must be in a proper state for duplication.">Placing the Source Database in a Proper State</a>"</span>.
                              </p>
                           </li>
                           <li>
                              <p>Configure RMAN channels, if necessary, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="The primary job of database duplication is performed by RMAN channels. Each channel corresponds to an Oracle Database server session that performs the duplication tasks. Depending on the duplication technique, RMAN uses either auxiliary channels or target channels.">Configuring RMAN Channels for Use in Duplication</a>"</span>.
                              </p>
                              <p>The primary task of duplication is performed by RMAN channels. Configuring additional channels improves the duplication performance.</p>
                           </li>
                           <li>
                              <p>Use the <code class="codeph">DUPLICATE</code> command to duplicate the source CDB. 
                              </p>
                              <p>See <span class="q">"<a href="rman-duplicating-databases.html#GUID-571FD3C7-BF5A-4CF4-970A-9F8CAC3DF1F1" title="RMAN provides multiple options for duplicating databases by using the DUPLICATE command.">Using the DUPLICATE Command to Duplicate Databases</a>"</span>.
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-39518A32-0A6D-4D03-87B1-89EF864DEF54" name="GUID-39518A32-0A6D-4D03-87B1-89EF864DEF54"></a><h4 id="BRADV-GUID-39518A32-0A6D-4D03-87B1-89EF864DEF54" class="sect4"><span class="enumeration_section">25.5.2 </span>Duplicating Sparse CDBs
                  </h4>
                  <div>
                     <p>Use the <code class="codeph">DUPLICATE</code> command to duplicate sparse CDBs.
                     </p>
                     <div class="section">To duplicate a sparse CDB:</div>
                     <!-- class="section" -->
                     <div class="section">
                        <p></p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Complete the planning tasks described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="Before duplicating a database, you must make some decisions about the duplication process.">Planning to Duplicate a Database</a>"</span> with the following change:</span><div>
                              <p>In <span class="q">"<a href="rman-duplicating-databases.html#GUID-08282A88-3810-4C70-91D6-5C7582D5787D" title="Names of the backups used during duplication are stored in the RMAN repository or control file.">Making Backups Accessible to the Duplicate Instance</a>"</span> and <span class="q">"<a href="rman-duplicating-databases-advanced.html#GUID-C575132F-23DE-47E5-8FFD-01F986F6CD13" title="You can use the shared disk technique to make backups available to the auxiliary instance. When NFS or shared disk is not an option, then the path that stores the backups must exist on both the source and destination hosts, unless the BACKUP LOCATION option is used for the DUPLICATE command without a target or recovery catalog connection.">Making Disk Backups Accessible Without Shared Disk</a>"</span>, note the following adjustment:
                              </p>
                              <p>Use the <code class="codeph">PLUGGABLE DATABASE</code> syntax of the <code class="codeph">BACKUP</code> command to copy only the backups of a specific PDB.
                              </p>
                              <p>The following command transfers the backup files for the entire CDB:</p><pre class="pre codeblock"><code>BACKUP COPY OF DATABASE; </code></pre><p>The following command transfers only the backup files for the PDB <code class="codeph">pdb3</code>:
                              </p><pre class="pre codeblock"><code>BACKUP COPY OF PLUGGABLE DATABASE pdb3;</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Ensure that the prerequisites for the selected duplication technique are met, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="The prerequisites depend on the type of database duplication being performed. Some prerequisites are common to all types of duplication and others are specific to a particular type of duplication.">Prerequisites for Duplicating a Database</a>"</span>.</span></li>
                        <li class="stepexpand"><span>Prepare the auxiliary instance, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN uses an auxiliary instance to create the duplicate database. You must prepare the auxiliary instance before you begin the duplication.">Preparing the Auxiliary Instance</a>"</span>, with the following changes:</span><div>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>You must create the auxiliary instance as a CDB. To do so, start the instance with the following declaration in the initialization parameter file:</p>
                                    <p><code class="codeph">enable_pluggable_database=TRUE</code></p>
                                 </li>
                                 <li>
                                    <p>When instructed to create an initialization parameter file for the auxiliary instance, you must copy the file from the source database. This ensures that the auxiliary instance is also a CDB. After you copy the file, perform the following steps:</p>
                                    <ul style="list-style-type: disc;">
                                       <li>
                                          <p>Modify the <code class="codeph">DB_NAME</code> parameter
                                          </p>
                                       </li>
                                       <li>
                                          <p>Modify the various destination/location parameters</p>
                                       </li>
                                    </ul>
                                 </li>
                                 <li>
                                    <p>When instructed to connect to the necessary instances, connect to the root as a user with <code class="codeph">SYSDBA</code> or <code class="codeph">SYSBACKUP</code> privilege. On both instances, the password for the user performing the duplication must be the same.
                                    </p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Start RMAN and connect to the root as a user with the <code class="codeph">SYSDBA</code> or <code class="codeph">SYSBACKUP</code> privilege.</span><div>
                              <p>On both the auxiliary instance and the target database, the password for the user performing the duplication must be the same.</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Place the source database in a proper state, if necessary, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-8204DB9C-2BEF-419A-B96E-1B1C977F5AFE" title="If RMAN is connected to the source database as TARGET, then the source database must be in a proper state for duplication.">Placing the Source Database in a Proper State</a>"</span>.</span></li>
                        <li class="stepexpand"><span>Configure RMAN channels, if necessary, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="The primary job of database duplication is performed by RMAN channels. Each channel corresponds to an Oracle Database server session that performs the duplication tasks. Depending on the duplication technique, RMAN uses either auxiliary channels or target channels.">Configuring RMAN Channels for Use in Duplication</a>"</span>.</span><div>
                              <p>The primary task of duplication is performed by RMAN channels. Configuring additional channels improves the duplication performance.</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Run the <code class="codeph">DUPLICATE</code> command with the <code class="codeph">FROM SPARSE</code> option.</span><div>
                              <p>For example, the following command duplicates the CDB on to <code class="codeph">cdb2</code>:
                              </p><pre class="pre codeblock"><code>DUPICATE FROM SPARSE TO cdb2 DATABASE;</code></pre></div>
                        </li>
                     </ol>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-68742310-3B60-4246-9431-6671697AB516" name="GUID-68742310-3B60-4246-9431-6671697AB516"></a><h4 id="BRADV-GUID-68742310-3B60-4246-9431-6671697AB516" class="sect4"><span class="enumeration_section">25.5.3 </span>Duplicating PDBs
                  </h4>
                  <div>
                     <p>You can duplicate a PDB to a new multitenant container database (CDB) or an existing CDB. </p>
                     <p></p>
                     <p><span class="bold">Topics:</span></p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-8AEC7767-8572-435C-9320-8B589CA4F224" title="You can duplicate a single PDB, a set of PDBs, or a set of tablespaces within a PDB by using the DUPLICATE command.">About Duplicating PDBs</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-539E89F6-C0BC-49CB-8D8C-CD8FF88BAF32" title="Duplicating a PDB to an existing CDB is subject to certain restrictions.">Restrictions on Duplicating a PDB to an Existing CDB</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-23205E75-CFA8-4BCE-AC50-3D39DF040512" title="Use the DUPLICATE command to duplicate one or more PDBs to a new CDB.">Duplicating a PDB to a New CDB</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-9E630E2C-3D1B-4594-B738-4B5B43E50C58" title="Use the DUPLICATE command to duplicate a PDB to an existing CDB.">Duplicating a PDB to an Existing CDB</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-404AF578-13E3-4E78-A089-BFCF99F84BF6" title="Use the DUPLICATE command to duplicate sparse pluggable databases (PDBs).">Duplicating Sparse PDBs</a></p>
                        </li>
                     </ul>
                  </div>
                  <div class="sect4"><a id="GUID-8AEC7767-8572-435C-9320-8B589CA4F224" name="GUID-8AEC7767-8572-435C-9320-8B589CA4F224"></a><h5 id="BRADV-GUID-8AEC7767-8572-435C-9320-8B589CA4F224" class="sect5"><span class="enumeration_section">25.5.3.1 </span>About Duplicating PDBs
                     </h5>
                     <div>
                        <p>You can duplicate a single PDB, a set of PDBs, or a set of tablespaces within a PDB by using the <code class="codeph">DUPLICATE</code> command.
                        </p>
                        <p></p>
                        <p>To duplicate PDBs, you must log in to the root of the CDB as a user with the <code class="codeph">SYSDBA</code> or <code class="codeph">SYSBACKUP</code> privilege. When duplicating a PDB to a new CDB, you must create the auxiliary instance as a CDB. To do so, start the auxiliary instance with the declaration <code class="codeph">enable_pluggable_database=TRUE</code> in the initialization parameter file.
                        </p>
                        <p>When you duplicate one or more PDBs, RMAN also duplicates the root (<code class="codeph">CDB$ROOT</code>) and the CDB seed (<code class="codeph">PDB$SEED</code>). The resulting duplicate database is a fully functional CDB that contains the root, the CDB seed, and the duplicated PDBs.
                        </p>
                        <div class="tblformal" id="GUID-8AEC7767-8572-435C-9320-8B589CA4F224__GUID-84A6A762-7577-4A4F-AEC7-ACF76EE12416">
                           <p class="titleintable">Table 25-3 Techniques for Duplicating PDBs</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="Techniques for Duplicating PDBs" summary="This table describes the techniques for duplicating PDBs and the RMAN commands used." frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" id="d109284e4544">Technique</th>
                                    <th align="left" valign="bottom" id="d109284e4546">Description</th>
                                    <th align="left" valign="bottom" id="d109284e4548">Additional Information</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d109284e4552" headers="d109284e4544 ">
                                       <p>Duplicate a PDB to an existing CDB</p>
                                    </td>
                                    <td align="left" valign="top" headers="d109284e4552 d109284e4546 ">
                                       <p>To duplicate a PDB into an existing CDB, use the <code class="codeph">DUPLICATE PLUGGABLE DATABASE </code><span class="italic"><code class="codeph">pdb_name</code></span><code class="codeph"> TO </code><span class="italic"><code class="codeph">cdb_name</code></span> syntax. Here, <span class="italic"><code class="codeph">cdb_name</code></span> is the name of an existing CDB.
                                       </p>
                                    </td>
                                    <td align="left" valign="top" headers="d109284e4552 d109284e4548 ">
                                       <p><a href="rman-duplicating-databases.html#GUID-9E630E2C-3D1B-4594-B738-4B5B43E50C58" title="Use the DUPLICATE command to duplicate a PDB to an existing CDB.">Duplicating a PDB to an Existing CDB</a></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d109284e4584" headers="d109284e4544 ">
                                       <p>Duplicate specified PDBs to a new CDB</p>
                                    </td>
                                    <td align="left" valign="top" headers="d109284e4584 d109284e4546 ">
                                       <p>Use one of the following techniques:</p>
                                       <ul style="list-style-type: disc;">
                                          <li>
                                             <p>Duplicate the specified PDBs to a new CDB by using the following syntax:</p>
                                             <p><code class="codeph">DUPLICATE DATABASE TO</code> <span class="italic"><code class="codeph">cdb_name</code></span> <code class="codeph">PLUGGABLE DATABASE</code> <span class="italic"><code class="codeph">pdb_name;</code></span></p>
                                             <p>Use a comma-delimited list to duplicate multiple PDBs.</p>
                                          </li>
                                          <li>
                                             <p>Duplicate all the PDBs, except the PDBs specified by <span class="italic">pdb_name</span>, to a new CDB by using the following syntax:
                                             </p>
                                             <p><code class="codeph">DUPLICATE DATABASE TO </code><span class="italic"><code class="codeph">cdb_name</code></span><code class="codeph"> SKIP PLUGGABLE DATABASE <span class="codeinlineitalic">pdb_name</span></code></p>
                                             <p>Use a comma-delimited list to specify multiple PDBs that must be excluded.</p>
                                          </li>
                                       </ul>
                                    </td>
                                    <td align="left" valign="top" headers="d109284e4584 d109284e4548 ">
                                       <p><a href="rman-duplicating-databases.html#GUID-23205E75-CFA8-4BCE-AC50-3D39DF040512" title="Use the DUPLICATE command to duplicate one or more PDBs to a new CDB.">Duplicating a PDB to a New CDB</a></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" id="d109284e4639" headers="d109284e4544 ">
                                       <p>Duplicate specified tablespaces within a PDB to a new CDB</p>
                                    </td>
                                    <td align="left" valign="top" headers="d109284e4639 d109284e4546 ">
                                       <p>Use one of the following techniques:</p>
                                       <ul style="list-style-type: disc;">
                                          <li>
                                             <p>Duplicate specified tablespaces within a PDB to a new CDB by usingthe following syntax:</p>
                                             <p><code class="codeph">DUPLICATE DATABASE TO </code><span class="italic"><code class="codeph">cdb_name</code></span><code class="codeph"> TABLESPACE <span class="codeinlineitalic">pdb_name:tablespace_name</span>;</code></p>
                                             <p>The tablespace name must be prefixed with the name of the PDB that contains the tablespace. If you omit the name of the PDB, root is taken as the default.</p>
                                          </li>
                                          <li>
                                             <p>Duplicate all tablespaces in the CDB except the specified tablespaces to a new CDB by usingthe following syntax:</p>
                                             <p><code class="codeph">DUPLICATE DATABASE TO </code><span class="italic"><code class="codeph">cdb_name</code></span><code class="codeph"> SKIP TABLESPACE <span class="codeinlineitalic">pdb_name:tablespace_name</span></code></p>
                                          </li>
                                       </ul>
                                    </td>
                                    <td align="left" valign="top" headers="d109284e4639 d109284e4548 ">
                                       <p><a href="rman-duplicating-databases.html#GUID-37931808-C740-4216-A3BC-5D0716F9D890" title="You can duplicate one or more tablespaces within a PDB to a new CDB by using the DUPLICATE command.">Duplicating Tablespaces Within a PDB to a New CDB</a></p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-539E89F6-C0BC-49CB-8D8C-CD8FF88BAF32" name="GUID-539E89F6-C0BC-49CB-8D8C-CD8FF88BAF32"></a><h5 id="BRADV-GUID-539E89F6-C0BC-49CB-8D8C-CD8FF88BAF32" class="sect5"><span class="enumeration_section">25.5.3.2 </span>Restrictions on Duplicating a PDB to an Existing CDB
                     </h5>
                     <div>
                        <p>Duplicating a PDB to an existing CDB is subject to certain restrictions.</p>
                        <div class="section">
                           <p></p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Only active database duplication is supported.</p>
                                 <p></p>
                              </li>
                              <li>
                                 <p>Only the following clauses of the <code class="codeph">DUPLICATE</code> command are supported: <code class="codeph">NORESUME</code>, <code class="codeph">DB_FILE_NAME_CONVERT</code>, <code class="codeph">SECTION SIZE</code>, and <code class="codeph">USING COMPRESSED BACKUPSET</code>.
                                 </p>
                              </li>
                              <li>
                                 <p>The following clauses of the <code class="codeph">DUPLICATE</code> command are not supported: <code class="codeph">SPFILE</code>, <code class="codeph">NO STANDBY</code>, <code class="codeph">FARSYNC STANDBY</code>, and <code class="codeph">LOG_FILE_NAME_CONVERT</code>.
                                 </p>
                              </li>
                              <li>
                                 <p>Duplicating a PDB to a CDB that is a standby database is not supported.</p>
                              </li>
                              <li>
                                 <p>Only one PDB can be duplicated at a time.</p>
                              </li>
                              <li>
                                 <p>Partial PDB duplication is not supported, only complete PDB duplication is supported. For example, you cannot include or exclude specific tablespaces while duplicating a PDB.</p>
                              </li>
                              <li>
                                 <p>Duplicating a non-CDB as a PDB in an existing CDB is not supported.</p>
                              </li>
                              <li>
                                 <p>Duplicating PDBs that contain TDE-encrypted tablespaces is not supported.</p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-9E630E2C-3D1B-4594-B738-4B5B43E50C58" name="GUID-9E630E2C-3D1B-4594-B738-4B5B43E50C58"></a><h5 id="BRADV-GUID-9E630E2C-3D1B-4594-B738-4B5B43E50C58" class="sect5"><span class="enumeration_section">25.5.3.3 </span>Duplicating a PDB to an Existing CDB
                     </h5>
                     <div>
                        <p>Use the <code class="codeph">DUPLICATE</code> command to duplicate a PDB to an existing CDB. 
                        </p>
                        <div class="p">
                           <p></p>
                           <p>To duplicate a PDB to an existing CDB:</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Ensure that the required prerequisites are met. This includes the following:</span><div>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>Prerequisites for active database duplication</p>
                                    </li>
                                    <li>
                                       <p>Additional prerequisites for duplicating a PDB to an existing CDB</p>
                                    </li>
                                 </ul>
                                 <p>See <a href="../rcmrf/DUPLICATE.html#RCMRF-GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a>.
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Review the limitations of duplicating a PDB to an existing CDB, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-539E89F6-C0BC-49CB-8D8C-CD8FF88BAF32" title="Duplicating a PDB to an existing CDB is subject to certain restrictions.">Restrictions on Duplicating a PDB to an Existing CDB</a>"</span>.</span></li>
                           <li class="stepexpand"><span>Choose a strategy for naming duplicate database files, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-5293AB47-97AA-45A2-9D64-BA1287D3F7B9" title="When you duplicate a database, RMAN generates names for the database files in the duplicate database. This includes the control files, data files, temp files, and online redo log files.">Choosing a Strategy for Naming Duplicate Database Files</a>"</span>.</span></li>
                           <li class="stepexpand"><span>Create the directories that store the duplicate database files on the destination CDB, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-2ECA94F4-E8EB-43D7-9934-39F2BE281700" title="On the destination host, you must create the directories that are used to store the duplicate database files on the destination host. This includes the directories that store the data files, control files, online redo log files, and temp files.">Creating Directories for the Duplicate Database</a>"</span>.</span></li>
                           <li class="stepexpand"><span>Establish Oracle net connectivity between the source CDB and the destination CDB, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-460171C8-2E09-4D0E-9AC3-A4C28392A220" title="You must be able to establish a connection between the source database and auxiliary instance for certain forms of duplication.">Establishing Oracle Net Connectivity Between the Source Database and Auxiliary Instance</a>"</span>.</span></li>
                           <li class="stepexpand"><span>Start RMAN and make the following connections:</span><div>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>Connect <code class="codeph">AS TARGET</code> to the root of the source CDB as a common user with the <code class="codeph">SYSDBA</code> or <code class="codeph">SYSBACKUP</code> privilege.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Connect <code class="codeph">AS AUXILIARY</code> to the root of the destination CDB as a common user with the <code class="codeph">SYSDBA</code> or <code class="codeph">SYSBACKUP</code> privilege.
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Ensure that the destination CDB is open in read-write mode.</span></li>
                           <li class="stepexpand"><span>Configure RMAN channels, if necessary, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="The primary job of database duplication is performed by RMAN channels. Each channel corresponds to an Oracle Database server session that performs the duplication tasks. Depending on the duplication technique, RMAN uses either auxiliary channels or target channels.">Configuring RMAN Channels for Use in Duplication</a>"</span>.</span><div>
                                 <p>The primary task of duplication is performed by RMAN channels. Configuring additional channels improves the duplication performance.</p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Duplicate the PDB by using the <code class="codeph">DUPLICATE PLUGGABLE DATABASE</code> command.</span><div>
                                 <p>The following command duplicates the PDB <code class="codeph">mypdb</code> to an existing CDB <code class="codeph">cdb_sales</code>. 
                                 </p><pre class="pre codeblock"><code>DUPLICATE PLUGGABLE DATABASE mypdb TO cdb_sales 
DB_FILE_NAME_CONVERT('cdb1','pdb1')
FROM ACTIVE DATABASE 
SECTION SIZE 400M;</code></pre><p>To use a different name for the PDB in the destination (duplicate) database, use the <code class="codeph">PLUGGABLE DATABASE mypdb AS pdb_dup TO cdb_sales</code> syntax.
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Delete the foreign archived redo log files that were restored to the location specified by the <code class="codeph">remote_recovery_file_dest</code> initialization parameter as part of the duplication.</span></li>
                        </ol>
                        <div class="section">
                           <div class="infoboxnote" id="GUID-9E630E2C-3D1B-4594-B738-4B5B43E50C58__GUID-9F12DADF-CFB8-4306-9BDB-D306D44F99A4">
                              <p class="notep1">Note:</p>
                              <p>Duplicating a PDB to an existing CDB is supported starting with Oracle Database Release 18c.</p>
                           </div>
                           <div class="infoboxnotealso" id="GUID-9E630E2C-3D1B-4594-B738-4B5B43E50C58__GUID-A9C7A86E-5027-4A03-AAF3-A83B1383F6C2">
                              <p class="notep1">See Also:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><a href="rman-duplicating-databases.html#GUID-8AEC7767-8572-435C-9320-8B589CA4F224" title="You can duplicate a single PDB, a set of PDBs, or a set of tablespaces within a PDB by using the DUPLICATE command.">About Duplicating PDBs</a></p>
                                 </li>
                                 <li>
                                    <p><a href="rman-duplicating-databases.html#GUID-3E8DE9F7-4A62-46D2-A0AE-7F25DCF6DEC3" title="This example describes how to use active database duplication to duplicate a PDB into an existing CDB.">Example: Duplicating a PDB to an Existing CDB by Using Active Duplication</a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="BRADV760"></a><div class="sect4"><a id="GUID-23205E75-CFA8-4BCE-AC50-3D39DF040512" name="GUID-23205E75-CFA8-4BCE-AC50-3D39DF040512"></a><h5 id="BRADV-GUID-23205E75-CFA8-4BCE-AC50-3D39DF040512" class="sect5"><span class="enumeration_section">25.5.3.4 </span>Duplicating a PDB to a New CDB
                     </h5>
                     <div>
                        <p>Use the <code class="codeph">DUPLICATE</code> command to duplicate one or more PDBs to a new CDB.
                        </p>
                        <div class="section">
                           <p>To duplicate a PDB to a new CDB:</p>
                           <ol>
                              <li>
                                 <p>Complete the planning tasks described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="Before duplicating a database, you must make some decisions about the duplication process.">Planning to Duplicate a Database</a>"</span> with the following change:
                                 </p>
                                 <p>In <span class="q">"<a href="rman-duplicating-databases.html#GUID-08282A88-3810-4C70-91D6-5C7582D5787D" title="Names of the backups used during duplication are stored in the RMAN repository or control file.">Making Backups Accessible to the Duplicate Instance</a>"</span> and <span class="q">"<a href="rman-duplicating-databases-advanced.html#GUID-C575132F-23DE-47E5-8FFD-01F986F6CD13" title="You can use the shared disk technique to make backups available to the auxiliary instance. When NFS or shared disk is not an option, then the path that stores the backups must exist on both the source and destination hosts, unless the BACKUP LOCATION option is used for the DUPLICATE command without a target or recovery catalog connection.">Making Disk Backups Accessible Without Shared Disk</a>"</span>, note the following adjustment:
                                 </p>
                                 <p>Use the <code class="codeph">PLUGGABLE DATABASE</code> syntax of the <code class="codeph">BACKUP</code> command to copy only the backups of a specific PDB.
                                 </p>
                                 <p>For example, the following command transfers only the backups files for the PDB <code class="codeph">pdb3</code>:
                                 </p>
                                 <p><code class="codeph">BACKUP COPY OF PLUGGABLE DATABASE pdb3;</code></p>
                              </li>
                              <li>
                                 <p>Ensure that the prerequisites for the selected duplication technique are met, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="The prerequisites depend on the type of database duplication being performed. Some prerequisites are common to all types of duplication and others are specific to a particular type of duplication.">Prerequisites for Duplicating a Database</a>"</span>.
                                 </p>
                              </li>
                              <li>
                                 <p>Prepare the auxiliary instance, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN uses an auxiliary instance to create the duplicate database. You must prepare the auxiliary instance before you begin the duplication.">Preparing the Auxiliary Instance</a>"</span>, with the following changes:
                                 </p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>You must create the auxiliary instance as a CDB. To do so, start the instance with the following declaration in the initialization parameter file:</p>
                                       <p><code class="codeph">enable_pluggable_database=TRUE</code></p>
                                    </li>
                                    <li>
                                       <p>When instructed to create an initialization parameter file for the auxiliary instance, you must copy the file from the source database. This ensures that the auxiliary instance is also a CDB. After you copy the file, perform the following steps:</p>
                                       <ul style="list-style-type: disc;">
                                          <li>
                                             <p>Modify the <code class="codeph">DB_NAME</code> parameter
                                             </p>
                                          </li>
                                          <li>
                                             <p>Modify the various destination/location parameters</p>
                                          </li>
                                       </ul>
                                    </li>
                                    <li>
                                       <p>When instructed to connect to the necessary instances, connect to the root as a user with <code class="codeph">SYSDBA</code> or <code class="codeph">SYSBACKUP</code> privilege. On both instances, the password for the user performing the duplication must be the same.
                                       </p>
                                    </li>
                                 </ul>
                              </li>
                              <li>
                                 <p>Start RMAN and connect to the root as a user with the <code class="codeph">SYSDBA</code> or <code class="codeph">SYSBACKUP</code> privilege.
                                 </p>
                                 <p>On both the auxiliary instance and the target database, the password for the user performing the duplication must be the same.</p>
                              </li>
                              <li>
                                 <p>Place source database in proper state, if necessary, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-8204DB9C-2BEF-419A-B96E-1B1C977F5AFE" title="If RMAN is connected to the source database as TARGET, then the source database must be in a proper state for duplication.">Placing the Source Database in a Proper State</a>"</span>.
                                 </p>
                              </li>
                              <li>
                                 <p>Configure RMAN channels, if necessary, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="The primary job of database duplication is performed by RMAN channels. Each channel corresponds to an Oracle Database server session that performs the duplication tasks. Depending on the duplication technique, RMAN uses either auxiliary channels or target channels.">Configuring RMAN Channels for Use in Duplication</a>"</span>.
                                 </p>
                                 <p>The primary task of duplication is performed by the RMAN channels. Configuring additional channels improves the duplication performance.</p>
                              </li>
                              <li>
                                 <p>Duplicate the PDB by using the <code class="codeph">DUPLICATE  PLUGGABLE DATABASE</code> command.
                                 </p>
                              </li>
                           </ol>
                           <p><span class="bold">Examples: Duplicating PDBs</span></p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>To duplicate the PDB <code class="codeph">pdb1</code> to the CDB <code class="codeph">cdb1</code>, use the following command:
                                 </p>
                                 <p><code class="codeph">DUPLICATE DATABASE TO cdb1 PLUGGABLE DATABASE pdb1;</code></p>
                              </li>
                              <li>
                                 <p>To duplicate the PDBs <code class="codeph">pdb1</code>, <code class="codeph">pdb3</code>, and <code class="codeph">pdb4</code> to the database <code class="codeph">cdb1</code>, use the following command:
                                 </p>
                                 <p><code class="codeph">DUPLICATE DATABASE TO cdb1 PLUGGABLE DATABASE pdb1,pdb3,pdb4;</code></p>
                              </li>
                              <li>
                                 <p>To duplicate all the PDBs in the CDB, except the PDB <code class="codeph">pdb3</code>, use the following command:
                                 </p>
                                 <p><code class="codeph">DUPLICATE DATABASE TO cdb1 SKIP PLUGGABLE DATABASE pdb3;</code></p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <div class="infoboxnotealso" id="GUID-23205E75-CFA8-4BCE-AC50-3D39DF040512__GUID-60C70C79-413A-4EA0-990F-644F0382EA72">
                              <p class="notep1">See Also:</p>
                              <p><a href="rman-duplicating-databases.html#GUID-8AEC7767-8572-435C-9320-8B589CA4F224" title="You can duplicate a single PDB, a set of PDBs, or a set of tablespaces within a PDB by using the DUPLICATE command.">About Duplicating PDBs</a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-404AF578-13E3-4E78-A089-BFCF99F84BF6" name="GUID-404AF578-13E3-4E78-A089-BFCF99F84BF6"></a><h5 id="BRADV-GUID-404AF578-13E3-4E78-A089-BFCF99F84BF6" class="sect5"><span class="enumeration_section">25.5.3.5 </span>Duplicating Sparse PDBs
                     </h5>
                     <div>
                        <p>Use the <code class="codeph">DUPLICATE</code> command to duplicate sparse pluggable databases (PDBs).
                        </p>
                        <div class="section"><span class="bold">To duplicate a sparse PDB:</span></div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Complete the planning tasks described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="Before duplicating a database, you must make some decisions about the duplication process.">Planning to Duplicate a Database</a>"</span> with the following change:</span><div>
                                 <p>In <span class="q">"<a href="rman-duplicating-databases.html#GUID-08282A88-3810-4C70-91D6-5C7582D5787D" title="Names of the backups used during duplication are stored in the RMAN repository or control file.">Making Backups Accessible to the Duplicate Instance</a>"</span> and <span class="q">"<a href="rman-duplicating-databases-advanced.html#GUID-C575132F-23DE-47E5-8FFD-01F986F6CD13" title="You can use the shared disk technique to make backups available to the auxiliary instance. When NFS or shared disk is not an option, then the path that stores the backups must exist on both the source and destination hosts, unless the BACKUP LOCATION option is used for the DUPLICATE command without a target or recovery catalog connection.">Making Disk Backups Accessible Without Shared Disk</a>"</span>, use the <code class="codeph">PLUGGABLE DATABASE</code> syntax of the <code class="codeph">BACKUP</code> command to copy only the backups of a specific PDB.
                                 </p>
                                 <p>For example, the following command transfers only the backups files for the PDB <code class="codeph">pdb3</code>:
                                 </p>
                                 <p><code class="codeph">BACKUP COPY OF PLUGGABLE DATABASE pdb3;</code></p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Ensure that the prerequisites for the selected duplication technique are met as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="The prerequisites depend on the type of database duplication being performed. Some prerequisites are common to all types of duplication and others are specific to a particular type of duplication.">Prerequisites for Duplicating a Database</a>"</span>.</span></li>
                           <li class="stepexpand"><span>Prepare the auxiliary instance as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN uses an auxiliary instance to create the duplicate database. You must prepare the auxiliary instance before you begin the duplication.">Preparing the Auxiliary Instance</a>"</span>, with the following changes:</span><div>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>Create the auxiliary instance as a CDB. To do so, start the instance with the following declaration in the initialization parameter file:</p>
                                       <p><code class="codeph">enable_pluggable_database=TRUE</code></p>
                                    </li>
                                    <li>
                                       <p>When instructed to create an initialization parameter file for the auxiliary instance, you must copy the file from the source database. This ensures that the auxiliary instance is also a CDB. After copying, perform the following steps:</p>
                                       <ul style="list-style-type: disc;">
                                          <li>
                                             <p>Modify the <code class="codeph">DB_NAME</code> parameter
                                             </p>
                                          </li>
                                          <li>
                                             <p>Modify the various destination/location parameters</p>
                                          </li>
                                       </ul>
                                    </li>
                                    <li>
                                       <p>When instructed to connect to the necessary instances, connect to the root as a user with <code class="codeph">SYSDBA</code> or <code class="codeph">SYSBACKUP</code> privilege. On both instances, the password for the user performing the duplication must be the same.
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Start RMAN and connect to the root as a user with the <code class="codeph">SYSDBA</code> or <code class="codeph">SYSBACKUP</code> privilege.</span><div>
                                 <p>On both the auxiliary instance and the target database, the password for the user performing the duplication must be the same.</p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Place source database in proper state (if necessary) as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-8204DB9C-2BEF-419A-B96E-1B1C977F5AFE" title="If RMAN is connected to the source database as TARGET, then the source database must be in a proper state for duplication.">Placing the Source Database in a Proper State</a>"</span>.</span></li>
                           <li class="stepexpand"><span>(Optional) Configure RMAN channels to improve duplication performance as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="The primary job of database duplication is performed by RMAN channels. Each channel corresponds to an Oracle Database server session that performs the duplication tasks. Depending on the duplication technique, RMAN uses either auxiliary channels or target channels.">Configuring RMAN Channels for Use in Duplication</a>"</span>.</span></li>
                           <li class="stepexpand"><span>Run the <code class="codeph">DUPLICATE</code> command with the <code class="codeph">PLUGGABLE DATABASE</code> and <code class="codeph">FROM SPARSE</code> options.</span><div>
                                 <p>To duplicate PDB <code class="codeph">pdb1</code> to CDB <code class="codeph">cdb2</code>, run the following command:
                                 </p><pre class="pre codeblock"><code>DUPLICATE FROM SPARSE to cdb2 PLUGGABLE DATABASE pdb1;</code></pre><div class="infoboxnote" id="GUID-404AF578-13E3-4E78-A089-BFCF99F84BF6__GUID-C4E36EE9-BE3A-4C27-AA7F-202EF48F8971">
                                    <p class="notep1">Note:</p>
                                    <p>The base (read-only) data files in a sparse database are not encrypted. Ensure that the base data files are stored in a protected storage and accessed using secured communications.</p>
                                 </div>
                              </div>
                           </li>
                        </ol>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-37931808-C740-4216-A3BC-5D0716F9D890" name="GUID-37931808-C740-4216-A3BC-5D0716F9D890"></a><h4 id="BRADV-GUID-37931808-C740-4216-A3BC-5D0716F9D890" class="sect4"><span class="enumeration_section">25.5.4 </span>Duplicating Tablespaces Within a PDB to a New CDB
                  </h4>
                  <div>
                     <p>You can duplicate one or more tablespaces within a PDB to a new CDB by using the <code class="codeph">DUPLICATE</code> command.
                     </p>
                     <div class="section">
                        <p>To duplicate tablespaces within a PDB:</p>
                        <ol>
                           <li>
                              <p>Ensure that you have completed Steps 1 to 4 in <a href="rman-duplicating-databases.html#GUID-23205E75-CFA8-4BCE-AC50-3D39DF040512" title="Use the DUPLICATE command to duplicate one or more PDBs to a new CDB.">Duplicating a PDB to a New CDB</a>.
                              </p>
                           </li>
                           <li>
                              <p>Run the <code class="codeph">DUPLICATE</code> command with the <code class="codeph">TABLESPACE</code> option described in <a href="rman-duplicating-databases.html#GUID-8AEC7767-8572-435C-9320-8B589CA4F224" title="You can duplicate a single PDB, a set of PDBs, or a set of tablespaces within a PDB by using the DUPLICATE command.">About Duplicating PDBs</a>.
                              </p>
                              <p>The following are some examples of duplicating tablespaces that are contained in PDBs:</p>
                              <p>To duplicate the <code class="codeph">users</code> tablespace that is part of PDB <code class="codeph">pdb1</code>, use the following command:
                              </p>
                              <p><code class="codeph">DUPLICATE DATABASE TO cdb1 TABLESPACE pdb1:users;</code></p>
                              <p>To duplicate the PDB <code class="codeph">pdb1</code> and the users tablespace in PDB <code class="codeph">pdb2</code>, use the following command:
                              </p>
                              <p><code class="codeph"><code class="codeph">DUPLICATE DATABASE TO cdb1 PLUGGABLE DATABASE pdb1 TABLESPACE pdb2:users;</code></code></p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-46F814AD-1457-4C46-B603-19A9D617D01C" name="GUID-46F814AD-1457-4C46-B603-19A9D617D01C"></a><h3 id="BRADV-GUID-46F814AD-1457-4C46-B603-19A9D617D01C" class="sect3"><span class="enumeration_section">25.6 </span>Duplicating Databases to Oracle Cloud
               </h3>
               <div>
                  <p>Use the <code class="codeph">DUPLICATE</code> command to duplicate an on-premise database to Oracle Cloud. Both backup-based and active duplication are supported.
                  </p>
                  <div class="section">
                     <p></p>
                     <p>Oracle databases on Oracle Cloud are always encrypted. Therefore, when you duplicate a database or part of a database to Oracle Cloud, any tablespaces created in Oracle Cloud are encrypted even if no encryption clause is specified during duplication.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="p">The <code class="codeph">COMPATIBLE</code> parameter of the source and Oracle Cloud database must be set to 18.0.0 or higher. 
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>Ensure that the prerequisites for the selected duplication technique are met. It is recommended that you use active database duplication.</span><div>
                           <p>See <span class="q">"<a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="The prerequisites depend on the type of database duplication being performed. Some prerequisites are common to all types of duplication and others are specific to a particular type of duplication.">Prerequisites for Duplicating a Database</a>"</span>.
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>Configure the Oracle Database Cloud Backup Module. This backup module is an SBT interface that enables you to perform backup and recovery operations to Oracle Cloud.</span><div>
                           <p>See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=CSDBB-GUID-483BAC13-854B-4044-9569-0FAD313AD126" target="_blank"><span class="italic">Oracle Cloud Using Oracle Database Backup Service</span></a> for information about installing the Oracle Database Cloud Backup Module
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>Complete the planning tasks, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="Before duplicating a database, you must make some decisions about the duplication process.">Planning to Duplicate a Database</a>"</span>.</span></li>
                     <li class="stepexpand"><span>Prepare the auxiliary instance, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN uses an auxiliary instance to create the duplicate database. You must prepare the auxiliary instance before you begin the duplication.">Preparing the Auxiliary Instance</a>"</span>, with the following changes when duplicating CDBs:</span><div>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>You must create the auxiliary instance as a CDB. To do so, start the instance with the following declaration in the initialization parameter file:</p>
                                 <p><code class="codeph">enable_pluggable_database=TRUE</code></p>
                              </li>
                              <li>
                                 <p>When instructed to create an initialization parameter file for the auxiliary instance, you must copy the file from the source database. This ensures that the auxiliary instance is also a CDB. After you copy the file, perform the following steps:</p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>Modify the <code class="codeph">DB_NAME</code> parameter
                                       </p>
                                    </li>
                                    <li>
                                       <p>Modify the various destination/location parameters</p>
                                    </li>
                                 </ul>
                              </li>
                              <li>
                                 <p>Start the auxiliary instance in <code class="codeph">NOMOUNT</code> mode.
                                 </p>
                              </li>
                           </ul>
                           <div class="infoboxnote" id="GUID-46F814AD-1457-4C46-B603-19A9D617D01C__GUID-B6622F9E-57AE-44A5-AC03-5C14595925CC">
                              <p class="notep1">Note:</p>
                              <p>Because the auxiliary instance must be created on Oracle Cloud, the Oracle Cloud administrator must perform the steps to prepare the auxiliary instance.</p>
                           </div>
                        </div>
                     </li>
                     <li class="stepexpand"><span>Start RMAN and connect to the root as a common user with the <code class="codeph">SYSDBA</code> or <code class="codeph">SYSBACKUP</code> privilege.</span><div>
                           <p>On both the auxiliary instance and the target database, the password for the user performing the duplication must be the same.</p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>If the source CDB uses encryption, then open the Oracle keystore that contains the master key on the source CDB.</span></li>
                     <li class="stepexpand"><span>Configure RMAN channels, if necessary, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="The primary job of database duplication is performed by RMAN channels. Each channel corresponds to an Oracle Database server session that performs the duplication tasks. Depending on the duplication technique, RMAN uses either auxiliary channels or target channels.">Configuring RMAN Channels for Use in Duplication</a>"</span>.</span><div>
                           <p>The RMAN channels perform the primary task of duplication. Configuring additional channels improves the duplication performance.</p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>On the destination CDB, open the Oracle keystore from the source CDB.</span><div>
                           <p>If the destination CDB uses a password-based software keystore, then you must specify the password used to open this keystore. The following command sets the password used to open a password-based software keystore (replace <span class="italic">password</span> with your keystore password):
                           </p><pre class="pre codeblock"><code>SET DECRYPTION WALLET OPEN IDENTIFIED BY '<span class="italic">password</span>';</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Use the <code class="codeph">DUPLICATE</code> command to duplicate the source CDB.</span><div>
                           <p>See <span class="q">"<a href="rman-duplicating-databases.html#GUID-571FD3C7-BF5A-4CF4-970A-9F8CAC3DF1F1" title="RMAN provides multiple options for duplicating databases by using the DUPLICATE command.">Using the DUPLICATE Command to Duplicate Databases</a>"</span>.
                           </p>
                        </div>
                     </li>
                  </ol>
                  <div class="section">
                     <div class="infoboxnote" id="GUID-46F814AD-1457-4C46-B603-19A9D617D01C__GUID-3D35CCCA-D8CA-4A13-9F92-052EA9836AA4">
                        <p class="notep1">Note:</p>
                        <p>Using duplication to create a standby database to Oracle Cloud is not supported. </p>
                     </div>
                     <div class="infoboxnotealso" id="GUID-46F814AD-1457-4C46-B603-19A9D617D01C__GUID-7B587ACA-4378-4465-8342-A8794B36D90E">
                        <p class="notep1">See Also:</p>
                        <p><a href="https://docs.us-phoenix-1.oraclecloud.com/Content/Database/Tasks/mig-rman-duplicate-active-database.htm#RMANDUPLICATEfromanActiveDatabase" target="_blank">RMAN Duplicate from an Active Database</a> for more details about duplicating databases to Oracle Cloud Infrastructure
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-4438284A-8177-4654-8C5C-0D60BEA7E857" name="GUID-4438284A-8177-4654-8C5C-0D60BEA7E857"></a><h3 id="BRADV-GUID-4438284A-8177-4654-8C5C-0D60BEA7E857" class="sect3"><span class="enumeration_section">25.7 </span>Duplicating an Oracle Cloud Database as an On-premise Database
               </h3>
               <div>
                  <p>Use the <code class="codeph">DUPLICATE</code> command to duplicate an Oracle Cloud Database as an on-premise database. Both backup-based and active duplication are supported.
                  </p>
                  <div class="section">
                     <p></p>
                     <p>Oracle Cloud databases are always encrypted. When you duplicate a database from Oracle Cloud, the Oracle keystore that stores the master key must be copied to the on-premise database. This key is required to decrypt the data files that are duplicated from the Oracle Cloud database. The duplicate database may or may not use encryption.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="p">The <code class="codeph">COMPATIBLE</code> parameter of the source and destination database must be set to 18.0.0 or higher.
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>Ensure that the prerequisites for the selected duplication technique are met, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="The prerequisites depend on the type of database duplication being performed. Some prerequisites are common to all types of duplication and others are specific to a particular type of duplication.">Prerequisites for Duplicating a Database</a>"</span>. It is recommended that you use active database duplication.</span></li>
                     <li class="stepexpand"><span>Configure the Oracle Database Cloud Backup Module. This backup module is an SBT interface that enables you to perform backup and recovery operations to Oracle Cloud.</span><div>
                           <p>See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=CSDBB-GUID-483BAC13-854B-4044-9569-0FAD313AD126" target="_blank"><span class="italic">Oracle Cloud Using Oracle Database Backup Service</span></a> for information about installing the Oracle Database Cloud Backup Module
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>Complete the planning tasks described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="Before duplicating a database, you must make some decisions about the duplication process.">Planning to Duplicate a Database</a>"</span>.</span></li>
                     <li class="stepexpand"><span>Prepare the auxiliary instance, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN uses an auxiliary instance to create the duplicate database. You must prepare the auxiliary instance before you begin the duplication.">Preparing the Auxiliary Instance</a>"</span>, with the following changes:</span><div>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>You must create the auxiliary instance as a CDB. To do so, start the instance with the following declaration in the initialization parameter file:</p>
                                 <p><code class="codeph">enable_pluggable_database=TRUE</code></p>
                              </li>
                              <li>
                                 <p>When instructed to create an initialization parameter file for the auxiliary instance, you must copy the file from the source database. This ensures that the auxiliary instance is also a CDB. After you copy the file, perform the following steps:</p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>Modify the <code class="codeph">DB_NAME</code> parameter
                                       </p>
                                    </li>
                                    <li>
                                       <p>Modify the various destination/location parameters</p>
                                    </li>
                                 </ul>
                              </li>
                              <li>
                                 <p>When instructed to connect to the necessary instances, start RMAN and connect to the root as a common user with <code class="codeph">SYSDBA</code> or <code class="codeph">SYSBACKUP</code> privilege. On both instances, the password for the user performing the duplication must be the same.
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </li>
                     <li class="stepexpand"><span>Copy the Oracle keystore from Oracle Cloud to the auxiliary instance.</span><div>
                           <p>The auxiliary instance needs to decrypt the data files from Oracle Cloud before encrypting them again by using the Oracle keystore in the Oracle Cloud database.</p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>Configure RMAN channels, if necessary, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="The primary job of database duplication is performed by RMAN channels. Each channel corresponds to an Oracle Database server session that performs the duplication tasks. Depending on the duplication technique, RMAN uses either auxiliary channels or target channels.">Configuring RMAN Channels for Use in Duplication</a>"</span>.</span><div>
                           <p>The primary task of duplication is performed by RMAN channels. Configuring additional channels improves the duplication performance.</p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>On the auxiliary instance, open the Oracle keystore that was copied from the source Oracle Cloud database.</span><div>
                           <p>If the destination CDB uses a password-based software keystore, then you must specify the password used to open this keystore. The following command sets the password used to open a password-based software keystore (replace <span class="italic">password</span> with your keystore password):
                           </p><pre class="pre codeblock"><code>SET DECRYPTION WALLET OPEN IDENTIFIED BY '<span class="italic">password</span>';</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Use the <code class="codeph">DUPLICATE</code> command to duplicate the source CDB.</span><div>
                           <p>To create a duplicate database that does not use encryption, use the <code class="codeph">AS DECRYPTED</code> option in the <code class="codeph">DUPLICATE</code> command. For example:
                           </p><pre class="pre codeblock"><code>DUPLICATE DATABASE TO my_cdb
FROM ACTIVE DATABASE
AS DECRYPTED;</code></pre><p>See <span class="q">"<a href="rman-duplicating-databases.html#GUID-571FD3C7-BF5A-4CF4-970A-9F8CAC3DF1F1" title="RMAN provides multiple options for duplicating databases by using the DUPLICATE command.">Using the DUPLICATE Command to Duplicate Databases</a>"</span>.
                           </p>
                        </div>
                     </li>
                  </ol>
                  <div class="section">
                     <div class="infoboxnote" id="GUID-4438284A-8177-4654-8C5C-0D60BEA7E857__GUID-FCFFECE0-B88F-42CA-A30D-33E555339064">
                        <p class="notep1">Note:</p>
                        <p>Duplicating <code class="codeph">AS STANDBY</code> by using <code class="codeph">AS ENCRYPTED</code> or <code class="codeph">AS DECRYPTED</code> is not supported. 
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-4A9A4F04-0D65-4BC0-AE4B-EFBD453D017F" name="GUID-4A9A4F04-0D65-4BC0-AE4B-EFBD453D017F"></a><h3 id="BRADV-GUID-4A9A4F04-0D65-4BC0-AE4B-EFBD453D017F" class="sect3"><span class="enumeration_section">25.8 </span>Restarting DUPLICATE After a Failure
               </h3>
               <div>
                  <p>RMAN automatically optimizes a <code class="codeph">DUPLICATE</code> command that is a repeat of a previously failed <code class="codeph">DUPLICATE</code> command. 
                  </p>
                  <div class="section">The repeat <code class="codeph">DUPLICATE</code> command notices which data files were successfully copied earlier and does not copy them again. This applies to all forms of duplication, whether they are backup-based (with or without a target connection) or active database duplication. The automatic optimization of the <code class="codeph">DUPLICATE</code> command can be especially useful when a failure occurs during the duplication of very large databases.
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>To restart a duplicate operation:</p>
                     <ol>
                        <li>
                           <p>Exit RMAN.</p>
                        </li>
                        <li>
                           <p>Start SQL*Plus and connect to the auxiliary instance with <code class="codeph">SYSDBA</code> or <code class="codeph">SYSBACKUP</code> privilege. Start the auxiliary instance in <code class="codeph">NOMOUNT</code> mode with the same <code class="codeph">SPFILE</code> or <code class="codeph">PFILE</code> specification that you used initially. If you omitted this specification initially, then omit it again here.
                           </p>
                           <p>This example starts the auxiliary instance by using the parameters in the file <code class="codeph">/home/my_pfile.ora</code>:
                           </p><pre class="pre codeblock"><code>STARTUP FORCE PFILE=/home/my_pfile.ora</code></pre></li>
                        <li>
                           <p>Exit SQL*Plus and start RMAN.</p>
                        </li>
                        <li>
                           <p>Connect to the same databases as initially.</p>
                        </li>
                        <li>
                           <p>Repeat the <code class="codeph">DUPLICATE</code> command.
                           </p>
                           <div class="p">The second <code class="codeph">DUPLICATE</code> operation:
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>Locates the data files that were successfully duplicated by the initial <code class="codeph">DUPLICATE</code> command.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Displays a message similar to the following for each data file that it does not need to duplicate again:</p><pre class="pre codeblock"><code>RMAN-05560: Using previous duplicated file /oradata/new/data01.f for datafile 1 with checkpoint SCN of 1654665</code></pre></li>
                                 <li>
                                    <p>Restores only the missing or incomplete data files, thereby avoiding recopying and restoring all the data files.</p>
                                 </li>
                              </ul>If you do not want RMAN to automatically recover from a failed <code class="codeph">DUPLICATE</code> operation, specify the keyword <code class="codeph">NORESUME</code> to disable the functionality. Using the keyword <code class="codeph">NORESUME</code> in the first invocation of <code class="codeph">DUPLICATE</code> prevents a subsequent <code class="codeph">DUPLICATE</code> command for the new database from using this automatic optimization.
                           </div>
                        </li>
                     </ol>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-EA6E8219-56BF-471C-AC5A-DFC55E760806" name="GUID-EA6E8219-56BF-471C-AC5A-DFC55E760806"></a><h3 id="BRADV-GUID-EA6E8219-56BF-471C-AC5A-DFC55E760806" class="sect3"><span class="enumeration_section">25.9 </span>Examples: Duplicating Databases
               </h3>
               <div>
                  <p>This section contains examples on duplicating databases by using different duplication techniques.</p>
                  <div class="infoboxnotealso" id="GUID-EA6E8219-56BF-471C-AC5A-DFC55E760806__GUID-9BF537AB-FF5A-432B-9800-BE012E6AC0FE">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-187339D5-ABD1-472E-92C7-83CCD21DB8D8" title="This example describes how to use active database duplication to duplicate a database to a remote ASM host.">Example: Duplicating a Database to a Remote ASM Host by Using Active Database Duplication with Backup Sets</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-815B6F9A-7B64-47B3-A68F-B62CECAE141D" title="This example uses active database duplication with image copies to duplicate a database to a remote host.">Example: Duplicating a Database to a Remote Host by Using Active Database Duplication with Image Copies</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-0AA76E9C-72CD-41CD-989E-BFA97857FC06" title="This example describes how to perform duplication to a remote host by using backup-based duplication without a target connection or recovery catalog.">Example: Duplicating a Database to a Remote Host by Using Backup-based Duplication without a Target Connection or Recovery Catalog</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-CDD05468-F1A7-4CCD-AE54-C5AF87965573" title="This example describes how to perform duplication to a remote host by using backup-based duplication with a recovery catalog.">Example: Duplicating a Database to a Remote Host by Using Backup-Based Duplication with a Recovery Catalog</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-86A4A8B2-F699-474B-A29E-955DDCF78B56" title="This example describes how to perform duplication to a remote host by using backup-based duplication with a target connection.">Example: Duplicating a Database to a Remote Host by Using Backup-based Duplication with a Target Connection</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-E9A97E86-8E83-4205-B76E-6AD013CEFDED" title="This example uses active database duplication to duplicate a database to the local host.">Example: Duplicating a Database to the Local Host by Using Active Database Duplication</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-49C686AA-587F-4F1C-9053-B58EB5581B6E" title="This example describes how to use active database duplication to duplicate a PDB to a new CDB.">Example: Duplicating PDBs to a New CDB by Using Active Database Duplication</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-3E8DE9F7-4A62-46D2-A0AE-7F25DCF6DEC3" title="This example describes how to use active database duplication to duplicate a PDB into an existing CDB.">Example: Duplicating a PDB to an Existing CDB by Using Active Duplication</a></p>
                        </li>
                        <li>
                           <p><a href="rman-duplicating-databases.html#GUID-915D2CB7-29AB-46E6-B923-3CF419F59362" title="RMAN enables you to use the DUPLICATE command to perform backup-based duplication by using encrypted backups.">Example: Performing Backup-based Duplication by Using Encrypted Backups</a></p>
                        </li>
                     </ul>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-187339D5-ABD1-472E-92C7-83CCD21DB8D8" name="GUID-187339D5-ABD1-472E-92C7-83CCD21DB8D8"></a><h4 id="BRADV-GUID-187339D5-ABD1-472E-92C7-83CCD21DB8D8" class="sect4"><span class="enumeration_section">25.9.1 </span>Example: Duplicating a Database to a Remote ASM Host by Using Active Database Duplication with Backup Sets
                  </h4>
                  <div>
                     <p>This example describes how to use active database duplication to duplicate a database to a remote ASM host.</p>
                     <div class="section">This example assumes the following scenario:
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>The source host and the destination host are different.</p>
                           </li>
                           <li>
                              <p>Both the source database and the duplicate database manage database files by using ASM.</p>
                           </li>
                           <li>
                              <p>The duplicate database files use a different directory structure than the source database.</p>
                           </li>
                           <li>
                              <p>Network bandwidth on the source host is limited.</p>
                           </li>
                           <li>
                              <p>The duplicate database must be opened after the duplication process completes.</p>
                           </li>
                        </ul>
                        <p>Use the following steps to create a duplicate database for the scenario that is described in this example:</p>
                        <ol>
                           <li>
                              <p>Plan the duplication, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="Before duplicating a database, you must make some decisions about the duplication process.">Planning to Duplicate a Database</a>"</span>. 
                              </p>
                              <div class="p">This includes the following tasks:
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>Choose a duplication technique that suits the scenario and requirements.</p>
                                       <p>Because network bandwidth on the source host is limited, active database duplication by using backup sets is performed.</p>
                                    </li>
                                    <li>
                                       <p>Choose a strategy to name duplicate database files. </p>
                                       <p>In this example, the <code class="codeph">DB_CREATE_FILE_DEST</code> initialization parameter is used to specify the location of the duplicate database files.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Configure six auxiliary channels on the auxiliary instance, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="The primary job of database duplication is performed by RMAN channels. Each channel corresponds to an Oracle Database server session that performs the duplication tasks. Depending on the duplication technique, RMAN uses either auxiliary channels or target channels.">Configuring RMAN Channels for Use in Duplication</a>"</span>.
                                       </p>
                                       <p>In this example, there are two target channels configured on the source database. For RMAN to use backup sets to perform active database duplication, the number of auxiliary channels must be equal to or greater than the number of target channels.</p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <p>Ensure that the prerequisites for the chosen duplication technique are met, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="The prerequisites depend on the type of database duplication being performed. Some prerequisites are common to all types of duplication and others are specific to a particular type of duplication.">Prerequisites for Duplicating a Database</a>"</span>.
                              </p>
                           </li>
                           <li>
                              <div class="p">Prepare the auxiliary instance, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN uses an auxiliary instance to create the duplicate database. You must prepare the auxiliary instance before you begin the duplication.">Preparing the Auxiliary Instance</a>"</span>.
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>Create the disk groups that will store the database files on the destination host.</p>
                                       <p>If it does not already exist, create the <code class="codeph">+DGROUP2</code> disk group to store the duplicate database files.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Copy the password file from the source database to the destination database, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-A338B143-E321-4329-A2ED-2467C70C03DC" title="Connections to the auxiliary instance can be established by using operating system authentication or password file authentication. For backup-based duplication, you can either create a password file or use operating system authentication to connect to the auxiliary instance. For active database duplication, you must use password file authentication.">Creating a Password File for the Auxiliary Instance</a>"</span>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Set up Oracle net services connectivity between the source database and the auxiliary instance by using a static listener.</p>
                                    </li>
                                    <li>
                                       <p>Copy the source database software keystore to the destination host. Specify the password that must be used to open the password-based software keystore by using the <code class="codeph">SET</code> command.
                                       </p>
                                       <p>See <span class="q">"<a href="rman-duplicating-databases.html#GUID-E016C2DC-1774-4057-8EAF-3F69E9A6322A" title="If transparent encryption is configured on the source database, then you must ensure that the Oracle software keystore from the source database is available to the auxiliary instance. Manually copy the keystore from the source database to the destination host.">Making the Oracle Keystore Available to the Destination Host</a>"</span>.
                                       </p>
                                    </li>
                                    <li>Start the auxiliary instance in <code class="codeph">NOMOUNT</code> mode, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-7534941B-A211-4EA5-87AC-D657AE51839E" title="The initialization parameter file that you create is used to start the auxiliary instance.">Starting the Auxiliary Instance</a>"</span>.
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <p>Start RMAN and connect to the source database as <code class="codeph">TARGET</code> and to the auxiliary instance as <code class="codeph">AUXILIARY</code>.
                              </p><pre class="pre codeblock"><code>%rman
RMAN&gt; CONNECT TARGET sys@srcdb as SYSDBA;
RMAN&gt; CONNECT AUXILIARY sys@dupdb AS SYSBACKUP;</code></pre><div class="infoboxnotealso" id="GUID-187339D5-ABD1-472E-92C7-83CCD21DB8D8__GUID-DB4DB45C-747A-4C03-A1BC-3C474E75CC37">
                                 <p class="notep1">See Also:</p>
                                 <p> For active database duplication, connection to the auxiliary instance must also use password file authentication.</p>
                              </div>
                           </li>
                           <li>
                              <p>Duplicate the database by using the <code class="codeph">DUPLICATE</code> command.
                              </p>
                              <p>The <code class="codeph">SPFILE</code> clause directs RMAN to copy the server parameter file from the source database to the auxiliary instance. Use the <code class="codeph">DB_CREATE_FILE_DEST</code> parameter to specify the disk group that is used to store the duplicate database files in the duplicate database.
                              </p><pre class="pre codeblock"><code>DUPLICATE DATABASE to dupdb
FROM ACTIVE DATABASE
PASSWORD FILE
SPFILE
SET DB_CREATE_FILE_DEST='+DGROUP2';</code></pre></li>
                        </ol>
                        <div class="infoboxnotealso" id="GUID-187339D5-ABD1-472E-92C7-83CCD21DB8D8__GUID-C24B8C47-5907-4985-A787-5C04AF5FFA87">
                           <p class="notep1">See Also:</p><a href="rman-duplicating-databases.html#GUID-EA6E8219-56BF-471C-AC5A-DFC55E760806" title="This section contains examples on duplicating databases by using different duplication techniques.">Examples: Duplicating Databases</a></div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-815B6F9A-7B64-47B3-A68F-B62CECAE141D" name="GUID-815B6F9A-7B64-47B3-A68F-B62CECAE141D"></a><h4 id="BRADV-GUID-815B6F9A-7B64-47B3-A68F-B62CECAE141D" class="sect4"><span class="enumeration_section">25.9.2 </span>Example: Duplicating a Database to a Remote Host by Using Active Database Duplication with Image Copies
                  </h4>
                  <div>
                     <p>This example uses active database duplication with image copies to duplicate a database to a remote host.</p>
                     <div class="section">This example assumes the following scenario:
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>The source host and the destination host are different.</p>
                           </li>
                           <li>
                              <p>The duplicate database files use a directory structure that is different from that of the source database.</p>
                           </li>
                           <li>
                              <p>The source database and the duplicate database use Oracle Managed Files (OMF) to create database files.</p>
                           </li>
                           <li>
                              <p>The source database must be available during the duplication process.</p>
                           </li>
                           <li>
                              <p>The duplicate database must be opened after the duplication process completes.</p>
                           </li>
                        </ul>Use the following steps to create a duplicate database for the scenario that is described in this example:
                        <ol>
                           <li>
                              <div class="p">Plan the duplication, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="Before duplicating a database, you must make some decisions about the duplication process.">Planning to Duplicate a Database</a>"</span>. This includes the following tasks:
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>Choose a duplication technique that suits the scenario and requirements.</p>
                                       <p>Since the bandwidth between the source and destination is limited, active database duplication by using image copies is performed.</p>
                                    </li>
                                    <li>
                                       <p>Choose a strategy to name duplicate database files. </p>
                                       <p>In this example, the <code class="codeph">DB_FILE_NAME_CONVERT</code> and <code class="codeph">LOG_FILE_NAME_CONVERT</code> initialization parameters are used to specify how the source database file names are converted to duplicate database file names.
                                       </p>
                                    </li>
                                    <li>
                                       <p>When you perform active database duplication by using image copies, RMAN uses image copies either if no auxiliary channels are configured or if the number of auxiliary channels is lesser than the number of target channels. Therefore, no additional channels need to be configured to perform active database duplication by using image copies.</p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <p>Ensure that the prerequisites for the chosen duplication technique are met, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="The prerequisites depend on the type of database duplication being performed. Some prerequisites are common to all types of duplication and others are specific to a particular type of duplication.">Prerequisites for Duplicating a Database</a>"</span>.
                              </p>
                           </li>
                           <li>
                              <div class="p">Prepare the auxiliary instance, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN uses an auxiliary instance to create the duplicate database. You must prepare the auxiliary instance before you begin the duplication.">Preparing the Auxiliary Instance</a>"</span>.
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>Create the directories that store the database files on the destination host.</p>
                                       <p>In this example, create the <code class="codeph">/app/db_home2/database</code> directory to store the data files, control file, and server parameter file and the <code class="codeph">/app/db_home2/logfiles</code> directory to store the online redo log files.
                                       </p>
                                    </li>
                                    <li>
                                       <p>On the destination host, create a minimal initialization parameter file for the auxiliary instance. The file is called <code class="codeph">initdup.ora</code> and is located in the <code class="codeph">/app/db_home1/database</code> directory. It contains the following entries:
                                       </p><pre class="pre codeblock"><code>DB_NAME=dup
DB_DOMAIN = dup.example.com</code></pre><p>See <span class="q">"<a href="rman-duplicating-databases.html#GUID-57888C11-63C3-4A7A-8488-2E623033A359" title="Multiple methods are available to create the initialization parameter file that is required to start the auxiliary instance.">Creating an Initialization Parameter File for the Auxiliary Instance</a>"</span>.
                                       </p>
                                    </li>
                                    <li>Copy the password file from the source database to destination host, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-A338B143-E321-4329-A2ED-2467C70C03DC" title="Connections to the auxiliary instance can be established by using operating system authentication or password file authentication. For backup-based duplication, you can either create a password file or use operating system authentication to connect to the auxiliary instance. For active database duplication, you must use password file authentication.">Creating a Password File for the Auxiliary Instance</a>"</span></li>
                                    <li>
                                       <p>Set up Oracle net services connectivity between the source database and the auxiliary instance by using a static listener, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-460171C8-2E09-4D0E-9AC3-A4C28392A220" title="You must be able to establish a connection between the source database and auxiliary instance for certain forms of duplication.">Establishing Oracle Net Connectivity Between the Source Database and Auxiliary Instance</a>"</span>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Start the auxiliary instance in <code class="codeph">NOMOUNT</code> mode, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-7534941B-A211-4EA5-87AC-D657AE51839E" title="The initialization parameter file that you create is used to start the auxiliary instance.">Starting the Auxiliary Instance</a>"</span>.
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <p>Start RMAN and connect to the source database as <code class="codeph">TARGET</code> and to the auxiliary instance as <code class="codeph">AUXILIARY</code>.
                              </p><pre class="pre codeblock"><code>% rman
RMAN&gt; CONNECT TARGET sys@srcdb as SYSDBA;
RMAN&gt; CONNECT AUXILIARY sys@dupdb AS SYSBACKUP;</code></pre><div class="infoboxnotealso" id="GUID-815B6F9A-7B64-47B3-A68F-B62CECAE141D__GUID-1487CE38-48EC-4BCB-8A09-27F10B83BFB8">
                                 <p class="notep1">See Also:</p>
                                 <p> For active database duplication, connection to the auxiliary instance must also use password file authentication.</p>
                              </div>
                           </li>
                           <li>
                              <p>Duplicate the database by using the <code class="codeph">DUPLICATE</code> command. Include the <code class="codeph">SPFILE</code> clause with the <code class="codeph">DB_FILE_NAME_CONVERT</code> and <code class="codeph">LOG_FILE_NAME_CONVERT</code> parameters to specify that the server parameter file from the source database must be used for the auxiliary instance.
                              </p>
                              <p>The duplicate database files are stored in the duplicate database by using OMF-generated names. The <code class="codeph">PARAMETER_VALUE_CONVERT</code> option of the <code class="codeph">SPFILE</code> clause specifies that the path name<code class="codeph"> /app/db_home1</code> should be converted to <code class="codeph">/app_db_home2</code>. 
                              </p><pre class="pre codeblock"><code>DUPLICATE DATABASE TO dupdb
FROM ACTIVE DATABASE
PASSWORD FILE
SPFILE PARAMETER_VALUE_CONVERT='/app/dbhome1','/app/db_home2'
SET db_file_name_convert='/app/dbhome1/dbs','/app/db_home2/database/dbs'
SET log_file_name_convert='/app/dbhome1/log','/app/db_home2/logfiles';</code></pre></li>
                        </ol>
                        <div class="infoboxnotealso" id="GUID-815B6F9A-7B64-47B3-A68F-B62CECAE141D__GUID-040F2BE0-BE85-48F5-9D19-3BA93375502C">
                           <p class="notep1">See Also:</p>
                           <p><a href="rman-duplicating-databases.html#GUID-EA6E8219-56BF-471C-AC5A-DFC55E760806" title="This section contains examples on duplicating databases by using different duplication techniques.">Examples: Duplicating Databases</a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-0AA76E9C-72CD-41CD-989E-BFA97857FC06" name="GUID-0AA76E9C-72CD-41CD-989E-BFA97857FC06"></a><h4 id="BRADV-GUID-0AA76E9C-72CD-41CD-989E-BFA97857FC06" class="sect4"><span class="enumeration_section">25.9.3 </span>Example: Duplicating a Database to a Remote Host by Using Backup-based Duplication without a Target Connection or Recovery Catalog
                  </h4>
                  <div>
                     <p>This example describes how to perform duplication to a remote host by using backup-based duplication without a target connection or recovery catalog.</p>
                     <div class="section">This example uses the following scenario:
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>A complete backup of the source database including the control files, data files, and archived redo log files is available in the <code class="codeph">/backups/db_files</code> directory on the destination host.
                              </p>
                           </li>
                           <li>
                              <p>A connection to the target database or recovery catalog is not available.</p>
                           </li>
                           <li>
                              <p>The source host and destination host are different.</p>
                           </li>
                           <li>
                              <p>The duplicate database uses a directory structure that is different from that used by the source database to store the duplicate database files. The data files and control file of the duplicate database files are stored in the <code class="codeph">/oracle2/database</code> directory and the online redo logs files are stored in <code class="codeph">/oracle2/database/logs</code> directory.
                              </p>
                           </li>
                           <li>
                              <p>The <code class="codeph">DB_NAME</code> of the source database is <code class="codeph">db12</code> and that of the duplicate database is <code class="codeph">dup</code>.
                              </p>
                           </li>
                           <li>
                              <p>The duplicate database must be opened after the duplication process completes.</p>
                           </li>
                        </ul>
                        <p>Use the following steps to create a duplicate database for the scenario that is described in this example:</p>
                        <ol>
                           <li>
                              <p>Plan the duplication, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="Before duplicating a database, you must make some decisions about the duplication process.">Planning to Duplicate a Database</a>"</span>. This includes the following tasks:
                              </p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>Choose a duplication technique that suits the scenario and requirements.</p>
                                    <p>In this example, backup-based duplication without a target connection or recovery catalog connection is performed. Therefore, we use the <code class="codeph">BACKUP LOCATION</code> clause to specify the location of the source database backups. 
                                    </p>
                                 </li>
                                 <li>
                                    <p>Because the duplicate database uses a directory structure that is different from the source database, you must choose a strategy to generate duplicate database file names.</p>
                                    <p>In this example, the <code class="codeph">SET NEWNAME FOR DATABASE</code> command specifies the location of the data files and control file. The <code class="codeph">LOGFILE</code> clause of the <code class="codeph">DUPLICATE</code> command specifies the location of the online redo log files.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Copy the required backups to the destination host by using the same directory structure used on the source database.</p>
                                    <p>In this example, the backups of the data files and archived redo log files must be stored in <code class="codeph">/backups/db_files</code> and the backups of the control files and server parameter file in <code class="codeph">/backups/cf</code> on the destination host.
                                    </p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>Ensure that the prerequisites for the chosen duplication technique are met, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="The prerequisites depend on the type of database duplication being performed. Some prerequisites are common to all types of duplication and others are specific to a particular type of duplication.">Prerequisites for Duplicating a Database</a>"</span>.
                              </p>
                           </li>
                           <li>
                              <p>Prepare the auxiliary instance.</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>Create the directories that will store the duplicate database files on the destination host.</p>
                                    <p>In this example, you create the <code class="codeph">/oracle2/database</code> directory to store the data files, control file, and server parameter file. Create the <code class="codeph">/oracle2/database/logs</code> directory to store the online redo log files.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Create a minimal initialization parameter file for the auxiliary instance, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-57888C11-63C3-4A7A-8488-2E623033A359" title="Multiple methods are available to create the initialization parameter file that is required to start the auxiliary instance.">Creating an Initialization Parameter File for the Auxiliary Instance</a>"</span>.
                                    </p>
                                    <div class="p">The file is called <code class="codeph">initdup.ora</code> and is located in the <code class="codeph">/oracle2/database</code> directory. In addition to any other specific settings, it must contain the following entries:<pre class="pre codeblock"><code>DB_NAME = dup
DB_DOMAIN = dupdb.example.com</code></pre></div>
                                 </li>
                                 <li>
                                    <p>Create a password file for the auxiliary instance by using the <code class="codeph">orapwd</code> utility. A password file is required because the duplicate database is being created on a remote host.
                                    </p>
                                    <p>See <span class="q">"<a href="rman-duplicating-databases.html#GUID-A338B143-E321-4329-A2ED-2467C70C03DC" title="Connections to the auxiliary instance can be established by using operating system authentication or password file authentication. For backup-based duplication, you can either create a password file or use operating system authentication to connect to the auxiliary instance. For active database duplication, you must use password file authentication.">Creating a Password File for the Auxiliary Instance</a>"</span>.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Set up Oracle Net Services connectivity between the source database and the auxiliary instance by using a static listener, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-460171C8-2E09-4D0E-9AC3-A4C28392A220" title="You must be able to establish a connection between the source database and auxiliary instance for certain forms of duplication.">Establishing Oracle Net Connectivity Between the Source Database and Auxiliary Instance</a>"</span>.
                                    </p>
                                    <p>This is required because this example duplicates a database to a remote host. </p>
                                 </li>
                                 <li>
                                    <p>Start the auxiliary instance in <code class="codeph">NOMOUNT</code> mode, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-7534941B-A211-4EA5-87AC-D657AE51839E" title="The initialization parameter file that you create is used to start the auxiliary instance.">Starting the Auxiliary Instance</a>"</span>.
                                    </p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>Start RMAN and connect to the source database as <code class="codeph">TARGET</code> and to the auxiliary instance as <code class="codeph">AUXILIARY</code>.
                              </p><pre class="pre codeblock"><code>%rman
RMAN&gt; CONNECT TARGET /
RMAN&gt; CONNECT AUXILIARY sys@dup AS SYSBACKUP;</code></pre><p>Enter the passwords when prompted.</p>
                           </li>
                           <li>
                              <p>Duplicate the database by using the <code class="codeph">DUPLICATE</code> command.
                              </p>
                              <p>Include the <code class="codeph">BACKUP LOCATION</code> clause to specify the location of the source database backups. Enclose the <code class="codeph">SET NEWNAME FOR DATABASE</code> and <code class="codeph">DUPLICATE</code> command within a <code class="codeph">RUN</code> block. The <code class="codeph">LOGFILE</code> clause specifies the names and location of the online redo log files.
                              </p><pre class="pre codeblock"><code>run
{
set newname for database to '/oracle2/database/%b';
duplicate database 'db12' to 'dup'
logfile group 1 ('/oracle2/database/logs/r1.f','/ oracle2/database/logs/r2.f') size 4m reuse, 
        group 2 ('/ oracle2/database/logs/r3.f','/oracle2/database/logs/r4.f') size 4m reuse
backup location '/backups/db_files';
}</code></pre></li>
                        </ol>
                        <div class="infoboxnotealso" id="GUID-0AA76E9C-72CD-41CD-989E-BFA97857FC06__GUID-BE060757-8FFC-4DA8-8136-961E7F9BDCFE">
                           <p class="notep1">See Also:</p>
                           <p><a href="rman-duplicating-databases.html#GUID-EA6E8219-56BF-471C-AC5A-DFC55E760806" title="This section contains examples on duplicating databases by using different duplication techniques.">Examples: Duplicating Databases</a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-CDD05468-F1A7-4CCD-AE54-C5AF87965573" name="GUID-CDD05468-F1A7-4CCD-AE54-C5AF87965573"></a><h4 id="BRADV-GUID-CDD05468-F1A7-4CCD-AE54-C5AF87965573" class="sect4"><span class="enumeration_section">25.9.4 </span>Example: Duplicating a Database to a Remote Host by Using Backup-Based Duplication with a Recovery Catalog
                  </h4>
                  <div>
                     <p>This example describes how to perform duplication to a remote host by using backup-based duplication with a recovery catalog.</p>
                     <div class="section">This example assumes the following scenario:
                        <ul style="list-style-type: disc;">
                           <li>A complete backup of the source database is available on the source host. The backups of the data files and archived redo log files are stored in <code class="codeph">/bkups/db_files</code>. The backups of the control files and server parameter file are stored in <code class="codeph">/bkups/cf</code>.
                           </li>
                           <li>A connection to the source database is not available, but a connection to the recovery catalog is available.</li>
                           <li>
                              <p>The source host and destination host are different. The destination host used OMF and has the Oracle Database software installed.</p>
                           </li>
                           <li>
                              <p>The duplicate database stores database files in a different directory structure than the source database. The database files of the duplicate database must be stored in the <code class="codeph">/app/oracle2/dbs</code> directory.
                              </p>
                           </li>
                           <li>
                              <p>The <code class="codeph">DB_NAME</code> of the source database is <code class="codeph">ora</code> and its Net Service name is <code class="codeph">oradb</code>. The <code class="codeph">DB_NAME</code> of the duplicate database is <code class="codeph">dup</code> and its Net Service name is <code class="codeph">dupdb</code>.
                              </p>
                           </li>
                           <li>
                              <p>The read-only tablespaces in the source database must be excluded from the duplicate database.</p>
                           </li>
                           <li>
                              <p>The duplicate database must not be opened after the duplication process completes.</p>
                           </li>
                        </ul>Use the following steps to create a duplicate database for the scenario that is described in this example:
                        <ol>
                           <li>
                              <div class="p">Plan the duplication. as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="Before duplicating a database, you must make some decisions about the duplication process.">Planning to Duplicate a Database</a>"</span>. This includes the following tasks:
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>Choose a duplication technique that suits the scenario and requirements.</p>
                                       <p>In this example, backup-based duplication using a recovery catalog connection is performed.</p>
                                    </li>
                                    <li>
                                       <p>Choose a strategy to generate duplicate database file names.</p>
                                       <p>Since the duplicate database uses OMF, use the <code class="codeph">DB_CREATE_FILE_DEST</code> parameter in the auxiliary instance's initialization parameter file to specify the directory in which the duplicate database files are stored.
                                       </p>
                                    </li>
                                    <li>Use the <code class="codeph">NOOPEN</code> clause of the <code class="codeph">DUPLICATE</code> command to specify that the duplicate database must not be opened using <code class="codeph">RESETLOGS</code> after the duplication completes.
                                    </li>
                                    <li>
                                       <p>Copy the required backups to the destination host using the same directory structure used on the source database.</p>
                                       <p>In this example, the backups of the data files and archived redo log files must be stored in <code class="codeph">/scratch/db_files</code> and the backups of the control files and server parameter file in <code class="codeph">/scratch/cf</code> on the destination host.
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <p>Ensure that the prerequisites for the chosen duplication technique are met, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="The prerequisites depend on the type of database duplication being performed. Some prerequisites are common to all types of duplication and others are specific to a particular type of duplication.">Prerequisites for Duplicating a Database</a>"</span>.
                              </p>
                           </li>
                           <li>
                              <div class="p">Prepare the auxiliary instance, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN uses an auxiliary instance to create the duplicate database. You must prepare the auxiliary instance before you begin the duplication.">Preparing the Auxiliary Instance</a>"</span>.
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>Create the directories that will store the duplicate database files on the destination host.</p>
                                       <p>In this example, you create the <code class="codeph">/app/oracle2/dbs</code> directory to store the data files, control file, online redo log files, and server parameter file.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Create an initialization parameter file for the auxiliary instance. The file is called <code class="codeph">initdup.ora</code> and is located in the <code class="codeph">/app/oracle2/dbs</code> directory. In addition to any other specific settings, it must contain the following entries:
                                       </p><pre class="pre codeblock"><code>DB_NAME=dup
DB_DOMAIN = dupdb.example.com
DB_CREATE_FILE_DEST= /app/oracle2/dbs</code></pre><p>See <span class="q">"<a href="rman-duplicating-databases.html#GUID-57888C11-63C3-4A7A-8488-2E623033A359" title="Multiple methods are available to create the initialization parameter file that is required to start the auxiliary instance.">Creating an Initialization Parameter File for the Auxiliary Instance</a>"</span>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Create a password file for the auxiliary instance by using the <code class="codeph">orapwd</code> utility. A password file is required because the duplicate database is being created on a remote host.
                                       </p>
                                       <p>See <span class="q">"<a href="rman-duplicating-databases.html#GUID-A338B143-E321-4329-A2ED-2467C70C03DC" title="Connections to the auxiliary instance can be established by using operating system authentication or password file authentication. For backup-based duplication, you can either create a password file or use operating system authentication to connect to the auxiliary instance. For active database duplication, you must use password file authentication.">Creating a Password File for the Auxiliary Instance</a>"</span>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Set up Oracle net services connectivity between the source database and the auxiliary instance using a static listener. This is required because this example duplicates a database to a remote host. </p>
                                       <p>See <span class="q">"<a href="rman-duplicating-databases.html#GUID-460171C8-2E09-4D0E-9AC3-A4C28392A220" title="You must be able to establish a connection between the source database and auxiliary instance for certain forms of duplication.">Establishing Oracle Net Connectivity Between the Source Database and Auxiliary Instance</a>"</span>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Start the auxiliary instance in <code class="codeph">NOMOUNT</code> mode, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-7534941B-A211-4EA5-87AC-D657AE51839E" title="The initialization parameter file that you create is used to start the auxiliary instance.">Starting the Auxiliary Instance</a>"</span>.
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <p>Start RMAN and connect to the source database as <code class="codeph">TARGET</code> and to the auxiliary instance as <code class="codeph">AUXILIARY</code>.
                              </p><pre class="pre codeblock"><code>%rman
RMAN&gt; CONNECT TARGET sys@oradb;
RMAN&gt; CONNECT AUXILIARY sys@dupdb;</code></pre><p>Enter the passwords when prompted.</p>
                           </li>
                           <li>
                              <p>Duplicate the database by using the <code class="codeph">DUPLICATE</code> command.
                              </p>
                              <p>Include the <code class="codeph">SKIP READONLY</code> clause to exclude the read-only tablespaces from the duplicate database. Because there is no connection to a target database, you must specify the name of the target database that is being duplicated.
                              </p><pre class="pre codeblock"><code>DUPLICATE DATABASE db12 TO dup
SKIP READONLY;</code></pre></li>
                        </ol>
                        <div class="infoboxnotealso" id="GUID-CDD05468-F1A7-4CCD-AE54-C5AF87965573__GUID-6F23E7A4-9C85-483E-B25C-5F10012E0E93">
                           <p class="notep1">See Also:</p>
                           <p><a href="rman-duplicating-databases.html#GUID-EA6E8219-56BF-471C-AC5A-DFC55E760806" title="This section contains examples on duplicating databases by using different duplication techniques.">Examples: Duplicating Databases</a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-86A4A8B2-F699-474B-A29E-955DDCF78B56" name="GUID-86A4A8B2-F699-474B-A29E-955DDCF78B56"></a><h4 id="BRADV-GUID-86A4A8B2-F699-474B-A29E-955DDCF78B56" class="sect4"><span class="enumeration_section">25.9.5 </span>Example: Duplicating a Database to a Remote Host by Using Backup-based Duplication with a Target Connection
                  </h4>
                  <div>
                     <p>This example describes how to perform duplication to a remote host by using backup-based duplication with a target connection.</p>
                     <div class="section">This example uses the following scenario: 
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>A complete backup of the source database including the control file, data files, and archived redo log files is available.</p>
                           </li>
                           <li>
                              <p>A connection to the source database is available.</p>
                           </li>
                           <li>
                              <p>The source host and destination host are different.</p>
                           </li>
                           <li>
                              <p>The source database is configured to use transparent encryption with a password-based software keystore.</p>
                           </li>
                           <li>
                              <p>The duplicate database uses the same directory structure and file names as the source database to store database files.</p>
                              <p>On the source host, the data file, control files and server parameter file are stored in <code class="codeph">/app/db_home1/database</code> and the online redo log files are stored in <code class="codeph">/app/db_home1/logfiles</code>.
                              </p>
                           </li>
                           <li>
                              <p>The <code class="codeph">DB_NAME</code> of the source database is <code class="codeph">src</code> and its Net Service name is <code class="codeph">srcdb</code>. The <code class="codeph">DB_NAME</code> of the duplicate database is <code class="codeph">dup</code> and its Net Service name is <code class="codeph">dupdb</code>.
                              </p>
                           </li>
                           <li>
                              <p>On the source host, backups of the data files and archived redo log files are stored in <code class="codeph">/bkups/oradata/db_files</code>. The backups of the control files and server parameter file are stored in <code class="codeph">/bkups/oradata/cf</code>.
                              </p>
                           </li>
                           <li>
                              <p>The tablespaces <code class="codeph">HR</code> and <code class="codeph">SH</code> must be excluded from the duplicate database.
                              </p>
                              <p>The remaining tablespaces in the source database are self-contained and do not have links to the <code class="codeph">hr</code> and <code class="codeph">sh</code> tablespaces.
                              </p>
                           </li>
                           <li>
                              <p>The duplicate database must be opened after the duplication process completes.</p>
                           </li>
                        </ul>Use the following steps to create a duplicate database for the scenario that is described in this example:
                        <ol>
                           <li>
                              <div class="p">Plan the duplication, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="Before duplicating a database, you must make some decisions about the duplication process.">Planning to Duplicate a Database</a>"</span>. This includes the following tasks:
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>Choose a duplication technique that is suitable for your scenario.</p>
                                       <p>In this example, backup-based duplication by using a target connection is performed.</p>
                                    </li>
                                    <li>
                                       <p>Because the duplicate database uses the same directory structure as source database, you need not specify an alternative file naming strategy.</p>
                                       <p>However, use the <code class="codeph">NOFILENAMECHECK</code> clause in the <code class="codeph">DUPLICATE</code> command to prevent RMAN from checking if the data files and online redo logs files of the source database use the same names as that on the duplicate database.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Configure three additional auxiliary channels, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="The primary job of database duplication is performed by RMAN channels. Each channel corresponds to an Oracle Database server session that performs the duplication tasks. Depending on the duplication technique, RMAN uses either auxiliary channels or target channels.">Configuring RMAN Channels for Use in Duplication</a>"</span>. Using additional auxiliary channels enhances the performance of the duplication process
                                       </p>
                                    </li>
                                    <li>
                                       <p>Copy the required backups to the destination host using the same directory structure used on the source database.</p>
                                       <p>In this example, the backups of the data files and archived redo log files must be stored in the <code class="codeph">/bkups/oradata/db_files</code> directory and the backups of the control file and server parameter file in the <code class="codeph">/bkups/oradata/cf</code> directory on the destination host.
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <p>Ensure that the prerequisites for the chosen duplication technique are met, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="The prerequisites depend on the type of database duplication being performed. Some prerequisites are common to all types of duplication and others are specific to a particular type of duplication.">Prerequisites for Duplicating a Database</a>"</span>.
                              </p>
                           </li>
                           <li>
                              <div class="p">Prepare the auxiliary instance, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN uses an auxiliary instance to create the duplicate database. You must prepare the auxiliary instance before you begin the duplication.">Preparing the Auxiliary Instance</a>"</span>.
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>Create the directories that store the duplicate database files on the destination host.</p>
                                       <p>In this example, the source database and the duplicate database use the same directory structure. Create the <code class="codeph">/app/database</code> directory to store the data files, control file, and server parameter file and the <code class="codeph">/app/logfiles</code> directory to store the online redo log files.
                                       </p>
                                    </li>
                                    <li>
                                       <div class="p">Create a minimal initialization parameter file for the auxiliary instance. The file is called <code class="codeph">initdup.or</code>a and is located in the <code class="codeph">/app/database</code> directory. It contains the following entries:<pre class="pre codeblock"><code>DB_NAME=dup
DB_DOMAIN = dup.example.com</code></pre></div>
                                       <p>See <span class="q">"<a href="rman-duplicating-databases.html#GUID-57888C11-63C3-4A7A-8488-2E623033A359" title="Multiple methods are available to create the initialization parameter file that is required to start the auxiliary instance.">Creating an Initialization Parameter File for the Auxiliary Instance</a>"</span>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Create a password file for the auxiliary instance by copying the password file from the source database to the duplicate database, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-A338B143-E321-4329-A2ED-2467C70C03DC" title="Connections to the auxiliary instance can be established by using operating system authentication or password file authentication. For backup-based duplication, you can either create a password file or use operating system authentication to connect to the auxiliary instance. For active database duplication, you must use password file authentication.">Creating a Password File for the Auxiliary Instance</a>"</span>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Set up Oracle Net Services connectivity between the source database and the auxiliary instance by using a static listener, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-460171C8-2E09-4D0E-9AC3-A4C28392A220" title="You must be able to establish a connection between the source database and auxiliary instance for certain forms of duplication.">Establishing Oracle Net Connectivity Between the Source Database and Auxiliary Instance</a>"</span>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Start the auxiliary instance in <code class="codeph">NOMOUNT</code> mode, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-7534941B-A211-4EA5-87AC-D657AE51839E" title="The initialization parameter file that you create is used to start the auxiliary instance.">Starting the Auxiliary Instance</a>"</span></p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <div class="p">Start RMAN and connect to the source database as <code class="codeph">TARGET</code> and to the auxiliary instance as <code class="codeph">AUXILIARY</code>. These connections are established from the destination host and the auxiliary connection uses operating system authentication.<pre class="pre codeblock"><code>%rman
RMAN&gt; CONNECT TARGET sys@dupdb AS SYSBACKUP;
RMAN&gt; CONNECT AUXILIARY /</code></pre></div>
                           </li>
                           <li>
                              <p>Duplicate the database by using the <code class="codeph">DUPLICATE</code> command.
                              </p>
                              <p>Include the <code class="codeph">SKIP TABLEPACE</code> clause to specify the tablespaces that must be omitted during the duplication process. Use the <code class="codeph">SPFILE</code> clause to specify that the server parameter file from the source database must be restored and copied to the duplicate database.
                              </p><pre class="pre codeblock"><code>DUPLICATE DATABASE TO dup
SPFILE
SKIP TABLESPACE HR, SH
NOFILENAMECHECK;</code></pre></li>
                        </ol>
                        <div class="infoboxnotealso" id="GUID-86A4A8B2-F699-474B-A29E-955DDCF78B56__GUID-E1013999-9440-43C5-9263-B6B946770DB2">
                           <p class="notep1">See Also:</p>
                           <p><a href="rman-duplicating-databases.html#GUID-EA6E8219-56BF-471C-AC5A-DFC55E760806" title="This section contains examples on duplicating databases by using different duplication techniques.">Examples: Duplicating Databases</a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-E9A97E86-8E83-4205-B76E-6AD013CEFDED" name="GUID-E9A97E86-8E83-4205-B76E-6AD013CEFDED"></a><h4 id="BRADV-GUID-E9A97E86-8E83-4205-B76E-6AD013CEFDED" class="sect4"><span class="enumeration_section">25.9.6 </span>Example: Duplicating a Database to the Local Host by Using Active Database Duplication
                  </h4>
                  <div>
                     <p>This example uses active database duplication to duplicate a database to the local host.</p>
                     <div class="section">This example assumes the following scenario:
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>The source host and the destination host are the same.</p>
                           </li>
                           <li>
                              <p>Both the source database and the duplicate database manage database files by using Oracle Managed Files (OMF).</p>
                           </li>
                           <li>
                              <p>The duplicate database files use a different directory structure than the source database.</p>
                           </li>
                           <li>
                              <p>The source database is run in <code class="codeph">ARCHIVELOG</code> mode and is available during the duplication process.
                              </p>
                           </li>
                           <li>
                              <p>The service name of the source database <code class="codeph">dbsrc</code> and that of the duplicate database is <code class="codeph">dbdup</code>. The source database uses a server parameter file (spfile).
                              </p>
                           </li>
                        </ul>
                        <p>Use the following steps to create a duplicate database for the scenario that is described in this example:</p>
                        <ol>
                           <li>
                              <p>Plan the duplication, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="Before duplicating a database, you must make some decisions about the duplication process.">Planning to Duplicate a Database</a>"</span>.
                              </p>
                              <div class="p">This includes the following tasks:
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>Choose a duplication technique that suits the scenario and requirements</p>
                                       <p>Because network bandwidth on the source host is limited, active database duplication by using backup sets is performed.</p>
                                    </li>
                                    <li>
                                       <p>Choose a strategy to name duplicate database files</p>
                                       <p>In this example, the <code class="codeph">DB_CREATE_FILE_DEST</code> initialization parameter is used to specify the location of the duplicate database files.
                                       </p>
                                       <p>To ensure that the source database files are not overwritten, do not include the <code class="codeph">NOFILENAMECHECK</code> clause in the <code class="codeph">DUPLICATE</code> command.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Configure auxiliary channels on the auxiliary instance</p>
                                       <p>In this example, there are three target channels configured on the source database. For RMAN to use backup sets to perform active database duplication, the number of auxiliary channels must be equal to or greater than the number of target channels.</p>
                                       <p>See <span class="q">"<a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="The primary job of database duplication is performed by RMAN channels. Each channel corresponds to an Oracle Database server session that performs the duplication tasks. Depending on the duplication technique, RMAN uses either auxiliary channels or target channels.">Configuring RMAN Channels for Use in Duplication</a>"</span>.
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <p>Ensure that the prerequisites for the chosen duplication technique are met, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="The prerequisites depend on the type of database duplication being performed. Some prerequisites are common to all types of duplication and others are specific to a particular type of duplication.">Prerequisites for Duplicating a Database</a>"</span>.
                              </p>
                           </li>
                           <li>
                              <div class="p">Prepare the auxiliary instance, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN uses an auxiliary instance to create the duplicate database. You must prepare the auxiliary instance before you begin the duplication.">Preparing the Auxiliary Instance</a>"</span>.
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>Create the directories that store the database files on the destination host</p>
                                       <p>In this example, create the <code class="codeph">/app/db_home3/dbs</code> directory to store the data files, control file, and server parameter file and the <code class="codeph">/app/db_home3/logfiles</code> directory to store the online redo log files.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Copy the password file from the source database to the duplicate database, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-A338B143-E321-4329-A2ED-2467C70C03DC" title="Connections to the auxiliary instance can be established by using operating system authentication or password file authentication. For backup-based duplication, you can either create a password file or use operating system authentication to connect to the auxiliary instance. For active database duplication, you must use password file authentication.">Creating a Password File for the Auxiliary Instance</a>"</span>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Create an initialization parameter file for the auxiliary instance with the following minimum parameters: <code class="codeph">DB_NAME</code>, <code class="codeph">CONTROL_FILES</code>, <code class="codeph">DB_CREATE_FILE_DEST</code>, and <code class="codeph">LOG_CREATE_FILE_DEST</code>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Set up Oracle net services connectivity between the source database and the auxiliary instance by using a static listener.</p>
                                    </li>
                                    <li>Start the auxiliary instance in <code class="codeph">NOMOUNT</code> mode, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-7534941B-A211-4EA5-87AC-D657AE51839E" title="The initialization parameter file that you create is used to start the auxiliary instance.">Starting the Auxiliary Instance</a>"</span>.
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <p>Start RMAN and connect to the source database as <code class="codeph">TARGET</code> and to the auxiliary instance as <code class="codeph">AUXILIARY</code>. Both connections user net service names.
                              </p><pre class="pre codeblock"><code>%rman
RMAN&gt; CONNECT TARGET sys@srcdb as SYSDBA;
RMAN&gt; CONNECT AUXILIARY sys@dupdb AS SYSBACKUP;</code></pre><p><span class="bold">Note:</span> For active database duplication, the connection to the auxiliary instance must also use password file authentication.
                              </p>
                           </li>
                           <li>
                              <p>Duplicate the database by using the <code class="codeph">DUPLICATE</code> command.
                              </p><pre class="pre codeblock"><code>DUPLICATE DATABASE to dbdup
FROM ACTIVE DATABASE;</code></pre></li>
                        </ol>
                        <div class="infoboxnotealso" id="GUID-E9A97E86-8E83-4205-B76E-6AD013CEFDED__GUID-C24B8C47-5907-4985-A787-5C04AF5FFA87">
                           <p class="notep1">See Also:</p><a href="rman-duplicating-databases.html#GUID-EA6E8219-56BF-471C-AC5A-DFC55E760806" title="This section contains examples on duplicating databases by using different duplication techniques.">Examples: Duplicating Databases</a></div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-49C686AA-587F-4F1C-9053-B58EB5581B6E" name="GUID-49C686AA-587F-4F1C-9053-B58EB5581B6E"></a><h4 id="BRADV-GUID-49C686AA-587F-4F1C-9053-B58EB5581B6E" class="sect4"><span class="enumeration_section">25.9.7 </span>Example: Duplicating PDBs to a New CDB by Using Active Database Duplication
                  </h4>
                  <div>
                     <p>This example describes how to use active database duplication to duplicate a PDB to a new CDB.</p>
                     <div class="section">This example assumes the following scenario:
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>The source host and the destination host are different.</p>
                           </li>
                           <li>
                              <p>Both the source database and the duplicate database manage database files by using OMF.</p>
                           </li>
                           <li>
                              <p>Network bandwidth on the source host is limited.</p>
                           </li>
                           <li>
                              <p>The duplicate database files use a different directory structure than the source database.</p>
                           </li>
                        </ul>
                        <p>Use the following steps to create a duplicate database for the scenario that is described in this example:</p>
                        <ol>
                           <li>
                              <div class="p">Plan the duplication, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="Before duplicating a database, you must make some decisions about the duplication process.">Planning to Duplicate a Database</a>"</span>. This includes the following tasks:
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>Choose a duplication technique that suits the scenario and requirements.</p>
                                       <p>Because network bandwidth on the source host is limited, active database duplication by using backup sets is performed.</p>
                                    </li>
                                    <li>
                                       <p>Choose a strategy to name duplicate database files. </p>
                                       <p>In this example, the <code class="codeph">DB_FILE_NAME_CONVERT</code> and <code class="codeph">LOG_FILE_NAME_CONVERT</code> initialization parameters are used to specify the location of the duplicate database files.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Configure four auxiliary channels on the auxiliary instance, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="The primary job of database duplication is performed by RMAN channels. Each channel corresponds to an Oracle Database server session that performs the duplication tasks. Depending on the duplication technique, RMAN uses either auxiliary channels or target channels.">Configuring RMAN Channels for Use in Duplication</a>"</span>.
                                       </p>
                                       <p>In this example, two target channels are configured on the source database. For RMAN to use backup sets to perform active database duplication, the number of auxiliary channels must be equal to or greater than the number of target channels.</p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <p>Ensure that the prerequisites for the chosen duplication technique are met, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="The prerequisites depend on the type of database duplication being performed. Some prerequisites are common to all types of duplication and others are specific to a particular type of duplication.">Prerequisites for Duplicating a Database</a>"</span>.
                              </p>
                           </li>
                           <li>
                              <div class="p">Prepare the auxiliary instance, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-FCE67CCA-78B3-47E4-8D1B-75C8719BD51A" title="RMAN uses an auxiliary instance to create the duplicate database. You must prepare the auxiliary instance before you begin the duplication.">Preparing the Auxiliary Instance</a>"</span>.
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>Create the directories that store the database files on the destination host.</p>
                                       <p>In this example, create the <code class="codeph">/app/dbhome3/database</code> directory to store the data files, control file, and server parameter file and the <code class="codeph">/app/dbhome3/logfiles</code> directory to store the online redo log files.
                                       </p>
                                    </li>
                                    <li>
                                       <p>On the destination host, create a minimal initialization parameter file for the auxiliary instance. The file is called <code class="codeph">initdup.ora</code> and contains the following entries:
                                       </p><pre class="pre codeblock"><code>ENABLE_PLUGGABLE_DATABASE=true
DB_NAME=dup
DB_DOMAIN = dup.example.com</code></pre></li>
                                    <li>
                                       <p>Create the password file on the destination database by using the <code class="codeph">PASSWORD FILE</code> option in the <code class="codeph">DUPLICATE</code> command..
                                       </p>
                                    </li>
                                    <li>
                                       <p>Set up Oracle net services connectivity between the source database and the auxiliary instance by using a static listener.</p>
                                    </li>
                                    <li>Start the auxiliary instance in <code class="codeph">NOMOUNT</code> mode, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-7534941B-A211-4EA5-87AC-D657AE51839E" title="The initialization parameter file that you create is used to start the auxiliary instance.">Starting the Auxiliary Instance</a>"</span>. Connect to the root as a common user with the <code class="codeph">SYSDBA</code> or <code class="codeph">SYSBACKUP</code> privilege.
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <p>Start RMAN and connect to the root of the source database as <code class="codeph">TARGET</code> and to the auxiliary instance as <code class="codeph">AUXILIARY</code>.
                              </p><pre class="pre codeblock"><code>%rman
RMAN&gt; CONNECT TARGET sys@srcdb as SYSDBA;
RMAN&gt; CONNECT AUXILIARY sys@dupdb AS SYSBACKUP;</code></pre><p><span class="bold">Note:</span> For active database duplication, connection to the auxiliary instance must also use password file authentication.
                              </p>
                           </li>
                           <li>
                              <p>Ensure that the source CDB is open or mounted.</p>
                           </li>
                           <li>
                              <p>Duplicate the database by using the <code class="codeph">DUPLICATE</code> command.
                              </p>
                              <p>The <code class="codeph">SPFILE</code> option directs RMAN to copy the server parameter file from the source database to the auxiliary instance. Use the <code class="codeph">DB_CREATE_FILE_DEST</code> parameter to specify the disk group that is used to store the duplicate database files in the duplicate database.
                              </p><pre class="pre codeblock"><code>DUPLICATE DATABASE to dupdb
FROM ACTIVE PLUGGABLE DATABASE my_pdb
PASSWORD FILE
SET DB_FILE_NAME_CONVERT='/app/dbhome/database','/app/dbhome3/database' SET LOG_FILE_NAME_CONVERT='/app/dbhome/logfiles','/app/dbhome3/logfiles';</code></pre></li>
                        </ol>
                        <div class="infoboxnotealso" id="GUID-49C686AA-587F-4F1C-9053-B58EB5581B6E__GUID-C24B8C47-5907-4985-A787-5C04AF5FFA87">
                           <p class="notep1">See Also:</p><a href="rman-duplicating-databases.html#GUID-EA6E8219-56BF-471C-AC5A-DFC55E760806" title="This section contains examples on duplicating databases by using different duplication techniques.">Examples: Duplicating Databases</a></div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-3E8DE9F7-4A62-46D2-A0AE-7F25DCF6DEC3" name="GUID-3E8DE9F7-4A62-46D2-A0AE-7F25DCF6DEC3"></a><h4 id="BRADV-GUID-3E8DE9F7-4A62-46D2-A0AE-7F25DCF6DEC3" class="sect4"><span class="enumeration_section">25.9.8 </span>Example: Duplicating a PDB to an Existing CDB by Using Active Duplication
                  </h4>
                  <div>
                     <p>This example describes how to use active database duplication to duplicate a PDB into an existing CDB.</p>
                     <div class="section">
                        <p></p>
                        <p>The example assumes the following scenario:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>The source CDB, <code class="codeph">cdb_src</code>, and the destination CDB, <code class="codeph">cdb_dest</code>, are on different hosts.
                              </p>
                           </li>
                           <li>
                              <p>Both source and destination CDB use OMF to manage database files.</p>
                           </li>
                           <li>
                              <p>The source and destination CDBs have compatible set to 18.0.0 or higher.</p>
                           </li>
                           <li>
                              <p>The source CDB and the destination CDB use local undo.</p>
                           </li>
                           <li>
                              <p>The PDB being duplicated, <code class="codeph">my_pdb</code>, is in read-write mode.
                              </p>
                           </li>
                           <li>
                              <p>The source CDB and the destination CDB are open in read-write mode.</p>
                           </li>
                           <li>
                              <p>The initialization parameter <code class="codeph">REMOTE_RECOVERY_FILE_DEST</code> which determines the location to which foreign archived redo log files are restored is set for the destination CDB.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Plan the duplication, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="Before duplicating a database, you must make some decisions about the duplication process.">Planning to Duplicate a Database</a>"</span>. This includes the following tasks:</span><div>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>Because the PDB is being duplicated to an existing CDB, the only duplication technique available is active duplication.</p>
                                 </li>
                                 <li>
                                    <p>Choose a strategy to name duplicate database files. </p>
                                    <p>In this example, the <code class="codeph">DB_FILE_NAME_CONVERT</code> initialization parameter is used to specify the location of the duplicate database files.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Configure four auxiliary channels on the destination CDB, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-F2ED1190-E3BF-4898-BDCC-B9FF0500C76B" title="The primary job of database duplication is performed by RMAN channels. Each channel corresponds to an Oracle Database server session that performs the duplication tasks. Depending on the duplication technique, RMAN uses either auxiliary channels or target channels.">Configuring RMAN Channels for Use in Duplication</a>"</span>.
                                    </p>
                                    <p>In this example, there are three target channels configured on the source database. For RMAN to use backup sets to perform active database duplication, the number of auxiliary channels must be equal to or greater than the number of target channels.</p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Ensure that the prerequisites for active duplication and the additional prerequisites for duplicating a PDB to an existing CDB are met, as described in <a href="../rcmrf/DUPLICATE.html#RCMRF-GUID-E13D8A02-80F9-49A2-9C31-92DD3A795CE4" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a>.</span></li>
                        <li class="stepexpand"><span>Establish Oracle net connectivity between the source CDB and the destination CDB, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-460171C8-2E09-4D0E-9AC3-A4C28392A220" title="You must be able to establish a connection between the source database and auxiliary instance for certain forms of duplication.">Establishing Oracle Net Connectivity Between the Source Database and Auxiliary Instance</a>"</span>.</span></li>
                        <li class="stepexpand"><span>Create the directories that will store the duplicate database files on the destination host, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-2ECA94F4-E8EB-43D7-9934-39F2BE281700" title="On the destination host, you must create the directories that are used to store the duplicate database files on the destination host. This includes the directories that store the data files, control files, online redo log files, and temp files.">Creating Directories for the Duplicate Database</a>"</span>.</span></li>
                        <li class="stepexpand"><span>Start RMAN and connect as <code class="codeph">TARGET</code> to the root of the source CDB and as <code class="codeph">AUXILIARY</code> to the root of the destination CDB.</span><div><pre class="pre codeblock"><code>%rman
RMAN&gt; CONNECT TARGET sys@cdbsrc as SYSDBA;
RMAN&gt; CONNECT AUXILIARY sys@cdbdup AS SYSBACKUP;</code></pre><p><span class="bold">Note:</span> For active database duplication, connection to the destination CDB must use password file authentication.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Duplicate the database by using the <code class="codeph">DUPLICATE</code> command.</span><div>
                              <p>Use the <code class="codeph">DB_CREATE_FILE_DEST</code> parameter to specify the disk group that is used to store the duplicate database files in the duplicate database.
                              </p><pre class="pre codeblock"><code>DUPLICATE PLUGGABLE DATABASE my_pdb AS dup_pdb TO cdb_dest
FROM ACTIVE DATABASE
DB_FILE_NAME_CONVERT='/disk1/oracle/dbs','disk2/oracle/dbs';  
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Delete the foreign archived redo log files that were restored to the location specified by the <code class="codeph">remote_recovery_file_dest</code> initialization parameter as part of the duplication.</span></li>
                     </ol>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-915D2CB7-29AB-46E6-B923-3CF419F59362" name="GUID-915D2CB7-29AB-46E6-B923-3CF419F59362"></a><h4 id="BRADV-GUID-915D2CB7-29AB-46E6-B923-3CF419F59362" class="sect4"><span class="enumeration_section">25.9.9 </span>Example: Performing Backup-based Duplication by Using Encrypted Backups
                  </h4>
                  <div>
                     <p>RMAN enables you to use the <code class="codeph">DUPLICATE</code> command to perform backup-based duplication by using encrypted backups.
                     </p>
                     <div class="section">
                        <p></p>
                        <p>This example uses the following scenario:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>The source host and destination host are different.</p>
                           </li>
                           <li>
                              <p>Both source and destination database use OMF to manage database file names. However, the duplicate database uses a directory structure that is different from that of the source database.</p>
                           </li>
                           <li>
                              <p>Source database backups are encrypted by using transparent-mode encryption with the encryption key stored in a password-based software keystore. The keystore password is set up by using the following command (where <code class="codeph"><span class="codeinlineitalic">password</span></code> is a placeholder for the actual password that you enter): 
                              </p><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM SET ENCRYPTION KEY IDENTIFIED BY <span class="italic">password</span>;</pre></li>
                           <li>
                              <p>A complete backup of the source database including the control files, data files, and archived  redo log files is stored in the <code class="codeph">/oracle2/rman_backups</code> directory.
                              </p>
                           </li>
                           <li>
                              <p>The <code class="codeph">DB_NAME</code> of source database is <code class="codeph">db_src</code> and that of the duplicate database is <code class="codeph">dup_db</code>.
                              </p>
                           </li>
                           <li>
                              <p>The <code class="codeph">EXAMPLE</code> and <code class="codeph">TOOLS</code> tablespaces must be excluded from the duplicate database.
                              </p>
                           </li>
                           <li>
                              <p>The duplicate database must be opened after the duplication process completes.</p>
                           </li>
                        </ul>
                        <p>To perform backup-based database duplication by using encrypted backups:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Plan the duplication, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-AAD4B8CB-B149-4837-85EF-07044EBCC40B" title="Before duplicating a database, you must make some decisions about the duplication process.">Planning to Duplicate a Database</a>"</span>. This includes the following tasks:</span><ol type="a">
                              <li class="substepexpand"><span>Choose a duplication technique that suits the scenario and requirements.</span><div>
                                    <p>In this example, backup-based duplication without target connection or recovery catalog connection is performed. The <code class="codeph">BACKUP LOCATION</code> option is used to specify the location of the source database backups.
                                    </p>
                                 </div>
                              </li>
                              <li class="substepexpand"><span>Choose a strategy to generate duplicate database file names.</span><div>
                                    <p>Because the duplicate database uses a directory structure that is different from the source database, use the <code class="codeph">DB_CREATE_FILE_DEST</code> parameter in the auxiliary instance's initialization parameter file to specify the location in which duplicate database files are stored.
                                    </p>
                                 </div>
                              </li>
                              <li class="substepexpand"><span>Copy the required backups to the destination host by using the same directory structure that was used on the source database.</span></li>
                           </ol>
                        </li>
                        <li class="stepexpand"><span>Ensure that the prerequisites for the chosen duplication technique are met, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-7FDB9916-8FB9-471A-8EFD-26E34FB8EA25" title="The prerequisites depend on the type of database duplication being performed. Some prerequisites are common to all types of duplication and others are specific to a particular type of duplication.">Prerequisites for Duplicating a Database</a>"</span>.</span></li>
                        <li class="stepexpand"><span>Prepare the auxiliary instance.</span><ol type="a">
                              <li class="substepexpand"><span>Create the directories that store the database files on the destination host.</span><div>
                                    <p>In this example, create the <code class="codeph">/app/db_home2/database</code> directory to store the data files, control file, and server parameter file and the <code class="codeph">/app/db_home2/logfiles</code> directory to store the online redo log files.
                                    </p>
                                 </div>
                              </li>
                              <li class="substepexpand"><span>Create a minimal initialization parameter file for the auxiliary instance. </span><div>
                                    <p>The file is called <code class="codeph">initdup.ora</code> and is located in the<code class="codeph"> /app/db_home2/database</code> directory. It contains the following entries:
                                    </p><pre class="pre codeblock"><code><code class="codeph">DB_NAME=dup_db</code><code class="codeph">
DB_DOMAIN = dup.example.com
</code><code class="codeph">DB_CREATE_FILE_DEST = /app/db_home2/database</code></code></pre><p>See <span class="q">"<a href="rman-duplicating-databases.html#GUID-57888C11-63C3-4A7A-8488-2E623033A359" title="Multiple methods are available to create the initialization parameter file that is required to start the auxiliary instance.">Creating an Initialization Parameter File for the Auxiliary Instance</a>"</span>.
                                    </p>
                                 </div>
                              </li>
                              <li class="substepexpand"><span>Copy the password file from the source database to destination host, as described in <span class="q">"<a href="rman-duplicating-databases.html#GUID-A338B143-E321-4329-A2ED-2467C70C03DC" title="Connections to the auxiliary instance can be established by using operating system authentication or password file authentication. For backup-based duplication, you can either create a password file or use operating system authentication to connect to the auxiliary instance. For active database duplication, you must use password file authentication.">Creating a Password File for the Auxiliary Instance</a>"</span>.</span><div>
                                    <p>A password file is required because the duplicate database is being created on a remote host.</p>
                                 </div>
                              </li>
                              <li class="substepexpand"><span>Set up Oracle net services connectivity between the source database and the auxiliary instance by using a static listener. This is required because this example duplicates a database to a remote host.</span><div>
                                    <p>See <span class="q">"<a href="rman-duplicating-databases.html#GUID-460171C8-2E09-4D0E-9AC3-A4C28392A220" title="You must be able to establish a connection between the source database and auxiliary instance for certain forms of duplication.">Establishing Oracle Net Connectivity Between the Source Database and Auxiliary Instance</a>"</span>.
                                    </p>
                                 </div>
                              </li>
                              <li class="substepexpand"><span>Start the auxiliary instance in <code class="codeph">NOMOUNT</code> mode by using the parameter file <code class="codeph">initdupdb.ora</code> created in Step 3b.</span></li>
                           </ol>
                        </li>
                        <li class="stepexpand"><span>Start RMAN and connect to the source database as <code class="codeph">TARGET</code> and to the auxiliary instance as <code class="codeph">AUXILIARY</code>.</span><div><pre class="oac_no_warn" dir="ltr">%rman
RMAN&gt; CONNECT TARGET /
RMAN&gt; CONNECT AUXILIARY sys@dup_db AS SYSBACKUP</pre><p>Enter the passwords when prompted.</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Because the source database backups used to duplicate the database are encrypted backups, specify the password that must be used to open the software keystore that contains the encryption key  (where <code class="codeph"><span class="codeinlineitalic">password</span></code> is a placeholder for the actual password that you enter).</span><div><pre class="oac_no_warn" dir="ltr">SET DECRYPTION WALLET OPEN IDENTIFIED BY <span class="italic">password</span>;</pre><p>Note that the password specified in the <code class="codeph">SET</code> command must the same as the one that was set on the source database by using the <code class="codeph">ALTER SYSTEM SET ENCRYPTION KEY</code> command.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Duplicate the database by using the <code class="codeph">DUPLICATE</code> command.</span><div>
                              <p>Before you perform the duplication, you must specify the password that must be used to decrypt the RMAN backups.</p><pre class="oac_no_warn" dir="ltr">DUPLICATE TARGET DATABASE TO 'dup_db'
          SKIP TABLESPACE example, tools
          PFILE '/ app/db_home2/initdupdb.ora'
          BACKUP LOCATION '/oracle2/rman_backups';</pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-915D2CB7-29AB-46E6-B923-3CF419F59362__GUID-25044B8D-894B-4170-BA75-434378AEC53A">
                           <p class="notep1">See Also:</p>
                           <p><a href="rman-duplicating-databases.html#GUID-EA6E8219-56BF-471C-AC5A-DFC55E760806" title="This section contains examples on duplicating databases by using different duplication techniques.">Examples: Duplicating Databases</a></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-D65799A8-0921-4DFE-B407-21715911DA21" name="GUID-D65799A8-0921-4DFE-B407-21715911DA21"></a><h3 id="BRADV-GUID-D65799A8-0921-4DFE-B407-21715911DA21" class="sect3"><span class="enumeration_section">25.10 </span>Example: Script to Duplicate a Database Using Backup-based Duplication
               </h3>
               <div>
                  <p>This example shows how to use a script to automate the process of duplicating a target database.</p>
                  <div class="section">
                     <div class="p">This example assumes the following:
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>The backups of the target database are available to the auxiliary instance.</p>
                           </li>
                           <li>
                              <p>The connection to the RMAN recovery catalog that contains metadata for the target database is available (connection to the target database is not required).</p>
                           </li>
                           <li>
                              <p>Both source and duplicate database use Oracle Managed Files (OMF).</p>
                           </li>
                           <li>
                              <p>The operating system used is Linux or UNIX.</p>
                           </li>
                           <li>
                              <p>The audit directory is created on the auxiliary database host.</p>
                           </li>
                           <li>
                              <p>The prerequisites for backup-based duplication are met.</p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <div class="p">The script provided in this example performs the following tasks:
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Drops the auxiliary database.</p>
                           </li>
                           <li>
                              <p>Backs up the target database.</p>
                           </li>
                           <li>
                              <p>Creates a dummy auxiliary instance and opens it in <code class="codeph">NOMOUNT</code> mode.
                              </p>
                           </li>
                           <li>
                              <p>Duplicates the target database by using the target database backups and metadata in the RMAN recovery catalog.</p>
                              <p>The duplicate database control file is stored as <code class="codeph">+REDO/</code><span class="italic"><code class="codeph">ORACLE_SID</code></span><code class="codeph">/CONTROLFILE/cf3.ctl</code> and the data files are stored in the <code class="codeph">+DATA</code> directory.
                              </p>
                           </li>
                           <li>
                              <p>Verifies that the required objects are created in the duplicate database.</p>
                           </li>
                        </ul>
                     </div>
                     <p>To duplicate a target database by using backup-based duplication without a target connection:</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>Create a parameter file (pfile) for the auxiliary instance. The pfile contains only the <code class="codeph">DB_NAME</code> initialization parameter, which is set to the SID of the duplicate database.</span><div>
                           <p>The following pfile, called <code class="codeph">init_dup.ora</code> and located in the <code class="codeph">/home/oracle</code> directory, sets the <code class="codeph">DB_NAME</code> parameter. Replace <span class="italic"><code class="codeph">dup_db</code></span> with the SID of your duplicate database:
                           </p><pre class="pre codeblock"><code>*.db_name = '<span class="italic">dup_db</span>'</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Use a text editor and create a Shell script (called <code class="codeph">dup_db.sh</code> in this example) with the contents shown below and with the following modifications:</span><div>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Replace the value of the <code class="codeph">ORACLE_HOME</code> variable with the Oracle home directory of your auxiliary instance.
                                 </p>
                              </li>
                              <li>
                                 <p>Replace the value of the <code class="codeph">logdir</code> variable with the directory in which you want to store log files.
                                 </p>
                              </li>
                              <li>
                                 <p>Replace the following placeholders (shown in Italics) with values appropriate to your duplication scenario: </p>
                                 <p><span class="italic"><code class="codeph">dup_db</code></span>: SID and service name of the auxiliary instance 
                                 </p>
                                 <p><span class="italic"><code class="codeph">tgt_db</code></span>: SID and service name of the target database
                                 </p>
                                 <p><span class="italic"><code class="codeph">sys_pswd</code></span>: Password for the <code class="codeph">SYS</code> user of the target database
                                 </p>
                                 <p><span class="italic"><code class="codeph">rman_cat_user</code></span>: Name of the RMAN catalog user 
                                 </p>
                                 <p><span class="italic"><code class="codeph">cat_user_pswd</code></span>: Password for the RMAN catalog user <span class="italic"><code class="codeph">rman_cat_user</code></span></p>
                                 <p><span class="italic"><code class="codeph">rman_catalog_db</code></span>: SID of the RMAN catalog database
                                 </p>
                                 <p><span class="italic"><code class="codeph">system_pswd</code></span>: Password for the <code class="codeph">SYSTEM</code> user in the target database
                                 </p>
                              </li>
                              <li>
                                 <p>If you want to store the duplicate database control file using a name and location that is different from <code class="codeph">+REDO/</code><span class="italic"><code class="codeph">ORACLE_SID</code></span><code class="codeph">/CONTROLFILE/cf3.ctl</code>, then replace the value of <code class="codeph">control_files</code> in the <code class="codeph">dup_aux_db</code> function with a value that is appropriate for your duplication scenario.
                                 </p>
                              </li>
                              <li>
                                 <p>If you want to store the duplicate data files in a directory that is different from <code class="codeph">+DATA</code>, then replace the value of <code class="codeph">db_create_file_dest</code> in the <code class="codeph">dup_aux_db</code> function with a value that is appropriate for your duplication scenario.
                                 </p>
                              </li>
                           </ul><pre class="pre codeblock"><code>#!/bin/bash
export ORACLE_HOME=/u01/app/oracle/product/11.2.0.4/dbhome_2
export ORACLE_BASE=/uo1/app/oracle
export ORACLE_SID=<span class="italic">dup_db</span>
export PATH=$PATH:$HOME/bin:$ORACLE_HOME/bin:$ORACLE_HOME/Opatch
export LD_LIBRARY_PATH=$ORACLE_HOME/lib:$ORACLE_HOME/rdbms/lib:/lib:/usr/lib;
export LD_LIBRARY_PATH
export logdir=/home/oracle/log
export dt='date +%y%m%d%H%M%S'
export NLS_DATE_FORMAT='DD-MM-YYYY HH24:MI:SS'

function drop_aux_db {
export ORACLE_SID=<span class="italic">dup_db</span>
$ORACLE_HOME/bin/sqlplus -s '/ as sysdba' &lt;&lt;EOF2
set pagesize 999 linesize 999 heading off feedback off
select name, open_mode from v\$database;
shutdown immediate;
startup mount exclusive restrict;
drop database;
exit;
EOF2
}

echo "Backup the target database"
function backup_source_db {
$ORACLE_HOME/bin/rman target sys/<span class="italic">sys_pswd</span>@<span class="italic">tgt_db</span> catalog
<span class="italic">rman_cat_user</span>/<span class="italic">cat_user_pswd</span>@<span class="italic">rman_catalog_db</span> &lt;&lt;EOF
RUN {
backup as backupset cumulative incremental level 1 database include current
controlfile plus archivelog not backed up delete input;}
exit;
EOF
}

sleep 120

echo "List the backup of the target database"
function check_source_db_backup {
$ORACLE_HOME/bin/rman target sys/<span class="italic">sys_pswd</span>@<span class="italic">tgt_db</span> catalog
<span class="italic">rman_cat_user</span>/<span class="italic">cat_user_pswd</span>@<span class="italic">rman_catalog_db</span> &lt;&lt;EOF
LIST BACKUP OF DATABASE COMPLETED AFTER '(SYSDATE-1/24)';
EOF
}

echo "Start the auxiliary database in FORCE NOMOUNT mode"
function nomount_aux_db {
export ORACLE_SID=<span class="italic">dup_db</span>
$ORACLE_HOME/bin/rman target / &lt;&lt;EOF2
startup force nomount pfile='/home/oracle/init_dup.ora';
exit;
EOF2
}

echo "Duplicate the target database"
function dup_aux_db {
export ORACLE_SID=<span class="italic">dup_db</span>
$ORACLE_HOME/bin/rman catalog <span class="italic">rman_cat_user</span>/<span class="italic">cat_user_pswd</span>@<span class="italic">rman_catalog_db</span> AUXILIARY /
&lt;&lt;EOF
duplicate database <span class="italic">tgt_db</span> to <span class="italic">dup_db</span> spfile
set control_files '+REDO/${<span class="italic">ORACLE_SID</span>}/CONTROLFILE/cf3.ctl'
set db_create_file_dest '+DATA/' ;
exit;
EOF
}

echo "Check schema objects on the target"
function check_source_db {
$ORACLE_HOME/bin/sqlplus -s system/<span class="italic">system_pswd</span>@<span class="italic">tgt_db</span> &lt;&lt;EOF2
set pagesize 999 linesize 999 heading off feedback off
select name, open_mode from v\$database;
select table_name, num_rows from dba_tables where owner='SOE';
exit;
EOF2
}

echo "Check schema objects on the auxiliary"
function check_aux_db {
export ORACLE_SID=<span class="italic">dup_db</span>
$ORACLE_HOME/bin/sqlplus -s '/ as sysdba' &lt;&lt;EOF2
set pagesize 999 linesize 999 heading off feedback off
select name, open_mode from v\$database;
select table_name, num_rows from dba_tables where owner='SOE';
exit;
EOF2
}

drop_aux_db
backup_source_db
check_source_db_backup
nomount_aux_db
dup_aux_db
check_source_db
check_aux_db
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Set execute permissions for the script <code class="codeph">dup_db.sh</code> by using the <code class="codeph">chmod</code> command.</span><div><code class="codeph">$ chmod +x dup_db.sh</code></div>
                     </li>
                     <li class="stepexpand"><span>On the duplicate host (that hosts the duplicate database), run the <code class="codeph">dup_db.sh</code> script.</span><div>
                           <p>The following command runs the <code class="codeph">dup_db.sh</code> script that is stored in the <code class="codeph">/home/my_scripts/duplication</code> directory:
                           </p><code class="codeph">$./home/my_scripts/duplication/dup_db.sh</code></div>
                     </li>
                  </ol>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>