<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Backing Up and Archiving Data</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Backup and Recovery User's Guide">
      <meta property="og:description" content>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Backup and Recovery User's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="database-backup-and-recovery-users-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-09T05:20:45-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="2003, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96241-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="using-flasback-database-restore-points.html" title="Previous" type="text/html">
      <link rel="next" href="rman-backup-concepts.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Backup and Recovery User's Guide">
    <meta name="dcterms.isVersionOf" content="BRADV">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="using-flasback-database-restore-points.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="rman-backup-concepts.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Backup and Recovery User's Guide</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Backing Up and Archiving Data</li>
            </ol>
            <a id="GUID-008E0F84-E623-4467-8706-A99B34002DD6" name="GUID-008E0F84-E623-4467-8706-A99B34002DD6"></a><a id="BRADV191"></a>
            
            <h2 id="BRADV-GUID-008E0F84-E623-4467-8706-A99B34002DD6" class="sect2"><span class="enumeration_part">Part III </span>Backing Up and Archiving Data
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>The chapters in this part describe how to use the RMAN utility to perform advanced backup and recovery operations, and explain RMAN performance tuning and troubleshooting. </p>
               <p>This part contains these chapters:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="rman-backup-concepts.html#GUID-B3380142-ABCD-437F-9E06-B219D74E6738" title="Use the RMAN BACKUP command to create both consistent and inconsistent backups.A consistent backup occurs when the database is in a consistent state. You can use the BACKUP command to make consistent backups of the database.Any database backup that is not consistent is an inconsistent backup. A backup made when the database is open is inconsistent, as is a backup made after an instance failure or SHUTDOWN ABORT command.You can create RMAN backups or user-managed backups.When you execute the BACKUP command in RMAN, you create one or more backup sets or image copies. By default, RMAN creates backup sets regardless of whether the destination is disk or a media manager.RMAN can store backup data in a logical structure called a backup set, which is the smallest unit of an RMAN backup.RMAN can use block compression when creating backup sets.When employing unused block compression, RMAN skips reading, and backing up, any database blocks that are not currently allocated to some database object. This is regardless of whether those blocks had previously been allocated.When employing null block compression, RMAN omits from its output any block that has never contained data. RMAN supports binary compression of backup sets. Binary compression is only enabled when you specify AS COMPRESSED BACKUPSET in the BACKUP command, or one-time with the CONFIGURE DEVICE TYPE [DISK | SBT] BACKUP TYPE TO COMPRESSED BACKUPSET command.In backup undo optimization, RMAN excludes undo not needed for recovery of a backup, that is, for transactions that have been committed. RMAN supports backup encryption for backup sets. You can use keystore-based transparent encryption, password-based encryption, or both. You can either let RMAN determine a unique name for backup pieces or use the FORMAT clause to specify a name. By default a backup set contains one backup piece. To restrict the size of each backup piece, specify the MAXPIECESIZE option of the CONFIGURE CHANNEL or ALLOCATE CHANNEL commands. You use the backupSpec clause of the BACKUP command to specify the objects to be backed up. Each backupSpec clause produces at least one backup set.When creating backup sets, RMAN can simultaneously read multiple files from disk and then write their blocks into the same backup set. For example, RMAN can read from two data files simultaneously, and then combine the blocks from these data files into a single backup piece. The combination of blocks from multiple files is called backup multiplexing.During a proxy copy, RMAN turns over control of the data transfer to a media manager that supports this feature. Proxy copy can only be used with media managers that support it and cannot be used with channels of type DISK. The PROXY option of the BACKUP command specifies that a backup is a proxy copy.An image copy is an exact copy of a single data file, archived redo log file, or control file. To create image copies and have them recorded in the RMAN repository, you run the RMAN BACKUP AS COPY command. RMAN can use image copies created by mechanisms outside of RMAN, such as native operating system file copy commands or third-party utilities that leave image copies of files on disk. This type of copy is known as a user-managed backup or operating system backup.You can use the RMAN BACKUP command to back up data blocks from sparse data files, tablespaces containing sparse data files, sparse pluggable databases (PDBs), and multitenant container databases (CDBs) containing sparse PDBs. A preplugin backup is an RMAN backup of a non-CDB or a PDB that was created before the non-CDB or PDB was plugged in to a different CDB.RMAN enables you to make multiple, identical copies of backups.The RMAN BACKUP BACKUPSET command backs up backup sets that were created on disk. The command is a useful way to spread backups among multiple media.Having recent backups of your control file and server parameter file is extremely valuable in many recovery situations. To ensure that you have backups of these files, the database supports control file and server parameter file autobackups. Depending on the configuration of the target database, RMAN can perform autobackups of the control file and server parameter file.The first channel allocated during the backup job creates the autobackup and places it into its own backup set. For autobackups after database structural changes, the server process associated with the structural change makes the backup.An incremental backup copies only those data blocks that have changed since a previous backup. You can use RMAN to create incremental backups of data files, tablespaces, or the whole database.RMAN can create multilevel incremental backups. Each incremental level is denoted by a value of 0 or 1. In a differential level 1 backup, RMAN backs up all blocks that have changed since the most recent incremental backup at level 1 (cumulative or differential) or level 0. In a cumulative level 1 backup, RMAN backs up all blocks used since the most recent level 0 incremental backup in either the current or parent incarnation.The block change tracking feature for incremental backups improves incremental backup performance by recording changed blocks in each data file in a block change tracking file. During media recovery, RMAN examines the restored files to determine whether it can recover them with an incremental backup. If it has a choice, then RMAN always chooses incremental backups over archived redo logs because applying changes at a block level is faster than applying redo.The incremental-forever backup strategy eliminates the need for creating recurring full backups when backing up to Zero Data Loss Recovery Appliance (Recovery Appliance). Although Recovery Appliance supports other RMAN backup strategies, the recommended method for ongoing backups is the incremental-forever backup strategy.You can use the CONFIGURE RETENTION POLICY command to create a persistent and automatic backup retention policy. A recovery window is a period that begins with the current time and extends backward in time to the point of recoverability. The point of recoverability is the earliest time for a hypothetical point-in-time recovery, that is, the earliest point to which you can recover following a media failure.In some cases using a recovery window can complicate disk space planning because the number of backups that must be retained is not constant and depends on the backup schedule. In contrast, a redundancy-based retention policy specifies how many backups of each data file must be retained. You can run the REPORT OBSOLETE command to determine which backups are currently obsolete according to the retention policy. If you configure a fast recovery area, then the database uses an internal algorithm to select files in the fast recovery area that are no longer needed to meet the configured retention policy."> RMAN Backup Concepts</a></p>
                  </li>
                  <li>
                     <p><a href="backing-up-database.html#GUID-93BAB347-063F-439E-BDF3-109AB8D1F8E7" title="RMAN backups are created using the BACKUP command.The primary purpose of RMAN backups is to protect your data. If a media failure or disaster occurs, then you can restore your backups and recover lost changes.You can back up all or part of your database with the BACKUP command from within the RMAN client.You can provide arguments to the BACKUP command to override the default backup options.The BACKUP command takes a DEVICE TYPE clause that specifies whether to back up to disk or tape device.RMAN can create backups on disk as image copies or as backup sets.RMAN provides a range of options to name the files generated by the BACKUP command. When backing up to disk, you can specify a format to spread the backup across several drives for improved performance. RMAN attaches a character string called a tag to every backup it creates, as a way of identifying the backup. You can either accept the default tag or specify your own with the TAG parameter of the BACKUP command.User-specified tags are a useful way to indicate the purpose or usage of different classes of backups or copies. Use the TAG parameter with the BACKUP command to specify tags for backup sets and image copies.When creating backup sets, you can use RMAN support for binary compression of backup sets by including the AS COMPRESSED BACKUPSET option to the BACKUP command.A multisection backup enables large data files to be divided into sections that can be backed up in parallel across multiple channels. This provides faster backup performance and better recovery times.While an image copy is being created, RMAN uses multiple channels to write files sections. However, the output of this operation is one copy for each data file.You can perform a whole database backup with the database mounted or open. You can back up one or more tablespaces with the BACKUP TABLESPACE command or one or more data files with the BACKUP DATAFILE command. You can back up the control file when the database is mounted or open. RMAN uses a snapshot control file to ensure a read-consistent version. A manual backup of the control file is different from a control file autobackup. RMAN makes a control file autobackup after the files specified in the BACKUP command are backed up. To make a manual backup, you can either specify INCLUDE CURRENT CONTROLFILE when backing up other files or specify BACKUP CURRENT CONTROLFILE. RMAN automatically backs up the current server parameter file in certain cases. The BACKUP SPFILE command backs up the parameter file explicitly. The server parameter file that is backed up is the one currently in use by the instance. You can only back up a database in NOARCHIVELOG mode when the database is closed and in a consistent state.Preplugin backups ensure that an RMAN backup is usable after a non-CDB is plugged in as a PDB into a CDB. Use the BACKUP command to back up multitenant container databases (CDBs) and pluggable databases (PDBs).RMAN and Oracle Enterprise Manager Cloud Control provide full support for backup and recovery in a multitenant environment.Backing up a whole multitenant container database (CDB) is similar to backing up a non-CDB. When you back up a whole CDB, RMAN backs up the root, all the pluggable databases (PDBs), and the archived redo logs.You can use RMAN to make a backup of only the root. Because the root contains critical metadata for the whole CDB, Oracle recommends that you back up the root or back up the whole CDB at regular intervals.Oracle Enterprise Manager Cloud Control (Cloud Control) can be used to back up the root.RMAN enables you to back up one or more PDBs in a CDB using the BACKUP command. Preplugin backups of a PDB can be used to perform restore and recover operations after the PDB is migrated and plugged in to a different destination CDB.Oracle Enterprise Manager Cloud Control (Cloud Control) can be used to perform backups of pluggable databases (PDBs).Because tablespaces in different PDBs can have the same name, to eliminate ambiguity you must connect directly to a PDB to back up one or more of its tablespaces.This example creates a preplugin backup of the PDB my_pdb that is contained in CDB cdb_prod. The CDB uses shared undo and is open in read-write mode.RMAN enables you to use the BACKUP command to perform backup operations on the application root, one or more application PDBs, and the application container.RMAN can back up application containers, application PDBs, and the application root.Use the RMAN BACKUP command to back up the application root.Use the BACKUP command to back up an application container, which consists of the application root and all the application PDBs that belong to the application root.The BACKUP command is used to back up one or more application PDBs. Use the BACKUP command to back up sparse databases.RMAN enables you to back up a sparse database, using steps similar to backing up a whole database, in the backup set or image copy format.You can back up one or more tablespaces containing sparse data files or individual sparse data files using the BACKUP command. RMAN enables you to back up one or more sparse PDBs in a CDB. Archived redo logs are the key to successful media recovery. You should back them up regularly.Several features of RMAN backups are specific to archived redo logs. For example, you can use BACKUP ... DELETE to delete one or all copies of archived redo logs from disk after backing them up to backup sets. Even if your redo logs are being archived to multiple destinations and you use RMAN to back up archived redo logs, RMAN selects only one copy of the archived redo log file to include in the backup set. Because logs with the same log sequence number are identical, RMAN does not need to include more than one log copy.Automatic online redo log switching is an important RMAN feature. In a CDB, archived redo logs can be backed up only when you connect to the root as a common user with the SYSDBA or SYSBACKUP privilege. To back up archived logs, use the BACKUP ARCHIVELOG command.You can indicate that RMAN should automatically skip backups of archived redo logs.You can back up archived redo logs in a multitenant container database (CDB) by using the BACKUP ARCHIVELOG command.The BACKUP ARCHIVELOG ... DELETE INPUT command deletes archived log files after they are backed up. This command eliminates the separate step of manually deleting archived redo logs. In a CDB, you can delete archived redo logs after they are backed up by using the BACKUP ARCHIVELOG ... DELETE INPUT command.An incremental backup copies only data file blocks that have changed since a specified previous backup. Use the BACKUP command to create incremental backups.RMAN incremental backups provide multiple benefits.Choose a backup strategy according to an acceptable MTTR (mean time to recover). You can use the Volume Shadow Copy Service (VSS) with the Oracle VSS writer to make a shadow copy or snapshot of files in a database.By incrementally updating backups, you can avoid the overhead of making full image copy backups of data files, while also minimizing time required for media recovery of your database. For example, if you run a daily backup script, then you never have more than 1 day of redo to apply for media recovery.To create incremental backups for use in an incrementally updated backup strategy, use the BACKUP ... FOR RECOVER OF COPY WITH TAG form of the BACKUP command. The command is best understood in a sample script that implements the strategy.The block change tracking feature for incremental backups improves backup performance by recording changed blocks for each data file.If block change tracking is enabled on a primary or standby database, then RMAN uses a block change tracking file to identify changed blocks for incremental backups. By reading this small bitmap file to determine which blocks changed, RMAN avoids having to scan every block in the data file that it is backing up.Oracle Database automatically manages space in the change tracking file to retain block change data that covers the eight most recent backups. After the maximum of eight bitmaps is reached, the oldest bitmap is overwritten by the bitmap that tracks the current changes.By default, the block change tracking file is created as an Oracle managed file in the destination specified by the DB_CREATE_FILE_DEST initialization parameter. You can also place the block change tracking file in any location that you choose, by specifying its name when enabling block change tracking. The size of the block change tracking file is proportional to the size of the database and the number of enabled threads of redo. You can enable block change tracking when the database is either open or mounted. When you disable block change tracking, the database removes the block change tracking file from the operating system.You can query the V$BLOCK_CHANGE_TRACKING view to determine whether change tracking is enabled, and if it is, the file name of the block change tracking file.To move the change tracking file, use the ALTER DATABASE RENAME FILE statement. You can use BACKUP... KEEP to create a backup that is both all-inclusive and exempt from the backup retention policy.You can exempt a backup from the retention policy by using the KEEP option with the BACKUP command. Typically, you make an archival backup to tape. Because your data protection backups are most likely to be on a set of tapes that remain accessible and are recycled, it is advisable to reserve a set of tapes for the archival backup. Use the BACKUP command with the KEEP option to make archival backups.One purpose of an archival backup is to create a test database. You can use the BACKUP BACKUPSET command to back up backup sets produced by other backup jobs. You can also use BACKUP RECOVERY AREA to back up recovery files created in the current and all previous fast recovery area destinations. The BACKUP BACKUPSET command creates additional copies of backup pieces in a backup set, but does not create a new backup set. For a backup retention policy based on redundancy, a backup set is counted as one instance of a backup. This statement is true even if there are multiple copies of the backup pieces that form the backup set, such as when a backup set has been backed up from disk to tape.Use the BACKUP BACKUPSET command to copy backup sets from disk to tape. Use the BACKUP command to back up image copies to tape."> Backing Up the Database</a></p>
                  </li>
                  <li>
                     <p><a href="backing-up-database-advanced.html#GUID-A4FABEF4-677C-42ED-9DF8-3731ADA12E5F" title="You can use the CONFIGURE command to create persistent settings that govern backup set size.The MAXSETSIZE parameter of the BACKUP command specifies a maximum size for a backup set in units of bytes (default), kilobytes, megabytes, or gigabytes. Backup piece size is an issue in those situations where it exceeds the maximum file size of the file system or media management software. Use the MAXSETSIZE parameter of the CONFIGURE CHANNEL or ALLOCATE CHANNEL command to limit the size of backup pieces.If you specify the SECTION SIZE parameter on the BACKUP command, then RMAN creates a backup set in which each backup piece contains the blocks from one file section. You run the CONFIGURE BACKUP OPTIMIZATION command to enable backup optimization. When certain criteria are met, RMAN skips backups of files that are identical to files that are already backed up.In Oracle Secure Backup, a media family is a named group of volumes with a set of shared, user-defined attributes. In this scenario, you back up logs that are not on tape to one media family, then back up the same logs to a second media family. Finally, you delete old logs.By default, the BACKUP command terminates when it cannot access a data file.RMAN can make up to four copies of a backup set simultaneously, each an exact duplicate of the others.The CONFIGURE...BACKUP COPIES command specifies the number of identical backup sets to create on the specified device type. The COPIES option of the BACKUP command overrides every other COPIES or DUPLEX setting to control duplexing of backup sets.Many sites keep a backup of the database stored on disk in case a media failure occurs on the primary database or an incorrect user action requires point-in-time recovery. A data file backup on disk simplifies the restore step of recovery, making recovery much quicker and more reliable.You can protect RMAN backup sets with backup encryption. Encrypted backups cannot be read if they are obtained by unauthorized users. Backup encryption is performed based on the specified encryption settings.You can set an encryption password in an RMAN session by executing the SET ENCRYPTION BY PASSWORD command. If transparent encryption is configured, then specify the ONLY keyword to indicate that the backups are protected with a password and not with the configured transparent encryption.Use the SET ENCRYPTION BY PASSWORD command at the RMAN prompt to make password-protected backups. If transparent encryption is configured, then omit the ONLY keyword to indicate that the backups are protected with both a password and the configured transparent encryption.With the restartable backup feature, RMAN backs up only those files that were not backed up after a specified date.The minimum unit of restartability is a data file. However, if a backup set contains one backup piece, and if this piece contains blocks from multiple data files, then the unit of restartability is the backup piece. The unit of restartability for image copies is a data file.Use the SINCE TIME parameter of the BACKUP command to specify a date after which a new backup is required.A backup window is a period of time during which a backup must complete. For example, you may want to restrict your database backups to a window of time when user activity on your system is low, such as between 2:00 a.m. and 6:00 a.m.Use the DURATION parameter of the BACKUP command to specify how long a given backup job is allowed to run.When you specify PARTIAL, RMAN does not report an error when a backup is interrupted because of the end of the backup window. Instead, RMAN displays a message showing which files are not backed up.When using DURATION you can run the backup with the maximum possible performance, or run as slowly as possible while still finishing within the allotted time, to minimize the performance impact of backup tasks."> Backing Up the Database: Advanced Topics</a></p>
                  </li>
               </ul>
            </div>
         </div>
      </article>
   </body>
</html>