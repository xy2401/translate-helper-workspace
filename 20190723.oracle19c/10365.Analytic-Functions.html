<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Analytic Functions</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="SQL Language Reference ">
      <meta property="og:description" content="">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="SQL Language Reference">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="sql-language-reference.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-02-12T15:36:36-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96310-02">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="Aggregate-Functions.html" title="Previous" type="text/html">
      <link rel="next" href="Object-Reference-Functions.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="SQL Language Reference">
    <meta name="dcterms.isVersionOf" content="SQLRF">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="Aggregate-Functions.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="Object-Reference-Functions.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">SQL Language Reference </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="Functions.html" property="item" typeof="WebPage"><span property="name">Functions</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Analytic Functions </li>
            </ol>
            <a id="GUID-527832F7-63C0-4445-8C16-307FA5084056" name="GUID-527832F7-63C0-4445-8C16-307FA5084056"></a><a id="SQLRF51188"></a><a id="SQLRF51189"></a><a id="SQLRF51190"></a><a id="SQLRF51191"></a><a id="SQLRF51192"></a><a id="SQLRF51193"></a><a id="SQLRF51194"></a><a id="SQLRF51195"></a><a id="SQLRF51196"></a><a id="SQLRF51197"></a><a id="SQLRF51198"></a><a id="SQLRF51199"></a><a id="SQLRF51200"></a><a id="SQLRF51201"></a><a id="SQLRF51202"></a><a id="SQLRF51203"></a><a id="SQLRF51204"></a><a id="SQLRF51205"></a><a id="SQLRF51206"></a><a id="SQLRF51207"></a><a id="SQLRF51208"></a><a id="SQLRF06174"></a>
            
            <h2 id="SQLRF-GUID-527832F7-63C0-4445-8C16-307FA5084056" class="sect2">Analytic Functions </h2>
         </header>
         <div class="ind">
            <div>
               <div class="section">
                  <p>Analytic functions compute an aggregate value based on a group of rows. They differ from aggregate functions in that they return multiple rows for each group. The group of rows is called a <span class="bold">window</span> and is defined by the <span class="italic"><code class="codeph">analytic_clause</code></span>. For each row, a sliding window of rows is defined. The window determines the range of rows used to perform the calculations for the current row. Window sizes can be based on either a physical number of rows or a logical interval such as time.
                  </p>
                  <p>Analytic functions are the last set of operations performed in a query except for the final <code class="codeph">ORDER</code> <code class="codeph">BY</code> clause. All joins and all <code class="codeph">WHERE</code>, <code class="codeph">GROUP</code> <code class="codeph">BY</code>, and <code class="codeph">HAVING</code> clauses are completed before the analytic functions are processed. Therefore, analytic functions can appear only in the select list or <code class="codeph">ORDER</code> <code class="codeph">BY</code> clause.
                  </p>
                  <p>Analytic functions are commonly used to compute cumulative, moving, centered, and reporting aggregates.</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__GUID-5410729B-24A9-46AB-B167-FA955FE7AA78"><span class="italic">analytic_function</span>::=
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <div class="figure" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__GUID-A7FA5EBC-A064-4E06-980E-E1BF43EE789C"><img src="img/analytic_function.gif" alt="Description of analytic_function.eps follows" title="Description of analytic_function.eps follows" longdesc="img_text/analytic_function.html"><br><a href="img_text/analytic_function.html">Description of the illustration analytic_function.eps</a></div>
                  <!-- class="figure" -->
               </div>
               <!-- class="section" -->
               <div class="section" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__CJAFAAIA">
                  <p class="subhead1" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__GUID-3F25B519-351E-4D07-94F5-E18B2721D5E9"><span class="italic">analytic_clause</span>::=
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <div class="figure" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__GUID-169A99F4-FB9B-4CCE-AB08-AC0BABEFEA1B"><img src="img/analytic_clause.gif" alt="Description of analytic_clause.eps follows" title="Description of analytic_clause.eps follows" longdesc="img_text/analytic_clause.html"><br><a href="img_text/analytic_clause.html">Description of the illustration analytic_clause.eps</a></div>
                  <!-- class="figure" -->
               </div>
               <!-- class="section" -->
               <div class="section" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__QUERY_PARTITION_CLAUSE-1E92A25F">
                  <p class="subhead1" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__GUID-241EDB65-4F86-45A9-A617-12D6CB46FB7C"><span class="italic">query_partition_clause</span>::=
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <div class="figure" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__GUID-28D3CEE9-919D-4035-843F-305450D713B6"><img src="img/query_partition_clause.gif" alt="Description of query_partition_clause.eps follows" title="Description of query_partition_clause.eps follows" longdesc="img_text/query_partition_clause.html"><br><a href="img_text/query_partition_clause.html">Description of the illustration query_partition_clause.eps</a></div>
                  <!-- class="figure" -->
               </div>
               <!-- class="section" -->
               <div class="section" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__ORDER_BY_CLAUSE-1E92A06C">
                  <p class="subhead1" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__GUID-4302F725-99B8-4965-AE54-A0F98EA567A3"><span class="italic">order_by_clause</span>::=
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <div class="figure" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__GUID-BD08C7BC-34C3-4648-8CAD-FE856FF5AA4D"><img src="img/order_by_clause.gif" alt="Description of order_by_clause.eps follows" title="Description of order_by_clause.eps follows" longdesc="img_text/order_by_clause.html"><br><a href="img_text/order_by_clause.html">Description of the illustration order_by_clause.eps</a></div>
                  <!-- class="figure" -->
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__GUID-915AA1E2-65CE-4FCD-9DF7-5D6D1DA98AFD"><span class="italic">windowing_clause</span>::=
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <div class="figure" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__GUID-41247A27-6EE2-43F8-B3BD-9A6CC31A1BB3"><img src="img/windowing_clause.gif" alt="Description of windowing_clause.eps follows" title="Description of windowing_clause.eps follows" longdesc="img_text/windowing_clause.html"><br><a href="img_text/windowing_clause.html">Description of the illustration windowing_clause.eps</a></div>
                  <!-- class="figure" -->
                  <p>The semantics of this syntax are discussed in the sections that follow.</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__GUID-BB48E078-CA5C-4367-AB3B-DFB42CF579CF"><span class="italic">analytic_function </span></p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p>Specify the name of an analytic function (see the listing of analytic functions following this discussion of semantics). </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__GUID-8B5BA781-30F6-4EE4-AA1A-253E64BC0005"><span class="italic">arguments</span></p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p>Analytic functions take 0 to 3 arguments. The arguments can be any numeric data type or any nonnumeric data type that can be implicitly converted to a numeric data type. Oracle determines the argument with the highest numeric precedence and implicitly converts the remaining arguments to that data type. The return type is also that data type, unless otherwise noted for an individual function.</p>
                  <div class="infoboxnotealso" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__GUID-2A54E27C-EA48-4A5C-AA93-AEFF49564F1D">
                     <p class="notep1">See Also:</p>
                     <p><a href="Data-Types.html#GUID-4C0B65DB-E751-4957-A1ED-5044BAFA7812">Numeric Precedence</a> for information on numeric precedence and <a href="Data-Type-Comparison-Rules.html#GUID-98BE3A78-6E33-4181-B5CB-D96FD9DC1694__G195937" title="This matrix lists the data types in the first column and in the header cell for each subsequent column. An X in a cell indicates implicit conversion of the data types named in the header of that column and column 1 of that row.">Table 2-8</a> for more information on implicit conversion
                     </p>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__GUID-90CD9193-D3E3-4B5E-8285-39D7265BA2E7"><span class="italic">analytic_clause</span></p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p>Use <code class="codeph">OVER</code> <span class="italic"><code class="codeph">analytic_clause</code></span> to indicate that the function operates on a query result set. This clause is computed after the <code class="codeph">FROM</code>, <code class="codeph">WHERE</code>, <code class="codeph">GROUP</code> <code class="codeph">BY</code>, and <code class="codeph">HAVING</code> clauses. You can specify analytic functions with this clause in the select list or <code class="codeph">ORDER</code> <code class="codeph">BY</code> clause. To filter the results of a query based on an analytic function, nest these functions within the parent query, and then filter the results of the nested subquery.
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__GUID-1F3F07C6-24A5-4AE5-8D7E-D4C2DDA3DF9A">Notes on the <span class="italic">analytic_clause</span>:
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p>The following notes apply to the <span class="italic"><code class="codeph">analytic_clause</code></span>:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>You cannot nest analytic functions by specifying any analytic function in any part of the <span class="italic"><code class="codeph">analytic_clause</code></span>. However, you can specify an analytic function in a subquery and compute another analytic function over it. 
                        </p>
                     </li>
                     <li>
                        <p>You can specify <code class="codeph">OVER</code> <span class="italic"><code class="codeph">analytic_clause</code></span> with user-defined analytic functions as well as built-in analytic functions. See <a href="CREATE-FUNCTION.html#GUID-156AEDAC-ADD0-4E46-AA56-6D1F7CA63306">CREATE FUNCTION</a>.
                        </p>
                     </li>
                     <li>
                        <p>The <code class="codeph">PARTITION</code> <code class="codeph">BY</code> and <code class="codeph">ORDER</code> <code class="codeph">BY</code> clauses in the <span class="italic"><code class="codeph">analytic_clause</code></span> are collation-sensitive.
                        </p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__GUID-2F371504-238A-46C2-89A5-FEB5E9F992EF">
                     <p class="notep1">See Also:</p>
                     <p>Appendix C in <a href="../nlspg/appendix-C-collation-derivation-and-determination-rules-for-SQL-operations.html#NLSPG-GUID-AFCE41ED-775B-4A00-AF38-C436776AE0C5" target="_blank"><span><cite>Oracle Database Globalization Support Guide</cite></span></a> for the collation determination rules for the <code class="codeph">OVER</code> <code class="codeph">(PARTITION</code> <code class="codeph">BY</code> ... <code class="codeph">ORDER</code> <code class="codeph">BY</code> ... <code class="codeph">)</code> clause of an analytic function
                     </p>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__GUID-146F6EDF-E8B5-4007-9DCD-A7FEF9F4DDCF"><span class="italic">query_partition_clause</span></p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p>Use the <code class="codeph">PARTITION</code> <code class="codeph">BY</code> clause to partition the query result set into groups based on one or more <span class="italic"><code class="codeph">value_expr</code></span>. If you omit this clause, then the function treats all rows of the query result set as a single group.
                  </p>
                  <p>To use the <span class="italic"><code class="codeph">query_partition_clause</code></span> in an analytic function, use the upper branch of the syntax (without parentheses). To use this clause in a model query (in the <span class="italic"><code class="codeph">model_column_clauses</code></span>) or a partitioned outer join (in the <span class="italic"><code class="codeph">outer_join_clause</code></span>), use the lower branch of the syntax (with parentheses).
                  </p>
                  <p>You can specify multiple analytic functions in the same query, each with the same or different <code class="codeph">PARTITION</code> <code class="codeph">BY</code> keys.
                  </p>
                  <p>If the objects being queried have the parallel attribute, and if you specify an analytic function with the <span class="italic"><code class="codeph">query_partition_clause</code></span>, then the function computations are parallelized as well.
                  </p>
                  <p>Valid values of <span class="italic"><code class="codeph">value_expr</code></span> are constants, columns, nonanalytic functions, function expressions, or expressions involving any of these.
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__GUID-666C34CD-99A1-4974-A898-AD1ACD8CA42E"><span class="italic">order_by_clause</span></p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p>Use the <span class="italic"><code class="codeph">order_by_clause</code></span> to specify how data is ordered within a partition. For all analytic functions you can order the values in a partition on multiple keys, each defined by a <span class="italic"><code class="codeph">value_expr</code></span> and each qualified by an ordering sequence.
                  </p>
                  <p>Within each function, you can specify multiple ordering expressions. Doing so is especially useful when using functions that rank values, because the second expression can resolve ties between identical values for the first expression.</p>
                  <p>Whenever the <span class="italic"><code class="codeph">order_by_clause</code></span> results in identical values for multiple rows, the function behaves as follows:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><code class="codeph">CUME_DIST</code>, <code class="codeph">DENSE_RANK</code>, <code class="codeph">NTILE</code>, <code class="codeph">PERCENT_RANK</code>, and <code class="codeph">RANK</code> return the same result for each of the rows.
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">ROW_NUMBER</code> assigns each row a distinct value even if there is a tie based on the <span class="italic"><code class="codeph">order_by_clause</code></span>. The value is based on the order in which the row is processed, which may be nondeterministic if the <code class="codeph">ORDER</code> <code class="codeph">BY</code> does not guarantee a total ordering.
                        </p>
                     </li>
                     <li>
                        <p>For all other analytic functions, the result depends on the window specification. If you specify a logical window with the <code class="codeph">RANGE</code> keyword, then the function returns the same result for each of the rows. If you specify a physical window with the <code class="codeph">ROWS</code> keyword, then the result is nondeterministic.
                        </p>
                     </li>
                  </ul>
               </div>
               <!-- class="section" -->
               <div class="section" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__CIHCEIGA">
                  <p class="subhead1" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__GUID-576D5FDA-98DC-4ECF-A068-1FEACEC5E032">Restrictions on the ORDER BY Clause</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p>The following restrictions apply to the <code class="codeph">ORDER</code> <code class="codeph">BY</code> clause:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>When used in an analytic function, the <span class="italic"><code class="codeph">order_by_clause</code></span> must take an expression (<span class="italic"><code class="codeph">expr</code></span>). The <code class="codeph">SIBLINGS</code> keyword is not valid (it is relevant only in hierarchical queries). Position (<span class="italic"><code class="codeph">position</code></span>) and column aliases (<span class="italic"><code class="codeph">c_alias</code></span>) are also invalid. Otherwise this <span class="italic"><code class="codeph">order_by_clause</code></span> is the same as that used to order the overall query or subquery.
                        </p>
                     </li>
                     <li>
                        <p>An analytic function that uses the <code class="codeph">RANGE</code> keyword can use multiple sort keys in its <code class="codeph">ORDER</code> <code class="codeph">BY</code> clause if it specifies any of the following windows:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">RANGE</code> <code class="codeph">BETWEEN</code> <code class="codeph">UNBOUNDED</code> <code class="codeph">PRECEDING</code> <code class="codeph">AND</code> <code class="codeph">CURRENT</code> <code class="codeph">ROW</code>.  The short form of this is <code class="codeph">RANGE</code> <code class="codeph">UNBOUNDED</code> <code class="codeph">PRECEDING</code>.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">RANGE</code> <code class="codeph">BETWEEN</code> <code class="codeph">CURRENT</code> <code class="codeph">ROW</code> <code class="codeph">AND</code> <code class="codeph">UNBOUNDED</code> <code class="codeph">FOLLOWING</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">RANGE</code> <code class="codeph">BETWEEN</code> <code class="codeph">CURRENT</code> <code class="codeph">ROW</code> <code class="codeph">AND</code> <code class="codeph">CURRENT</code> <code class="codeph">ROW</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">RANGE</code> <code class="codeph">BETWEEN</code> <code class="codeph">UNBOUNDED</code> <code class="codeph">PRECEDING</code> <code class="codeph">AND</code> <code class="codeph">UNBOUNDED</code> <code class="codeph">FOLLOWING</code></p>
                           </li>
                        </ul>
                        <p>Window boundaries other than these four can have only one sort key in the <code class="codeph">ORDER</code> <code class="codeph">BY</code> clause of the analytic function. This restriction does not apply to window boundaries specified by the <code class="codeph">ROW</code> keyword.
                        </p>
                     </li>
                  </ul>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__GUID-71C83C7C-EF27-449A-9A15-D8B766DF7839">ASC | DESC</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p>Specify the ordering sequence (ascending or descending). <code class="codeph">ASC</code> is the default.
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__GUID-77FE7FDB-3AD3-4271-963D-5B6326747B66">NULLS FIRST | NULLS LAST</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p>Specify whether returned rows containing nulls should appear first or last in the ordering sequence. </p>
                  <p><code class="codeph">NULLS</code> <code class="codeph">LAST</code> is the default for ascending order, and <code class="codeph">NULLS</code> <code class="codeph">FIRST</code> is the default for descending order.
                  </p>
                  <p>Analytic functions always operate on rows in the order specified in the <span class="italic"><code class="codeph">order_by_clause</code></span> of the function. However, the <span class="italic"><code class="codeph">order_by_clause</code></span> of the function does not guarantee the order of the result. Use the <span class="italic"><code class="codeph">order_by_clause</code></span> of the query to guarantee the final result ordering.
                  </p>
                  <div class="infoboxnotealso" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__GUID-7E6E6A07-320C-45C7-B5E0-4199B163571B">
                     <p class="notep1">See Also:</p>
                     <p><span class="italic"><a href="SELECT.html#GUID-CFA006CA-6FF1-4972-821E-6996142A51C6__I2171079">order_by_clause</a></span> of <a href="SELECT.html#GUID-CFA006CA-6FF1-4972-821E-6996142A51C6">SELECT</a>  for more information on this clause
                     </p>
                  </div>
               </div>
               <!-- class="section" -->
               <div class="section" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__I97640">
                  <p class="subhead1" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__GUID-ACD92224-03AE-420F-8D2A-75DBAF46A52F"><span class="italic">windowing_clause</span><span class="bold"> </span></p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p>Some analytic functions allow the <span class="italic"><code class="codeph">windowing_clause</code></span>. In the listing of analytic functions at the end of this section, the functions that allow the <span class="italic"><code class="codeph">windowing_clause</code></span> are followed by an asterisk (*).
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__GUID-11156F7B-A9E7-440E-8623-1A4DC0333CAC">ROWS | RANGE</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p>These keywords define for each row a window (a physical or logical set of rows) used for calculating the function result. The function is then applied to all the rows in the window. The window moves through the query result set or partition from top to bottom.</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><code class="codeph">ROWS</code> specifies the window in physical units (rows).
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">RANGE</code> specifies the window as a logical offset. 
                        </p>
                     </li>
                  </ul>
                  <p>You cannot specify this clause unless you have specified the <span class="italic"><code class="codeph">order_by_clause</code></span>. Some window boundaries defined by the <code class="codeph">RANGE</code> clause let you specify only one expression in the <span class="italic"><code class="codeph">order_by_clause</code></span>. Refer to <a href="Analytic-Functions.html#GUID-527832F7-63C0-4445-8C16-307FA5084056__CIHCEIGA">Restrictions on the ORDER BY Clause</a>.
                  </p>
                  <p>The value returned by an analytic function with a logical offset is always deterministic. However, the value returned by an analytic function with a physical offset may produce nondeterministic results unless the ordering expression results in a unique ordering. You may have to specify multiple columns in the <span class="italic"><code class="codeph">order_by_clause</code></span> to achieve this unique ordering.
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__GUID-C08BA9CF-6BCD-4D31-A1EA-DCEF7172A499">BETWEEN ... AND</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p>Use the <code class="codeph">BETWEEN</code> ... <code class="codeph">AND</code> clause to specify a start point and end point for the window. The first expression (before <code class="codeph">AND</code>) defines the start point and the second expression (after <code class="codeph">AND</code>) defines the end point. 
                  </p>
                  <p>If you omit <code class="codeph">BETWEEN</code> and specify only one end point, then Oracle considers it the start point, and the end point defaults to the current row.
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__GUID-80CD3F98-47D8-4DC5-B1B1-B2289FB1DC57">UNBOUNDED PRECEDING</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p>Specify <code class="codeph">UNBOUNDED</code> <code class="codeph">PRECEDING</code> to indicate that the window starts at the first row of the partition. This is the start point specification and cannot be used as an end point specification.
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__GUID-FCCD244F-C7E3-4D43-8AEA-D1008C796566">UNBOUNDED FOLLOWING</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p>Specify <code class="codeph">UNBOUNDED</code> <code class="codeph">FOLLOWING</code> to indicate that the window ends at the last row of the partition. This is the end point specification and cannot be used as a start point specification.
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__GUID-FC87DB5A-558F-4736-A446-BC06FA412B3E">CURRENT ROW</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p>As a start point, <code class="codeph">CURRENT</code> <code class="codeph">ROW</code> specifies that the window begins at the current row or value (depending on whether you have specified <code class="codeph">ROW</code> or <code class="codeph">RANGE</code>, respectively). In this case the end point cannot be <span class="italic"><code class="codeph">value_expr</code></span> <code class="codeph">PRECEDING</code>.
                  </p>
                  <p>As an end point, <code class="codeph">CURRENT</code> <code class="codeph">ROW</code> specifies that the window ends at the current row or value (depending on whether you have specified <code class="codeph">ROW</code> or <code class="codeph">RANGE</code>, respectively). In this case the start point cannot be <span class="italic"><code class="codeph">value_expr</code></span> <code class="codeph">FOLLOWING</code>.
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__GUID-0A0B25DD-63EC-4C45-A2E5-01123E3E2AFA"><span class="italic">value_expr</span> PRECEDING or <span class="italic">value_expr</span> FOLLOWING
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p>For <code class="codeph">RANGE</code> or <code class="codeph">ROW</code>:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>If <span class="italic"><code class="codeph">value_expr</code></span> <code class="codeph">FOLLOWING</code> is the start point, then the end point must be <span class="italic"><code class="codeph">value_expr</code></span> <code class="codeph">FOLLOWING</code>.
                        </p>
                     </li>
                     <li>
                        <p>If <span class="italic"><code class="codeph">value_expr</code></span> <code class="codeph">PRECEDING</code> is the end point, then the start point must be <span class="italic"><code class="codeph">value_expr</code></span> <code class="codeph">PRECEDING</code>.
                        </p>
                     </li>
                  </ul>
                  <p>If you are defining a logical window defined by an interval of time in numeric format, then you may need to use conversion functions. </p>
                  <div class="infoboxnotealso" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__GUID-3232B9F6-52FD-4A5A-90D5-97FD0402F8CD">
                     <p class="notep1">See Also:</p>
                     <p><a href="NUMTOYMINTERVAL.html#GUID-B98B21AA-44F7-4A9D-A646-6775A1D5F46D">NUMTOYMINTERVAL</a> and <a href="NUMTODSINTERVAL.html#GUID-5A7392A8-7976-4465-8839-A65EFF1A80B6">NUMTODSINTERVAL</a> for information on converting numeric times into intervals
                     </p>
                  </div>
                  <p>If you specified <code class="codeph">ROWS</code>:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><span class="italic"><code class="codeph">value_expr</code></span> is a physical offset. It must be a constant or expression and must evaluate to a positive numeric value.
                        </p>
                     </li>
                     <li>
                        <p>If <span class="italic"><code class="codeph">value_expr</code></span> is part of the start point, then it must evaluate to a row before the end point.
                        </p>
                     </li>
                  </ul>
                  <p>If you specified <code class="codeph">RANGE</code>: 
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><span class="italic"><code class="codeph">value_expr</code></span> is a logical offset. It must be a constant or expression that evaluates to a positive numeric value or an interval literal. Refer to <a href="Literals.html#GUID-192417E8-A79D-4A1D-9879-68272D925707">Literals</a> for information on interval literals.
                        </p>
                     </li>
                     <li>
                        <p>You can specify only one expression in the <span class="italic"><code class="codeph">order_by_clause</code></span>.
                        </p>
                     </li>
                     <li>
                        <p>If <span class="italic"><code class="codeph">value_expr</code></span> evaluates to a numeric value, then the <code class="codeph">ORDER</code> <code class="codeph">BY</code> <span class="italic"><code class="codeph">expr</code></span> must be a numeric or <code class="codeph">DATE</code> data type.
                        </p>
                     </li>
                     <li>
                        <p>If <span class="italic"><code class="codeph">value_expr</code></span> evaluates to an interval value, then the <code class="codeph">ORDER</code> <code class="codeph">BY</code> <span class="italic"><code class="codeph">expr</code></span> must be a <code class="codeph">DATE</code> data type.
                        </p>
                     </li>
                  </ul>
                  <p>If you omit the <span class="italic"><code class="codeph">windowing_clause</code></span> entirely, then the default is <code class="codeph">RANGE</code> <code class="codeph">BETWEEN</code> <code class="codeph">UNBOUNDED</code> <code class="codeph">PRECEDING</code> <code class="codeph">AND</code> <code class="codeph">CURRENT</code> <code class="codeph">ROW</code>.
                  </p>
                  <p>Analytic functions are commonly used in data warehousing environments. In the list of analytic functions that follows, functions followed by an asterisk (*) allow the full syntax, including the <span class="italic"><code class="codeph">windowing_clause</code></span>.
                  </p>
                  <ul class="simple" style="list-style-type: none;padding-left:0;">
                     <li><a href="AVG.html#GUID-B64BCBF1-DAA0-4D88-9821-2C4D3FDE5E4A">AVG</a> *
                     </li>
                     <li><a href="CLUSTER_DETAILS.html#GUID-6E47A5A7-B73A-4D79-BAA5-BB7E3C173D0F">CLUSTER_DETAILS</a></li>
                     <li><a href="CLUSTER_DISTANCE.html#GUID-21E611E3-2F15-4DF1-B648-9A36E8D5CE4D">CLUSTER_DISTANCE</a></li>
                     <li><a href="CLUSTER_ID.html#GUID-1B0D0954-5A57-409C-9E84-F3EE12712040">CLUSTER_ID</a></li>
                     <li><a href="CLUSTER_PROBABILITY.html#GUID-999A15BA-FEDD-4FA6-8F1B-C847C2FE51CD">CLUSTER_PROBABILITY</a></li>
                     <li><a href="CLUSTER_SET.html#GUID-7B44CB7A-4783-4FE0-80D8-26AE88D6B060">CLUSTER_SET</a></li>
                     <li><a href="CORR.html#GUID-E73AF5E2-38A4-436A-955C-5122C079F49C">CORR</a> *
                     </li>
                     <li><a href="COUNT.html#GUID-AEF08B79-024D-4E3A-B362-9715FB011776">COUNT</a> *
                     </li>
                     <li><a href="COVAR_POP.html#GUID-D728D05F-D2E3-405C-986F-088B8353553A">COVAR_POP</a> *
                     </li>
                     <li><a href="COVAR_SAMP.html#GUID-7850B9E1-83A4-41CB-8F17-DCD2E2A70C95">COVAR_SAMP</a> *
                     </li>
                     <li><a href="CUME_DIST.html#GUID-B12C577C-A63C-4D19-8E18-FCCBBFBF8278">CUME_DIST</a></li>
                     <li><a href="DENSE_RANK.html#GUID-BB66F574-09DF-4594-87A4-ABD83E8DC3FE">DENSE_RANK</a></li>
                     <li><a href="FEATURE_DETAILS.html#GUID-A42F313B-22C1-4CAC-BA3F-C418178D743F">FEATURE_DETAILS</a></li>
                     <li><a href="FEATURE_ID.html#GUID-BA187F80-5F51-49F6-BB69-64422FB9FD90">FEATURE_ID</a></li>
                     <li><a href="FEATURE_SET.html#GUID-55582346-F1D6-447E-851A-D4912982EB28">FEATURE_SET</a></li>
                     <li><a href="FEATURE_VALUE.html#GUID-EC0E44D0-BE01-49F8-9E5A-72B500119877">FEATURE_VALUE</a></li>
                     <li><a href="FIRST.html#GUID-85AB9246-0E0A-44A1-A7E6-4E57502E9238">FIRST</a></li>
                     <li><a href="FIRST_VALUE.html#GUID-D454EC3F-370C-4C64-9B11-33FCB10D95EC">FIRST_VALUE</a> *
                     </li>
                     <li><a href="LAG.html#GUID-68081CD0-72BE-4C0A-AA6B-AD39FFA7BCF2">LAG</a></li>
                     <li><a href="LAST.html#GUID-4E16BC0E-D3B8-4BA4-8F97-3A08891A85CC">LAST</a></li>
                     <li><a href="LAST_VALUE.html#GUID-A646AF95-C8E9-4A67-87BA-87B11AEE7B79">LAST_VALUE</a> *
                     </li>
                     <li><a href="LEAD.html#GUID-0A0481F1-E98F-4535-A739-FCCA8D1B5B77">LEAD</a></li>
                     <li><a href="LISTAGG.html#GUID-B6E50D8E-F467-425B-9436-F7F8BF38D466">LISTAGG</a></li>
                     <li><a href="MAX.html#GUID-E5372020-A6DA-44BF-93BE-DA8C3F74CD01">MAX</a> *
                     </li>
                     <li><a href="MIN.html#GUID-F7F04E18-1AD8-4D15-9491-4622AD847A74">MIN</a> *
                     </li>
                     <li><a href="NTH_VALUE.html#GUID-F8A0E88C-67E5-4AA6-9515-95D03A7F9EA0">NTH_VALUE</a> *
                     </li>
                     <li><a href="NTILE.html#GUID-FAD7A986-AEBD-4A03-B0D2-F7F2148BA5E9">NTILE</a></li>
                     <li><a href="PERCENT_RANK.html#GUID-66A868F5-9EBA-482A-BF8C-09300B9EE165">PERCENT_RANK</a></li>
                     <li><a href="PERCENTILE_CONT.html#GUID-CA259452-A565-41B3-A4F4-DD74B66CEDE0">PERCENTILE_CONT</a></li>
                     <li><a href="PERCENTILE_DISC.html#GUID-7C34FDDA-C241-474F-8C5C-50CC0182E005">PERCENTILE_DISC</a></li>
                     <li><a href="PREDICTION.html#GUID-DA66A1C3-BFB2-43A1-A3FF-93D4A3DAB9C6">PREDICTION</a></li>
                     <li><a href="PREDICTION_COST.html#GUID-2E58222D-FB7E-4CA2-BCAA-C932FCDEE890">PREDICTION_COST</a></li>
                     <li><a href="PREDICTION_DETAILS.html#GUID-D7261A56-E729-4882-B48D-CDD343C53810">PREDICTION_DETAILS</a></li>
                     <li><a href="PREDICTION_PROBABILITY.html#GUID-0F309771-40A3-4E23-9A96-CD134C80F584">PREDICTION_PROBABILITY</a></li>
                     <li><a href="PREDICTION_SET.html#GUID-25AE84A7-C733-4BC5-8C57-2E5574C49AFC">PREDICTION_SET</a></li>
                     <li><a href="RANK.html#GUID-0950BD34-C994-41DA-A8F9-34B3FE53BBBA">RANK</a></li>
                     <li><a href="RATIO_TO_REPORT.html#GUID-9D10C275-4341-435F-ACF4-767B9CCB7390">RATIO_TO_REPORT</a></li>
                     <li><a href="REGR_-Linear-Regression-Functions.html#GUID-A675B68F-2A88-4843-BE2C-FCDE9C65F9A9">REGR_ (Linear Regression) Functions</a> *
                     </li>
                     <li><a href="ROW_NUMBER.html#GUID-D5A157F8-0F53-45BD-BF8C-AE79B1DB8C41">ROW_NUMBER</a></li>
                     <li><a href="STDDEV.html#GUID-CA0C3B1F-1A4C-4CFB-ADAB-D90216C4E099">STDDEV</a> *
                     </li>
                     <li><a href="STDDEV_POP.html#GUID-4F804DE5-7E20-4E08-A1BA-32DBB167B34B">STDDEV_POP</a> *
                     </li>
                     <li><a href="STDDEV_SAMP.html#GUID-7B2A708E-E73A-4CFE-978E-3F9C4BD37467">STDDEV_SAMP</a> *
                     </li>
                     <li><a href="SUM.html#GUID-5610BE2C-CFE5-446F-A1F7-B924B5663220">SUM</a> *
                     </li>
                     <li><a href="VAR_POP.html#GUID-B62FB4A4-BD1F-47B0-B412-31A98B70C2E4">VAR_POP</a> *
                     </li>
                     <li><a href="VAR_SAMP.html#GUID-314D5831-0E26-4ABF-9F46-35F78F97DA52">VAR_SAMP</a> *
                     </li>
                     <li><a href="VARIANCE.html#GUID-EC33717A-2509-402D-B3BB-7EECB2E4ED8B">VARIANCE</a> *
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-527832F7-63C0-4445-8C16-307FA5084056__GUID-B3924FAE-EC0F-4781-A733-7BDE13A6B8AF">
                     <p class="notep1">See Also:</p>
                     <p><a href="../dwhsg/index.html" target="_blank"><span><cite>Oracle Database Data Warehousing Guide</cite></span></a> for more information on these functions and for scenarios illustrating their use
                     </p>
                  </div>
               </div>
               <!-- class="section" -->
            </div>
         </div>
      </article>
   </body>
</html>