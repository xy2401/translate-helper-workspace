<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Creating Metadata and Analytic Workspaces</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Java API Developer's Guide ">
      <meta property="og:description" content>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Java API Developer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="olap-java-api-developers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-10T13:53:39-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="2000, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96402-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="discovering-metadata.html" title="Previous" type="text/html">
      <link rel="next" href="understanding-source-objects.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="OLAP Java API Developer's Guide">
    <meta name="dcterms.isVersionOf" content="OLAAP">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="discovering-metadata.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="understanding-source-objects.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Java API Developer's Guide </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem"> Creating Metadata and Analytic Workspaces</li>
            </ol>
            <a id="GUID-67674127-304F-4F8A-BCA1-410C8CB4797E" name="GUID-67674127-304F-4F8A-BCA1-410C8CB4797E"></a><a id="OLAAP220"></a>
            
            <h2 id="OLAAP-GUID-67674127-304F-4F8A-BCA1-410C8CB4797E" class="sect2"><span class="enumeration_chapter">4 </span> Creating Metadata and Analytic Workspaces
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>This chapter describes how to create new metadata objects and map them to relational structures or expressions. It describes how to export and import the definitions of the metadata objects to XML templates. It also describes how to associate the objects with an analytic workspace, and how to build the analytic workspace.</p>
               <p>The examples in this chapter are from the <code class="codeph">CreateMetadataAndAW.java</code> example program. That program creates some of the same metadata objects as the <code class="codeph">CreateAndBuildAW.java</code> and <code class="codeph">SpecifyAWValues.java</code> example programs. The <code class="codeph">CreateMetadataAndAW</code> program also exports the analytic workspace to an XML template.
               </p>
               <p>This chapter includes the following topics:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="creating-metadata-and-analytic-workspaces.html#GUID-2A726D0C-2B7F-4E15-B594-348487D1BF28">Overview of Creating and Mapping Metadata</a></p>
                  </li>
                  <li>
                     <p><a href="creating-metadata-and-analytic-workspaces.html#GUID-8AD05B73-FBF3-4D2F-99F7-02E406BAEA0D">Creating an Analytic Workspace</a></p>
                  </li>
                  <li>
                     <p><a href="creating-metadata-and-analytic-workspaces.html#GUID-83B7A4E9-430A-4B7D-8A18-10D6175FAE10">Creating the Dimensions, Levels, and Hierarchies </a></p>
                  </li>
                  <li>
                     <p><a href="creating-metadata-and-analytic-workspaces.html#GUID-EA1BAC07-B64E-45CB-B0E9-74A2E2EE9FD3">Creating Attributes</a></p>
                  </li>
                  <li>
                     <p><a href="creating-metadata-and-analytic-workspaces.html#GUID-3C6A8328-2BB6-43B7-86FB-2513B31DAABD">Creating Cubes and Measures</a></p>
                  </li>
                  <li>
                     <p><a href="creating-metadata-and-analytic-workspaces.html#GUID-E79729DC-35F2-4A1F-975A-6DB9F91D7361">Committing Transactions</a></p>
                  </li>
                  <li>
                     <p><a href="creating-metadata-and-analytic-workspaces.html#GUID-767D2EF6-AAC5-47DA-91A8-9D48AD90A279">Exporting and Importing XML Templates</a></p>
                  </li>
                  <li>
                     <p><a href="creating-metadata-and-analytic-workspaces.html#GUID-FBBE0DE5-B703-4CBD-9A1B-845AEFE5E640">Building an Analytic Workspace</a></p>
                  </li>
               </ul>
            </div><a id="OLAAP221"></a><div class="props_rev_3"><a id="GUID-2A726D0C-2B7F-4E15-B594-348487D1BF28" name="GUID-2A726D0C-2B7F-4E15-B594-348487D1BF28"></a><h3 id="OLAAP-GUID-2A726D0C-2B7F-4E15-B594-348487D1BF28" class="sect3"><span class="enumeration_section">4.1 </span>Overview of Creating and Mapping Metadata
               </h3>
               <div>
                  <p><a id="d11910e126" class="indexterm-anchor"></a><a id="d11910e130" class="indexterm-anchor"></a>The OLAP Java API provides the ability to create persistent metadata objects. The top-level metadata objects exist in the data dictionary of the Oracle Database instance. The API also provides the ability to create transient metadata objects that exist only for the duration of the session. An application can use both types of metadata objects to create queries that retrieve or otherwise use the data in the data store.
                  </p>
                  <p>Before an OLAP Java API application can create metadata objects, a database administrator must have prepared the Oracle Database instance. The DBA must have set up permanent and temporary tablespaces in the database to support the creation of Oracle OLAP metadata objects and must have granted the privileges that allow the user of the session to create and manage objects. A dimensional metadata model typically includes the objects described in <a href="understanding-olap-java-api-metadata.html#GUID-8E4F4EC0-8EF8-4D2A-BBAE-6010021A6D1A" title="With an MdmDescription object, you can associate descriptive information with an MdmObject object.The relational schema owned by a database user is represented by an MdmDatabaseSchema object.">Understanding OLAP Java API Metadata</a>.
                  </p>
                  <p>You implement the dimensional model by creating OLAP Java API metadata objects. You use classes in the <code class="codeph">oracle.olapi.metadata.mapping</code> package to map the metadata objects to relational source objects and to build analytic workspaces. You use classes in the <code class="codeph">oracle.olapi.syntax</code> package to specify <code class="codeph">Expression</code> objects that you use in mapping the metadata. You use classes in the <code class="codeph">oracle.olapi.metadata.deployment</code> package to deploy the metadata objects in an analytic workspace or in a relational database (ROLAP) organization.
                  </p>
                  <p>The basic steps for implementing the dimensional model as OLAP Java API objects in an analytic workspace are the following:</p>
                  <ol>
                     <li>
                        <p>Create an <code class="codeph">AW</code> object and <code class="codeph">MdmPrimaryDimension</code> and <code class="codeph">MdmCube</code> objects.
                        </p>
                     </li>
                     <li>
                        <p>Deploy the <code class="codeph">MdmPrimaryDimension</code> and <code class="codeph">MdmCube</code> objects to the <code class="codeph">		AW</code>.
                        </p>
                     </li>
                     <li>
                        <p>Create <code class="codeph">MdmDimensionLevel</code>, <code class="codeph">MdmHierarchy</code>, and <code class="codeph">MdmAttribute</code> objects for each <code class="codeph">MdmPrimaryDimension</code>, create <code class="codeph">MdmHierarchyLevel</code> objects to associate <code class="codeph">MdmDimensionLevel</code> objects with an <code class="codeph">MdmHierarchy</code>, and create the <code class="codeph">MdmMeasure</code> and related objects for the <code class="codeph">MdmCube</code> objects.
                        </p>
                     </li>
                     <li>
                        <p>Map the metadata objects to the relational sources of the base data.</p>
                     </li>
                     <li>
                        <p>Commit the <code class="codeph">Transaction</code>, which creates persistent objects in the database.
                        </p>
                     </li>
                     <li>
                        <p>Load data into the objects from the relational sources by building the analytic workspace.</p>
                     </li>
                  </ol>
                  <p>For a list of the topics that describe these steps, see <a href="creating-metadata-and-analytic-workspaces.html#GUID-67674127-304F-4F8A-BCA1-410C8CB4797E"> Creating Metadata and Analytic Workspaces</a>.
                  </p>
               </div>
            </div><a id="OLAAP223"></a><a id="OLAAP222"></a><div class="props_rev_3"><a id="GUID-8AD05B73-FBF3-4D2F-99F7-02E406BAEA0D" name="GUID-8AD05B73-FBF3-4D2F-99F7-02E406BAEA0D"></a><h3 id="OLAAP-GUID-8AD05B73-FBF3-4D2F-99F7-02E406BAEA0D" class="sect3"><span class="enumeration_section">4.2 </span>Creating an Analytic Workspace
               </h3>
               <div>
                  <div class="section">
                     <p><a id="d11910e281" class="indexterm-anchor"></a><a id="d11910e285" class="indexterm-anchor"></a><a id="d11910e289" class="indexterm-anchor"></a>An analytic workspace is a container for dimensional objects. It is represented by the <code class="codeph">AW</code> class in the <code class="codeph">oracle.olapi.metadata.deployment</code> package. An analytic workspace is owned by an <code class="codeph">MdmDatabaseSchema</code>.
                     </p>
                     <p><a id="d11910e304" class="indexterm-anchor"></a><a id="d11910e308" class="indexterm-anchor"></a><a href="creating-metadata-and-analytic-workspaces.html#GUID-8AD05B73-FBF3-4D2F-99F7-02E406BAEA0D__BABGHIJF">Example 4-1</a> demonstrates getting the <code class="codeph">MdmDatabaseSchema</code> for the GLOBAL user and creating an <code class="codeph">AW</code>. For an example that gets the <code class="codeph">MdmRootSchema</code>, see <a href="discovering-metadata.html#GUID-0F34DAE9-AD90-4107-A14D-4DA29A13A369"> Discovering Metadata</a>.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-8AD05B73-FBF3-4D2F-99F7-02E406BAEA0D__BABGHIJF">
                     <p class="titleinexample">Example 4-1 Creating an AW</p><pre class="oac_no_warn" dir="ltr">private void createAW(MdmRootSchema mdmRootSchema)
{
  MdmDatabaseSchema mdmDBSchema = mdmRootSchema.getDatabaseSchema("GLOBAL");
  aw = mdmDBSchema.findOrCreateAW("GLOBAL_AWJ");
}</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="OLAAP224"></a><div class="props_rev_3"><a id="GUID-83B7A4E9-430A-4B7D-8A18-10D6175FAE10" name="GUID-83B7A4E9-430A-4B7D-8A18-10D6175FAE10"></a><h3 id="OLAAP-GUID-83B7A4E9-430A-4B7D-8A18-10D6175FAE10" class="sect3"><span class="enumeration_section">4.3 </span>Creating the Dimensions, Levels, and Hierarchies 
               </h3>
               <div>
                  <p><a id="d11910e368" class="indexterm-anchor"></a><a id="d11910e372" class="indexterm-anchor"></a><a id="d11910e376" class="indexterm-anchor"></a><a id="d11910e380" class="indexterm-anchor"></a>A dimension is a list of unique values that identify and categorize data. Dimensions form the edges of a cube and identify the values in the measures of the cube. A dimension can have one or more levels that categorize the dimension members. It can have one or more hierarchies that further categorize the members. A dimension can also have no levels or hierarchies. However, a dimension must have one or more levels before Oracle OLAP can create a materialized view for it.
                  </p>
                  <p>A dimension also has attributes that contain information about dimension members. For descriptions of creating attributes, see <span class="q">"<a href="creating-metadata-and-analytic-workspaces.html#GUID-EA1BAC07-B64E-45CB-B0E9-74A2E2EE9FD3">Creating Attributes</a>"</span>.
                  </p>
                  <p>The following topics describe how to create objects that represent a dimension and the levels and hierarchies of a dimension.</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="creating-metadata-and-analytic-workspaces.html#GUID-AFF38664-59EF-47FC-A503-FCFB689510C1">Creating and Mapping Dimensions</a></p>
                     </li>
                     <li>
                        <p><a href="creating-metadata-and-analytic-workspaces.html#GUID-36EF8BE6-12A1-4ED8-B664-57C8C2DB08F0">Creating and Mapping Dimension Levels</a></p>
                     </li>
                     <li>
                        <p><a href="creating-metadata-and-analytic-workspaces.html#GUID-962D8275-96D9-493D-8398-6691EBBEDB23">Creating and Mapping Hierarchies</a></p>
                     </li>
                  </ul>
               </div><a id="OLAAP226"></a><a id="OLAAP225"></a><div class="props_rev_3"><a id="GUID-AFF38664-59EF-47FC-A503-FCFB689510C1" name="GUID-AFF38664-59EF-47FC-A503-FCFB689510C1"></a><h4 id="OLAAP-GUID-AFF38664-59EF-47FC-A503-FCFB689510C1" class="sect4"><span class="enumeration_section">4.3.1 </span>Creating and Mapping Dimensions
                  </h4>
                  <div>
                     <div class="section">
                        <p><a id="d11910e448" class="indexterm-anchor"></a><a id="d11910e452" class="indexterm-anchor"></a><a id="d11910e456" class="indexterm-anchor"></a><a id="d11910e460" class="indexterm-anchor"></a>An OLAP dimension is represented by the <code class="codeph">MdmPrimaryDimension</code> class. A dimension is owned by an <code class="codeph">MdmDatabaseSchema</code>. You create a dimension with the <code class="codeph">findOrCreateTimeDimension</code> or the <code class="codeph">findOrCreateStandardDimension</code> method of the <code class="codeph">MdmDatabaseSchema</code>. You can map a dimension that has no levels to a relational data source by creating a <code class="codeph">MemberListMap</code> for the dimension.
                        </p>
                        <p><a id="d11910e485" class="indexterm-anchor"></a><a id="d11910e489" class="indexterm-anchor"></a><a href="creating-metadata-and-analytic-workspaces.html#GUID-AFF38664-59EF-47FC-A503-FCFB689510C1__BABEACAJ">Example 4-2</a> creates a standard dimension that has the name CHANNEL_AWJ. The example creates an <code class="codeph">AWPrimaryDimensionOrganization</code> object to deploy the dimension in an analytic workspace. The <code class="codeph">mdmDBSchema</code> and <code class="codeph">aw</code> objects are created by <a href="creating-metadata-and-analytic-workspaces.html#GUID-8AD05B73-FBF3-4D2F-99F7-02E406BAEA0D__BABGHIJF">Example 4-1</a>. The last three lines call the methods of <a href="creating-metadata-and-analytic-workspaces.html#GUID-36EF8BE6-12A1-4ED8-B664-57C8C2DB08F0__BABDJEDC">Example 4-3</a>, <a href="creating-metadata-and-analytic-workspaces.html#GUID-EFF7B8CF-44A2-464D-905B-4AD086345A81__BABHDHDG">Example 4-4</a>, and <a href="creating-metadata-and-analytic-workspaces.html#GUID-E79729DC-35F2-4A1F-975A-6DB9F91D7361__BABDCDHH">Example 4-9</a>, respectively.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-AFF38664-59EF-47FC-A503-FCFB689510C1__BABEACAJ">
                        <p class="titleinexample">Example 4-2 Creating and Deploying an MdmStandardDimension</p><pre class="oac_no_warn" dir="ltr">MdmStandardDimension mdmChanDim =
  mdmDBSchema.findOrCreateStandardDimension("CHANNEL_AWJ");
AWPrimaryDimensionOrganization awChanDimOrg = 
  mdmChanDim.findOrCreateAWPrimaryDimensionOrganization(aw);

createAndMapDimensionLevels(mdmChanDim);
createAndMapHierarchies();
commit(mdmChanDim);</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="OLAAP228"></a><a id="OLAAP227"></a><div class="props_rev_3"><a id="GUID-36EF8BE6-12A1-4ED8-B664-57C8C2DB08F0" name="GUID-36EF8BE6-12A1-4ED8-B664-57C8C2DB08F0"></a><h4 id="OLAAP-GUID-36EF8BE6-12A1-4ED8-B664-57C8C2DB08F0" class="sect4"><span class="enumeration_section">4.3.2 </span>Creating and Mapping Dimension Levels
                  </h4>
                  <div>
                     <div class="section">
                        <p><a id="d11910e556" class="indexterm-anchor"></a><a id="d11910e560" class="indexterm-anchor"></a><a id="d11910e564" class="indexterm-anchor"></a><a id="d11910e568" class="indexterm-anchor"></a><a id="d11910e572" class="indexterm-anchor"></a><a id="d11910e576" class="indexterm-anchor"></a><a id="d11910e580" class="indexterm-anchor"></a>An <code class="codeph">MdmDimensionLevel</code> represents the members of a dimension that are at the same level. Typically, the members of a level are in a column in a dimension table in the relational source. A <code class="codeph">MemberListMap</code> associates the <code class="codeph">MdmDimensionLevel</code> with the relational source.
                        </p>
                        <p><a id="d11910e596" class="indexterm-anchor"></a><a id="d11910e600" class="indexterm-anchor"></a><a id="d11910e604" class="indexterm-anchor"></a><a id="d11910e608" class="indexterm-anchor"></a><a id="d11910e612" class="indexterm-anchor"></a><a id="d11910e616" class="indexterm-anchor"></a><a id="d11910e620" class="indexterm-anchor"></a><a id="d11910e624" class="indexterm-anchor"></a><a id="d11910e628" class="indexterm-anchor"></a><a href="creating-metadata-and-analytic-workspaces.html#GUID-36EF8BE6-12A1-4ED8-B664-57C8C2DB08F0__BABDJEDC">Example 4-3</a> creates two <code class="codeph">MdmDimensionLevel</code> objects for the CHANNEL_AWJ dimension and maps the dimension levels to the key columns of the GLOBAL.CHANNEL_DIM table. The example also maps the long description attributes for the dimension levels to columns of that table. The long description attribute, <code class="codeph">chanLongDescAttr</code>, is created by <a href="creating-metadata-and-analytic-workspaces.html#GUID-EA1BAC07-B64E-45CB-B0E9-74A2E2EE9FD3__BABEHBJF">Example 4-6</a>.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-36EF8BE6-12A1-4ED8-B664-57C8C2DB08F0__BABDJEDC">
                        <p class="titleinexample">Example 4-3 Creating and Mapping an MdmDimensionLevel</p><pre class="oac_no_warn" dir="ltr">private ArrayList&lt;MdmDimensionLevel&gt; dimLevelList = new ArrayList();
private ArrayList&lt;String&gt; dimLevelNames = new ArrayList();
private ArrayList&lt;String&gt; keyColumns = new ArrayList();
private ArrayList&lt;String&gt; lDescColNames = new ArrayList();

private void createAndMapDimensionLevels(MdmPrimaryDimension mdmChanDim)
{
  dimLevelNames.add("TOTAL_CHANNEL");
  dimLevelNames.add("CHANNEL");

  keyColumns.add("GLOBAL.CHANNEL_DIM.TOTAL_ID");
  keyColumns.add("GLOBAL.CHANNEL_DIM.CHANNEL_ID");

  lDescColNames.add("GLOBAL.CHANNEL_DIM.TOTAL_DSC");
  lDescColNames.add("GLOBAL.CHANNEL_DIM.CHANNEL_DSC");

  // Create the MdmDimensionLevel and MemberListMap objects.
  int i = 0;
  for(String dimLevelName : dimLevelNames)
  {
<a id="d11910e648" class="indexterm-anchor"></a>    MdmDimensionLevel mdmDimLevel = 
      mdmChanDim.findOrCreateDimensionLevel(dimLevelNames.get(i));
    dimLevelList.add(mdmDimLevel);

    // Create a MemberListMap for the dimension level.
    MemberListMap mdmDimLevelMemListMap = 
      mdmDimLevel.findOrCreateMemberListMap();
    ColumnExpression keyColExp = 
      (ColumnExpression)SyntaxObject.fromSyntax(keyColumns.get(i),
                                                metadataProvider);
    mdmDimLevelMemListMap.setKeyExpression(keyColExp);
    mdmDimLevelMemListMap.setQuery(keyColExp.getQuery());

    // Create an attribute map for the Long Description attribute.
<a id="d11910e653" class="indexterm-anchor"></a>    AttributeMap attrMapLong = 
      mdmDimLevelMemListMap.findOrCreateAttributeMap(chanLongDescAttr);

    // Create an expression for the attribute map.
    Expression lDescColExp = 
      (Expression)SyntaxObject.fromSyntax(lDescColNames.get(i),
                                          metadataProvider);
    attrMapLong.setExpression(lDescColExp);
    i++;
  }
}</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="OLAAP229"></a><div class="props_rev_3"><a id="GUID-962D8275-96D9-493D-8398-6691EBBEDB23" name="GUID-962D8275-96D9-493D-8398-6691EBBEDB23"></a><h4 id="OLAAP-GUID-962D8275-96D9-493D-8398-6691EBBEDB23" class="sect4"><span class="enumeration_section">4.3.3 </span>Creating and Mapping Hierarchies
                  </h4>
                  <div>
                     <p><a id="d11910e694" class="indexterm-anchor"></a><a id="d11910e698" class="indexterm-anchor"></a><a id="d11910e702" class="indexterm-anchor"></a><a id="d11910e706" class="indexterm-anchor"></a><a id="d11910e710" class="indexterm-anchor"></a><a id="d11910e714" class="indexterm-anchor"></a><a id="d11910e718" class="indexterm-anchor"></a>An <code class="codeph">MdmHierarchy</code> represents a hierarchy in the dimensional object model. An <code class="codeph">MdmHierarchy</code> can be an instance of the <code class="codeph">MdmLevelHierarchy</code> or the <code class="codeph">MdmValueHierarchy</code> class. An <code class="codeph">MdmLevelHierarchy</code> has an ordered list of <code class="codeph">MdmHierarchyLevel</code> objects that relate <code class="codeph">MdmDimensionLevel</code> objects to the hierarchy.
                     </p>
                  </div><a id="OLAAP231"></a><a id="OLAAP230"></a><div class="props_rev_3"><a id="GUID-EFF7B8CF-44A2-464D-905B-4AD086345A81" name="GUID-EFF7B8CF-44A2-464D-905B-4AD086345A81"></a><h5 id="OLAAP-GUID-EFF7B8CF-44A2-464D-905B-4AD086345A81" class="sect5"><span class="enumeration_section">4.3.3.1 </span>Creating and Mapping an MdmLevelHierarchy
                     </h5>
                     <div>
                        <div class="section">
                           <p><a href="creating-metadata-and-analytic-workspaces.html#GUID-EFF7B8CF-44A2-464D-905B-4AD086345A81__BABHDHDG">Example 4-4</a> creates a hierarchy for the CHANNEL_AWJ dimension. It creates hierarchy levels for the hierarchy and associates attributes with the hierarchy levels. It also maps the hierarchy levels and the attributes to relational sources. The example uses the <code class="codeph">ArrayList</code> objects from <a href="creating-metadata-and-analytic-workspaces.html#GUID-36EF8BE6-12A1-4ED8-B664-57C8C2DB08F0__BABDJEDC">Example 4-3</a>. It maps the <code class="codeph">MdmHierarchyLevel</code> objects to the same relational source objects as the <code class="codeph">MdmDimensionLevel</code> objects are mapped.
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-EFF7B8CF-44A2-464D-905B-4AD086345A81__BABHDHDG">
                           <p class="titleinexample">Example 4-4 Creating and Mapping MdmLevelHierarchy and MdmHierarchyLevel Objects</p><pre class="oac_no_warn" dir="ltr">private void createAndMapHierarchies()
{
  MdmLevelHierarchy mdmLevelHier =
    mdmChanDim.findOrCreateLevelHierarchy("CHANNEL_PRIMARY");

  // Create the MdmHierarchyLevel and HierarchyLevelMap objects.
  int i = 0;
  for(String dimLevelName : dimLevelNames)
  {
    MdmDimensionLevel mdmDimLevel = 
      mdmChanDim.findOrCreateDimensionLevel(dimLevelName);
    MdmHierarchyLevel mdmHierLevel = 
<a id="d11910e801" class="indexterm-anchor"></a>      mdmLevelHier.findOrCreateHierarchyLevel(mdmDimLevel);
    HierarchyLevelMap hierLevelMap =
      mdmHierLevel.findOrCreateHierarchyLevelMap();
    ColumnExpression keyColExp = 
      (ColumnExpression)SyntaxObject.fromSyntax(keyColumns.get(i),
                                                metadataProvider);
    hierLevelMap.setKeyExpression(keyColExp);
    hierLevelMap.setQuery(keyColExp.getQuery());
    i++;
  }
}</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div><a id="OLAAP233"></a><a id="OLAAP232"></a><div class="props_rev_3"><a id="GUID-9F97D203-9DDC-4726-83E7-F22F41C00538" name="GUID-9F97D203-9DDC-4726-83E7-F22F41C00538"></a><h5 id="OLAAP-GUID-9F97D203-9DDC-4726-83E7-F22F41C00538" class="sect5"><span class="enumeration_section">4.3.3.2 </span>Creating and Mapping an MdmValueHierarchy
                     </h5>
                     <div>
                        <div class="section">
                           <p><a id="d11910e844" class="indexterm-anchor"></a>The GLOBAL_AWJ analytic workspace that is used by the examples in this documentation does not have an <code class="codeph">MdmPrimaryDimension</code> for which an <code class="codeph">MdmValueHierarchy</code> would be sensible. The sample schema for the user <code class="codeph">SCOTT</code> has a table that can serve as an example.
                           </p>
                           <p>The SCOTT sample schema has a table named EMP. That table has columns for employees and for managers. You could create a dimension for employees. You could then create an <code class="codeph">MdmValueHierarchy</code> in which you map the employee column as the base values for the hierarchy and you map the manager column as the parent relation, as shown in <a href="creating-metadata-and-analytic-workspaces.html#GUID-9F97D203-9DDC-4726-83E7-F22F41C00538__BABDCIBA">Example 4-5</a>. To be able to create OLAP dimensions, the SCOTT user must be granted the <code class="codeph">OLAP_USER</code> role and the <code class="codeph">CREATE SESSION</code> privilege.
                           </p>
                           <p><a id="d11910e872" class="indexterm-anchor"></a>In the example, <code class="codeph">mdmDBSchema</code> is the <code class="codeph">MdmDatabaseSchema</code> for the SCOTT user, <code class="codeph">dp</code> is the <code class="codeph">DataProvider</code>, and <code class="codeph">mp</code> is the <code class="codeph">MdmMetadataProvider</code>. The example does not show the code for connecting to the database or getting the <code class="codeph">DataProvider</code> and creating a <code class="codeph">UserSession</code>, or getting the <code class="codeph">MdmMetadataProvider</code>, the <code class="codeph">MdmRootSchema</code>, or the <code class="codeph">MdmDatabaseSchema</code>. The code is an excerpt from a class that extends the <code class="codeph">BaseExample11g</code> example class. That class uses other example classes that have methods for committing the current <code class="codeph">Transaction</code> and for displaying output. For the complete code, see the <code class="codeph">CreateValueHierarchy.java</code> example program.
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="example" id="GUID-9F97D203-9DDC-4726-83E7-F22F41C00538__BABDCIBA">
                           <p class="titleinexample">Example 4-5 Creating an MdmValueHierarchy</p><pre class="oac_no_warn" dir="ltr">// Create an analytic workspace object.
AW aw = mdmDBSchema.findOrCreateAW(awName);
// Create a dimension and deploy it to the analytic workspace.
MdmPrimaryDimension mdmEmpDim =
  mdmDBSchema.findOrCreateStandardDimension("EMP_DIM");
AWPrimaryDimensionOrganization awEmpDimOrg =
  mdmEmpDim.findOrCreateAWPrimaryDimensionOrganization(aw);

// Get the EMP table and the Query for the table.
MdmTable empTable = (MdmTable)mdmDBSchema.getTopLevelObject("EMP");
Query empQuery = empTable.getQuery();

// Create a value hierarchy. 
MdmValueHierarchy mdmValHier =
 mdmEmpDim.findOrCreateValueHierarchy("EMPVALHIER");
// Create a map for the hierarchy.
SolvedValueHierarchyMap solvedValHierMap =
 mdmValHier.findOrCreateSolvedValueHierarchyMap();
// Specify the Query, the key expression and the parent key expression for
// the hierarchy.
solvedValHierMap.setQuery(empQuery);
Expression keyExp =
 (Expression)SyntaxObject.fromSyntax("SCOTT.EMP.EMPNO", mp);
solvedValHierMap.setKeyExpression(keyExp);
Expression parentExp =
 (Expression)SyntaxObject.fromSyntax("SCOTT.EMP.MGR", mp);
solvedValHierMap.setParentKeyExpression(parentExp);

// Create an attribute that relates a name to each dimension member.
MdmBaseAttribute mdmNameAttr = 
 mdmEmpDim.findOrCreateBaseAttribute("EMP_NAME");
SQLDataType sdtVC2 = new SQLDataType("VARCHAR2");
mdmNameAttr.setSQLDataType(sdtVC2)
// Create an attribute map for the attribute.
AttributeMap attrMap =
 solvedValHierMap.findOrCreateAttributeMap(mdmNameAttr);
// Create and set an expression for the attribute map.
Expression exp = (Expression)
  SyntaxObject.fromSyntax("SCOTT.EMP.ENAME", mp);
attrMap.setExpression(exp);
mdmValHier.addAttribute(mdmNameAttr);
 
// Commit the Transaction before building the analytic workspace.
// The getContext method of BaseExample11g returns a Context11g object,
// which has a method that commits the Transaction.
getContext().commit();
BuildItem bldEmpDim = new BuildItem(mdmEmpDim);
ArrayList&lt;BuildItem&gt; items = new ArrayList();
items.add(bldEmpDim);
BuildProcess bldProc = new BuildProcess(items);
 
// Execute the build.
try
{
 dp.executeBuild(bldProc, 0);
}
catch (Exception ex)
{
 println("Could not execute the BuildProcess.");
 println("Caught: " + ex);
}

//Get the Source objects for the dimension, the hierarchy, and the attribute.
Source empDim = mdmEmpDim.getSource();
Source valHier = mdmValHier.getSource();
Source empNameAttr = mdmNameAttr.getSource();
// Get the parent attribute and get the Source for it.
MdmAttribute mdmParentAttr = mdmEmpDim.getParentAttribute();
Source parentAttr = mdmParentAttr.getSource();

Source parentByEmpByName = parentAttr.join(valHier.join(empNameAttr));
// Sort the values in ascending order by employee number of the managers.
Source sortedParentByEmpByName = parentByEmpByName.sortAscending();

// Commit the Transaction before creating a Cursor.
getContext().commit();
// The displayResult method of the Context11g object creates a Cursor and 
// displays the results.
println("The managers of the employees are:");
getContext().displayResult(sortedParentByEmpByName);
</pre><p>The output of the example is the following. It shows the employee name, the employee ID and then the employee ID of the manager. The results are sorted by manager. The employee King does not have a parent and is the highest member of the hierarchy so the manager value for King is null, which appears as <code class="codeph">NA</code> in the output.
                           </p><pre class="oac_no_warn" dir="ltr">The managers of the employees are:
1: ((SCOTT,EMPVALHIER::7788),EMPVALHIER::7566)
2: ((FORD,EMPVALHIER::7902),EMPVALHIER::7566)
3: ((ALLEN,EMPVALHIER::7499),EMPVALHIER::7698)
4: ((WARD,EMPVALHIER::7521),EMPVALHIER::7698)
5: ((MARTIN,EMPVALHIER::7654),EMPVALHIER::7698)
6: ((TURNER,EMPVALHIER::7844),EMPVALHIER::7698)
7: ((JAMES,EMPVALHIER::7900),EMPVALHIER::7698)
8: ((MILLER,EMPVALHIER::7934),EMPVALHIER::7782)
9: ((ADAMS,EMPVALHIER::7876),EMPVALHIER::7788)
10: ((JONES,EMPVALHIER::7566),EMPVALHIER::7839)
11: ((BLAKE,EMPVALHIER::7698),EMPVALHIER::7839)
12: ((CLARK,EMPVALHIER::7782),EMPVALHIER::7839)
13: ((SMITH,EMPVALHIER::7369),EMPVALHIER::7902)
14: ((KING,EMPVALHIER::7839),NA)</pre></div>
                        <!-- class="example" -->
                     </div>
                  </div>
               </div>
            </div><a id="OLAAP235"></a><a id="OLAAP234"></a><div class="props_rev_3"><a id="GUID-EA1BAC07-B64E-45CB-B0E9-74A2E2EE9FD3" name="GUID-EA1BAC07-B64E-45CB-B0E9-74A2E2EE9FD3"></a><h3 id="OLAAP-GUID-EA1BAC07-B64E-45CB-B0E9-74A2E2EE9FD3" class="sect3"><span class="enumeration_section">4.4 </span>Creating Attributes
               </h3>
               <div>
                  <div class="section">
                     <p>Attributes contain information about dimension members. An <code class="codeph">MdmBaseAttribute</code> represents values that are based on relational source tables. An <code class="codeph">MdmDerivedAttribute</code> represents values that Oracle OLAP derives from characteristics or relationships of the dimension members. For example, the <code class="codeph">getParentAttribute</code> method of an <code class="codeph">MdmPrimaryDimension</code> returns an <code class="codeph">MdmDerivedAttribute</code> that records the parent of each dimension member.
                     </p>
                     <p><a id="d11910e986" class="indexterm-anchor"></a><a id="d11910e990" class="indexterm-anchor"></a><a id="d11910e994" class="indexterm-anchor"></a>You create a base attribute for a dimension with the <code class="codeph">findOrCreateBaseAttribute</code> method. You can specify the data type of the attribute, although for many attributes Oracle OLAP can determine the data type from the attribute mapping. With the <code class="codeph">setAllowAutoDataTypeChange</code> method, you can specify that Oracle OLAP determine the data type. Some attributes are used by the dimension in certain ways, such as to provide descriptions of dimension members or to provide date information that can be used in calculations. For example, you can specify an attribute for descriptions with the <code class="codeph">setValueDescriptionAttribute</code> method of the dimension and you can specify an attribute that contains end date time period values with the <code class="codeph">setEndDateAttribute</code> method of an <code class="codeph">MdmTimeDimension</code>.
                     </p>
                     <p><a id="d11910e1016" class="indexterm-anchor"></a><a id="d11910e1020" class="indexterm-anchor"></a><a id="d11910e1024" class="indexterm-anchor"></a><a href="creating-metadata-and-analytic-workspaces.html#GUID-EA1BAC07-B64E-45CB-B0E9-74A2E2EE9FD3__BABEHBJF">Example 4-6</a> creates a long description attribute for the CHANNEL_AWJ dimension and specifies it as the attribute that contains descriptions of the members of the dimension. The example specifies that Oracle OLAP automatically determines a SQL data type for the attribute.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-EA1BAC07-B64E-45CB-B0E9-74A2E2EE9FD3__BABEHBJF">
                     <p class="titleinexample">Example 4-6 Creating an MdmBaseAttribute</p><pre class="oac_no_warn" dir="ltr">private MdmBaseAttribute chanLongDescAttr = null;
private void createLongDesciptionAttribute(MdmPrimaryDimension mdmChanDim)
{
// Create the long description attribute and allow the automatic changing of
// the SQL data type.
chanLongDescAttr = mdmChanDim.findOrCreateBaseAttribute("LONG_DESCRIPTION");
chanLongDescAttr.setAllowAutoDataTypeChange(true));

// Specifies that the attribute contains descriptions of the dimension members.
mdmChanDim.setValueDescriptionAttribute(chanLongDescAttr);
}
</pre><p><a id="d11910e1036" class="indexterm-anchor"></a><a id="d11910e1040" class="indexterm-anchor"></a><a id="d11910e1044" class="indexterm-anchor"></a>An attribute can have different values for the members of different levels of the dimension. In that case the attribute has an attribute mapping for each level. <a href="creating-metadata-and-analytic-workspaces.html#GUID-36EF8BE6-12A1-4ED8-B664-57C8C2DB08F0__BABDJEDC">Example 4-3</a> creates an <code class="codeph">AttributeMap</code> for the long description attribute for each dimension level by calling the <code class="codeph">findOrCreateAttributeMap</code> method of the <code class="codeph">MemberListMap</code> for each dimension level. It specifies a different column for each attribute map.
                     </p>
                  </div>
                  <!-- class="example" -->
               </div>
            </div><a id="OLAAP236"></a><div class="props_rev_3"><a id="GUID-3C6A8328-2BB6-43B7-86FB-2513B31DAABD" name="GUID-3C6A8328-2BB6-43B7-86FB-2513B31DAABD"></a><h3 id="OLAAP-GUID-3C6A8328-2BB6-43B7-86FB-2513B31DAABD" class="sect3"><span class="enumeration_section">4.5 </span>Creating Cubes and Measures
               </h3>
               <div>
                  <p>A cube in a dimensional object model is represented by the <code class="codeph">MdmCube</code> class. An <code class="codeph">MdmCube</code> owns one or more <code class="codeph">MdmMeasure</code> objects. It has a list of the <code class="codeph">MdmPrimaryDimension</code> objects that dimension the measures.
                  </p>
                  <p>An <code class="codeph">MdmCube</code> has the following objects associated with it.
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><code class="codeph">MdmPrimaryDimension</code> objects that specify the dimensionality of the cube.
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">MdmMeasure</code> objects that contain data that is identified by the dimensions.
                        </p>
                     </li>
                     <li>
                        <p>A <code class="codeph">CubeOrganization</code> that specifies how the cube stores and manages the measure data.
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">CubeMap</code> objects that associate the cube with relational sources.
                        </p>
                     </li>
                     <li>
                        <p>A <code class="codeph">ConsistentSolveSpecification</code> that specifies how to calculate, or solve, the aggregate level data. 
                        </p>
                     </li>
                  </ul>
                  <p>The following examples demonstrate creating and mapping a cube and its measures .</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="creating-metadata-and-analytic-workspaces.html#GUID-62FDFA22-A3BA-47B9-84BE-383A2351ADBE">Creating Cubes</a></p>
                     </li>
                     <li>
                        <p><a href="creating-metadata-and-analytic-workspaces.html#GUID-C04F33E1-5FB8-41A1-90CC-C27D026D00A0">Creating and Mapping Measures</a></p>
                     </li>
                  </ul>
               </div><a id="OLAAP238"></a><a id="OLAAP237"></a><div class="props_rev_3"><a id="GUID-62FDFA22-A3BA-47B9-84BE-383A2351ADBE" name="GUID-62FDFA22-A3BA-47B9-84BE-383A2351ADBE"></a><h4 id="OLAAP-GUID-62FDFA22-A3BA-47B9-84BE-383A2351ADBE" class="sect4"><span class="enumeration_section">4.5.1 </span>Creating Cubes
                  </h4>
                  <div>
                     <div class="example" id="GUID-62FDFA22-A3BA-47B9-84BE-383A2351ADBE__BABHHCBI">
                        <p class="titleinexample">Example 4-7 Creating and Mapping an MdmCube</p>
                        <p><a id="d11910e1192" class="indexterm-anchor"></a><a id="d11910e1196" class="indexterm-anchor"></a><a id="d11910e1200" class="indexterm-anchor"></a><a id="d11910e1204" class="indexterm-anchor"></a><a id="d11910e1208" class="indexterm-anchor"></a>This example creates a cube and some of the objects associated with it. It creates an <code class="codeph">MdmCube</code> that has the name PRICE_CUBE_AWJ. It also creates an <code class="codeph">AWCubeOrganization</code> object to deploy the cube in an analytic workspace. The <code class="codeph">mdmDBSchema</code> and <code class="codeph">aw</code> objects are created by <a href="creating-metadata-and-analytic-workspaces.html#GUID-8AD05B73-FBF3-4D2F-99F7-02E406BAEA0D__BABGHIJF">Example 4-1</a> and the <code class="codeph">leafLevel</code> <code class="codeph">ArrayList</code> is created in <a href="creating-metadata-and-analytic-workspaces.html#GUID-EFF7B8CF-44A2-464D-905B-4AD086345A81__BABHDHDG">Example 4-4</a>. The <code class="codeph">mdmTimeDim</code> and <code class="codeph">mdmProdDim</code> objects are dimensions of time periods and product categories. The <code class="codeph">CreateAndBuildAW</code> program creates those dimensions. The last lines of the example call the methods in <a href="creating-metadata-and-analytic-workspaces.html#GUID-C04F33E1-5FB8-41A1-90CC-C27D026D00A0__BABICJFH">Example 4-8</a> and <a href="creating-metadata-and-analytic-workspaces.html#GUID-E79729DC-35F2-4A1F-975A-6DB9F91D7361__BABDCDHH">Example 4-9</a>, respectively.
                        </p><pre class="oac_no_warn" dir="ltr">private MdmCube createAndMapCube(MdmPrimaryDimension mdmTimeDim,
                                 MdmPrimaryDimension mdmProdDim)
{
<a id="d11910e1252" class="indexterm-anchor"></a>  MdmCube mdmPriceCube = mdmDBSchema.findOrCreateCube("PRICE_CUBE_AWJ");
  // Add dimensions to the cube.
  mdmPriceCube.addDimension(mdmTimeDim);
  mdmPriceCube.addDimension(mdmProdDim);

<a id="d11910e1257" class="indexterm-anchor"></a>  AWCubeOrganization awCubeOrg =
    mdmPriceCube.findOrCreateAWCubeOrganization(aw);
  awCubeOrg.setMVOption(AWCubeOrganization.NONE_MV_OPTION);
  awCubeOrg.setMeasureStorage(AWCubeOrganization.SHARED_MEASURE_STORAGE);
  awCubeOrg.setCubeStorageType("NUMBER");

  AggregationCommand aggCommand = new AggregationCommand("AVG");
  ArrayList&lt;ConsistentSolveCommand&gt; solveCommands = new ArrayList();
  solveCommands.add(aggCommand);
  ConsistentSolveSpecification conSolveSpec = 
                      new ConsistentSolveSpecification(solveCommands);
<a id="d11910e1262" class="indexterm-anchor"></a>  mdmPriceCube.setConsistentSolveSpecification(conSolveSpec);

  // Create and map the measures of the cube.
  createAndMapMeasures(mdmPriceCube);
  // Commit the Transaction.
  commit(mdmPriceCube); 
}</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="OLAAP240"></a><a id="OLAAP239"></a><div class="props_rev_3"><a id="GUID-C04F33E1-5FB8-41A1-90CC-C27D026D00A0" name="GUID-C04F33E1-5FB8-41A1-90CC-C27D026D00A0"></a><h4 id="OLAAP-GUID-C04F33E1-5FB8-41A1-90CC-C27D026D00A0" class="sect4"><span class="enumeration_section">4.5.2 </span>Creating and Mapping Measures
                  </h4>
                  <div>
                     <div class="example" id="GUID-C04F33E1-5FB8-41A1-90CC-C27D026D00A0__BABICJFH">
                        <p class="titleinexample">Example 4-8 Creating and Mapping Measures</p>
                        <p><a id="d11910e1307" class="indexterm-anchor"></a><a id="d11910e1311" class="indexterm-anchor"></a><a id="d11910e1315" class="indexterm-anchor"></a><a id="d11910e1319" class="indexterm-anchor"></a><a id="d11910e1323" class="indexterm-anchor"></a><a id="d11910e1327" class="indexterm-anchor"></a><a id="d11910e1331" class="indexterm-anchor"></a><a id="d11910e1335" class="indexterm-anchor"></a><a id="d11910e1339" class="indexterm-anchor"></a><a id="d11910e1343" class="indexterm-anchor"></a><a id="d11910e1347" class="indexterm-anchor"></a>This example creates measures for a cube and maps the measures to fact tables in the relational database. The example uses the cube created by <a href="creating-metadata-and-analytic-workspaces.html#GUID-62FDFA22-A3BA-47B9-84BE-383A2351ADBE__BABHHCBI">Example 4-7</a>.
                        </p><pre class="oac_no_warn" dir="ltr">private void createAndMapMeasures(MdmCube mdmPriceCube)
{
  ArrayList&lt;MdmBaseMeasure&gt; measures = new ArrayList();
<a id="d11910e1357" class="indexterm-anchor"></a>  MdmBaseMeasure mdmCostMeasure =
    mdmPriceCube.findOrCreateBaseMeasure("UNIT_COST");
  MdmBaseMeasure mdmPriceMeasure =
    mdmPriceCube.findOrCreateBaseMeasure("UNIT_PRICE");
  mdmCostMeasure.setAllowAutoDataTypeChange(true);
  mdmPriceMeasure.setAllowAutoDataTypeChange(true);
  measures.add(mdmCostMeasure);
  measures.add(mdmPriceMeasure);
<a id="d11910e1362" class="indexterm-anchor"></a>  MdmTable priceCostTable = 
    (MdmTable)mdmDBSchema.getTopLevelObject("PRICE_FACT"); 
  Query cubeQuery = priceCostTable.getQuery();
  ArrayList&lt;String&gt; measureColumns = new ArrayList();
  measureColumns.add("GLOBAL.PRICE_FACT.UNIT_COST");
  measureColumns.add("GLOBAL.PRICE_FACT.UNIT_PRICE");
  CubeMap cubeMap = mdmPriceCube.findOrCreateCubeMap();
  cubeMap.setQuery(cubeQuery);

  // Create MeasureMap objects for the measures of the cube and
  // set the expressions for the measures. The expressions specify the
  // columns of the fact table for the measures.
  int i = 0;
  for(MdmBaseMeasure mdmBaseMeasure : measures)
  {
<a id="d11910e1367" class="indexterm-anchor"></a>    MeasureMap measureMap = cubeMap.findOrCreateMeasureMap(mdmBaseMeasure);
    Expression expr =
      (Expression)SyntaxObject.fromSyntax(measureColumns.get(i), 
                                          metadataProvider);
    measureMap.setExpression(expr);
    i++;
  }

  // Create CubeDimensionalityMap objects for the dimensions of the cube and
  // set the expressions for the dimensions. The expressions specify the
  // columns of the fact table for the dimensions.

  ArrayList&lt;String&gt; factColNames = new ArrayList();
  factColNames.add("GLOBAL.PRICE_FACT.MONTH_ID");
  factColNames.add("GLOBAL.PRICE_FACT.ITEM_ID");
  List&lt;MdmDimensionality&gt; mdmDimltys = mdmPriceCube.getDimensionality();
  for (MdmDimensionality mdmDimlty: mdmDimltys)
  {
<a id="d11910e1372" class="indexterm-anchor"></a>    CubeDimensionalityMap cubeDimMap = 
      cubeMap.findOrCreateCubeDimensionalityMap(mdmDimlty);
    MdmPrimaryDimension mdmPrimDim = 
      (MdmPrimaryDimension)mdmDimlty.getDimension();
    String columnMap = null;
    if (mdmPrimDim.getName().startsWith("TIME"))
    {
      columnMap = factColNames.get(0);
      i = 0;
    }
    else// (mdmPrimDim.getName().startsWith("PRODUCT"))
    {
      columnMap = factColNames.get(1);
      i = 1;
    }
    Expression expr =
      (Expression)SyntaxObject.fromSyntax(columnMap,metadataProvider);
    cubeDimMap.setExpression(expr);

    // Associate the leaf level of the hierarchy with the cube.
    MdmHierarchy mdmDefHier = mdmPrimDim.getDefaultHierarchy();
    MdmLevelHierarchy mdmLevHier = (MdmLevelHierarchy)mdmDefHier;
    List&lt;MdmHierarchyLevel&gt; levHierList = mdmLevHier.getHierarchyLevels();
    // The last element in the list must be the leaf level of the hierarchy.
    MdmHierarchyLevel leafLevel = levHierList.get(levHierList.size() - 1);
    cubeDimMap.setMappedDimension(leafLevel);
  }
}</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="OLAAP242"></a><a id="OLAAP241"></a><div class="props_rev_3"><a id="GUID-E79729DC-35F2-4A1F-975A-6DB9F91D7361" name="GUID-E79729DC-35F2-4A1F-975A-6DB9F91D7361"></a><h3 id="OLAAP-GUID-E79729DC-35F2-4A1F-975A-6DB9F91D7361" class="sect3"><span class="enumeration_section">4.6 </span>Committing Transactions
               </h3>
               <div>
                  <div class="section">
                     <p><a id="d11910e1416" class="indexterm-anchor"></a><a id="d11910e1420" class="indexterm-anchor"></a>To save a metadata object as a persistent entity in the database, you must commit the <code class="codeph">Transaction</code> in which you created the object. You can commit a <code class="codeph">Transaction</code> at any time. Committing the <code class="codeph">Transaction</code> after creating a top-level object and the objects that it owns is a good practice.
                     </p>
                     <p><a href="creating-metadata-and-analytic-workspaces.html#GUID-E79729DC-35F2-4A1F-975A-6DB9F91D7361__BABDCDHH">Example 4-9</a> gets the <code class="codeph">TransactionProvider</code> from the <code class="codeph">DataProvider</code> for the session and commits the current <code class="codeph">Transaction</code>.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-E79729DC-35F2-4A1F-975A-6DB9F91D7361__BABDCDHH">
                     <p class="titleinexample">Example 4-9 Committing Transactions</p><pre class="oac_no_warn" dir="ltr">private void commit(MdmSource mdmSource)
{
  try 
  {
    System.out.println("Committing the transaction for " + 
                        mdmSource.getName() + ".");      
    (dp.getTransactionProvider()).commitCurrentTransaction();
  } 
  catch (Exception ex) 
  {
    System.out.println("Could not commit the Transaction. " + ex);
  } 
}</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="OLAAP244"></a><a id="OLAAP243"></a><div class="props_rev_3"><a id="GUID-767D2EF6-AAC5-47DA-91A8-9D48AD90A279" name="GUID-767D2EF6-AAC5-47DA-91A8-9D48AD90A279"></a><h3 id="OLAAP-GUID-767D2EF6-AAC5-47DA-91A8-9D48AD90A279" class="sect3"><span class="enumeration_section">4.7 </span>Exporting and Importing XML Templates
               </h3>
               <div>
                  <div class="section">
                     <p><a id="d11910e1487" class="indexterm-anchor"></a><a id="d11910e1489" class="indexterm-anchor"></a><a id="d11910e1493" class="indexterm-anchor"></a>You can save the definition of a metadata object by exporting the object to an XML template. Exporting an object saves the definition of the object and the definitions of any objects that it owns. For example, if you export an <code class="codeph">AW</code> object to XML, then the XML includes the definitions of any <code class="codeph">MdmPrimaryDimension</code> and <code class="codeph">MdmCube</code> objects that the <code class="codeph">AW</code> owns, and the <code class="codeph">MdmAttribute</code>, <code class="codeph">MdmMeasure</code> and other objects owned by the dimensions and cubes.
                     </p>
                     <p><a id="d11910e1518" class="indexterm-anchor"></a><a id="d11910e1520" class="indexterm-anchor"></a><a id="d11910e1524" class="indexterm-anchor"></a>You can import a metadata object definition as an XML template. After importing, you must build the object.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-767D2EF6-AAC5-47DA-91A8-9D48AD90A279__BABGCBEB">
                     <p class="titleinexample">Example 4-10 Exporting to an XML Template</p>
                     <p><a id="d11910e1533" class="indexterm-anchor"></a>This example exports metadata objects to an XML template and saves it in a file. The code excerpt at the beginning of the example creates a <code class="codeph">List</code> of the objects to export. It adds to the <code class="codeph">List</code> the <code class="codeph">aw</code> object, which is the analytic workspace created by <a href="creating-metadata-and-analytic-workspaces.html#GUID-8AD05B73-FBF3-4D2F-99F7-02E406BAEA0D__BABGHIJF">Example 4-1</a>. It then calls the <code class="codeph">exportToXML</code> method. 
                     </p><pre class="oac_no_warn" dir="ltr"> ... // In some method.
List objectsToExport = new ArrayList();
objectsToExport.add(aw);
exportToXML(objectsToExport, "globalawj.xml");
...
public void exportToXML(List objectsToExport, String fileName)
{
  try
  {
    PrintWriter writer = new PrintWriter(new FileWriter(filename));
    mp.exportFullXML(writer,         // mp is the MdmMetadataProvider
                     objectsToExport,
                     null,           // No Map for renaming objects
                     false);         // Do not include the owner name
    writer.close();
  }
  catch (IOException ie)
  {
    ie.printStackTrace();
  }
}
</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="OLAAP246"></a><a id="OLAAP245"></a><div class="props_rev_3"><a id="GUID-FBBE0DE5-B703-4CBD-9A1B-845AEFE5E640" name="GUID-FBBE0DE5-B703-4CBD-9A1B-845AEFE5E640"></a><h3 id="OLAAP-GUID-FBBE0DE5-B703-4CBD-9A1B-845AEFE5E640" class="sect3"><span class="enumeration_section">4.8 </span>Building an Analytic Workspace
               </h3>
               <div>
                  <div class="section">
                     <p>After creating and mapping metadata objects, or importing the XML definition of an object, you must perform the calculations that the objects specify and load the resulting data into physical storage structures.</p>
                     <p><a id="d11910e1594" class="indexterm-anchor"></a><a id="d11910e1598" class="indexterm-anchor"></a><a id="d11910e1602" class="indexterm-anchor"></a><a id="d11910e1606" class="indexterm-anchor"></a><a id="d11910e1610" class="indexterm-anchor"></a><a href="creating-metadata-and-analytic-workspaces.html#GUID-FBBE0DE5-B703-4CBD-9A1B-845AEFE5E640__BABDFIJC">Example 4-11</a> creates <code class="codeph">BuildItem</code> objects for the dimensions and cubes of the analytic workspace. It creates a <code class="codeph">BuildProcess</code> that specifies the <code class="codeph">BuildItem</code> objects and passes the <code class="codeph">BuildProcess</code> to the <code class="codeph">executeBuild</code> method of the <code class="codeph">DataProvider</code> for the session.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-FBBE0DE5-B703-4CBD-9A1B-845AEFE5E640__BABDFIJC">
                     <p class="titleinexample">Example 4-11 Building an Analytic Workspace</p><pre class="oac_no_warn" dir="ltr">BuildItem bldChanDim = new BuildItem(mdmChanDim);
BuildItem bldProdDim = new BuildItem(mdmProdDim);
BuildItem bldCustDim = new BuildItem(mdmCustDim);
BuildItem bldTimeDim = new BuildItem(mdmTimeDim);
BuildItem bldUnitsCube = new BuildItem(mdmUnitsCube);
BuildItem bldPriceCube = new BuildItem(mdmPriceCube);
ArrayList&lt;BuildItem&gt; items = new ArrayList();
items.add(bldChanDim);
items.add(bldProdDim); 
items.add(bldCustDim);
items.add(bldTimeDim);
items.add(bldUnitsCube);
items.add(bldPriceCube);
BuildProcess bldProc = new BuildProcess(items);
try 
{
  dp.executeBuild(bldProc, 0);
} 
catch (Exception ex) 
{
  System.out.println("Could not execute the BuildProcess." + ex);
}</pre></div>
                  <!-- class="example" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html>