<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Using Oracle Object References</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="JDBC Developer's Guide">
      <meta property="og:description" content>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="JDBC Developer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="jdbc-developers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-02-13T13:20:37-08:00">
      <meta name="dcterms.title" content="JDBC Developer's Guide">
      <meta name="dcterms.dateCopyrighted" content="1999, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96471-02">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="LOBs-and-BFiles.html" title="Previous" type="text/html">
      <link rel="next" href="Oracle-collections.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="JJDBC">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="LOBs-and-BFiles.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="Oracle-collections.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">JDBC Developer's Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="data-access-and-manipulation.html" property="item" typeof="WebPage"><span property="name"> Data Access and Manipulation</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem"> Using Oracle Object References </li>
            </ol>
            <a id="GUID-AE74076F-C906-41C6-B8DF-D7056BA0CEA4" name="GUID-AE74076F-C906-41C6-B8DF-D7056BA0CEA4"></a><a id="JJDBC28566"></a>
            
            <h2 id="JJDBC-GUID-AE74076F-C906-41C6-B8DF-D7056BA0CEA4" class="sect2"><span class="enumeration_chapter">15 </span> Using Oracle Object References 
            </h2>
         </header>
         <div class="ind">
            <div>
               <p><a id="d57173e21" class="indexterm-anchor"></a><a id="d57173e25" class="indexterm-anchor"></a>This chapter describes the standard Java Database Connectivity (JDBC) that let you access and manipulate object references.
               </p>
               <p>This section discusses the following topics:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="Oracle-object-references.html#GUID-2911A754-8AB1-4104-95ED-DA7C01E216AE">Oracle Extensions for Object References</a></p>
                  </li>
                  <li>
                     <p><a href="Oracle-object-references.html#GUID-F488767E-88FC-4EF3-AD41-072D44F15E0A">Retrieving and Passing an Object Reference</a></p>
                  </li>
                  <li>
                     <p><a href="Oracle-object-references.html#GUID-4B5FAA66-0B3D-47DD-B69B-0FA83806B495">Accessing and Updating Object Values Through an Object Reference</a></p>
                  </li>
               </ul>
            </div><a id="JJDBC28567"></a><div class="props_rev_3"><a id="GUID-2911A754-8AB1-4104-95ED-DA7C01E216AE" name="GUID-2911A754-8AB1-4104-95ED-DA7C01E216AE"></a><h3 id="JJDBC-GUID-2911A754-8AB1-4104-95ED-DA7C01E216AE" class="sect3"><span class="enumeration_section">15.1 </span>Oracle Extensions for Object References
               </h3>
               <div>
                  <p>Oracle supports the use of refer<a id="d57173e76" class="indexterm-anchor"></a>ences to database objects. Oracle JDBC provides support for object references as:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Columns in a <code class="codeph">SELECT</code> clause
                        </p>
                     </li>
                     <li>
                        <p>IN or OUT bind variables</p>
                     </li>
                     <li>
                        <p>Attributes in an Oracle object</p>
                     </li>
                     <li>
                        <p>Elements in a collection type object</p>
                     </li>
                  </ul>
                  <p>In SQL, an object reference (<code class="codeph">REF</code>) is strongly typed. For example, a reference to an <code class="codeph">EMPLOYEE</code> object would be defined as an <code class="codeph">EMPLOYEE REF</code>, not just a <code class="codeph">REF</code>. 
                  </p>
                  <p>When you select an object reference, be aware that you are retrieving only a pointer to an object, not the object itself. You have the choice of materializing the reference as a <code class="codeph">java.sql.Ref</code> instance for portability, or materializing it as an instance of a custom Java class that you have created in advance, which is strongly typed. Custom Java classes used for object references are referred to as <span class="bold">custom reference classes</span> and must implement the <code class="codeph">oracle.jdbc.OracleData</code> interface.
                  </p>
                  <p>You can retrieve a <code class="codeph">REF</code> instance through a result set or callable statement object, and pass an updated <code class="codeph">REF</code> instance back to the database through a prepared statement or callable statement object. The <code class="codeph">REF</code> class includes functionality to get and set underlying object attribute values, and get the SQL base type name of the underlying object.
                  </p>
                  <p>Custom reference classes include this same functionality, as well as having the advantage of being strongly typed. This can help you find coding errors during compilation that might not otherwise be discovered until run time.</p>
                  <div class="infoboxnote" id="GUID-2911A754-8AB1-4104-95ED-DA7C01E216AE__GUID-840F2F3E-F9CF-483F-8107-2726225FCC93">
                     <p class="notep1">Note:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>If you are using the <code class="codeph">oracle.jdbc.OracleData</code> interface for custom object classes, then you will presumably use <code class="codeph">OracleData</code> for corresponding custom reference classes as well. However, if you are using the standard <code class="codeph">java.sql.SQLData</code> interface for custom object classes, then you can only use weak Java types for references. The <code class="codeph">SQLData</code> interface is for mapping SQL object types only.
                           </p>
                        </li>
                        <li>
                           <p>You can create and retrieve <code class="codeph">REF</code> objects in your JDBC application only by running SQL statements. There is no JDBC-specific functionality for creating and retrieving <code class="codeph">REF</code> objects.
                           </p>
                        </li>
                        <li>
                           <p>You cannot have a reference to an array, even though arrays, like objects, are structured types.</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="JJDBC28568"></a><div class="props_rev_3"><a id="GUID-F488767E-88FC-4EF3-AD41-072D44F15E0A" name="GUID-F488767E-88FC-4EF3-AD41-072D44F15E0A"></a><h3 id="JJDBC-GUID-F488767E-88FC-4EF3-AD41-072D44F15E0A" class="sect3"><span class="enumeration_section">15.2 </span>Retrieving and Passing an Object Reference
               </h3>
               <div>
                  <div class="section">
                     <p>This section discusses JDBC functionality for retrieving and passing object references. It covers the following topics:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="Oracle-object-references.html#GUID-D35B2BB6-3D4C-49C9-A0E0-E17F4A8473CF">Retrieving an Object Reference from a Result Set</a></p>
                        </li>
                        <li>
                           <p><a href="Oracle-object-references.html#GUID-7113339D-61CC-414B-9ADA-E5EECA317846">Retrieving an Object Reference from a Callable Statement</a></p>
                        </li>
                        <li>
                           <p><a href="Oracle-object-references.html#GUID-90C1244F-CAD6-4800-8B91-4A73D068F38B">Passing an Object Reference to a Prepared Statement</a></p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div><a id="JJDBC28569"></a><div class="props_rev_3"><a id="GUID-D35B2BB6-3D4C-49C9-A0E0-E17F4A8473CF" name="GUID-D35B2BB6-3D4C-49C9-A0E0-E17F4A8473CF"></a><h4 id="JJDBC-GUID-D35B2BB6-3D4C-49C9-A0E0-E17F4A8473CF" class="sect4"><span class="enumeration_section">15.2.1 </span>Retrieving an Object Reference from a Result Set
                  </h4>
                  <div>
                     <div class="section">
                        <p>To demon<a id="d57173e230" class="indexterm-anchor"></a>strate how to retrieve object references, the following example first defines an Oracle object type <code class="codeph">ADDRESS</code>, which is then referenced in the <code class="codeph">PEOPLE</code> table:
                        </p><pre class="oac_no_warn" dir="ltr">create type ADDRESS as object
   (street_name     VARCHAR2(30),
    house_no        NUMBER);

create table PEOPLE 
    (col1 VARCHAR2(30),
     col2 NUMBER,
     col3 REF ADDRESS);
</pre><p>The <code class="codeph">ADDRESS</code> object type has two attributes: a street name and a house number. The <code class="codeph">PEOPLE</code> table has three columns: a column for character data, a column for numeric data, and a column containing a reference to an <code class="codeph">ADDRESS</code> object.
                        </p>
                        <p>To retrieve an object reference, follow these general steps:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li><span>Use a standard SQL <code class="codeph">SELECT</code> statement to retrieve the reference from a database table <code class="codeph">REF</code> column.</span></li>
                        <li><span>Use <code class="codeph">getRef</code> to get the address reference from the result set into an <code class="codeph">OracleRef</code> instance.</span></li>
                        <li><span>Let <code class="codeph">Address</code> be the Java custom class corresponding to the SQL object type <code class="codeph">ADDRESS</code>.</span></li>
                        <li><span>Add the correspondence between the Java class <code class="codeph">Address</code> and the SQL type <code class="codeph">ADDRESS</code> to your type map.</span></li>
                        <li><span>Use the <code class="codeph">getObject</code> method to retrieve the contents of the <code class="codeph">Address</code> reference. Cast the output to <code class="codeph">Address</code>.</span></li>
                     </ol>
                     <div class="section">
                        <p>The <code class="codeph">PEOPLE</code> database table is defined earlier in this section<a id="d57173e311" class="indexterm-anchor"></a><a id="d57173e315" class="indexterm-anchor"></a>. The code for the preceding steps, except the step of adding <code class="codeph">Address</code> to the type map, is as follows:
                        </p><pre class="oac_no_warn" dir="ltr">ResultSet rs = stmt.executeQuery("SELECT col3 FROM PEOPLE"); 
while (rs.next())
{
   OracleRef ref = rs.getRef(1);
   Address a = (Address)ref.getObject();
}
</pre><div class="infoboxnote" id="GUID-D35B2BB6-3D4C-49C9-A0E0-E17F4A8473CF__GUID-ACCBC8FF-E2C4-4C03-B38B-1856F867E8DB">
                           <p class="notep1">Note:</p>
                           <p>In the preceding code, <code class="codeph">stmt</code> is a previously defined statement object.
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="JJDBC28570"></a><div class="props_rev_3"><a id="GUID-7113339D-61CC-414B-9ADA-E5EECA317846" name="GUID-7113339D-61CC-414B-9ADA-E5EECA317846"></a><h4 id="JJDBC-GUID-7113339D-61CC-414B-9ADA-E5EECA317846" class="sect4"><span class="enumeration_section">15.2.2 </span>Retrieving an Object Reference from a Callable Statement
                  </h4>
                  <div>
                     <div class="section">
                        <p>To retrieve an <a id="d57173e356" class="indexterm-anchor"></a>object reference as an <code class="codeph">OUT</code> parameter in PL/SQL blocks, you must register the bind type for your <code class="codeph">OUT</code> parameter.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Cast your callable statement to <code class="codeph">OracleCallableStatement</code>, as follows:</span><div><pre class="oac_no_warn" dir="ltr">OracleCallableStatement ocs = 
   (OracleCallableStatement)conn.prepareCall("{? = call func()}");
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Register the <code class="codeph">OUT</code> parameter with the following form of the <code class="codeph">registerOutParameter</code> method:</span><div><pre class="oac_no_warn" dir="ltr">ocs.registerOutParameter (int <span class="italic">param_index</span>, int <span class="italic">sql_type</span>, String <span class="italic">sql_type_name</span>);
</pre><p><span class="italic"><code class="codeph">param_index</code></span> is the parameter index and <span class="italic"><code class="codeph">sql_type</code></span> is the SQL type code. The <span class="italic"><code class="codeph">sql_type_name</code></span> is the name of the structured object type that this reference is used for. For example, if the <code class="codeph">OUT</code> parameter is a reference to an <code class="codeph">ADDRESS</code> object, then <code class="codeph">ADDRESS</code> is the <span class="italic"><code class="codeph">sql_type_name</code></span> that should be passed in.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Run the call, as follows:</span><div><pre class="oac_no_warn" dir="ltr">ocs.execute();</pre></div>
                        </li>
                     </ol>
                  </div>
               </div><a id="JJDBC28571"></a><div class="props_rev_3"><a id="GUID-90C1244F-CAD6-4800-8B91-4A73D068F38B" name="GUID-90C1244F-CAD6-4800-8B91-4A73D068F38B"></a><h4 id="JJDBC-GUID-90C1244F-CAD6-4800-8B91-4A73D068F38B" class="sect4"><span class="enumeration_section">15.2.3 </span>Passing an Object Reference to a Prepared Statement
                  </h4>
                  <div>
                     <div class="section">
                        <p>Pass an <a id="d57173e457" class="indexterm-anchor"></a>object reference to a prepared statement in the same way as you would pass any other SQL type. Use either the <code class="codeph">setObject</code> method or the <code class="codeph">setREF </code>method of a prepared statement object.
                        </p>
                        <p>Use a prepared statement to update an address reference based on <code class="codeph">ROWID</code>, as follows:
                        </p><pre class="oac_no_warn" dir="ltr">PreparedStatement pstmt = 
   conn.prepareStatement ("update PEOPLE set ADDR_REF = ? where ROWID = ?");
pstmt.setRef (1, addr_ref);
    pstmt.setRowId (2, rowid);</pre></div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="JJDBC28572"></a><div class="props_rev_3"><a id="GUID-4B5FAA66-0B3D-47DD-B69B-0FA83806B495" name="GUID-4B5FAA66-0B3D-47DD-B69B-0FA83806B495"></a><h3 id="JJDBC-GUID-4B5FAA66-0B3D-47DD-B69B-0FA83806B495" class="sect3"><span class="enumeration_section">15.3 </span>Accessing and Updating Object Values Through an Object Reference
               </h3>
               <div>
                  <div class="section">
                     <p>You can use the <code class="codeph">Ref</code> object <code class="codeph">setObject</code> method to update the value of an object in the database through an object reference. To do this, you must first retrieve the reference to the database object and create a Java object that corresponds to the database object. 
                     </p>
                     <p>For example, you can use the code in the <span class="q">"Retrieving and Passing an Object Reference"</span> section to retrieve the reference to a database <code class="codeph">ADDRESS</code> object, as shown in the following code snippet: 
                     </p><pre class="oac_no_warn" dir="ltr">ResultSet rs = stmt.executeQuery("SELECT col3 FROM PEOPLE"); 
if (rs.next())
{
   Ref ref = rs.getRef(1);
<a id="d57173e517" class="indexterm-anchor"></a><a id="d57173e521" class="indexterm-anchor"></a>   Address a = (Address)ref.getObject();
}
</pre><p>Then, <a id="d57173e528" class="indexterm-anchor"></a><a id="d57173e532" class="indexterm-anchor"></a>you can create a Java <code class="codeph">Address</code> object that corresponds to the database <code class="codeph">ADDRESS</code> object. Use the <code class="codeph">setObject</code> method of the <code class="codeph">Ref</code> interface to set the value of the database object, as follows:
                     </p><pre class="oac_no_warn" dir="ltr">Address addr = new Address(...);
ref.setObject(addr);
</pre><p>Here, the <code class="codeph">setValue</code> method updates the database <code class="codeph">ADDRESS</code> object immediately. 
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="Oracle-object-references.html#GUID-F488767E-88FC-4EF3-AD41-072D44F15E0A">Retrieving and Passing an Object Reference</a></li>
                     </ul>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>