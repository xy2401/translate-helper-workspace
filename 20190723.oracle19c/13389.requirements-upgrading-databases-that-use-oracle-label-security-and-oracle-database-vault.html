<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="You must complete these tasks before starting an upgrade with a database using Oracle Label Security or Oracle Database Vault.">
      <meta name="description" content="You must complete these tasks before starting an upgrade with a database using Oracle Label Security or Oracle Database Vault.">
      <title>Requirements for Upgrading Databases That Use Oracle Label Security and Oracle Database Vault</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Database Upgrade Guide">
      <meta property="og:description" content="You must complete these tasks before starting an upgrade with a database using Oracle Label Security or Oracle Database Vault.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Database Upgrade Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="database-upgrade-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-04-25T08:26:31-07:00">
      <meta name="dcterms.title" content="Database Upgrade Guide">
      <meta name="dcterms.dateCopyrighted" content="1996, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96252-05">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="testing-upgraded-production-oracle-database.html" title="Previous" type="text/html">
      <link rel="next" href="using-autoupgrade-oracle-database-upgrades.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="UPGRD">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="testing-upgraded-production-oracle-database.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="using-autoupgrade-oracle-database-upgrades.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Database Upgrade Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="tasks-prepare-upgrade-oracle-database.html" property="item" typeof="WebPage"><span property="name"> Preparing to Upgrade Oracle Database </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Requirements for Upgrading Databases That Use Oracle Label Security and Oracle Database Vault</li>
            </ol>
            <a id="GUID-8EEEB9FC-CEFC-451C-8EC7-4B6D03418B96" name="GUID-8EEEB9FC-CEFC-451C-8EC7-4B6D03418B96"></a><a id="UPGRD60015"></a>
            
            <h2 id="UPGRD-GUID-8EEEB9FC-CEFC-451C-8EC7-4B6D03418B96" class="sect2">Requirements for Upgrading Databases That Use Oracle Label Security and Oracle Database Vault</h2>
         </header>
         <div class="ind">
            <div>
               <p>You must complete these tasks before starting an upgrade with a database using Oracle Label Security or Oracle Database Vault.</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="requirements-upgrading-databases-that-use-oracle-label-security-and-oracle-database-vault.html#GUID-843920D9-DEC0-4C93-8AA3-30016EA2FB12">Audit Table Preupgrade and Archive Requirements</a><br>For Oracle Database releases earlier than 12.1 using Oracle Label Security and Oracle Database Vault, you must run the OLS preprocess script before you upgrade.
                  </li>
                  <li class="ulchildlink"><a href="requirements-upgrading-databases-that-use-oracle-label-security-and-oracle-database-vault.html#GUID-55666B56-2F98-439B-93B7-836F827370BC">Oracle Database Vault and Upgrades of Oracle Database Release 11.2</a><br>If Oracle Label Security is installed in the earlier release that you are upgrading, then grant the DV_PATCH_ADMIN role to SYS.
                  </li>
                  <li class="ulchildlink"><a href="requirements-upgrading-databases-that-use-oracle-label-security-and-oracle-database-vault.html#GUID-3572726F-3408-4AAD-A46B-710092A59E3F">Granting the DV_PATCH_ADMIN Role to SYS for Oracle Database Vault</a><br>If Oracle Database Vault is enabled, then to perform checks for Oracle Data Vault, the upgrade process requires running three SQL scripts. 
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>Parent topic:</strong> <a href="tasks-prepare-upgrade-oracle-database.html#GUID-733D2563-A42D-4366-9FCD-DABD25D0E2DF" title="Complete preupgrade tasks and checks to assist you with completing a successful upgrade.">Preparing to Upgrade Oracle Database</a></p>
                  </div>
               </div>
            </div>
            
            <div class="props_rev_3"><a id="GUID-843920D9-DEC0-4C93-8AA3-30016EA2FB12" name="GUID-843920D9-DEC0-4C93-8AA3-30016EA2FB12"></a><h3 id="UPGRD-GUID-843920D9-DEC0-4C93-8AA3-30016EA2FB12" class="sect3">Audit Table Preupgrade and Archive Requirements</h3>
               <div>
                  <p>For Oracle Database releases earlier than 12.1 using Oracle Label Security and Oracle Database Vault, you must run the OLS preprocess script before you upgrade.</p>
                  <p>If you are upgrading from a database earlier than Oracle Database release 12.1 that uses Oracle Label Security (OLS) and Oracle Database Vault, then you must first run the OLS preprocess script, <code class="codeph">olspreupgrade.sql</code>, to process the <code class="codeph">aud$</code> table contents. The OLS upgrade moves the <code class="codeph">aud$</code> table from the <code class="codeph">SYSTEM</code> schema to the <code class="codeph">SYS</code> schema. The <code class="codeph">olspreupgrade.sql</code> script is a preprocessing script required for this move.
                  </p>
                  <div class="infoboxnote" id="GUID-843920D9-DEC0-4C93-8AA3-30016EA2FB12__GUID-884F99C5-3217-451C-8CFF-CD7DB3A328F6">
                     <p class="notep1">Caution:</p>
                     <p>Running the <code class="codeph">olspreupgrade.sql</code> script before upgrading is mandatory for upgrading databases earlier than Oracle Database release 12.1 that use Oracle Label Security and Oracle Database Vault. Once you have upgraded to Oracle Database release 12.1, you do not have to perform the OLS preprocessing procedure going forward to patch or upgrade the database.
                     </p>
                  </div>
                  <p>The <code class="codeph">olspreupgrade.sql</code> script creates a temporary table <code class="codeph">PREUPG_AUD$</code> in the <code class="codeph">SYS</code> schema and moves the <code class="codeph">SYSTEM.aud$</code> records to <code class="codeph">SYS.PREUPG_AUD$</code>. As a safety measure, Oracle recommends that you archive your audit trail before running the <code class="codeph">olspreupgrade.sql</code> script. If Oracle Label Security is installed on your database, and you are upgrading from an earlier release, then you must run the OLS preprocess script before upgrading. 
                  </p>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-843920D9-DEC0-4C93-8AA3-30016EA2FB12__GUID-4AB90AF7-3938-43C1-B964-3ECD10CFAE85">
                     <p class="notep1">See Also:</p>
                     <p><a href="../dbseg/administering-the-audit-trail.html#DBSEG732" target="_blank"><span class="italic">Oracle Database Security Guide</span></a> for information about archiving audit trails
                     </p>
                     <p><a href="../olsag/performing-dba-functions-under-oracle-label-security.html#OLSAG3687" target="_blank"><span class="italic">Oracle Label Security Administrator's Guide</span></a> for information about the OLS preprocess script
                     </p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="requirements-upgrading-databases-that-use-oracle-label-security-and-oracle-database-vault.html#GUID-8EEEB9FC-CEFC-451C-8EC7-4B6D03418B96" title="You must complete these tasks before starting an upgrade with a database using Oracle Label Security or Oracle Database Vault.">Requirements for Upgrading Databases That Use Oracle Label Security and Oracle Database Vault</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="UPGRD60030"></a><div class="props_rev_3"><a id="GUID-55666B56-2F98-439B-93B7-836F827370BC" name="GUID-55666B56-2F98-439B-93B7-836F827370BC"></a><h3 id="UPGRD-GUID-55666B56-2F98-439B-93B7-836F827370BC" class="sect3">Oracle Database Vault and Upgrades of Oracle Database Release 11.2</h3>
               <div>
                  <p>If Oracle Label Security is installed in the earlier release that you are upgrading, then grant the DV_PATCH_ADMIN role to SYS.</p>
                  <p> If Oracle Database Vault is not installed with your release 11.2 database, then you can skip steps 2, 3, 6, and 7 in this section.</p>
                  <p>To run the OLS preprocess script on a release 11.2 database before upgrading:</p>
                  <ol>
                     <li>
                        <p>Copy the following scripts script from the newly installed Oracle home to the Oracle home of the database that y0u want to upgrade:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code><span class="variable" translate="no">ORACLE_HOME</span>/rdbms/admin/olspreupgrade.sql</code></p>
                           </li>
                           <li>
                              <p><code><span class="variable" translate="no">ORACLE_HOME</span>/rdbms/admin/emremove.sql</code></p>
                           </li>
                           <li>
                              <p><code><span class="variable" translate="no">ORACLE_HOME</span>/rdbms/admin/catnoamd.sql</code></p>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <p>Start SQL*Plus and connect as <code class="codeph">DVOWNER</code> to the database that you want to upgrade.
                        </p>
                     </li>
                     <li>
                        <p>Run the following statement:</p><pre class="pre codeblock"><code>SQL&gt; GRANT DV_PATCH_ADMIN to SYS;
</code></pre></li>
                     <li>
                        <p>At the system prompt, connect SYS as SYSDBA:</p><pre class="pre codeblock"><code>CONNECT SYS AS SYSDBA
</code></pre></li>
                     <li>
                        <p>Run the preprocess scripts for Data Vault</p><pre class="pre codeblock"><code><span class="variable" translate="no">ORACLE_HOME</span>/rdbms/admin/olspreupgrade.sql
<span class="variable" translate="no">ORACLE_HOME</span>/rdbms/admin/emremove.sql
<span class="variable" translate="no">ORACLE_HOME</span>/rdbms/admin/catnoamd.sql
</code></pre><p>You may continue to run your applications on the database while the preprocess scripts are running.</p>
                     </li>
                     <li>
                        <p>After the <code>olspreupgrade.sql</code> completes its run successfully, start SQL*Plus and connect to the database as <code class="codeph">DVOWNER</code>.
                        </p>
                     </li>
                     <li>
                        <p>Run the following SQL statement:</p><pre class="pre codeblock"><code>SQL&gt; REVOKE DV_PATCH_ADMIN from SYS;</code></pre></li>
                  </ol>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="requirements-upgrading-databases-that-use-oracle-label-security-and-oracle-database-vault.html#GUID-8EEEB9FC-CEFC-451C-8EC7-4B6D03418B96" title="You must complete these tasks before starting an upgrade with a database using Oracle Label Security or Oracle Database Vault.">Requirements for Upgrading Databases That Use Oracle Label Security and Oracle Database Vault</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-3572726F-3408-4AAD-A46B-710092A59E3F" name="GUID-3572726F-3408-4AAD-A46B-710092A59E3F"></a><h3 id="UPGRD-GUID-3572726F-3408-4AAD-A46B-710092A59E3F" class="sect3">Granting the DV_PATCH_ADMIN Role to SYS for Oracle Database Vault</h3>
               <div>
                  <p>If Oracle Database Vault is enabled, then to perform checks for Oracle Data Vault, the upgrade process requires running three SQL scripts. </p>
                  <div class="section">
                     <p>The SYS user requires the DV_PATCH_ADMIN role for the following scripts:</p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-3572726F-3408-4AAD-A46B-710092A59E3F__GUID-C6BADECE-4C2F-434D-BBF4-69DE89A8733A">
                     <p>OLS_SYS_MOVE runs <code class="codeph">olspreupgrade.sql</code>:
                     </p><pre class="pre codeblock"><code>CHECK.OLS_SYS_MOVE.MIN_VERSION_INCLUSIVE=10.2 
CHECK.OLS_SYS_MOVE.MAX_VERSION_EXCLUSIVE=12.1
</code></pre><p>EM_PRESENT runs <code class="codeph">emremove.sql</code>:
                     </p><pre class="pre codeblock"><code>CHECK.EM_PRESENT.MIN_VERSION_INCLUSIVE=NONE
CHECK.EM_PRESENT.MAX_VERSION_EXCLUSIVE=12.1.0.1</code></pre><p>AMD_EXISTS CHECK runs <code class="codeph">catnoamd.sql</code>:
                     </p><pre class="pre codeblock"><code>CHECK.AMD_EXISTS.MIN_VERSION_INCLUSIVE=NONE 
CHECK.AMD_EXISTS.MAX_VERSION_EXCLUSIVE=NONE</code></pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="requirements-upgrading-databases-that-use-oracle-label-security-and-oracle-database-vault.html#GUID-8EEEB9FC-CEFC-451C-8EC7-4B6D03418B96" title="You must complete these tasks before starting an upgrade with a database using Oracle Label Security or Oracle Database Vault.">Requirements for Upgrading Databases That Use Oracle Label Security and Oracle Database Vault</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>