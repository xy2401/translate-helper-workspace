<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>ANSI Dynamic SQL</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Programmer's Guide">
      <meta property="og:description" content>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Programmer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="cobol-programmers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-11T02:40:40-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96466-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="applications.html" title="Previous" type="text/html">
      <link rel="next" href="Oracle-dynamic-SQL-method-4.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Pro*COBOL Programmer's Guide">
    <meta name="dcterms.isVersionOf" content="LNPCB">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="applications.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="Oracle-dynamic-SQL-method-4.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Programmer's Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="applications.html" property="item" typeof="WebPage"><span property="name">  Applications </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem"> ANSI Dynamic SQL</li>
            </ol>
            <a id="GUID-D6E9ACBE-EFF4-42F6-A855-B510004F4164" name="GUID-D6E9ACBE-EFF4-42F6-A855-B510004F4164"></a><a id="LNPCB010"></a>
            
            <h2 id="LNPCB-GUID-D6E9ACBE-EFF4-42F6-A855-B510004F4164" class="sect2"><span class="enumeration_chapter">10 </span> ANSI Dynamic SQL
            </h2>
         </header>
         <div class="ind">
            <div>
               <p><a id="d68132e21" class="indexterm-anchor"></a><a id="d68132e25" class="indexterm-anchor"></a><a id="d68132e29" class="indexterm-anchor"></a>This chapter describes Oracle's implementation of <a id="d68132e34" class="indexterm-anchor"></a>ANSI dynamic SQL (that is, dynamic SQL as specified by the SQL standard) which should be used for new Method 4 applications. It has enhancements over the older Oracle dynamic SQL Method 4, which is described in “Oracle Dynamic SQL: Method 4”. The ANSI Method 4 supports all Oracle types, while the older Oracle Method 4 does <span class="italic">not</span> support cursor variables, tables of group items, the DML returning clause, and LOBs.
               </p>
               <p>In ANSI dynamic SQL, descriptors are internally maintained by Oracle, while in the older Oracle dynamic SQL Method 4, descriptors are defined in the user's Pro*COBOL program. In both cases, with Method 4 your Pro*COBOL program accepts or builds SQL statements that contain a varying number of host variables.</p>
               <p>The main sections in this chapter are:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="ANSI-dynamic-SQL.html#GUID-11CE39E7-DC23-4AF4-80DE-436DD93D713A">Basics of ANSI Dynamic SQL</a></p>
                  </li>
                  <li>
                     <p><a href="ANSI-dynamic-SQL.html#GUID-C6A4A78D-1914-44CB-B7FC-9A808917F681">Overview of ANSI SQL Statements</a></p>
                  </li>
                  <li>
                     <p><a href="ANSI-dynamic-SQL.html#GUID-A68A8D42-8AB5-4EDF-B4FA-D57C95967D8E">Oracle Extensions</a></p>
                  </li>
                  <li>
                     <p><a href="ANSI-dynamic-SQL.html#GUID-696564A9-7206-4D4A-B78E-4A1375659239">ANSI Dynamic SQL Precompiler Options</a></p>
                  </li>
                  <li>
                     <p><a href="ANSI-dynamic-SQL.html#GUID-BF9199DA-04C3-48C1-B055-7682C13D2BE8">Full Syntax of the Dynamic SQL Statements</a></p>
                  </li>
                  <li>
                     <p><a href="ANSI-dynamic-SQL.html#GUID-754BE05E-F9C4-406E-B77C-7E4BF7F67EDC">Sample Programs: SAMPLE12.PCO</a></p>
                  </li>
               </ul>
            </div>
            <div>
               <div class="relinfo">
                  <p><strong>Related Topics</strong></p>
                  <ul>
                     <li><a href="Oracle-dynamic-SQL-method-4.html#GUID-C6256169-5928-466C-B7C7-960D20705EED">Oracle Dynamic SQL: Method 4</a></li>
                  </ul>
               </div>
            </div>
            <a id="LNPCB617"></a><div class="props_rev_3"><a id="GUID-11CE39E7-DC23-4AF4-80DE-436DD93D713A" name="GUID-11CE39E7-DC23-4AF4-80DE-436DD93D713A"></a><h3 id="LNPCB-GUID-11CE39E7-DC23-4AF4-80DE-436DD93D713A" class="sect3"><span class="enumeration_section">10.1 </span>Basics of ANSI Dynamic SQL
               </h3>
               <div>
                  <p>Consider the SQL statement:</p><pre class="oac_no_warn" dir="ltr">SELECT ename, empno FROM emp WHERE deptno = :deptno_data 
</pre><p>The steps you follow to use ANSI dynamic SQL are:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Declare variables, including a string to hold the statement to be executed.</p>
                     </li>
                     <li>
                        <p>Allocate descriptors for input and output variables.</p>
                     </li>
                     <li>
                        <p>Prepare the statement.</p>
                     </li>
                     <li>
                        <p>Describe input for the input descriptor.</p>
                     </li>
                     <li>
                        <p>Set the input descriptor (in our example the one input host bind variable, <code class="codeph">deptno_data)</code>.
                        </p>
                     </li>
                     <li>
                        <p>Declare and open a dynamic cursor.</p>
                     </li>
                     <li>
                        <p>Set the output descriptors (in our example, the output host variables <code class="codeph">ename </code>and <code class="codeph">empno)</code>.
                        </p>
                     </li>
                     <li>
                        <p>Repeatedly fetch data, using GET DESCRIPTOR to retrieve the <code class="codeph">ename</code> and <code class="codeph">empno</code> data fields from each row.
                        </p>
                     </li>
                     <li>
                        <p>Do something with the data retrieved (output it, for instance).</p>
                     </li>
                     <li>
                        <p>Close the dynamic cursor and deallocate the input and output descriptors.</p>
                     </li>
                  </ul>
               </div><a id="LNPCB618"></a><div class="props_rev_3"><a id="GUID-E6165C6C-EA44-4388-B080-13BEC7938601" name="GUID-E6165C6C-EA44-4388-B080-13BEC7938601"></a><h4 id="LNPCB-GUID-E6165C6C-EA44-4388-B080-13BEC7938601" class="sect4"><span class="enumeration_section">10.1.1 </span>Precompiler Options
                  </h4>
                  <div>
                     <p>Normally, if you are using ANSI dynamic SQL you will be writing to the ANSI standard for precompilers and will therefore be using the macro command line option <code class="codeph">MODE=ANSI</code>. If you wish to use this method and do not wish to use MODE=ANSI, then the functionality is controlled by the micro command line option: <code class="codeph">DYNAMIC=ANSI</code>. 
                     </p>
                     <p>You can either set the micro precompiler option DYNAMIC to ANSI, or set the macro option MODE to ANSI. This causes the default value of DYNAMIC to be ANSI. The other setting of DYNAMIC is <code class="codeph">ORACLE</code>. For more about micro options, see “Macro and Micro Options” and “<code class="codeph">DYNAMIC</code>”.
                     </p>
                     <p>In order to use ANSI type codes, set the precompiler micro option <code class="codeph">TYPE_CODE</code> to ANSI, or set the macro option <code class="codeph">MODE</code> to <code class="codeph">ANSI</code>. This changes the default setting of <code class="codeph">TYPE_CODE</code> to ANSI. To set <code class="codeph">TYPE_CODE</code> to <code class="codeph">ANSI</code>, <code class="codeph">DYNAMIC</code> must also be <code class="codeph">ANSI</code>.
                     </p>
                     <p>For a list of the <code class="codeph">ANSI SQL </code>types see “ANSI SQL Datatypes”. Use the <code class="codeph">ANSI</code> types with precompiler option <code class="codeph">TYPE_CODE</code> set to ANSI if you want your application to be portable across database platforms and be as compliant to <code class="codeph">ANSI</code> as possible. 
                     </p>
                     <p>For more details, see “<code class="codeph">MODE</code>” and “<code class="codeph">TYPE_CODE</code>”.
                     </p>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="precompiler-options.html#GUID-B8F5D2F9-D077-4CC0-B8A5-0B4CB1D6425D">Macro and Micro Options</a></li>
                           <li><a href="precompiler-options.html#GUID-2BD90C22-D39B-471D-BF6C-0CFD927BF8A5">DYNAMIC</a></li>
                           <li><a href="precompiler-options.html#GUID-976DED3A-3840-48A5-B5A8-35FB91BF2A0D">MODE</a></li>
                           <li><a href="precompiler-options.html#GUID-A2017FBB-772E-4272-A4F8-A40A5362C8CE">TYPE_CODE</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div>
            </div><a id="LNPCB620"></a><a id="LNPCB619"></a><div class="props_rev_3"><a id="GUID-C6A4A78D-1914-44CB-B7FC-9A808917F681" name="GUID-C6A4A78D-1914-44CB-B7FC-9A808917F681"></a><h3 id="LNPCB-GUID-C6A4A78D-1914-44CB-B7FC-9A808917F681" class="sect3"><span class="enumeration_section">10.2 </span>Overview of ANSI SQL Statements
               </h3>
               <div>
                  <div class="section">
                     <p>Allocate a descriptor area before using it in a dynamic SQL statement. </p>
                     <p>The ALLOCATE DESCRIPTOR statement syntax is:</p><pre class="oac_no_warn" dir="ltr">     EXEC SQL ALLOCATE DESCRIPTOR [GLOBAL | LOCAL] {<span class="italic">:desc_nam | string_literal</span>}
        [WITH MAX <span class="italic">{:occurrences </span>|<span class="italic"> numeric_literal}</span>]
     END-EXEC.
</pre><p>A global descriptor can be used in any module in the program. A local descriptor can be accessed only in the file in which it is allocated. Local is the default. </p>
                     <p>The descriptor name, <code class="codeph">desc_nam</code>, is a host variable. A string literal can be used instead.
                     </p>
                     <p><code class="codeph">occurrences</code> is the maximum number of bind variables or columns that the descriptor can hold, with a default of 100.
                     </p>
                     <p>When a descriptor is no longer needed, deallocate it to conserve memory. </p>
                     <p>The deallocate statement is:</p><pre class="oac_no_warn" dir="ltr">     EXEC SQL DEALLOCATE DESCRIPTOR [GLOBAL | LOCAL]
        {:<span class="italic">desc_nam </span>|<span class="italic"> string_literal</span>}
<span class="italic">     </span>END-EXEC.
</pre><p>Use the DESCRIBE statement to obtain information on a prepared SQL statement. DESCRIBE INPUT describes bind variables for the dynamic statement that has been prepared. DESCRIBE OUTPUT (the default) can give the number, type, and length of the output columns. The simplified syntax is:</p><pre class="oac_no_warn" dir="ltr">     EXEC SQL DESCRIBE [INPUT | OUTPUT] <span class="italic">sql_statement</span> 
        USING [SQL] DESCRIPTOR [GLOBAL | LOCAL] {:<span class="italic">desc_nam </span>|<span class="italic"> string_literal</span>}
     END-EXEC.
</pre><p>If your SQL statement has input and output values, you must allocate two descriptors: one for input and one for output values. If there are no input values, for example:</p><pre class="oac_no_warn" dir="ltr">SELECT ename, empno FROM emp 
</pre><p>then the input descriptor is not needed.</p>
                     <p>Use the SET DESCRIPTOR statement to specify input values for INSERTS, UPDATES, DELETES and the WHERE clauses of SELECT statements. Use SET DESCRIPTOR to set the number of input bind variables (stored in <span class="italic">COUNT</span>) when you have not done a DESCRIBE into your input descriptor: 
                     </p><pre class="oac_no_warn" dir="ltr">     EXEC SQL SET DESCRIPTOR [GLOBAL | LOCAL] {:<span class="italic">desc_nam </span>|<span class="italic"> string_literal</span>}<span class="italic"> </span>
        COUNT = {:<span class="italic">kount </span>|<span class="italic"> numeric_literal</span>} 
     END-EXEC.
</pre><p><code class="codeph">kount</code> can be a host variable or a numeric literal, such as 5. Use a SET DESCRIPTOR statement for each host variable, giving at least the data value of the variable:
                     </p><pre class="oac_no_warn" dir="ltr">     EXEC SQL SET DESCRIPTOR [GLOBAL | LOCAL] {<span class="italic">:desc_nam </span>|<span class="italic"> string_literal</span>}
        VALUE <span class="italic">item_number</span> DATA = :<span class="italic">hv3</span>
<span class="italic">     </span>END-EXEC.
</pre><p>You can also set the type and length of the input host variable:</p>
                     <p><span class="bold">Note:</span> If you do not set the type and length, either explicitly, through the SET DESCRIPTOR statement, or implicitly by doing a DESCRIBE OUTPUT, when TYPE_CODE=ORACLE, the precompiler will use values for these derived from the host variable itself. When TYPE_CODE=ANSI, you must set the type using the values in Table 10-1. You should also set the length because the ANSI default lengths may not match those of your host variable.
                     </p><pre class="oac_no_warn" dir="ltr">     EXEC SQL SET DESCRIPTOR [GLOBAL | LOCAL] {<span class="italic">:desc_nam </span>|<span class="italic"> string_literal</span>}
        VALUE <span class="italic">item_number</span> TYPE = :<span class="italic">hv1</span>, LENGTH = :<span class="italic">hv2</span>, DATA = :<span class="italic">hv3</span>
<span class="italic">     </span>END-EXEC.
</pre><p>We use the identifiers<code class="codeph"> hv1</code>, <code class="codeph">hv2</code>, and <code class="codeph">hv3 </code>to remind us that the values must be supplied by host variables. <span class="italic">item_number</span> is the position of the input variable in the SQL statement. It can be a host variable or an integer number.
                     </p>
                     <p>TYPE is the Type Code selected from the following table, if TYPE_CODE is set to ANSI:</p>
                  </div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-C6A4A78D-1914-44CB-B7FC-9A808917F681__CDDBDDFB">
                     <p class="titleintable">Table 10-1 ANSI SQL Datatypes</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="ANSI SQL Datatypes" summary="q" width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="31%" id="d68132e478">Datatype</th>
                              <th align="left" valign="bottom" width="69%" id="d68132e481">Type Code</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d68132e486" headers="d68132e478 ">
                                 <p>CHARACTER</p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d68132e486 d68132e481 ">
                                 <p>1</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d68132e493" headers="d68132e478 ">
                                 <p>CHARACTER VARYING</p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d68132e493 d68132e481 ">
                                 <p>12</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d68132e500" headers="d68132e478 ">
                                 <p>DATE</p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d68132e500 d68132e481 ">
                                 <p>9</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d68132e507" headers="d68132e478 ">
                                 <p>DECIMAL</p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d68132e507 d68132e481 ">
                                 <p>3</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d68132e514" headers="d68132e478 ">
                                 <p>DOUBLE PRECISION</p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d68132e514 d68132e481 ">
                                 <p>8</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d68132e521" headers="d68132e478 ">
                                 <p>FLOAT</p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d68132e521 d68132e481 ">
                                 <p>6</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d68132e528" headers="d68132e478 ">
                                 <p>INTEGER</p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d68132e528 d68132e481 ">
                                 <p>4</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d68132e535" headers="d68132e478 ">
                                 <p>NUMERIC</p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d68132e535 d68132e481 ">
                                 <p>2</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d68132e542" headers="d68132e478 ">
                                 <p>REAL</p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d68132e542 d68132e481 ">
                                 <p>7</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d68132e549" headers="d68132e478 ">
                                 <p>SMALLINT</p>
                              </td>
                              <td align="left" valign="top" width="69%" headers="d68132e549 d68132e481 ">
                                 <p>5</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p>See Table 11-2 for the Oracle type codes. Use the negative value of the Oracle code if the ANSI datatype is not in the table, and TYPE_CODE = ANSI.</p>
                     <p>DATA is the host variable value which is input.</p>
                     <p>You can also set other input values such as indicator, precision and scale. See the more complete discussion of “SET_DESCRIPTOR” for a list of all the possible descriptor item names.</p>
                     <p>The numeric values in the SET DESCRIPTOR statement must be declared as either <code class="codeph">PIC S9(9) COMP </code>or <code class="codeph">PIC S9(4) COMP</code> except for indicator and returned length values which you must declare as <code class="codeph">PIC S9(4)COMP</code>. 
                     </p>
                     <p>In the following example, when you want to retrieve empno, set these values: VALUE=2, because <code class="codeph">empno</code> is the second output host variable in the dynamic SQL statement. The host variable <code class="codeph">EMPNO-TYP</code> is set to 3 (Oracle Type for integer). The length of a host integer, <code class="codeph">EMPNO-LEN</code>, is set to 4, which is the size of the host variable. The DATA is equated to the host variable EMPNO-DATA which will receive the value from the database table. The code fragment is as follows:
                     </p><pre class="oac_no_warn" dir="ltr"> ... 
 01  DYN-STATEMENT PIC X(58)
     VALUE "SELECT ename, empno FROM emp WHERE deptno =:deptno_number".
 01  EMPNO-DATA PIC S9(9) COMP.
 01  EMPNO-TYP  PIC S9(9) COMP   VALUE 3.
 01  EMPNO-LEN  PIC S9(9) COMP   VALUE 4.
 ...
     EXEC SQL SET DESCRIPTOR 'out' VALUE 2  TYPE=:EMPNO-TYP, LENGTH=:EMPNO-LEN,
        DATA=:EMPNO-DATA END-EXEC.
 </pre><p>After setting the input values, execute or open your statement using the input descriptor. If there are output values in your statement, set them before doing a FETCH. If you have done a DESCRIBE OUTPUT, you may have to reset the actual types and lengths of your host variables because the DESCRIBE execution will produce internal types and lengths which differ from your host variable external types and length.</p>
                     <p>After the FETCH of the output descriptor, use GET DESCRIPTOR to access the returned data. Again we show a simplified syntax with details later in this chapter:</p><pre class="oac_no_warn" dir="ltr">     EXEC SQL GET DESCRIPTOR [GLOBAL | LOCAL] {<span class="italic">:desc_nam | string_literal</span>}
        VALUE <span class="italic">item_number </span>
<span class="italic">        </span>:<span class="italic">hv1 </span>= DATA, :<span class="italic">hv2 </span>= INDICATOR, :<span class="italic">hv3 </span>= RETURNED_LENGTH
     END-EXEC.
</pre><p><code class="codeph">desc_nam</code> and <code class="codeph">item_number</code> can be literals or host variables. A descriptor name can be a literal such as 'out'. An item number can be a numeric literal such as 2.
                     </p>
                     <p><code class="codeph">hv1, hv2, and hv3</code> are host variables. They must be host variables, not literals. Only three are shown in the example. See Table 10-4 for a list of all possible items of returned data that you can get.
                     </p>
                     <p>Use either<code class="codeph"> PIC S9(n) COMP </code>where n is the platform-dependent upper limit, <code class="codeph">PIC S9(9)COMP </code>or <code class="codeph">PIC S9(4)COMP</code>for all numeric values, except for indicator and returned length variables, which must be <code class="codeph">PIC S9(4) COMP</code>.
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="ANSI-dynamic-SQL.html#GUID-180E79CB-4D44-4A81-808A-7353715B176A">SET DESCRIPTOR</a></li>
                     </ul>
                  </div>
               </div>
               
            </div><a id="LNPCB621"></a><div class="props_rev_3"><a id="GUID-5AE6524C-F343-4ABD-A1C8-3452F2889000" name="GUID-5AE6524C-F343-4ABD-A1C8-3452F2889000"></a><h3 id="LNPCB-GUID-5AE6524C-F343-4ABD-A1C8-3452F2889000" class="sect3"><span class="enumeration_section">10.3 </span>Sample Code
               </h3>
               <div>
                  <p>The following example demonstrates the use of ANSI Dynamic SQL. It allocates an input descriptor <code class="codeph">in</code> and an output descriptor <code class="codeph">out</code> to execute a SELECT statement. Input values are set through the SET DESCRIPTOR statement. The cursor is opened and fetched from and the resulting output values are retrieved through a GET DESCRIPTOR statement.
                  </p><pre class="oac_no_warn" dir="ltr"> ... 
 01  DYN-STATEMENT PIC X(58)
     VALUE "SELECT ENAME, EMPNO FROM EMP WHERE DEPTNO =:DEPTNO-DAT".
 01  EMPNO-DAT  PIC S9(9) COMP.
 01  EMPNO-TYP  PIC S9(9) COMP   VALUE 3.
 01  EMPNO-LEN  PIC S9(9) COMP   VALUE 4.
 01  DEPTNO-TYP PIC S9(9) COMP   VALUE 3.
 01  DEPTNO-LEN PIC S9(9) COMP   VALUE 4.
 01  DEPTNO-DAT PIC S9(9) COMP   VALUE 10.
 01  ENAME-TYP  PIC S9(9) COMP   VALUE 3.
 01  ENAME-LEN  PIC S9(9) COMP   VALUE 30.
 01  ENAME-DAT  PIC X(30).
 01  SQLCODE PIC S9(9)    COMP   VALUE 0.
 ...
* Place preliminary code, including connection, here
...
     EXEC SQL ALLOCATE DESCRIPTOR 'in' END-EXEC.
     EXEC SQL ALLOCATE DESCRIPTOR 'out' END-EXEC.
     EXEC SQL PREPARE s FROM :DYN-STATEMENT END-EXEC.
     EXEC SQL DESCRIBE INPUT s USING DESCRIPTOR 'in' END-EXEC.
     EXEC SQL SET DESCRIPTOR 'in' VALUE 1 TYPE=:DEPTNO-TYP,
        LENGTH=:DEPTNO-LEN, DATA=:DEPTNO-DAT END-EXEC.
     EXEC SQL DECLARE c CURSOR FOR s END-EXEC.
     EXEC SQL OPEN c USING DESCRIPTOR 'in' END-EXEC.
     EXEC SQL DESCRIBE OUTPUT s USING DESCRIPTOR 'out' END-EXEC.
     EXEC SQL SET DESCRIPTOR 'out' VALUE 1 TYPE=:ENAME-TYP, 
        LENGTH=:ENAME-LEN, DATA=:ENAME-DAT END-EXEC.
     EXEC SQL SET DESCRIPTOR 'out' VALUE 2 TYPE=:EMPNO-TYP, 
        LENGTH=:EMPNO-LEN, DATA=:EMPNO-DAT END-EXEC.

     EXEC SQL WHENEVER NOT FOUND GOTO BREAK END-EXEC.
 LOOP.
     IF SQLCODE NOT = 0
        GOTO BREAK.
     EXEC SQL FETCH c INTO DESCRIPTOR 'out' END-EXEC.
     EXEC SQL GET DESCRIPTOR 'OUT' VALUE 1 :ENAME-DAT = DATA END-EXEC.
     EXEC SQL GET DESCRIPTOR 'OUT' VALUE 2 :EMPNO-DAT = DATA END-EXEC.
     DISPLAY "ENAME = " WITH NO ADVANCING
     DISPLAY ENAME-DAT  WITH NO ADVANCING
     DISPLAY "EMPNO = " WITH NO ADVANCING
     DISPLAY EMPNO-DAT.
     GOTO LOOP.
 BREAK:
     EXEC SQL CLOSE c END-EXEC.
     EXEC SQL DEALLOCATE DESCRIPTOR 'in' END-EXEC.
     EXEC SQL DEALLOCATE DESCRIPTOR 'out' END-EXEC.</pre></div>
            </div><a id="LNPCB622"></a><div class="props_rev_3"><a id="GUID-A68A8D42-8AB5-4EDF-B4FA-D57C95967D8E" name="GUID-A68A8D42-8AB5-4EDF-B4FA-D57C95967D8E"></a><h3 id="LNPCB-GUID-A68A8D42-8AB5-4EDF-B4FA-D57C95967D8E" class="sect3"><span class="enumeration_section">10.4 </span>Oracle Extensions
               </h3>
               <div>
                  <p>These extensions are described next:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Reference semantics for data items in SET statements.</p>
                     </li>
                     <li>
                        <p>Arrays for bulk operations.</p>
                     </li>
                     <li>
                        <p>Support for object types, NCHAR columns, and LOBs.</p>
                     </li>
                  </ul>
               </div><a id="LNPCB623"></a><div class="props_rev_3"><a id="GUID-2CF30CC9-3F6A-4A05-A9D3-2849FF35AEBF" name="GUID-2CF30CC9-3F6A-4A05-A9D3-2849FF35AEBF"></a><h4 id="LNPCB-GUID-2CF30CC9-3F6A-4A05-A9D3-2849FF35AEBF" class="sect4"><span class="enumeration_section">10.4.1 </span>Reference Semantics
                  </h4>
                  <div>
                     <div class="section">
                        <p>The ANSI standard specifies <span class="italic">value</span> semantics. To improve performance, Oracle has extended this standard to include <span class="italic">reference</span> semantics. 
                        </p>
                        <p>Value semantics makes a copy of your host variables data. Reference semantics uses the addresses of your host variables, avoiding a copy. Thus, reference semantics can provide performance improvements for large amounts of data.</p>
                        <p>To help speed up fetches, use the REF keyword before the data clauses:</p><pre class="oac_no_warn" dir="ltr">     EXEC SQL SET DESCRIPTOR 'out' VALUE 1 TYPE=:ENAME-TYP,
        LENGTH=:ENAME-LEN, REF DATA=:ENAME-DAT END-EXEC.
     EXEC SQL DESCRIPTOR 'out' VALUE 2 TYPE=:EMPNO-TYP,
        LENGTH=:EMPNO-LEN, REF DATA=:EMPNO-DAT END-EXEC.
</pre><p>Then the host variables receive the results of the retrieves. The GET statement is not needed. The retrieved data is written directly into <code class="codeph">ename_data</code> and <code class="codeph">empno_data</code> after each FETCH.
                        </p>
                        <p>Use of the REF keyword is allowed <span class="italic">only</span> before DATA, INDICATOR and RETURNED_LENGTH items (which can vary with each row fetched) as in this fragment of code:
                        </p><pre class="oac_no_warn" dir="ltr"> 01   INDI       PIC S9(4) COMP.
 01   RETRN-LEN  PIC S9(9) COMP.
 ...
      EXEC SQL SET DESCRIPTOR 'out' VALUE 1 TYPE=:ENAME-TYP,
         LENGTH=:ENAME-LEN, REF DATA=:ENAME-DAT,
         REF INDICATOR=:INDI, REF RETURNED_LENGTH =:RETRN-LEN END-EXEC.
</pre><p>After each fetch, <code class="codeph">RETRN-LEN </code>holds the actual retrieved length of the <code class="codeph">ename</code> field, which is useful for <code class="codeph">CHAR</code> or <code class="codeph">VARCHAR2 </code>data.
                        </p>
                        <p><code class="codeph">ENAME-LEN</code> will not receive the returned length. It will not be changed by the FETCH statement. Use a DESCRIBE statement, followed by a GET statement to find out the maximum column width before fetching rows of data.
                        </p>
                        <p>REF keyword is also used for other types of SQL statements than SELECT, to speed them up. Note that with reference semantics, the host variable is used rather than a value copied into the descriptor area. The host variable data at the time of execution of the SQL statement is used, not its data at the time of the SET. Here is an example:</p><pre class="oac_no_warn" dir="ltr">
 ...
     MOVE 1 to VAL.
 ...
     EXEC SQL SET DESCRIPTOR 'value' VALUE 1 DATA = :VAL END-EXEC.
     EXEC SQL SET DESCRIPTOR 'reference' VALUE 1 REF DATA = :VAL END-EXEC.
     MOVE 2 to VAL.
* Will use  VAL = 1
     EXEC SQL EXECUTE s USING  DESCRIPTOR 'value' END-EXEC.
*Will use VAL = 2
     EXEC SQL EXECUTE s USING DESCRIPTOR 'reference' END-EXEC.
</pre><p>See “SET_DESCRIPTOR” for many more details on the differences.</p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="ANSI-dynamic-SQL.html#GUID-180E79CB-4D44-4A81-808A-7353715B176A">SET DESCRIPTOR</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div><a id="LNPCB624"></a><div class="props_rev_3"><a id="GUID-88BE9B20-8BF1-42AA-84CA-9B46D6562B6F" name="GUID-88BE9B20-8BF1-42AA-84CA-9B46D6562B6F"></a><h4 id="LNPCB-GUID-88BE9B20-8BF1-42AA-84CA-9B46D6562B6F" class="sect4"><span class="enumeration_section">10.4.2 </span>Using Tables for Bulk Operations
                  </h4>
                  <div>
                     <div class="section">
                        <p>Oracle's implementation of ANSI dynamic SQL extends the SQL standard's dynamic SQL by providing bulk operations. To use bulk operations, use the <code class="codeph">FOR</code> clause with an array size to specify the amount of input data or the number of rows you want to process.
                        </p>
                        <p>The <code class="codeph">FOR</code> clause is used in the ALLOCATE statement to give the maximum amount of data or number of rows. For example, to use a maximum array size of 100:
                        </p><pre class="oac_no_warn" dir="ltr">     EXEC SQL FOR 100 ALLOCATE DESCRIPTOR 'out' END-EXEC.
</pre><p>or:</p><pre class="oac_no_warn" dir="ltr">     MOVE 100 TO INT-ARR-SIZE.
     EXEC SQL FOR :INT-ARR-SIZE ALLOCATE DESCRIPTOR 'out' END-EXEC.
</pre><p>The <code class="codeph">FOR </code>clause is then used in subsequent statements that access the descriptor. In an output descriptor the FETCH statement must have an array size equal to or less than the array size already used in the ALLOCATE statement:
                        </p><pre class="oac_no_warn" dir="ltr">     EXEC SQL FOR 20 FETCH c1 USING DESCRIPTOR 'out' END-EXEC.
</pre><p>Subsequent GET statements for the same descriptor, that get DATA, INDICATOR, or RETURNED_LENGTH values, must use the same array size as the FETCH statement.</p><pre class="oac_no_warn" dir="ltr"> 01  VAL-DATA   OCCURS 20 TIMES  PIC S9(9) COMP.
 01  VAL-INDI   OCCURS 20 TIMES  PIC S9(4) COMP.
...
     EXEC SQL FOR 20 GET DESCRIPTOR 'out' VALUE 1 :VAL-DATA = DATA,
       :VAL-INDI = INDICATOR 
     END-EXEC.
</pre><p>However, GET statements that reference other items which do not vary from row to row, such as LENGTH, TYPE and COUNT, must <span class="italic">not</span> use the <code class="codeph">FOR</code> clause:
                        </p><pre class="oac_no_warn" dir="ltr"> 01  CNT  PIC S9(9) COMP.
 01  LEN  PIC S9(9) COMP.
...
     EXEC SQL GET DESCRIPTOR 'out'   :CNT = COUNT END-EXEC.
     EXEC SQL GET DESCRIPTOR 'out' VALUE 1 :LEN = LENGTH END-EXEC.
</pre><p>The same holds true for SET statements with reference semantics. SET statements which precede the FETCH and employ reference semantics for DATA, INDICATOR, or RETURNED_LENGTH must have the same array size as the FETCH:</p><pre class="oac_no_warn" dir="ltr"> ... 
 01  REF-DATA   OCCURS 20 TIMES  PIC S9(9) COMP.
 01  REF-INDI   OCCURS 20 TIMES  PIC S9(4) COMP.
...
     EXEC SQL FOR 20 SET DESCRIPTOR 'out' VALUE 1 REF DATA = :REF-DATA,
        REF INDICATOR = :REF-INDI END-EXEC.
</pre><p>Similarly, for a descriptor that is used for input, to insert a batch of rows, for instance, the EXECUTE or OPEN statement must use an array size equal to or less than the size used in the ALLOCATE statement. The SET statement, for both value and reference semantics, that accesses DATA, INDICATOR, or RETURNED_LENGTH must use the same array size as in the EXECUTE statement.</p>
                        <p>The FOR clause is never used on the DEALLOCATE or PREPARE statements.</p>
                        <p>The following code sample illustrates a bulk operation with no output descriptor (there is no output, only input to be inserted into the table <code class="codeph">emp</code>). The value of <code class="codeph">CNT</code> is 2 (there are two host variables, <code class="codeph">ENAME and EMPNO</code>, in the INSERT statement). The data table <code class="codeph">ENAME-TABLE</code> holds three character strings: <code class="codeph">Tom</code>, <code class="codeph">Dick</code> and <code class="codeph">Harry</code>, in that order. Their employee numbers are in the table <code class="codeph">EMPNO-TABLE</code>. The indicator table <code class="codeph">ENAME-IND</code> has a value of -1 for the second element; so a <code class="codeph">NULL</code> will be inserted instead of <code class="codeph">Dick</code>.
                        </p><pre class="oac_no_warn" dir="ltr"> 01  DYN-STATEMENT  PIC X(240) value 
         "INSERT INTO EMP(ENAME, EMPNO) VALUES (:ENAME,:EMPNO)". 
 01  ARRAY-SIZE PIC S9(9) COMP   VALUE 3. 
 01  ENAME-VALUES. 
      05 FILLER PIC X(6)   VALUE "Tom   ". 
      05 FILLER PIC X(6)   VALUE "Dick  ". 
      05 FILLER PIC X(6)   VALUE "Harry ". 
 01  ENAME-TABLE REDEFINES ENAME-VALUES. 
      05 ENAME  PIC X(6)OCCURS 3 TIMES. 
 01  ENAME-IND  PIC S9(4) COMPOCCURS 3 TIMES. 
 01  ENAME-LEN  PIC S9(9) COMP   VALUE   6. 
 01  ENAME-TYP  PIC S9(9) COMP   VALUE  96. 
 01  EMPNO-VALUES. 
      05 FILLER PIC S9(9) COMP   VALUE 8001. 
      05 FILLER PIC S9(9) COMP   VALUE 8002. 
      05 FILLER PIC S9(9) COMP   VALUE 8003. 
 01  EMPNO-TABLE REDEFINES EMPNO-VALUES. 
      05 EMPNO  PIC S9(9) DISPLAY SIGN LEADING  OCCURS 3 TIMES. 
 01  EMPNO-LEN  PIC S9(9) COMP   VALUE   4. 
 01  EMPNO-TYP  PIC S9(9) COMP   VALUE   3. 
 01  CNT        PIC S9(9) COMP   VALUE   2. 
........ 
     EXEC SQL FOR :ARRAY-SIZE ALLOCATE DESCRIPTOR 'in' END-EXEC.  
     EXEC SQL PREPARE S FROM :DYN-STATEMENT  END-EXEC. 
     MOVE 0 TO ENAME-IND(1). 
     MOVE -1 TO ENAME-IND(2). 
     MOVE 0 TO ENAME-IND(3). 
     EXEC SQL SET DESCRIPTOR 'in' COUNT = :CNT END-EXEC. 
     EXEC SQL SET DESCRIPTOR 'in' VALUE 1  
        TYPE = :ENAME-TYP, LENGTH =:ENAME-LEN 
     END-EXEC. 
     EXEC SQL FOR :ARRAY-SIZE  SET DESCRIPTOR 'in' VALUE 1 
        DATA = :ENAME, INDICATOR = :ENAME-IND  
     END-EXEC. 
     EXEC SQL SET DESCRIPTOR 'in' VALUE 2  
        TYPE = :EMPNO-TYP, LENGTH =:EMPNO-LEN 
     END-EXEC. 
     EXEC SQL FOR :ARRAY-SIZE  SET DESCRIPTOR 'in' VALUE 2 
        DATA = :EMPNO  
     END-EXEC. 
     EXEC SQL FOR :ARRAY-SIZE EXECUTE S  
        USING DESCRIPTOR 'in' END-EXEC. 
  ...
</pre><p>The preceding code inserts these values into the table: </p><pre class="oac_no_warn" dir="ltr">      EMPNO   ENAME 
      8001    Tom        
      8002            
      8003    Harry      
</pre><p> See the discussion in “The FOR Clause” for restrictions and cautions.</p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="host-tables.html#GUID-81265F69-2532-4014-A048-BF0739CC8486">The FOR Clause</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div>
            </div><a id="LNPCB626"></a><a id="LNPCB627"></a><a id="LNPCB625"></a><div class="props_rev_3"><a id="GUID-696564A9-7206-4D4A-B78E-4A1375659239" name="GUID-696564A9-7206-4D4A-B78E-4A1375659239"></a><h3 id="LNPCB-GUID-696564A9-7206-4D4A-B78E-4A1375659239" class="sect3"><span class="enumeration_section">10.5 </span>ANSI Dynamic SQL Precompiler Options
               </h3>
               <div>
                  <div class="section">
                     <p><a id="d68132e975" class="indexterm-anchor"></a>The macro option MODE (See “MODE”) sets ANSI compatibility characteristics and controls a number of functions. It can have the values ANSI or ORACLE. For individual functions there are micro options that override the MODE setting.
                     </p>
                     <p><a id="d68132e981" class="indexterm-anchor"></a><a id="d68132e985" class="indexterm-anchor"></a>The precompiler micro option <span class="italic">DYNAMIC</span> specifies the descriptor behavior in dynamic SQL. The precompiler micro option <span class="italic">TYPE_CODE</span> specifies whether ANSI or Oracle datatype codes are to be used. 
                     </p>
                     <p>When the macro option MODE is set to ANSI, the micro option DYNAMIC becomes ANSI automatically. When MODE is set to ORACLE, DYNAMIC becomes ORACLE. </p>
                     <p>DYNAMIC and TYPE_CODE cannot be used inline.</p>
                     <p>The following table describes how the <a id="d68132e1002" class="indexterm-anchor"></a>DYNAMIC setting affects various functionality:
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-696564A9-7206-4D4A-B78E-4A1375659239__GUID-71822BAF-1401-4568-8C9B-E9D152E2C927">
                     <p class="titleintable">Table 10-2 DYNAMIC Option Settings</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="DYNAMIC Option Settings" summary="q" width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="26%" id="d68132e1018">Function</th>
                              <th align="left" valign="bottom" width="31%" id="d68132e1021">DYNAMIC=ANSI</th>
                              <th align="left" valign="bottom" width="44%" id="d68132e1024">DYNAMIC=ORACLE</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d68132e1029" headers="d68132e1018 ">
                                 <p>Descriptor creation.</p>
                              </td>
                              <td align="left" valign="top" width="31%" headers="d68132e1029 d68132e1021 ">
                                 <p>Must use ALLOCATE statement.</p>
                              </td>
                              <td align="left" valign="top" width="44%" headers="d68132e1029 d68132e1024 ">
                                 <p>Must use an Oracle format descriptor.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d68132e1039" headers="d68132e1018 ">
                                 <p>Descriptor destruction.</p>
                              </td>
                              <td align="left" valign="top" width="31%" headers="d68132e1039 d68132e1021 ">
                                 <p>May use DEALLOCATE statement.</p>
                              </td>
                              <td align="left" valign="top" width="44%" headers="d68132e1039 d68132e1024 ">
                                 <p>N/A</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d68132e1049" headers="d68132e1018 ">
                                 <p>Retrieving data.</p>
                              </td>
                              <td align="left" valign="top" width="31%" headers="d68132e1049 d68132e1021 ">
                                 <p>May use both FETCH and GET statements.</p>
                              </td>
                              <td align="left" valign="top" width="44%" headers="d68132e1049 d68132e1024 ">
                                 <p>Must use only FETCH statement.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d68132e1059" headers="d68132e1018 ">
                                 <p>Setting input data.</p>
                              </td>
                              <td align="left" valign="top" width="31%" headers="d68132e1059 d68132e1021 ">
                                 <p>May use DESCRIBE INPUT statement. Must use SET statement.</p>
                              </td>
                              <td align="left" valign="top" width="44%" headers="d68132e1059 d68132e1024 ">
                                 <p>Must set descriptor values in code. Must use DESCRIBE BIND VARIABLES statement.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d68132e1069" headers="d68132e1018 ">
                                 <p>Descriptor representation.</p>
                              </td>
                              <td align="left" valign="top" width="31%" headers="d68132e1069 d68132e1021 ">
                                 <p>Single quoted literal or host identifier which contains the descriptor name. </p>
                              </td>
                              <td align="left" valign="top" width="44%" headers="d68132e1069 d68132e1024 ">
                                 <p>Host variable, a pointer to SQLDA.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="26%" id="d68132e1079" headers="d68132e1018 ">
                                 <p>Data types available.</p>
                              </td>
                              <td align="left" valign="top" width="31%" headers="d68132e1079 d68132e1021 ">
                                 <p>All ANSI types except BIT and all Oracle types.</p>
                              </td>
                              <td align="left" valign="top" width="44%" headers="d68132e1079 d68132e1024 ">
                                 <p>Oracle types except objects, LOBs, and cursor variables.</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="section">
                     <p>The micro option TYPE_CODE is set by the precompiler to the same setting as the macro option MODE. TYPE_CODE can only equal ANSI if DYNAMIC equals ANSI.</p>
                     <p><a id="d68132e1092" class="indexterm-anchor"></a>The following table shows the functionality corresponding to the TYPE_CODE settings.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="tblformal" id="GUID-696564A9-7206-4D4A-B78E-4A1375659239__G1016234">
                     <p class="titleintable">Table 10-3 TYPE_CODE Option Settings</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="TYPE_CODE Option Settings" summary="q" width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="31%" id="d68132e1108">Function</th>
                              <th align="left" valign="bottom" width="34%" id="d68132e1111">TYPE_CODE=ANSI</th>
                              <th align="left" valign="bottom" width="35%" id="d68132e1114">TYPE_CODE=ORACLE</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="31%" id="d68132e1119" headers="d68132e1108 ">
                                 <p>Data type code numbers input and returned in dynamic SQL. </p>
                              </td>
                              <td align="left" valign="top" width="34%" headers="d68132e1119 d68132e1111 ">
                                 <p>Use ANSI code numbers when ANSI type exists. Otherwise, use the negative of the Oracle code number.</p>
                                 <p>Only valid when DYNAMIC=ANSI.</p>
                              </td>
                              <td align="left" valign="top" width="35%" headers="d68132e1119 d68132e1114 ">
                                 <p>Use Oracle code numbers.</p>
                                 <p>May be used regardless of the setting of DYNAMIC.</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="precompiler-options.html#GUID-976DED3A-3840-48A5-B5A8-35FB91BF2A0D">MODE</a></li>
                     </ul>
                  </div>
               </div>
               
            </div><a id="LNPCB628"></a><div class="props_rev_3"><a id="GUID-BF9199DA-04C3-48C1-B055-7682C13D2BE8" name="GUID-BF9199DA-04C3-48C1-B055-7682C13D2BE8"></a><h3 id="LNPCB-GUID-BF9199DA-04C3-48C1-B055-7682C13D2BE8" class="sect3"><span class="enumeration_section">10.6 </span>Full Syntax of the Dynamic SQL Statements
               </h3>
               <div>
                  <div class="section">
                     <p>For more details on all these statements, see the alphabetical listing in the appendix “Embedded SQL Statements and Precompiler Directives”.</p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="embedded-SQL-statements-and-precompiler-directives.html#GUID-F5251483-48EC-4B39-8E14-68F65480B16B">Embedded SQL Statements and Precompiler Directives</a></li>
                     </ul>
                  </div>
               </div>
               <a id="LNPCB630"></a><a id="LNPCB631"></a><a id="LNPCB629"></a><div class="props_rev_3"><a id="GUID-74B34D46-6D98-44AB-A2E8-3E7A31F07E8A" name="GUID-74B34D46-6D98-44AB-A2E8-3E7A31F07E8A"></a><h4 id="LNPCB-GUID-74B34D46-6D98-44AB-A2E8-3E7A31F07E8A" class="sect4"><span class="enumeration_section">10.6.1 </span>ALLOCATE DESCRIPTOR
                  </h4>
                  <div>
                     <div class="section">
                        <p>This statement is used only for ANSI dynamic SQL.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-74B34D46-6D98-44AB-A2E8-3E7A31F07E8A__GUID-041A3C6D-8F2C-453E-AC44-EFE35C857849">Purpose</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>Use this statement to allocate a SQL descriptor area. Supply a descriptor, the maximum number of occurrences of host bind items, and an array size. </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-74B34D46-6D98-44AB-A2E8-3E7A31F07E8A__GUID-8B51CA05-1EB8-4348-8296-9F23FA4BA964">Syntax</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">     EXEC SQL [FOR [:]array_size] ALLOCATE DESCRIPTOR [GLOBAL | LOCAL]
        {:desc_nam | string_literal} [WITH MAX occurrences]
     END-EXEC.</pre></div>
                     <!-- class="section" -->
                  </div><a id="LNPCB632"></a><div class="props_rev_3"><a id="GUID-64F0C92F-0F19-4554-AD64-C61DEF697DFF" name="GUID-64F0C92F-0F19-4554-AD64-C61DEF697DFF"></a><h5 id="LNPCB-GUID-64F0C92F-0F19-4554-AD64-C61DEF697DFF" class="sect5"><span class="enumeration_section">10.6.1.1 </span>Variables
                     </h5>
                     <div>
                        <div class="section">
                           <p>A number of variables can be used with the ALLOCATE descriptor. These include: array_size, desc_nam, and occurrences.</p>
                           <dl>
                              <dt class="dlterm"><a name="GUID-64F0C92F-0F19-4554-AD64-C61DEF697DFF__GUID-53249AC6-E895-426E-BA91-F074E67F0E0A">
                                    <!-- --></a>array_size
                              </dt>
                              <dd>
                                 <p>The optional array_size clause (an Oracle extension) supports table processing. It tells the precompiler that the descriptor is usable for table processing.</p><pre class="oac_no_warn" dir="ltr"> GLOBAL | LOCAL</pre><p>The optional scope clause defaults to LOCAL if not entered. A local descriptor can be accessed only in the file in which it is allocated. A global descriptor can be used in any module in the compilation unit.</p>
                              </dd>
                              <dt class="dlterm"><a name="GUID-64F0C92F-0F19-4554-AD64-C61DEF697DFF__GUID-25969DA4-4014-4370-A8E6-026E1C7F3FC8">
                                    <!-- --></a>desc_nam
                              </dt>
                              <dd>
                                 <p>The desc_nam variable defines the local descriptors that must be unique in the module. A runtime error is generated if the descriptor has been previously allocated, but not deallocated. A global descriptor must be unique for the application or a runtime error results.</p>
                              </dd>
                              <dt class="dlterm"><a name="GUID-64F0C92F-0F19-4554-AD64-C61DEF697DFF__GUID-E5E67886-5E2A-4847-8E29-8494B5005073">
                                    <!-- --></a>occurrences
                              </dt>
                              <dd>
                                 <p>The optional occurrences clause is the maximum number of host variables possible in the descriptor. The occurrences variable must be an integer constant between 0 and 64K, or an error is returned. The default is 100. A precompiler error results if it does not conform to these rules.</p>
                              </dd>
                           </dl>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="LNPCB633"></a><div class="props_rev_3"><a id="GUID-F762CFB0-8B2B-4DE4-A87F-29153F3EF882" name="GUID-F762CFB0-8B2B-4DE4-A87F-29153F3EF882"></a><h5 id="LNPCB-GUID-F762CFB0-8B2B-4DE4-A87F-29153F3EF882" class="sect5"><span class="enumeration_section">10.6.1.2 </span> Examples
                     </h5>
                     <div><pre class="oac_no_warn" dir="ltr">     EXEC SQL ALLOCATE DESCRIPTOR 'SELDES' WITH MAX 50 END-EXEC.

     EXEC SQL FOR :BATCH ALLOCATE DESCRIPTOR GLOBAL :BINDDES WITH MAX 25
        END-EXEC.</pre></div>
                  </div>
               </div><a id="LNPCB635"></a><a id="LNPCB636"></a><a id="LNPCB637"></a><a id="LNPCB638"></a><a id="LNPCB634"></a><div class="props_rev_3"><a id="GUID-606A2B8D-0E34-486A-8595-4556693EEFD5" name="GUID-606A2B8D-0E34-486A-8595-4556693EEFD5"></a><h4 id="LNPCB-GUID-606A2B8D-0E34-486A-8595-4556693EEFD5" class="sect4"><span class="enumeration_section">10.6.2 </span>DEALLOCATE DESCRIPTOR
                  </h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-606A2B8D-0E34-486A-8595-4556693EEFD5__GUID-FB9F32B9-CD1C-41DF-B830-B1D1E81C2926">Purpose</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>To free memory, use the deallocate statement. This statement deallocates a previously allocated SQL descriptor area.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-606A2B8D-0E34-486A-8595-4556693EEFD5__GUID-7FE48556-4A8B-4207-8E5C-49DF6D31A897">Syntax</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">     EXEC SQL DEALLOCATE DESCRIPTOR [GLOBAL | LOCAL] 
        {<span class="italic">:desc_nam </span>| <span class="italic">string_literal</span>}
     END-EXEC.</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-606A2B8D-0E34-486A-8595-4556693EEFD5__GUID-1C133685-3386-4C5D-B3B6-7A94B32BAA5E">Variables</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <dl>
                           <dt class="dlterm"><a name="GUID-606A2B8D-0E34-486A-8595-4556693EEFD5__GUID-D5EF62E7-E530-410E-AB4C-55BD3A8E7C88">
                                 <!-- --></a>desc_nam
                           </dt>
                           <dd>
                              <p>The only variable available with the deallocate descriptor is desc_nam (for descriptor name.) A runtime error results when a descriptor with the same name and scope has not been allocated, or has already been allocated and deallocated. </p>
                           </dd>
                        </dl>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-606A2B8D-0E34-486A-8595-4556693EEFD5__GUID-6FD4605F-FB3D-4F7F-8CFD-678B2C426D84">Examples</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">     EXEC SQL DEALLOCATE DESCRIPTOR GLOBAL 'SELDES' END-EXEC.

     EXEC SQL DEALLOCATE DESCRIPTOR :BINDDES END-EXEC.</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCB640"></a><a id="LNPCB641"></a><a id="LNPCB642"></a><a id="LNPCB643"></a><a id="LNPCB644"></a><a id="LNPCB645"></a><a id="LNPCB646"></a><a id="LNPCB647"></a><a id="LNPCB639"></a><div class="props_rev_3"><a id="GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8" name="GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8"></a><h4 id="LNPCB-GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8" class="sect4"><span class="enumeration_section">10.6.3 </span>GET DESCRIPTOR
                  </h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8__GUID-93CE6528-7E78-45F9-BA7A-3DA1730CB66D">Purpose</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>Use to obtain information from a SQL descriptor area.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8__GUID-FAE28D06-E5FD-4069-9B7B-5140DCEA4FC3">Syntax</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">     EXEC SQL [FOR [:]<span class="italic">array_size</span>] GET DESCRIPTOR [GLOBAL | LOCAL]
     <span class="italic">   </span>{<span class="italic">:desc_nam </span>|<span class="italic"> string_literal</span>}
        {:<span class="italic">hv0</span>  = COUNT | VALUE <span class="italic">item_number</span> :<span class="italic">hv1</span> = <span class="italic">item_name1</span> 
        [{, :<span class="italic">hvN</span> = <span class="italic">item_nameN </span>}]}
     END-EXEC.</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8__GUID-CA805249-06E1-4205-B84A-4403F48706D0">Variables</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <dl>
                           <dt class="dlterm"><a name="GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8__GUID-E19C8BDA-D025-48EC-8044-A6DF8A5160F9">
                                 <!-- --></a>array_size
                           </dt>
                           <dd>
                              <p>The <code class="codeph">FOR array_size</code> variable is an optional Oracle extension.<code class="codeph"> FOR array_size</code> has to be equal to the <code class="codeph">array_size</code> field in the FETCH statement.
                              </p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8__GUID-290C9798-435A-4F72-8041-8100DFA846F3">
                                 <!-- --></a>desc_nam
                           </dt>
                           <dd>
                              <p>The descriptor name.</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8__GUID-1FFDF537-9791-4EFC-B32E-1CE5D1BD57AD">
                                 <!-- --></a>GLOBAL | LOCAL
                           </dt>
                           <dd>
                              <p>GLOBAL means that the descriptor name is known to all program files. LOCAL means that it is known only in the file in which it is allocated. LOCAL is the default.</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8__GUID-1563DE43-953A-4DF1-BDA4-A6F18351BB1D">
                                 <!-- --></a>COUNT 
                           </dt>
                           <dd>
                              <p>The total number of bind variables. </p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8__GUID-5F5456DD-B702-4400-AB16-8DF92DEDB7E6">
                                 <!-- --></a>VALUE item_number
                           </dt>
                           <dd>
                              <p>The position of the item in the SQL statement. <code class="codeph">item_number</code> can be a variable or a constant. If<code class="codeph"> item_number</code> is greater than <code class="codeph">COUNT</code>, the "no data found" condition is returned. <code class="codeph">item_number</code> must be greater than 0.
                              </p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8__GUID-05E4B948-8574-4370-9C75-3A324CDC3BA5">
                                 <!-- --></a>hv1 .. hvN
                           </dt>
                           <dd>
                              <p>These are host variables to which values are transferred.</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8__GUID-0D3A963E-8D87-4748-A798-7E4CD97F0A90">
                                 <!-- --></a>item_name1 .. item_nameN
                           </dt>
                           <dd>
                              <p>The descriptor item names corresponding to the host variables. The possible ANSI descriptor item names<code class="codeph"> </code>are listed in the following table.
                              </p>
                           </dd>
                        </dl>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8__G1028984">
                        <p class="titleintable">Table 10-4 Definitions of Descriptor Item Names</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="Definitions of Descriptor Item Names" summary="q" width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="31%" id="d68132e1521">Descriptor Item Name</th>
                                 <th align="left" valign="bottom" width="69%" id="d68132e1525">Meaning</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1531" headers="d68132e1521 ">
                                    <p><code class="codeph">TYPE</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1531 d68132e1525 ">
                                    <p>See Table 10-1 for the ANSI type codes. See Table 11-2 for the Oracle type codes. Use the negative value of the Oracle code if the ANSI datatype is not in the table, and TYPE_CODE = ANSI.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1539" headers="d68132e1521 ">
                                    <p><code class="codeph">LENGTH</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1539 d68132e1525 ">
                                    <p>Length of data in the column. In characters for NCHAR, and otherwise in bytes. Set by the DESCRIBE OUTPUT.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1547" headers="d68132e1521 ">
                                    <p><code class="codeph">OCTET_LENGTH</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1547 d68132e1525 ">
                                    <p>Length of data in bytes.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1555" headers="d68132e1521 ">
                                    <p><code class="codeph">RETURNED_LENGTH</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1555 d68132e1525 ">
                                    <p>The actual data length after a FETCH. It is undefined for fixed-length character types.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1563" headers="d68132e1521 ">
                                    <p><code class="codeph">RETURNED_OCTET_LENGTH</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1563 d68132e1525 ">
                                    <p>Length of the returned data in bytes.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1571" headers="d68132e1521 ">
                                    <p><code class="codeph">PRECISION</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1571 d68132e1525 ">
                                    <p>The number of digits.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1579" headers="d68132e1521 ">
                                    <p><code class="codeph">SCALE</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1579 d68132e1525 ">
                                    <p>For exact numeric types, the number of digits to the right of the decimal point.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1587" headers="d68132e1521 ">
                                    <p><code class="codeph">NULLABLE</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1587 d68132e1525 ">
                                    <p>If 1, the column can have NULL values. If 0, the column cannot have NULL values.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1595" headers="d68132e1521 ">
                                    <p><code class="codeph">INDICATOR</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1595 d68132e1525 ">
                                    <p>The associated indicator value.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1603" headers="d68132e1521 ">
                                    <p><code class="codeph">DATA</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1603 d68132e1525 ">
                                    <p>The data value.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1611" headers="d68132e1521 ">
                                    <p><code class="codeph">NAME</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1611 d68132e1525 ">
                                    <p>Column name.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1620" headers="d68132e1521 ">
                                    <p><code class="codeph">CHARACTER_SET_NAME</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1620 d68132e1525 ">
                                    <p>Column's character set.</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="section">
                        <p>The following table lists the Oracle extensions to the descriptor item names.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8__G1030681">
                        <p class="titleintable">Table 10-5 Oracle Extensions to Definitions of Descriptor Item Names</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="Oracle Extensions to Definitions of Descriptor Item Names" summary="q" width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="31%" id="d68132e1640">Descriptor Item Name</th>
                                 <th align="left" valign="bottom" width="69%" id="d68132e1644">Meaning</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1650" headers="d68132e1640 ">
                                    <p><code class="codeph">NATIONAL_CHARACTER</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1650 d68132e1644 ">
                                    <p>If 2, NCHAR or NVARCHAR2. If 1, character. If 0, non-character.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1658" headers="d68132e1640 ">
                                    <p><code class="codeph">INTERNAL_LENGTH</code></p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1658 d68132e1644 ">
                                    <p>The internal length, in bytes.</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8__GUID-ECD3B728-ED6C-4675-B58B-FBE55000578B">Usage Notes</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>Use the FOR clause in GET DESCRIPTOR statements which contain DATA, INDICATOR, and RETURNED_LENGTH items only. </p>
                        <p>The internal type is provided by the DESCRIBE OUTPUT statement. For both input and output, you must set the type to be the external type of your host variable. TYPE is the Oracle or ANSI code in Table 10-1. You will receive the negative value of the Oracle type code if the ANSI type is not in the table.</p>
                        <p>LENGTH contains the column length in characters for fields that have fixed-width National Language character sets. It is in bytes for other character columns. It is set in DESCRIBE OUTPUT.</p>
                        <p>RETURNED_LENGTH is the actual data length set by the FETCH statement. It is in bytes or characters as described for LENGTH. The fields OCTET_LENGTH and RETURNED_OCTET_LENGTH are the lengths in bytes.</p>
                        <p>NULLABLE = 1 means that the column can have NULLS; NULLABLE = 0 means it cannot.</p>
                        <p>CHARACTER_SET_NAME only has meaning for character columns. For other types, it is undefined. The DESCRIBE OUTPUT statement obtains the value.</p>
                        <p>DATA and INDICATOR are the data value and the indicator status for that column. If data = NULL, but the indicator was not requested, an error is generated at runtime ("DATA EXCEPTION, NULL VALUE, NO INDICATOR PARAMETER").</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8__GUID-AC3EBDCA-2A07-4EB6-AAFA-89715EF8D973">Oracle-specific Descriptor Item Names</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>NATIONAL_CHARACTER =  2 if the column is an NCHAR or NVARCHAR2 column. If the column is a character (but not National Character) column, this item is set to 1. If a non-character column, this item becomes 0 after DESCRIBE OUTPUT is executed.</p>
                        <p>INTERNAL_LENGTH is for compatibility with Oracle dynamic Method 4. It has the same value as the length member of the Oracle descriptor area. See “Oracle Dynamic SQL: Method 4”.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8__GUID-0B41E461-80C6-4201-A126-A4EAF78362BD">Examples</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">     EXEC SQL GET DESCRIPTOR :BINDDES :COUNT = COUNT END-EXEC.

     EXEC SQL GET DESCRIPTOR 'SELDES' VALUE 1 :TYP = TYPE, :LEN = LENGTH
        END-EXEC.

     EXEC SQL FOR :BATCH GET DESCRIPTOR LOCAL 'SELDES'
        VALUE :SEL-ITEM-NO :IND = INDICATOR, :DAT = DATA END-EXEC. </pre></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="Oracle-dynamic-SQL-method-4.html#GUID-C6256169-5928-466C-B7C7-960D20705EED">Oracle Dynamic SQL: Method 4</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div><a id="LNPCB649"></a><a id="LNPCB650"></a><a id="LNPCB651"></a><a id="LNPCB652"></a><a id="LNPCB653"></a><a id="LNPCB654"></a><a id="LNPCB648"></a><div class="props_rev_3"><a id="GUID-180E79CB-4D44-4A81-808A-7353715B176A" name="GUID-180E79CB-4D44-4A81-808A-7353715B176A"></a><h4 id="LNPCB-GUID-180E79CB-4D44-4A81-808A-7353715B176A" class="sect4"><span class="enumeration_section">10.6.4 </span>SET DESCRIPTOR
                  </h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-180E79CB-4D44-4A81-808A-7353715B176A__GUID-C87329C5-10A9-4C33-ACE7-AFE2A6707279">Purpose</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>Use this statement to set information in the descriptor area from host variables. The SET DESCRIPTOR statement supports <span class="italic">only</span> host variables for the item names.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-180E79CB-4D44-4A81-808A-7353715B176A__GUID-7B294DEC-BA24-4BD8-B4D0-5A0D8CC84C6E">Syntax</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">     EXEC SQL [FOR [:]<span class="italic">array_size</span>] SET DESCRIPTOR [GLOBAL | LOCAL] 
        {<span class="italic">:desc_nam | string_literal</span>} 
        {COUNT = :<span class="italic">hv0</span> | VALUE <span class="italic">item_number</span>
        [REF] <span class="italic">item_name1</span> = :<span class="italic">hv1</span> 
        [{, [REF] <span class="italic">item_nameN</span> = :<span class="italic">hvN</span>}]}
     END-EXEC.</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-180E79CB-4D44-4A81-808A-7353715B176A__GUID-E7522612-46F6-4B80-9288-1B17C782D931">Variables</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <dl>
                           <dt class="dlterm"><a name="GUID-180E79CB-4D44-4A81-808A-7353715B176A__GUID-915F3F41-F6E6-4453-9F0D-B8243AE42F95">
                                 <!-- --></a>array_size
                           </dt>
                           <dd>
                              <p>This optional Oracle clause permits using arrays when setting the descriptor items DATA, INDICATOR, and RETURNED_LENGTH only. You cannot use other items in a SET DESCRIPTOR that contains the FOR clause. All host variable table sizes must match. Use the same array size for the SET statement that you use for the FETCH statement. </p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-180E79CB-4D44-4A81-808A-7353715B176A__GUID-4F14766C-99F7-4FEB-B08E-A45783A95EFA">
                                 <!-- --></a>desc_nam
                           </dt>
                           <dd>
                              <p>The descriptor name. It follows the rules in ALLOCATE DESCRIPTOR.</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-180E79CB-4D44-4A81-808A-7353715B176A__GUID-D70E9E17-20E5-4161-BD7D-BB9F636F715A">
                                 <!-- --></a>COUNT 
                           </dt>
                           <dd>
                              <p>The number of bind (input) or define (output) variables.</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-180E79CB-4D44-4A81-808A-7353715B176A__GUID-633769CD-4164-4497-ABF5-E0D1732C4B12">
                                 <!-- --></a>VALUE item_number
                           </dt>
                           <dd>
                              <p>Position in the dynamic SQL statement of a host variable.</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-180E79CB-4D44-4A81-808A-7353715B176A__GUID-9E59CD53-34B5-4776-A9D6-A278CDBFC439">
                                 <!-- --></a>hv1 .. hvN
                           </dt>
                           <dd>
                              <p>The host variables (not constants) that you set.</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-180E79CB-4D44-4A81-808A-7353715B176A__GUID-7BA04E21-873C-4B81-ADAD-AD2B39A4F5D9">
                                 <!-- --></a>item_name1 .. item_nameN
                           </dt>
                           <dd>
                              <p>In a similar way to the GET DESCRIPTOR syntax (see “GET DESCRIPTOR”), <code class="codeph">item_name</code> can take on these values:
                              </p>
                           </dd>
                        </dl>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-180E79CB-4D44-4A81-808A-7353715B176A__G1029727">
                        <p class="titleintable">Table 10-6 Descriptor Item Names for SET DESCRIPTOR</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="Descriptor Item Names for SET DESCRIPTOR" summary="q" width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="31%" id="d68132e1836">Descriptor Item Name</th>
                                 <th align="left" valign="bottom" width="69%" id="d68132e1840">Meaning</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1846" headers="d68132e1836 ">
                                    <p>TYPE</p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1846 d68132e1840 ">
                                    <p>See Table 10-1 for the ANSI type codes. See Table 11-2 for the Oracle type codes. Use the negative value of the Oracle type code if the Oracle type is not in the table, and TYPE_CODE = ANSI.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1853" headers="d68132e1836 ">
                                    <p>LENGTH</p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1853 d68132e1840 ">
                                    <p>Maximum length of data in the column.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1860" headers="d68132e1836 ">
                                    <p>PRECISION</p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1860 d68132e1840 ">
                                    <p>The number of digits.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1867" headers="d68132e1836 ">
                                    <p>SCALE</p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1867 d68132e1840 ">
                                    <p>For exact numeric types, the number of bytes to the right of the decimal point.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1874" headers="d68132e1836 ">
                                    <p>INDICATOR</p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1874 d68132e1840 ">
                                    <p>The associated indicator value. Set for reference semantics.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1881" headers="d68132e1836 ">
                                    <p>DATA</p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1881 d68132e1840 ">
                                    <p>Value of the data to be set. Set for reference semantics.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="31%" id="d68132e1888" headers="d68132e1836 ">
                                    <p>CHARACTER_SET_NAME</p>
                                 </td>
                                 <td align="left" valign="top" width="69%" headers="d68132e1888 d68132e1840 ">
                                    <p>Column's character set.</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="section">
                        <p>The Oracle extensions to the descriptor item names are listed in the following table.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="tblformal" id="GUID-180E79CB-4D44-4A81-808A-7353715B176A__G1029923">
                        <p class="titleintable">Table 10-7 Extensions to Descriptor Item Names for SET DESCRIPTOR </p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="Extensions to Descriptor Item Names for SET DESCRIPTOR " summary="q" width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="32%" id="d68132e1907">Descriptor Item Name</th>
                                 <th align="left" valign="bottom" width="68%" id="d68132e1911">Meaning</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="32%" id="d68132e1917" headers="d68132e1907 ">
                                    <p>RETURNED_LENGTH</p>
                                 </td>
                                 <td align="left" valign="top" width="68%" headers="d68132e1917 d68132e1911 ">
                                    <p>Length returned after a FETCH. Set if reference semantics is being used.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="32%" id="d68132e1924" headers="d68132e1907 ">
                                    <p>NATIONAL_CHARACTER</p>
                                 </td>
                                 <td align="left" valign="top" width="68%" headers="d68132e1924 d68132e1911 ">
                                    <p>Set to 2 when the input host variable is an NCHAR or NVARCHAR2 type.</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-180E79CB-4D44-4A81-808A-7353715B176A__GUID-EDD63A0C-A1D7-4A14-B3A6-2F814DBE4776">Usage Notes</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>Reference semantics is another optional Oracle extension that speeds performance. Use the keyword REF before these descriptor items names only: DATA, INDICATOR, RETURNED_LENGTH. When you use the REF keyword you do not need to use a GET statement. Complex data types and DML returning clauses require the REF form of SET DESCRIPTOR. See “DML Returning Clause”.</p>
                        <p>When REF is used the associated host variable itself is used in the SET. The GET is not needed in this case. The RETURNED_LENGTH can only be set when you use the REF semantics, not the value semantics.</p>
                        <p>Use the same array size for the SET or GET statements that you use in the FETCH.</p>
                        <p>Set the NATIONAL_CHAR field to 2 for NCHAR host input values.</p>
                        <p>When setting an object type's characteristics, you must set USER_DEFINED_TYPE_NAME and USER_DEFINED_TYPE_NAME_LENGTH.</p>
                        <p>If omitted, USER_DEFINED_TYPE_SCHEMA and USER_DEFINED_TYPE_SCHEMA_LENGTH default to the current connection.</p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="embedded-SQL.html#GUID-672BB15A-1E0C-4179-8F2B-16012A02B325">DML Returning Clause</a></li>
                           <li><a href="ANSI-dynamic-SQL.html#GUID-5572BF6D-CC71-42BF-B4F9-77F29D99D3E8">GET DESCRIPTOR</a></li>
                        </ul>
                     </div>
                  </div>
                  <a id="LNPCB655"></a><div class="props_rev_3"><a id="GUID-A3BB9D8F-CEA6-420B-8876-0FFCDE56E58A" name="GUID-A3BB9D8F-CEA6-420B-8876-0FFCDE56E58A"></a><h5 id="LNPCB-GUID-A3BB9D8F-CEA6-420B-8876-0FFCDE56E58A" class="sect5"><span class="enumeration_section">10.6.4.1 </span>Example
                     </h5>
                     <div>
                        <p>Bulk table examples are found in <span class="q">"<a href="ANSI-dynamic-SQL.html#GUID-88BE9B20-8BF1-42AA-84CA-9B46D6562B6F">Using Tables for Bulk Operations</a>"</span>.
                        </p><pre class="oac_no_warn" dir="ltr"> ...
 O1  BINDNO  PIC S9(9) COMP  VALUE 2.
 01  INDI    PIC S9(4) COMP  VALUE -1.
 01  DATA    PIC X(6)  COMP  VALUE "ignore".
 01  BATCH   PIC S9(9) COMP  VALUE 1.
 ...
     EXEC SQL FOR :batch ALLOCATE DESCRIPTOR :BINDDES END-EXEC.
     EXEC SQL SET DESCRIPTOR GLOBAL :BINDDES COUNT = 3 END-EXEC.
     EXEC SQL FOR :batch SET DESCRIPTOR :BINDDES
        VALUE :BINDNO INDICATOR = :INDI, DATA = :DATA END-EXEC.
...</pre></div>
                  </div>
               </div><a id="LNPCB657"></a><a id="LNPCB658"></a><a id="LNPCB659"></a><a id="LNPCB660"></a><a id="LNPCB656"></a><div class="props_rev_3"><a id="GUID-7B7FDA36-A72A-4167-A2C8-B9B0BB5EA7E2" name="GUID-7B7FDA36-A72A-4167-A2C8-B9B0BB5EA7E2"></a><h4 id="LNPCB-GUID-7B7FDA36-A72A-4167-A2C8-B9B0BB5EA7E2" class="sect4"><span class="enumeration_section">10.6.5 </span>Use of PREPARE
                  </h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-7B7FDA36-A72A-4167-A2C8-B9B0BB5EA7E2__GUID-96CB7F5B-2981-405F-90CA-A872281628C6">Purpose</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>The PREPARE statement used in this method is the same as the PREPARE statement used in the Oracle dynamic SQL methods. An Oracle extension allows a quoted string for the SQL statement, as well as a variable. </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-7B7FDA36-A72A-4167-A2C8-B9B0BB5EA7E2__GUID-17EBCBA6-3703-4D4A-82A9-51E7211F7D0B">Syntax</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">     EXEC SQL PREPARE <span class="italic">statement_id</span> FROM :<span class="italic">sql_statement</span> END-EXEC.</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-7B7FDA36-A72A-4167-A2C8-B9B0BB5EA7E2__GUID-97D3A9E7-EE90-401E-B6E2-AE19A42771A7">Variables</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <dl>
                           <dt class="dlterm"><a name="GUID-7B7FDA36-A72A-4167-A2C8-B9B0BB5EA7E2__GUID-54875C66-CE13-44A6-AC65-EF58B8FAEC75">
                                 <!-- --></a>statement_id
                           </dt>
                           <dd>
                              <p>This must not be declared; it is an undeclared SQL identifier associated with the prepared SQL statement.</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-7B7FDA36-A72A-4167-A2C8-B9B0BB5EA7E2__GUID-B7BEF3C3-A274-4BC1-9138-9310643D9DE4">
                                 <!-- --></a>sql_statement
                           </dt>
                           <dd>
                              <p>A character string (a constant or a variable) holding the embedded SQL statement.</p>
                           </dd>
                        </dl>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-7B7FDA36-A72A-4167-A2C8-B9B0BB5EA7E2__GUID-ED242AE9-D00B-4FFB-AE79-07E39F725A7E">Examples</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr"> ...
 01  STATEMENT    PIC X(255)
        VALUE "SELECT ENAME FROM emp WHERE deptno = :d".
 ...
     EXEC SQL PREPARE S1 FROM :STATEMENT END-EXEC.</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCB662"></a><a id="LNPCB663"></a><a id="LNPCB664"></a><a id="LNPCB665"></a><a id="LNPCB661"></a><div class="props_rev_3"><a id="GUID-E3614D75-879B-47CB-8179-CE88A25F25FE" name="GUID-E3614D75-879B-47CB-8179-CE88A25F25FE"></a><h4 id="LNPCB-GUID-E3614D75-879B-47CB-8179-CE88A25F25FE" class="sect4"><span class="enumeration_section">10.6.6 </span>DESCRIBE INPUT
                  </h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-E3614D75-879B-47CB-8179-CE88A25F25FE__GUID-C060C02F-406D-4E2A-B078-E7A648CF4968">Purpose</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>This statement returns information about the input bind variables.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-E3614D75-879B-47CB-8179-CE88A25F25FE__GUID-923AF3B3-0A19-454C-A154-8FAD17493037">Syntax</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">     EXEC SQL DESCRIBE INPUT <span class="italic">statement_id</span> USING [SQL] DESCRIPTOR 
        [GLOBAL | LOCAL] {<span class="italic">:desc_nam </span>|<span class="italic"> string_literal</span>}
<span class="italic">     </span>END-EXEC.</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-E3614D75-879B-47CB-8179-CE88A25F25FE__GUID-69A4C3F6-ED74-4FE6-B4CA-B40D6D4D44B4">Variables</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <dl>
                           <dt class="dlterm"><a name="GUID-E3614D75-879B-47CB-8179-CE88A25F25FE__GUID-C7C32013-434E-4A97-9E16-1D0E1B3B5BC6">
                                 <!-- --></a>statement_id
                           </dt>
                           <dd>
                              <p>The same as used in PREPARE and DESCRIBE OUTPUT. This must not be declared; it is a SQL identifier.</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-E3614D75-879B-47CB-8179-CE88A25F25FE__GUID-C82918A2-2C96-4336-8CAD-A06099A264ED">
                                 <!-- --></a>GLOBAL | LOCAL
                           </dt>
                           <dd>
                              <p>GLOBAL means that the descriptor name is known to all program files. LOCAL means that it is known only in the file in which it is allocated. LOCAL is the default.</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-E3614D75-879B-47CB-8179-CE88A25F25FE__GUID-9B346C9B-1BEF-49AA-B064-B0E959F7D5BF">
                                 <!-- --></a>desc_nam
                           </dt>
                           <dd>
                              <p>The descriptor name.</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-E3614D75-879B-47CB-8179-CE88A25F25FE__GUID-A4B54850-E6A1-4124-9769-6867A576362C">
                                 <!-- --></a>Usage Notes
                           </dt>
                           <dd>
                              <p>Only COUNT and NAME are implemented for bind variables in this version. </p>
                           </dd>
                        </dl>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-E3614D75-879B-47CB-8179-CE88A25F25FE__GUID-9C8EE567-9528-4029-9DC2-0DD418569E8E">Examples</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">     EXEC SQL DESCRIBE INPUT S1 USING SQL DESCRIPTOR GLOBAL :BINDDES END-EXEC.
     EXEC SQL DESCRIBE INPUT S2 USING DESCRIPTOR 'input' END-EXEC.</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCB667"></a><a id="LNPCB668"></a><a id="LNPCB669"></a><a id="LNPCB670"></a><a id="LNPCB666"></a><div class="props_rev_3"><a id="GUID-F3087B1D-E4F0-46E6-893F-3034E37A3F9F" name="GUID-F3087B1D-E4F0-46E6-893F-3034E37A3F9F"></a><h4 id="LNPCB-GUID-F3087B1D-E4F0-46E6-893F-3034E37A3F9F" class="sect4"><span class="enumeration_section">10.6.7 </span>DESCRIBE OUTPUT
                  </h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-F3087B1D-E4F0-46E6-893F-3034E37A3F9F__GUID-968C8410-1538-46F4-9CF0-D8AF34B28CF1">Purpose</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>The DESCRIBE INPUT statement is used to obtain information about the columns in a PREPARE statement. The ANSI syntax differs from the older syntax. The information which is stored in the SQL descriptor area is the number of values returned and associated information such as type, length, and name.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-F3087B1D-E4F0-46E6-893F-3034E37A3F9F__GUID-59005712-6D5A-4C55-9478-AC902715672A">Syntax</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">     EXEC SQL DESCRIBE [OUTPUT] <span class="italic">statement_id</span> USING [SQL] DESCRIPTOR
        [GLOBAL | LOCAL] {<span class="italic">:desc_nam </span>|<span class="italic"> string_literal</span>}
<span class="italic">     </span>END-EXEC.</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-F3087B1D-E4F0-46E6-893F-3034E37A3F9F__GUID-0B505C56-1E7D-40B4-BCFB-013AFD7382E7">Variables</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <dl>
                           <dt class="dlterm"><a name="GUID-F3087B1D-E4F0-46E6-893F-3034E37A3F9F__GUID-F2AA99C4-1EDB-435E-ADCC-E1A8ACF0AF7C">
                                 <!-- --></a>statement_id
                           </dt>
                           <dd>
                              <p>The statement_id is a SQL identifier. It must not be declared.</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-F3087B1D-E4F0-46E6-893F-3034E37A3F9F__GUID-528EE1EB-CD74-472B-B1B8-C909E9FE2373">
                                 <!-- --></a>GLOBAL | LOCAL
                           </dt>
                           <dd>
                              <p>GLOBAL means that the descriptor name is known to all program files. LOCAL means that it is known only in the file in which it is allocated. LOCAL is the default.</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-F3087B1D-E4F0-46E6-893F-3034E37A3F9F__GUID-B4E596EE-1538-4EED-9922-C75CEF3839C8">
                                 <!-- --></a>desc_nam
                           </dt>
                           <dd>
                              <p>The descriptor name. Either a host variable preceded by a ':', or a single-quoted string. OUTPUT is the default and can be omitted.</p>
                           </dd>
                        </dl>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-F3087B1D-E4F0-46E6-893F-3034E37A3F9F__GUID-BE040B0B-2097-491B-AA66-E9C901A0A340">Examples</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr"> ...
 01  DESNAME   PIC X(10) VALUE "SELDES".
 ...
     EXEC SQL DESCRIBE S1 USING SQL DESCRIPTOR 'SELDES' END-EXEC. 
* Or:
     EXEC SQL DESCRIBE OUTPUT S1 USING DESCRIPTOR :DESNAME END-EXEC.</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCB672"></a><a id="LNPCB673"></a><a id="LNPCB674"></a><a id="LNPCB675"></a><a id="LNPCB676"></a><a id="LNPCB671"></a><div class="props_rev_3"><a id="GUID-65D67227-F41A-4CF2-8D9D-87AD8B5A388D" name="GUID-65D67227-F41A-4CF2-8D9D-87AD8B5A388D"></a><h4 id="LNPCB-GUID-65D67227-F41A-4CF2-8D9D-87AD8B5A388D" class="sect4"><span class="enumeration_section">10.6.8 </span>EXECUTE
                  </h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-65D67227-F41A-4CF2-8D9D-87AD8B5A388D__GUID-BF3EA97C-092F-43B3-9019-8F3C582E3DFE">Purpose</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>EXECUTE matches input and output variables in a prepared SQL statement and then executes the statement. This ANSI version of EXECUTE differs from the older EXECUTE statement by allowing two descriptors in one statement to support DML RETURNING.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-65D67227-F41A-4CF2-8D9D-87AD8B5A388D__GUID-92FA8E9A-4935-40BA-8508-534E8554F9CB">Syntax</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">     EXEC SQL [FOR [:]<span class="italic">array_size</span>] EXECUTE <span class="italic">statement_id</span> 
        [USING [SQL] DESCRIPTOR [GLOBAL | LOCAL] {<span class="italic">:desc_nam </span>|<span class="italic"> string_literal</span>}] 
        [INTO [SQL] DESCRIPTOR [GLOBAL | LOCAL] {<span class="italic">:desc_nam </span>|<span class="italic"> string_literal</span>}]
     END-EXEC.</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-65D67227-F41A-4CF2-8D9D-87AD8B5A388D__GUID-5A4DD5FD-7969-44FD-9196-CDF627AC96A6">Variables</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <dl>
                           <dt class="dlterm"><a name="GUID-65D67227-F41A-4CF2-8D9D-87AD8B5A388D__GUID-82BCB64A-AA93-4D74-A83C-99BCB8323EEB">
                                 <!-- --></a>array_size
                           </dt>
                           <dd>
                              <p>The number of rows the statement will process.</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-65D67227-F41A-4CF2-8D9D-87AD8B5A388D__GUID-5F950EC0-D7DF-4072-A5FC-24010BCB5F68">
                                 <!-- --></a>statement_id
                           </dt>
                           <dd>
                              <p>The same as used in PREPARE. This must not be declared; it is a SQL identifier. It can be a literal.</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-65D67227-F41A-4CF2-8D9D-87AD8B5A388D__GUID-9F1BEDD7-4DB1-4A06-BE13-D4210869ED27">
                                 <!-- --></a>GLOBAL | LOCAL
                           </dt>
                           <dd>
                              <p>GLOBAL means that the descriptor name is known to all program files. LOCAL means that it is known only in the file in which it is allocated. LOCAL is the default.</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-65D67227-F41A-4CF2-8D9D-87AD8B5A388D__GUID-E3A36DA3-EA33-48F8-8A25-10F4DEBE5F92">
                                 <!-- --></a>desc_nam
                           </dt>
                           <dd>
                              <p>The descriptor name. Either a host variable preceded by a ':', or a single-quoted string.</p>
                           </dd>
                        </dl>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-65D67227-F41A-4CF2-8D9D-87AD8B5A388D__GUID-4F056CC1-742D-481A-9425-8EE71EFE6F6B">Usage Notes</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>The INTO clause implements the RETURNING clause for INSERT, UPDATE and DELETE (See “Inserting Rows”  and succeeding pages).</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-65D67227-F41A-4CF2-8D9D-87AD8B5A388D__GUID-D3BB9E76-2418-4348-A628-1DB879B0E8A9">Examples</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">     EXEC SQL EXECUTE S1 USING SQL DESCRIPTOR GLOBAL :BINDDES END-EXEC.

     EXEC SQL EXECUTE S2 USING DESCRIPTOR :bv1 INTO DESCRIPTOR 'SELDES'
        END-EXEC.</pre></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="embedded-SQL.html#GUID-646DE444-E6B3-4213-B633-411C1CBDDC87">Inserting Rows</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div><a id="LNPCB678"></a><a id="LNPCB679"></a><a id="LNPCB680"></a><a id="LNPCB681"></a><a id="LNPCB677"></a><div class="props_rev_3"><a id="GUID-8FD6596A-31AB-4558-8A6E-D1F3B1426BB9" name="GUID-8FD6596A-31AB-4558-8A6E-D1F3B1426BB9"></a><h4 id="LNPCB-GUID-8FD6596A-31AB-4558-8A6E-D1F3B1426BB9" class="sect4"><span class="enumeration_section">10.6.9 </span>Use of EXECUTE IMMEDIATE
                  </h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-8FD6596A-31AB-4558-8A6E-D1F3B1426BB9__GUID-09273C88-BA97-4B4E-99F5-CC3009A7A7D7">Purpose</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>The EXECUTE IMMEDIATE statement executes a literal or host variable character string containing the SQL statement.The ANSI SQL form of this statement is the same as in the older dynamic SQL:</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-8FD6596A-31AB-4558-8A6E-D1F3B1426BB9__GUID-7D679695-861C-4C0C-BE6B-54750C95DD9D">Syntax</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">     EXEC SQL EXECUTE IMMEDIATE [:]<span class="italic">sql_statement END-EXEC.</span></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-8FD6596A-31AB-4558-8A6E-D1F3B1426BB9__GUID-58E47F4F-68AA-4C8A-A223-96FD22C600C8">Variables</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>Only one variable is available with the EXECUTE IMMEDIATE statement. </p>
                        <dl>
                           <dt class="dlterm"><a name="GUID-8FD6596A-31AB-4558-8A6E-D1F3B1426BB9__GUID-E70C7175-4B23-4945-8034-A456D4D552A9">
                                 <!-- --></a>sql_statement
                           </dt>
                           <dd>
                              <p>The sql_statement variable is the SQL statement or PL/SQL block in a character string. It can be a host variable or a literal. </p>
                           </dd>
                        </dl>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-8FD6596A-31AB-4558-8A6E-D1F3B1426BB9__GUID-7B25521C-E35D-4860-9F11-B5C652280168">Examples</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">     EXEC SQL EXECUTE IMMEDIATE :<span class="italic">statement</span> END-EXEC.</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCB683"></a><a id="LNPCB684"></a><a id="LNPCB685"></a><a id="LNPCB686"></a><a id="LNPCB682"></a><div class="props_rev_3"><a id="GUID-F31468EA-D1A3-4C12-933C-4937F074E9CF" name="GUID-F31468EA-D1A3-4C12-933C-4937F074E9CF"></a><h4 id="LNPCB-GUID-F31468EA-D1A3-4C12-933C-4937F074E9CF" class="sect4"><span class="enumeration_section">10.6.10 </span>Use of DYNAMIC DECLARE CURSOR
                  </h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-F31468EA-D1A3-4C12-933C-4937F074E9CF__GUID-40CD4903-F765-4EA9-9C3D-664192B667D4">Purpose</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>The DYNAMIC DECLARE CURSOR statement declares a cursor that is associated with a statement which is a query. This is a form of the generic Declare Cursor statement.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-F31468EA-D1A3-4C12-933C-4937F074E9CF__GUID-7AA7B7D7-BC15-4CD2-8013-6D28AC608A73">Syntax</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">     EXEC SQL DECLARE <span class="italic">cursor_name</span> CURSOR FOR <span class="italic">statement_id END-EXEC.</span></pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-F31468EA-D1A3-4C12-933C-4937F074E9CF__GUID-FF7B5F14-DDEB-413F-A3F7-70CFD5BB43B6">Variables</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <dl>
                           <dt class="dlterm"><a name="GUID-F31468EA-D1A3-4C12-933C-4937F074E9CF__GUID-2BAC61E8-59FB-450A-A11A-09E315FBE006">
                                 <!-- --></a>cursor_name
                           </dt>
                           <dd>
                              <p>A cursor variable (a SQL identifier, not a host variable).</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-F31468EA-D1A3-4C12-933C-4937F074E9CF__GUID-0E034250-8E66-48A3-9C18-6BBD5515F648">
                                 <!-- --></a>statement_id
                           </dt>
                           <dd>
                              <p>An undeclared SQL identifier (the same as the one used in the PREPARE statement).</p>
                           </dd>
                        </dl>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-F31468EA-D1A3-4C12-933C-4937F074E9CF__GUID-F7447FA6-EF59-4A41-98B7-404F9A878C11">Examples</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">     EXEC SQL DECLARE C1 CURSOR FOR S1 END-EXEC. </pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCB688"></a><a id="LNPCB689"></a><a id="LNPCB690"></a><a id="LNPCB691"></a><a id="LNPCB692"></a><a id="LNPCB687"></a><div class="props_rev_3"><a id="GUID-1377CFFE-523E-4C44-99B0-50FAC47A8AC6" name="GUID-1377CFFE-523E-4C44-99B0-50FAC47A8AC6"></a><h4 id="LNPCB-GUID-1377CFFE-523E-4C44-99B0-50FAC47A8AC6" class="sect4"><span class="enumeration_section">10.6.11 </span>OPEN Cursor
                  </h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-1377CFFE-523E-4C44-99B0-50FAC47A8AC6__GUID-A5C5B169-3291-4D8D-9BED-E0880F8B5220">Purpose</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>The OPEN statement associates input parameters with a cursor and then opens the cursor. </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-1377CFFE-523E-4C44-99B0-50FAC47A8AC6__GUID-C024FC15-192B-486F-86EC-32F902D608A9">Syntax</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">     EXEC SQL [FOR [:]<span class="italic">array_size</span>] OPEN <span class="italic">dyn_cursor</span> 
        [[USING [SQL] DESCRIPTOR [GLOBAL | LOCAL] <span class="italic">desc_nam1</span>]
        [INTO [SQL] DESCRIPTOR [GLOBAL | LOCAL] <span class="italic">desc_nam2</span>] ]
     END-EXEC.</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-1377CFFE-523E-4C44-99B0-50FAC47A8AC6__GUID-B680E57B-D1AF-4CAD-96B6-E0F457CEE626">Variables</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <dl>
                           <dt class="dlterm"><a name="GUID-1377CFFE-523E-4C44-99B0-50FAC47A8AC6__GUID-36433AD1-A54E-4C0D-B150-450D96C2D68D">
                                 <!-- --></a>array_size
                           </dt>
                           <dd>
                              <p>This limit is less than or equal to number specified when the descriptor was allocated.</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-1377CFFE-523E-4C44-99B0-50FAC47A8AC6__GUID-4230AE90-3AD1-466D-A742-5CD2BFB241D8">
                                 <!-- --></a>GLOBAL | LOCAL
                           </dt>
                           <dd>
                              <p>GLOBAL means that the descriptor name is known to all program files. LOCAL means that it is known only in the file in which it is allocated. LOCAL is the default.</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-1377CFFE-523E-4C44-99B0-50FAC47A8AC6__GUID-D5B50CF3-6A49-440E-AE75-B9A0921FCCBB">
                                 <!-- --></a>dyn_cursor
                           </dt>
                           <dd>
                              <p>The cursor variable.</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-1377CFFE-523E-4C44-99B0-50FAC47A8AC6__GUID-F774FDA8-50A2-40DC-82B3-420F736DF725">
                                 <!-- --></a>desc_nam1, desc_nam2
                           </dt>
                           <dd>
                              <p>The optional descriptor names.</p>
                           </dd>
                        </dl>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-1377CFFE-523E-4C44-99B0-50FAC47A8AC6__GUID-A536A0CB-70E9-446F-8107-761488EA0937">Usage Notes</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>If the prepared statement associated with the cursor contains colons or question marks, a USING clause must be specified, or an error results at runtime. The INTO clause supports DML RETURNING (See “Inserting Rows” and succeeding sections on DELETE and UPDATE).</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-1377CFFE-523E-4C44-99B0-50FAC47A8AC6__GUID-C8BDDE51-9257-455F-8622-0B5DBFB8D3E1">Examples</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">     EXEC SQL OPEN C1 USING SQL DESCRIPTOR :BINDDES END-EXEC.

     EXEC SQL FOR :LIMIT OPEN C2 USING DESCRIPTOR :B1, :B2 
       INTO SQL DESCRIPTOR :SELDES
     END-EXEC.</pre></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="embedded-SQL.html#GUID-646DE444-E6B3-4213-B633-411C1CBDDC87">Inserting Rows</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div><a id="LNPCB694"></a><a id="LNPCB695"></a><a id="LNPCB696"></a><a id="LNPCB697"></a><a id="LNPCB698"></a><a id="LNPCB693"></a><div class="props_rev_3"><a id="GUID-12FAAF57-D09A-4842-846B-1A21F0938629" name="GUID-12FAAF57-D09A-4842-846B-1A21F0938629"></a><h4 id="LNPCB-GUID-12FAAF57-D09A-4842-846B-1A21F0938629" class="sect4"><span class="enumeration_section">10.6.12 </span>FETCH
                  </h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-12FAAF57-D09A-4842-846B-1A21F0938629__GUID-0D042BAA-B4AA-4FAD-9AD1-138B37E00BFE">Purpose</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>The FETCH statement fetches a row for a cursor declared with a dynamic DECLARE statement.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-12FAAF57-D09A-4842-846B-1A21F0938629__GUID-09837F1E-D122-4B53-A8D5-44C72E4A00F5">Syntax</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">     EXEC SQL [FOR [:]<span class="italic">array_size</span>] FETCH cursor INTO [SQL] DESCRIPTOR 
       [GLOBAL | LOCAL] {<span class="italic">:desc_nam </span>|<span class="italic"> string_literal</span>}
     END-EXEC.</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-12FAAF57-D09A-4842-846B-1A21F0938629__GUID-ADF5DD0B-EABD-45D1-A1A4-881DFE43BA86">Variables</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <dl>
                           <dt class="dlterm"><a name="GUID-12FAAF57-D09A-4842-846B-1A21F0938629__GUID-E132AE29-C134-4441-AEDE-3C4C2DC51BC4">
                                 <!-- --></a>array_size
                           </dt>
                           <dd>
                              <p>The number of rows the statement will process.</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-12FAAF57-D09A-4842-846B-1A21F0938629__GUID-F651BC37-8222-46DF-99E0-30F8686A00B0">
                                 <!-- --></a>cursor
                           </dt>
                           <dd>
                              <p>The dynamic cursor that was previously declared.</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-12FAAF57-D09A-4842-846B-1A21F0938629__GUID-2FEE9042-F0E2-4E26-9E58-0B9385F5155A">
                                 <!-- --></a>GLOBAL | LOCAL
                           </dt>
                           <dd>
                              <p>GLOBAL means that the descriptor name is known to all program files. LOCAL means that it is known only in the file in which it is allocated. LOCAL is the default.</p>
                           </dd>
                           <dt class="dlterm"><a name="GUID-12FAAF57-D09A-4842-846B-1A21F0938629__GUID-8C24425C-442C-4E18-8DCD-C5980DC23F9D">
                                 <!-- --></a>desc_nam
                           </dt>
                           <dd>
                              <p>Descriptor name.</p>
                           </dd>
                        </dl>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-12FAAF57-D09A-4842-846B-1A21F0938629__GUID-03491603-71DE-42C5-B714-655F46F6F5F8">Usage Notes</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>The optional <code class="codeph">array_size </code>in the FOR clause must be less than or equal to the number specified in the ALLOCATE DESCRIPTOR statement.
                        </p>
                        <p>RETURNED_LENGTH is undefined for fixed-length character types.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-12FAAF57-D09A-4842-846B-1A21F0938629__GUID-417E38E8-4D29-4EA0-B5BE-BB804CDA9791">Examples</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">     EXEC SQL FETCH FROM C1 INTO DESCRIPTOR 'SELDES' END-EXEC.

     EXEC SQL FOR :ARSZ FETCH C2 INTO DESCRIPTOR :DESC END-EXEC.</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCB700"></a><a id="LNPCB701"></a><a id="LNPCB702"></a><a id="LNPCB703"></a><a id="LNPCB699"></a><div class="props_rev_3"><a id="GUID-3DF3693C-B448-4B7C-9F0A-FC2DA9F4156C" name="GUID-3DF3693C-B448-4B7C-9F0A-FC2DA9F4156C"></a><h4 id="LNPCB-GUID-3DF3693C-B448-4B7C-9F0A-FC2DA9F4156C" class="sect4"><span class="enumeration_section">10.6.13 </span>CLOSE a Dynamic Cursor
                  </h4>
                  <div>
                     <div class="section">
                        <p class="subhead3" id="GUID-3DF3693C-B448-4B7C-9F0A-FC2DA9F4156C__GUID-29C5C6F7-329D-4779-B64F-B6BF125940BF">Purpose</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>The CLOSE statement closes a dynamic cursor. Its syntax is identical to the Oracle Method 4.</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-3DF3693C-B448-4B7C-9F0A-FC2DA9F4156C__GUID-81234B1E-A41B-4C32-877A-1B52D30C13A8">Syntax</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">     EXEC SQL CLOSE <span class="italic">cursor</span> END-EXEC.</pre></div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-3DF3693C-B448-4B7C-9F0A-FC2DA9F4156C__GUID-9AA022C9-EC33-4018-BF32-D7A13940AA26">Variables</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>Only one variable is available with the CLOSE statement. </p>
                        <dl>
                           <dt class="dlterm"><a name="GUID-3DF3693C-B448-4B7C-9F0A-FC2DA9F4156C__GUID-DE24023F-46BA-4F9F-8469-CF1167EDF2B9">
                                 <!-- --></a>cursor
                           </dt>
                           <dd>
                              <p>The cursor variable describes the previously declared dynamic cursor.</p>
                           </dd>
                        </dl>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-3DF3693C-B448-4B7C-9F0A-FC2DA9F4156C__GUID-99776063-E051-4D5B-9CC8-4AFD1F3211E4">Examples</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section"><pre class="oac_no_warn" dir="ltr">     EXEC SQL CLOSE C1 END-EXEC.</pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="LNPCB704"></a><div class="props_rev_3"><a id="GUID-5CAE1EED-2A42-4D21-94A8-89E1AC89323F" name="GUID-5CAE1EED-2A42-4D21-94A8-89E1AC89323F"></a><h4 id="LNPCB-GUID-5CAE1EED-2A42-4D21-94A8-89E1AC89323F" class="sect4"><span class="enumeration_section">10.6.14 </span>Differences From Oracle Dynamic Method 4
                  </h4>
                  <div>
                     <p>The ANSI dynamic SQL interface supports all the features supported by the Oracle dynamic Method 4, with these additions:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>All datatypes, including cursor variables, and LOB types are supported by ANSI Dynamic SQL.</p>
                        </li>
                        <li>
                           <p>The ANSI mode uses an internal <span class="italic">SQL descriptor area</span> which is an expansion of the external SQLDA used in Oracle older dynamic Method 4 to store its input and output information.
                           </p>
                        </li>
                        <li>
                           <p>New embedded SQL statements are introduced: ALLOCATE DESCRIPTOR, DEALLOCATE DESCRIPTOR, DESCRIBE, GET DESCRIPTOR, and SET DESCRIPTOR.</p>
                        </li>
                        <li>
                           <p>The DESCRIBE statement does not return the names of indicator variables in ANSI Dynamic SQL.</p>
                        </li>
                        <li>
                           <p>ANSI Dynamic SQL does not allow you to specify the maximum size of the returned column name or expression. The default size is set at 128.</p>
                        </li>
                        <li>
                           <p>The descriptor name must be either an identifier in single-quotes or a host variable preceded by a colon.</p>
                        </li>
                        <li>
                           <p>For output, the optional SELECT LIST FOR clause in the DESCRIBE is replaced by the optional keyword OUTPUT. The INTO clause is replaced by the USING DESCRIPTOR clause, which can contain the optional keyword SQL.</p>
                        </li>
                        <li>
                           <p>For input, the optional BIND VARIABLES FOR clause of the DESCRIBE can be replaced by the keyword INPUT. The INTO clause is replaced by the USING DESCRIPTOR clause, which can contain the optional keyword SQL.</p>
                        </li>
                        <li>
                           <p>The optional keyword SQL can come before the keyword DESCRIPTOR in the USING clause of the EXECUTE, FETCH and OPEN statements.</p>
                        </li>
                     </ul>
                  </div>
               </div><a id="LNPCB705"></a><div class="props_rev_3"><a id="GUID-775B7328-E784-4AB1-BD40-0C0E619BA633" name="GUID-775B7328-E784-4AB1-BD40-0C0E619BA633"></a><h4 id="LNPCB-GUID-775B7328-E784-4AB1-BD40-0C0E619BA633" class="sect4"><span class="enumeration_section">10.6.15 </span>Restrictions
                  </h4>
                  <div>
                     <div class="section">
                        <p>Restrictions in effect on ANSI dynamic SQL are:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>You cannot mix the two dynamic methods in the same module.</p>
                           </li>
                           <li>
                              <p>The precompiler option DYNAMIC must be set to ANSI. The precompiler option TYPE_CODE can be set to ANSI only if DYNAMIC is set to ANSI.</p>
                           </li>
                           <li>
                              <p>The SET statement supports only host variables as item names.</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="LNPCB706"></a><div class="props_rev_3"><a id="GUID-754BE05E-F9C4-406E-B77C-7E4BF7F67EDC" name="GUID-754BE05E-F9C4-406E-B77C-7E4BF7F67EDC"></a><h3 id="LNPCB-GUID-754BE05E-F9C4-406E-B77C-7E4BF7F67EDC" class="sect3"><span class="enumeration_section">10.7 </span>Sample Programs: SAMPLE12.PCO
               </h3>
               <div>
                  <p>The following ANSI SQL dynamic Method 4 program, SAMPLE12.PCO, is found in the demo directory. SAMPLE12 mimics SQL*Plus by prompting for SQL statements to be input by the user. Read the comments at the beginning for details of the program flow.</p><pre class="oac_no_warn" dir="ltr">      ******************************************************************
      * Sample Program 12: Dynamic SQL Method 4 using ANSI Dynamic SQL *
      *                                                                *
      * This program shows the basic steps required to use dynamic     *
      * SQL Method 4 with ANSI Dynamic SQL.  After logging on to       *
      * ORACLE, the program prompts the user for a SQL statement,      *
      * PREPAREs the statement, DECLAREs a cursor, checks for any      *
      * bind variables using DESCRIBE INPUT, OPENs the cursor, and     *
      * DESCRIBEs any select-list variables.  If the input SQL         *
      * statement is a query, the program FETCHes each row of data,    *
      * then CLOSEs the cursor.                                        *
      * use option dynamic=ansi when precompiling this sample.         *
      ******************************************************************

       IDENTIFICATION DIVISION.
       PROGRAM-ID.  ANSIDYNSQL4.
       ENVIRONMENT DIVISION.
       DATA DIVISION.
       WORKING-STORAGE SECTION.

       01  USERNAME       PIC X(20).
       01  PASSWD         PIC X(20).
       01  BDSC           PIC X(6) VALUE "BNDDSC".
       01  SDSC           PIC X(6) VALUE "SELDSC".
       01  BNDCNT         PIC S9(9) COMP.
       01  SELCNT         PIC S9(9) COMP.
       01  BNDNAME        PIC X(80).
       01  BNDVAL         PIC X(80).
       01  SELNAME        PIC X(80) VARYING.
       01  SELDATA        PIC X(80).
       01  SELTYP         PIC S9(4) COMP.
       01  SELPREC        PIC S9(4) COMP.
       01  SELLEN         PIC S9(4) COMP.
       01  SELIND         PIC S9(4) COMP.
       01  DYN-STATEMENT  PIC X(80).
       01  BND-INDEX      PIC S9(9) COMP.
       01  SEL-INDEX      PIC S9(9) COMP.
       01  VARCHAR2-TYP   PIC S9(4) COMP VALUE 1.
       01  VAR-COUNT      PIC 9(2).
       01  ROW-COUNT      PIC 9(4).
       01  NO-MORE-DATA   PIC X(1) VALUE "N".
       01  TMPLEN         PIC S9(9) COMP.
       01  MAX-LENGTH     PIC S9(9) COMP VALUE 80.

           EXEC SQL INCLUDE SQLCA         END-EXEC.

       PROCEDURE DIVISION.
       START-MAIN.

           EXEC SQL WHENEVER SQLERROR GOTO SQL-ERROR END-EXEC.

           DISPLAY "USERNAME: " WITH NO ADVANCING.
           ACCEPT USERNAME.
           DISPLAY "PASSWORD: " WITH NO ADVANCING.
           ACCEPT PASSWD.
           EXEC SQL CONNECT :USERNAME IDENTIFIED BY :PASSWD END-EXEC.
           DISPLAY "CONNECTED TO ORACLE AS USER: ", USERNAME.

      *    ALLOCATE THE BIND AND SELECT DESCRIPTORS.

           EXEC SQL ALLOCATE DESCRIPTOR :BDSC WITH MAX 20 END-EXEC.
           EXEC SQL ALLOCATE DESCRIPTOR :SDSC WITH MAX 20 END-EXEC.

      *    GET A SQL STATEMENT FROM THE OPERATOR.

           DISPLAY "ENTER SQL STATEMENT WITHOUT TERMINATOR:".
           DISPLAY "&gt;" WITH NO ADVANCING.
           ACCEPT DYN-STATEMENT.
           DISPLAY " ".

      *    PREPARE THE SQL STATEMENT AND DECLARE A CURSOR.

           EXEC SQL  PREPARE S1 FROM :DYN-STATEMENT  END-EXEC.
           EXEC SQL  DECLARE C1 CURSOR FOR S1        END-EXEC.

      *    DESCRIBE BIND VARIABLES.

           EXEC SQL DESCRIBE INPUT S1 USING DESCRIPTOR :BDSC END-EXEC.

           EXEC SQL GET DESCRIPTOR :BDSC :BNDCNT = COUNT END-EXEC.

           IF BNDCNT &lt; 0
               DISPLAY "TOO MANY BIND VARIABLES."
               GO TO END-SQL
           ELSE
               DISPLAY "NUMBER OF BIND VARIABLES: " WITH NO ADVANCING
               MOVE BNDCNT TO VAR-COUNT
               DISPLAY VAR-COUNT
      *        EXEC SQL SET DESCRIPTOR :BDSC COUNT = :BNDCNT END-EXEC
           END-IF.

           IF BNDCNT = 0
               GO TO DESCRIBE-ITEMS.
           PERFORM SET-BND-DSC
                   VARYING BND-INDEX FROM 1 BY 1
                   UNTIL BND-INDEX &gt; BNDCNT.

      *    OPEN THE CURSOR AND DESCRIBE THE SELECT-LIST ITEMS.

       DESCRIBE-ITEMS.
           EXEC SQL  OPEN C1 USING DESCRIPTOR :BDSC END-EXEC.

           EXEC SQL  DESCRIBE OUTPUT S1 USING DESCRIPTOR :SDSC  END-EXEC.

           EXEC SQL GET DESCRIPTOR :SDSC :SELCNT = COUNT END-EXEC.

           IF SELCNT &lt; 0
               DISPLAY "TOO MANY SELECT-LIST ITEMS."
               GO TO END-SQL
           ELSE
               DISPLAY "NUMBER OF SELECT-LIST ITEMS: "
                   WITH NO ADVANCING
               MOVE SELCNT TO VAR-COUNT
               DISPLAY VAR-COUNT
               DISPLAY " "
      *        EXEC SQL SET DESCRIPTOR :SDSC COUNT = :SELCNT END-EXEC
           END-IF.

      *    SET THE INPUT DESCRIPTOR

           IF SELCNT &gt; 0
               PERFORM SET-SEL-DSC
                   VARYING SEL-INDEX FROM 1 BY 1
                   UNTIL SEL-INDEX &gt; SELCNT
               DISPLAY " ".

      *    FETCH EACH ROW AND PRINT EACH SELECT-LIST VALUE.

           IF SELCNT &gt; 0
               PERFORM FETCH-ROWS UNTIL NO-MORE-DATA = "Y".

           DISPLAY " "
           DISPLAY "NUMBER OF ROWS PROCESSED: " WITH NO ADVANCING.
           MOVE SQLERRD(3) TO ROW-COUNT.
           DISPLAY ROW-COUNT.

      *    CLEAN UP AND TERMINATE.

           EXEC SQL CLOSE C1 END-EXEC.
           EXEC SQL DEALLOCATE DESCRIPTOR :BDSC END-EXEC.
           EXEC SQL DEALLOCATE DESCRIPTOR :SDSC END-EXEC.
           EXEC SQL ROLLBACK WORK RELEASE END-EXEC.
           DISPLAY " ".
           DISPLAY "HAVE A GOOD DAY!".
           DISPLAY " ".
           STOP RUN.

      *    DISPLAY ORACLE ERROR MESSAGE AND CODE.

       SQL-ERROR.
           DISPLAY " ".
           DISPLAY SQLERRMC.
       END-SQL.
           EXEC SQL WHENEVER SQLERROR CONTINUE END-EXEC.
           EXEC SQL ROLLBACK WORK RELEASE END-EXEC.
           STOP RUN.

      *    PERFORMED SUBROUTINES BEGIN HERE:

      *    SET A BIND-LIST ELEMENT'S ATTRIBUTE
      *    LET THE USER FILL IN THE BIND VARIABLES AND
      *    REPLACE THE 0S DESCRIBED INTO THE DATATYPE FIELDS OF THE
      *    BIND DESCRIPTOR WITH 1S TO AVOID AN "INVALID DATATYPE"
      *    ORACLE ERROR
       SET-BND-DSC.
               EXEC SQL GET DESCRIPTOR :BDSC VALUE
                      :BND-INDEX :BNDNAME = NAME END-EXEC.
               DISPLAY "ENTER VALUE FOR ", BNDNAME.
               ACCEPT BNDVAL.
               EXEC SQL SET DESCRIPTOR :BDSC VALUE :BND-INDEX
                 TYPE = :VARCHAR2-TYP, LENGTH = :MAX-LENGTH, 
                 DATA = :BNDVAL END-EXEC.

      * SET A SELECT-LIST ELEMENT'S ATTRIBUTES
       SET-SEL-DSC.
           MOVE SPACES TO SELNAME-ARR.
           EXEC SQL GET DESCRIPTOR :SDSC VALUE :SEL-INDEX
                 :SELNAME = NAME, :SELTYP = TYPE,
                 :SELPREC = PRECISION, :SELLEN = LENGTH END-EXEC.

      *    IF DATATYPE IS DATE, LENGTHEN TO 9 CHARACTERS.
           IF SELTYP = 12
               MOVE 9 TO SELLEN.

      *    IF DATATYPE IS NUMBER, SET LENGTH TO PRECISION.
           MOVE 0 TO TMPLEN. 
           IF SELTYP = 2 AND SELPREC = 0
               MOVE 40 TO TMPLEN.
           IF SELTYP = 2 AND SELPREC &gt; 0
               ADD 2 TO SELPREC
               MOVE SELPREC TO TMPLEN.

           IF SELTYP = 2
               IF TMPLEN &gt; MAX-LENGTH
                   DISPLAY "COLUMN VALUE TOO LARGE FOR DATA BUFFER."
                   GO TO END-SQL
               ELSE
                   MOVE TMPLEN TO SELLEN.


      * COERCE DATATYPES TO VARCHAR2.
           MOVE 1 TO SELTYP.

      *    DISPLAY COLUMN HEADING.
           DISPLAY "  ", SELNAME-ARR(1:SELLEN) WITH NO ADVANCING.

           EXEC SQL SET DESCRIPTOR :SDSC VALUE :SEL-INDEX
              TYPE = :SELTYP, LENGTH = :SELLEN END-EXEC.

      * FETCH A ROW AND PRINT THE SELECT-LIST VALUE.

       FETCH-ROWS.
           EXEC SQL  FETCH C1 INTO DESCRIPTOR :SDSC END-EXEC.
           IF SQLCODE NOT = 0
               MOVE "Y" TO NO-MORE-DATA.
           IF SQLCODE = 0
               PERFORM PRINT-COLUMN-VALUES
                   VARYING SEL-INDEX FROM 1 BY 1
                   UNTIL SEL-INDEX &gt; SELCNT
               DISPLAY " ".

      * PRINT A SELECT-LIST VALUE.

       PRINT-COLUMN-VALUES.
           MOVE SPACES TO SELDATA.
      *    returned length is not set for blank padded types
           IF SELTYP EQUALS 1
              EXEC SQL GET DESCRIPTOR :SDSC VALUE :SEL-INDEX
                :SELDATA = DATA, :SELIND = INDICATOR, 
                :SELLEN = LENGTH END-EXEC
           ELSE    
              EXEC SQL GET DESCRIPTOR :SDSC VALUE :SEL-INDEX
                 :SELDATA = DATA, :SELIND = INDICATOR, 
                 :SELLEN = RETURNED_LENGTH END-EXEC.
           IF (SELIND = -1)
              move "  NULL" to SELDATA.

           DISPLAY SELDATA(1:SELLEN), "  " 
                 WITH NO ADVANCING.
</pre></div>
            </div>
         </div>
      </article>
   </body>
</html>