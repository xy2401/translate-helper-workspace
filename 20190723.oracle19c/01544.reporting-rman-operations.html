<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Reporting on RMAN Operations</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Backup and Recovery User's Guide">
      <meta property="og:description" content="">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Backup and Recovery User's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="database-backup-and-recovery-users-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-01-09T05:20:45-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="2003, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E96241-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/19">
      
      <link rel="prev" href="part-managing-rman-backups.html" title="Previous" type="text/html">
      <link rel="next" href="maintaining-rman-backups.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"19","element_name":"Release 19","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Database Backup and Recovery User's Guide">
    <meta name="dcterms.isVersionOf" content="BRADV">
    <meta name="dcterms.release" content="Release 19">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="part-managing-rman-backups.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="maintaining-rman-backups.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Backup and Recovery User's Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="part-managing-rman-backups.html" property="item" typeof="WebPage"><span property="name"> Managing RMAN Backups </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Reporting on RMAN Operations</li>
            </ol>
            <a id="GUID-550638CC-0D16-4B1A-83C7-5D10181DC7C1" name="GUID-550638CC-0D16-4B1A-83C7-5D10181DC7C1"></a><a id="BRADV8004"></a>
            
            <h2 id="BRADV-GUID-550638CC-0D16-4B1A-83C7-5D10181DC7C1" class="sect2"><span class="enumeration_chapter">11 </span>Reporting on RMAN Operations
            </h2>
         </header>
         <div class="ind">
            <div>
               <p><a id="d53814e69" class="indexterm-anchor"></a><a id="d53814e73" class="indexterm-anchor"></a><a id="d53814e75" class="indexterm-anchor"></a>This chapter describes how to report on RMAN operations. This chapter contains the following topics:
               </p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="reporting-rman-operations.html#GUID-AAAE5ACE-EE63-4AD1-8F63-B0F4F6F1D1B2" title="As part of your backup and recovery strategy, you should periodically run reports that indicate what you have backed up. You can determine which data files need backups or which files were not backed up recently. Also, you can preview which backups RMAN must restore if a problem occurs.RMAN stores metadata of every database on which it performs operations.In a Data Guard environment, you can use the LIST, REPORT, and SHOW commands just as you can when not using Data Guard. You can run these commands with the FOR DB_UNIQUE_NAME clause to show the backups associated with a specified database.">Overview of RMAN Reporting</a></p>
                  </li>
                  <li>
                     <p><a href="reporting-rman-operations.html#GUID-1B911001-C106-4267-9265-F649946DBF52" title="The LIST command uses the information in the RMAN repository to provide lists of backups and other objects relating to backup and recovery.">Listing Backups and Recovery-Related Objects</a></p>
                  </li>
                  <li>
                     <p><a href="reporting-rman-operations.html#GUID-A1FDD9FE-74B8-4146-AFC4-6BD5402C8B5D" title="The RMAN REPORT command analyzes the available backups and your database.">Reporting on Backups and Database Schema</a></p>
                  </li>
                  <li>
                     <p><a href="reporting-rman-operations.html#GUID-9E60E2AC-6667-49B5-9D31-6480BEF026B9" title="In some cases, V$ views supply information that is not available through use of the LIST and REPORT commands.">Using V$ Views to Query Backup Metadata</a></p>
                  </li>
                  <li>
                     <p><a href="reporting-rman-operations.html#GUID-C48F1F48-E11D-4DA4-AB54-6D7EB4CA8957" title="The LIST, REPORT, and SHOW commands provide the easiest means of accessing the data in the control file and the recovery catalog.">Querying Recovery Catalog Views</a></p>
                  </li>
               </ul>
            </div><a id="BRADV8135"></a><div class="props_rev_3"><a id="GUID-AAAE5ACE-EE63-4AD1-8F63-B0F4F6F1D1B2" name="GUID-AAAE5ACE-EE63-4AD1-8F63-B0F4F6F1D1B2"></a><h3 id="BRADV-GUID-AAAE5ACE-EE63-4AD1-8F63-B0F4F6F1D1B2" class="sect3"><span class="enumeration_section">11.1 </span>Overview of RMAN Reporting
               </h3>
               <div>
                  <p>This section explains the purpose and basic concepts of RMAN reporting.</p>
               </div><a id="BRADV89582"></a><div class="props_rev_3"><a id="GUID-0FC15229-684C-4279-8E60-CC0B4079FB5F" name="GUID-0FC15229-684C-4279-8E60-CC0B4079FB5F"></a><h4 id="BRADV-GUID-0FC15229-684C-4279-8E60-CC0B4079FB5F" class="sect4"><span class="enumeration_section">11.1.1 </span>Purpose of RMAN Reporting
                  </h4>
                  <div>
                     <p>As part of your backup and recovery strategy, you should periodically run reports that indicate what you have backed up. You can determine which data files need backups or which files were not backed up recently. Also, you can preview which backups RMAN must restore if a problem occurs.</p>
                     <p>Another important aspect of backup and recovery is monitoring space usage. If you back up to disk, then it is possible for the disk to fill, which can create performance problems or even cause the database to halt. You can use RMAN to determine whether a backup is an <a href="glossary.html#GUID-A4D8B0BE-D3B9-4DD9-A7B3-BC0D88D25DC0"><span class="xrefglossterm">obsolete backup</span></a> and can therefore be deleted.
                     </p>
                     <p>You may also need to obtain historical information about RMAN jobs. For example, you may want to know how many backup jobs have been issued, the status of each backup job (for example, whether it failed or completed), when a job started and finished, and what type of backup was performed.</p>
                  </div>
               </div><a id="BRADV89583"></a><div class="props_rev_3"><a id="GUID-1C655AF1-B3CD-452C-BC3C-A566912311FF" name="GUID-1C655AF1-B3CD-452C-BC3C-A566912311FF"></a><h4 id="BRADV-GUID-1C655AF1-B3CD-452C-BC3C-A566912311FF" class="sect4"><span class="enumeration_section">11.1.2 </span>Basic Concepts of RMAN Reporting
                  </h4>
                  <div>
                     <p>RMAN stores metadata of every database on which it performs operations.</p>
                     <p>RMAN always stores its RMAN repository of metadata in the control file of the target database. For example, suppose that you use RMAN to back up the <code class="codeph">prod1</code> and <code class="codeph">prod2</code> databases. RMAN stores the metadata for backups of <code class="codeph">prod1</code> in the control file of <code class="codeph">prod1</code>, and the metadata for backups of <code class="codeph">prod2</code> in the control file of <code class="codeph">prod2</code>.
                     </p>
                     <p>Optionally, you can use RMAN with a <a href="glossary.html#GUID-CBFA8015-2DFF-42B1-A818-D6C5B92C608F"><span class="xrefglossterm">recovery catalog</span></a>. In this case, RMAN maintains an additional repository of metadata in a set of tables in a separate <a href="glossary.html#GUID-C54D9858-2461-412B-95FF-80FBACD58AB0"><span class="xrefglossterm">recovery catalog database</span></a>. For example, you could create a recovery catalog in <code class="codeph">prod3</code>. You can register multiple target databases in this recovery catalog. For example, if you register <code class="codeph">prod1</code> and <code class="codeph">prod2</code> in the recovery catalog stored in <code class="codeph">prod3</code>, then RMAN stores metadata about its backups of <code class="codeph">prod1</code> and <code class="codeph">prod2</code> in the <a href="glossary.html#GUID-3EF7A531-FA6D-483B-AE34-F87D31DCE572"><span class="xrefglossterm">recovery catalog schema</span></a>.
                     </p>
                     <p>The following table lists the techniques used to access metadata from the RMAN repository.</p>
                     <div class="tblformal" id="GUID-1C655AF1-B3CD-452C-BC3C-A566912311FF__GUID-A84C150E-9505-45B2-A3A2-F08486E336C2">
                        <p class="titleintable">Table 11-1 Techniques for Accessing Data from the RMAN Repository</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="Techniques for Accessing Data from the RMAN Repository" summary="This table describes the techniques available for accessing data from the RMAN repository." frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="20%" id="d53814e476">Technique</th>
                                 <th align="left" valign="bottom" width="20%" id="d53814e478">Description</th>
                                 <th align="left" valign="bottom" width="20%" id="d53814e480">Additional Information</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d53814e484" headers="d53814e476 ">
                                    <p>RMAN <code class="codeph">LIST</code> and <code class="codeph">REPORT</code> commands
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d53814e484 d53814e478 ">
                                    <p>The RMAN <code class="codeph">LIST</code> and <code class="codeph">REPORT</code> commands provide extensive information about available backups and how they can be used to restore and recover your database.
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d53814e484 d53814e480 ">
                                    <ul style="list-style-type: disc;">
                                       <li>
                                          <p><span class="q">"<a href="reporting-rman-operations.html#GUID-1B911001-C106-4267-9265-F649946DBF52" title="The LIST command uses the information in the RMAN repository to provide lists of backups and other objects relating to backup and recovery.">Listing Backups and Recovery-Related Objects</a>"</span></p>
                                       </li>
                                       <li>
                                          <p><span class="q">"<a href="reporting-rman-operations.html#GUID-A1FDD9FE-74B8-4146-AFC4-6BD5402C8B5D" title="The RMAN REPORT command analyzes the available backups and your database.">Reporting on Backups and Database Schema</a>"</span></p>
                                       </li>
                                       <li>
                                          <p><code class="codeph">LIST</code> , <code class="codeph">REPORT</code>, and <code class="codeph">RESTORE</code> commands in <a href="../rcmrf/LIST.html#RCMRF132" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a> 
                                          </p>
                                       </li>
                                    </ul>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d53814e544" headers="d53814e476 ">
                                    <p><code class="codeph">V$</code> views 
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d53814e544 d53814e478 ">
                                    <p>When the database is open, several <code class="codeph">V$</code> views provide direct access to RMAN repository records in the control file of each target database.
                                    </p>
                                    <p>Some <code class="codeph">V$</code> views such as <code class="codeph">V$DATAFILE_HEADER</code>, <code class="codeph">V$PROCESS</code>, and <code class="codeph">V$SESSION</code> contain information not found in the recovery catalog views.
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d53814e544 d53814e480 ">
                                    <p><a href="../refrn/dynamic-performance-v-views-1.html#REFRN-GUID-A634ED26-2334-40F5-A016-22973F54BEDA" target="_blank"><span><cite>Oracle Database Reference</cite></span></a></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d53814e577" headers="d53814e476 ">
                                    <p><code class="codeph">RC_</code> views
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d53814e577 d53814e478 ">
                                    <p>If your database is registered in a recovery catalog, then <code class="codeph">RC_</code> views provide direct access to the RMAN repository data stored in the recovery catalog.
                                    </p>
                                    <p>The <code class="codeph">RC_</code> views mostly correspond to the <code class="codeph">V$</code> views.
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d53814e577 d53814e480 ">
                                    <p><a href="../rcmrf/recovery-catalog-views.html#RCMRF003" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d53814e604" headers="d53814e476 ">
                                    <p><code class="codeph">RESTORE ... PREVIEW </code> and <code class="codeph">RESTORE ... VALIDATE HEADER</code> commands 
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d53814e604 d53814e478 ">
                                    <p>These commands list the backups that RMAN can restore to the specified time.</p>
                                    <p><code class="codeph">RESTORE ... PREVIEW</code> queries the metadata but does not read the backup files. The <code class="codeph">RESTORE ... VALIDATE HEADER</code> command performs the same work, but in addition to listing the files needed for restore and recovery operations, the command validates the backup file headers to determine whether the files on disk or in the media management catalog correspond to the metadata in the RMAN repository.
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d53814e604 d53814e480 ">
                                    <p>These commands are documented in <span class="q">"<a href="rman-complete-database-recovery.html#GUID-8837082E-3409-4D00-9836-3B9617720349" title="Previewing backups helps you to ensure that all backups required for a restore and recovery operation are available.">Previewing Backups Used in Restore Operations</a>"</span></p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>The RMAN repository can sometimes fail to reflect the reality on disk and tape. For example, a user may delete a backup with an operating system utility, so that the RMAN repository incorrectly reports the backup as available. You can use commands such as <code class="codeph">CHANGE</code>, <code class="codeph">CROSSCHECK</code>, and <code class="codeph">DELETE</code> to update the RMAN repository to reflect the actual state of available backups. Otherwise, the output of the commands and views may be misleading, which means that RMAN may not be able to find the backups to restore and recover your database.
                     </p>
                     <div class="infoboxnotealso" id="GUID-1C655AF1-B3CD-452C-BC3C-A566912311FF__GUID-37B22BAE-190E-4F12-8F03-544F873C9DD3">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="maintaining-rman-backups.html#GUID-EFF8F8D1-D67C-4202-9C8E-DE74ADFF1FFB" title="To ensure that data about backups in the recovery catalog or control file is synchronized with corresponding data on disk or in the media management catalog, perform a crosscheck. The CROSSCHECK command operates only on files that are currently recorded in the RMAN repository.">Crosschecking the RMAN Repository</a> to learn how to keep the RMAN repository current
                              </p>
                           </li>
                           <li>
                              <p><a href="maintaining-rman-backups.html#GUID-F5C3D045-279B-4AB3-8A91-3231A716402C" title="The recommended maintenance strategy is to configure a fast recovery area, a backup retention policy, and an archived redo log deletion policy. In this case, the database automatically maintains and deletes backups and archived redo logs as needed. However, manual maintenance of database backups and archived redo logs is sometimes necessary.RMAN provides multiple commands to maintain RMAN backups and repository records.RMAN always stores its metadata in the control file of each target database on which it performs operations. If you register a target database in the recovery catalog, then RMAN stores the metadata for this target database in the recovery catalog. The database in a Data Guard environment that creates a backup or copy is associated with the file. For example, if RMAN is connected to target database standby1 and backs it up, then this backup is associated with standby1.For a crosscheck, RMAN can only update the status of a file from AVAILABLE to EXPIRED when connected to the database associated with the file. RMAN can delete files when connected to any database. If RMAN is not connected as TARGET to the database associated with a file, and if RMAN cannot delete a file successfully, then RMAN prompts you to connect as TARGET to the database associated with the file. You must then use DELETE ... FORCE to delete the file metadata.If a maintenance command changes RMAN metadata only, then you can connect RMAN as TARGET to any database in the Data Guard environment. A backup remains associated with a database unless you explicitly use the CHANGE ... RESET DB_UNIQUE_NAME to associate the backup with a different database.RMAN is designed to work without a recovery catalog. If you choose not to use a recovery catalog, however, then the control file of each target database is the exclusive repository for RMAN metadata.The control file contains two types of records: circular reuse records and noncircular reuse records.When a control file record containing information about a file created in the fast recovery area is about to be reused, the database attempts to delete the file from the fast recovery area when the file is eligible for deletion. Otherwise, the database expands the size of the control file section containing the record for this file.The best way to prevent the loss of RMAN metadata because of overwritten control file records is to use a recovery catalog.If you are not using a recovery catalog to store RMAN metadata, then it is doubly important that you protect each target database control file.Although the fast recovery area is largely self-managing, some situations may require database administration intervention.RMAN uses certain rules to determine when files can be deleted from the fast recovery area.You can use the V$RECOVERY_FILE_DEST and V$RECOVERY_AREA_USAGE views to determine whether you have allocated enough space for your fast recovery area.You cannot manage the flashback logs in the fast recovery area directly other than by setting the flashback retention target or using guaranteed restore points.If the RMAN retention policy requires keeping a set of backups larger than the fast recovery area disk quota, or if the retention policy is set to NONE, then the fast recovery area can fill completely with no reclaimable space.Use the ALTER SYSTEM command to change the location of the fast recovery area.The ALTER SYSTEM command can be used to disable the fast recovery area.As a rule, the fast recovery area is self-maintaining. When an instance crashes during the creation of a file in the fast recovery area, however, the database may leave the file in the fast recovery area.Several situations can cause a discrepancy between the repository and the files that it records, including tape or disk failures and user-managed copies or deletions of RMAN-related files.To ensure that data about backups in the recovery catalog or control file is synchronized with corresponding data on disk or in the media management catalog, perform a crosscheck. The CROSSCHECK command operates only on files that are currently recorded in the RMAN repository.Crosschecks update outdated RMAN repository information about backups whose repository records do not match their physical status. For example, if a user removes archived logs from disk with an operating system command, the repository still indicates that the logs are on disk, when in fact they are not.After connecting to the target database and recovery catalog (if you use one), run CROSSCHECK commands as needed to verify the status and availability of backups known to RMAN.You can use the LIST command to report your backups and then use the CROSSCHECK command to check that specific backups described in the LIST output still exist. Use the CROSSCHECK command to verify the status and availability of preplugin backups and preplugin archived redo log files known to RMAN.RMAN provides multiple methods of changing the repository status of backups and copies.Run the CHANGE...UNAVAILABLE command when a backup cannot be found or has migrated offsite.You can designate backups as exempt from the retention policy. This technique is useful for archiving backups to comply with business requirements.Use the CHANGE command with the GUID option to change the status of backups that correspond to pluggable databases (PDBs) that have been dropped from a multitenant container database (CDB).Use the CHANGE command to modify the repository status of preplugin backups and preplugin archived redo log files.You can use the CATALOG command to make RMAN aware of the existence of archived logs not recorded in the repository or copies of database files that are created through means other than RMAN. The target database control file keeps records of all archived redo logs generated by the target database and all RMAN backups. The purpose of the CATALOG command is to add metadata to the repository when it does not have a record of files for RMAN to manage.Use the CATALOG command to propagate information about user-managed copies to the RMAN repository. After the files are cataloged, you can run the LIST command or query V$BACKUP_FILES view to confirm the information is contained in the RMAN repository.You can catalog backup pieces on disk. This technique is useful if you use an operating system utility to copy backup pieces from one location to another on the same host, or from one host to another. If you use Automatic Storage Management (ASM), an Oracle Managed Files framework, or the fast recovery area, then you may want to recatalog files that are known to the disk management system but are no longer listed in the RMAN repository. This situation can occur when the intended mechanism for tracking file names fails due to media failure, software bug, or user error.Use the CATALOG command to add preplugin archived redo log files to the RMAN repository.You can remove records for files from the RMAN repository.You can use the CHANGE ... UNCATALOG command to update the RMAN repository for the absent files.You can use the RMAN DELETE command to delete archived redo logs and RMAN backups. Every RMAN backup produces a corresponding record in the RMAN repository. This record is stored in the control file. If a recovery catalog is used, then the record can also be found in the recovery catalog after the recovery catalog is resynchronized from the control file. You can delete backups and recovery catalog records for backups.The recommended maintenance strategy is to configure a fast recovery area, a backup retention policy, and an archived redo log deletion policy.Use the RMAN DELETE command to delete backups and image copies.You can use both the DELETE and BACKUP ... DELETE commands to delete specific backups and copies.You can use BACKUP ... DELETE to back up archived redo logs, data file copies, or backup sets and then delete the input files after successfully backing them up. If you run CROSSCHECK, and if RMAN cannot locate the files, then it updates their records in the RMAN repository to EXPIRED status. You can then use the DELETE EXPIRED command to remove records of expired backups and copies from the RMAN repository.The RMAN DELETE command supports an OBSOLETE option, which deletes backups that are no longer needed to satisfy specified recoverability requirements. Use the DELETE command with the GUID option to delete backups of pluggable databases (PDBs) that have been dropped from a multitenant container database (CDB).Use the DELETE command to delete preplugin backups and prelplugin archived redo log files.To remove a database from the operating system, you can use the DROP DATABASE command in RMAN. RMAN removes the server parameter file, all data files, online redo logs, and control files belonging to the target database.">Maintaining RMAN Backups and Repository&nbsp;Records</a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="BRADV89584"></a><div class="props_rev_3"><a id="GUID-06F4023A-3517-4BDB-BEA3-1E7186A5492D" name="GUID-06F4023A-3517-4BDB-BEA3-1E7186A5492D"></a><h4 id="BRADV-GUID-06F4023A-3517-4BDB-BEA3-1E7186A5492D" class="sect4"><span class="enumeration_section">11.1.3 </span>Reporting in a Data Guard Environment
                  </h4>
                  <div>
                     <p>In a Data Guard environment, you can use the <code class="codeph">LIST</code>, <code class="codeph">REPORT</code>, and <code class="codeph">SHOW</code> commands just as you can when not using Data Guard. You can run these commands with the <code class="codeph">FOR DB_UNIQUE_NAME</code> clause to show the backups associated with a specified database. 
                     </p>
                     <div class="section">
                        <p>As explained in <span class="q">"<a href="rman-architecture.html#GUID-E514F9D2-D96E-4087-B8C5-5A8EB6A44E6B" title="RMAN uses a recovery catalog to track file names for all database files in a Data Guard environment.">About RMAN File Management in a Data Guard Environment</a>"</span>, every backup is associated with the primary or standby database that created it. For example, if you backed up the database with the <code class="codeph">DB_UNIQUE_NAME</code> of <code class="codeph">standby1</code>, then the <code class="codeph">standby1</code> database is associated with this backup.
                        </p>
                        <p>For example, the following command lists archived redo logs associated only with <code class="codeph">sfstandby</code>:
                        </p><pre class="pre codeblock"><code>LIST ARCHIVELOG ALL FOR DB_UNIQUE_NAME sfstandby;
</code></pre><p>If you use the <code class="codeph">LIST</code>, <code class="codeph">REPORT</code>, and <code class="codeph">SHOW</code> commands in a Data Guard environment <span class="italic">without</span> specifying the <code class="codeph">FOR DB_UNIQUE_NAME</code> clause, then RMAN shows the files that are accessible to the target database. <span class="q">"<a href="rman-architecture.html#GUID-3DDC5739-0A55-4F04-BE4C-4705E300C87F" title="The recovery catalog tracks the files in the Data Guard environment by associating every database file or backup file with a DB_UNIQUE_NAME. The database that creates a file is associated with the file.">About Association of Backups in a Data Guard Environment</a>"</span> explains when backups are considered accessible to RMAN.
                        </p>
                        <p>In a Data Guard environment, you must use RMAN with a recovery catalog. RMAN stores the metadata for all backup and recovery files in the Data Guard environment in the recovery catalog. When running the RMAN reporting commands, you can either connect RMAN as <code class="codeph">TARGET</code> to a mounted or open database, or identify the database with the <code class="codeph">SET DBID</code> command.
                        </p>
                        <div class="infoboxnotealso" id="GUID-06F4023A-3517-4BDB-BEA3-1E7186A5492D__GUID-5A2B1EA5-91EA-44DA-B934-1A2D9D01597D">
                           <p class="notep1">See Also:</p>
                           <p><a href="../sbydb/using-RMAN-in-oracle-data-guard-configurations.html#SBYDB04700" target="_blank"><span><cite>Oracle Data Guard Concepts and Administration</cite></span></a> to report on RMAN operations in a Data Guard environment
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="BRADV8136"></a><div class="props_rev_3"><a id="GUID-1B911001-C106-4267-9265-F649946DBF52" name="GUID-1B911001-C106-4267-9265-F649946DBF52"></a><h3 id="BRADV-GUID-1B911001-C106-4267-9265-F649946DBF52" class="sect3"><span class="enumeration_section">11.2 </span>Listing Backups and Recovery-Related Objects
               </h3>
               <div>
                  <p>The <code class="codeph">LIST</code> command uses the information in the RMAN repository to provide lists of backups and other objects relating to backup and recovery. 
                  </p>
                  <p>This section contains the following topics:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="reporting-rman-operations.html#GUID-2CD81DF5-F74C-43E1-A202-23D8811BB098" title="The primary purpose of the LIST command is to list backup and copies.">About the LIST Command</a></p>
                     </li>
                     <li>
                        <p><a href="reporting-rman-operations.html#GUID-EBE4B021-273E-4208-97FC-AA1F2AE092FF" title="Specify the desired objects with the listObjList or recordSpec clause. If you do not specify an object, then RMAN displays copies of all database files and archived redo log files.">Listing All Backups and Copies</a></p>
                     </li>
                     <li>
                        <p><a href="reporting-rman-operations.html#GUID-27C4AD72-0556-4388-AD65-8224C49E388F" title="You can specify several different conditions to narrow your LIST output.">Listing Selected Backups and Copies</a></p>
                     </li>
                     <li>
                        <p><a href="reporting-rman-operations.html#GUID-1019A5BE-C3A0-4036-86E3-017F6E620A7D" title="Use the LIST command to list preplugin backups and preplugin archived redo log files.">Listing Preplugin Backups</a></p>
                     </li>
                     <li>
                        <p><a href="reporting-rman-operations.html#GUID-D46FAC21-3514-4A6D-967A-BDEA5E9CB0EB" title="Each time an OPEN RESETLOGS operation is performed on a database, this operation creates a new incarnation of the database.">Listing Database Incarnations</a></p>
                     </li>
                  </ul>
               </div><a id="BRADV274"></a><a id="BRADV275"></a><a id="BRADV89585"></a><div class="props_rev_3"><a id="GUID-2CD81DF5-F74C-43E1-A202-23D8811BB098" name="GUID-2CD81DF5-F74C-43E1-A202-23D8811BB098"></a><h4 id="BRADV-GUID-2CD81DF5-F74C-43E1-A202-23D8811BB098" class="sect4"><span class="enumeration_section">11.2.1 </span>About the LIST Command
                  </h4>
                  <div>
                     <p>The primary purpose of the <code class="codeph">LIST</code> command is to list backup and copies. 
                     </p>
                     <p>For example, you can list:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Backups and proxy copies of a database, tablespace, data file, archived redo log, or control file</p>
                        </li>
                        <li>
                           <p>Backups that have expired</p>
                        </li>
                        <li>
                           <p>Backups restricted by time, path name, device type, tag, or recoverability</p>
                        </li>
                        <li>
                           <p>Archived redo log files and disk copies</p>
                        </li>
                     </ul>
                     <p>Besides backups and copies, RMAN can list other types of data. The following table summarizes several useful objects that you can list.</p>
                     <div class="tblformal" id="GUID-2CD81DF5-F74C-43E1-A202-23D8811BB098__CIHCGEIG">
                        <p class="titleintable">Table 11-2 LIST Objects</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="LIST Objects" summary="This table describes options for the LIST command and list contents. " width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" id="d53814e1238">Contents of List</th>
                                 <th align="left" valign="bottom" id="d53814e1241">Command</th>
                                 <th align="left" valign="bottom" id="d53814e1244">Description</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d53814e1249" headers="d53814e1238 ">
                                    <p>Backup sets and proxy copies</p>
                                 </td>
                                 <td align="left" valign="top" headers="d53814e1249 d53814e1241 ">
                                    <p><code class="codeph">LIST BACKUP</code></p>
                                 </td>
                                 <td align="left" valign="top" headers="d53814e1249 d53814e1244 ">
                                    <p>You can list all backup sets, copies, and proxy copies of a database, tablespace, data file, archived redo log, control file, or server parameter file.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d53814e1260" headers="d53814e1238 ">
                                    <p>Image copies</p>
                                 </td>
                                 <td align="left" valign="top" headers="d53814e1260 d53814e1241 ">
                                    <p><code class="codeph">LIST COPY</code></p>
                                 </td>
                                 <td align="left" valign="top" headers="d53814e1260 d53814e1244 ">
                                    <p>You can list data file copies and archived redo log files. By default, <code class="codeph">LIST COPY</code> displays copies of all database files and archived redo logs. Both usable and unusable image copies are included in the output, even those that cannot be restored or are expired or unavailable.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d53814e1274" headers="d53814e1238 ">
                                    <p>Archived redo log files</p>
                                 </td>
                                 <td align="left" valign="top" headers="d53814e1274 d53814e1241 ">
                                    <p><code class="codeph">LIST ARCHIVELOG</code></p>
                                 </td>
                                 <td align="left" valign="top" headers="d53814e1274 d53814e1244 ">
                                    <p>You can list archive redo log files. You can list all archive log redo log files or specify individual archive log files through SCN, time, or sequence number ranges. If you specify a range you can further restrict the list returned by specifying an incarnation number.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d53814e1285" headers="d53814e1238 ">
                                    <p>Preplugin backups</p>
                                 </td>
                                 <td align="left" valign="top" headers="d53814e1285 d53814e1241 ">
                                    <p><code class="codeph">LIST ... PREPLUGIN</code></p>
                                 </td>
                                 <td align="left" valign="top" headers="d53814e1285 d53814e1244 ">
                                    <p></p>
                                    <p>You can list all preplugin backups and preplugin archived redo log files.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d53814e1297" headers="d53814e1238 ">
                                    <p>Database incarnations</p>
                                 </td>
                                 <td align="left" valign="top" headers="d53814e1297 d53814e1241 ">
                                    <p><code class="codeph">LIST INCARNATION</code></p>
                                 </td>
                                 <td align="left" valign="top" headers="d53814e1297 d53814e1244 ">
                                    <p>You can list all incarnations of a database. A new database <a href="glossary.html#GUID-4CCAB7DD-FEA7-4237-AF2C-304BA3BD52B1"><span class="xrefglossterm">incarnation</span></a> is created when you open with the <code class="codeph">RESETLOGS</code> option.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d53814e1314" headers="d53814e1238 ">
                                    <p>Databases in a Data Guard environment</p>
                                 </td>
                                 <td align="left" valign="top" headers="d53814e1314 d53814e1241 ">
                                    <p><code class="codeph">LIST DB_UNIQUE_NAME</code></p>
                                 </td>
                                 <td align="left" valign="top" headers="d53814e1314 d53814e1244 ">
                                    <p>A database in a Data Guard environment is distinguished by its <code class="codeph">DB_UNIQUE_NAME</code> initialization parameter setting. You can list all databases that have the same DBID.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d53814e1328" headers="d53814e1238 ">
                                    <p>Backups and copies for a primary or standby database in a Data Guard environment</p>
                                 </td>
                                 <td align="left" valign="top" headers="d53814e1328 d53814e1241 ">
                                    <p><code class="codeph">LIST ... FOR DB_UNIQUE_NAME</code></p>
                                 </td>
                                 <td align="left" valign="top" headers="d53814e1328 d53814e1244 ">
                                    <p>You can list all backups and copies for a specified database in a Data Guard environment or for all databases in the environment.</p>
                                    <p>RMAN restricts the output to files or objects associated exclusively with the database with the specified <code class="codeph">DB_UNIQUE_NAME</code>. For example, you can use <code class="codeph">LIST</code> with <code class="codeph">FOR DB_UNIQUE_NAME</code> to display the list of archived redo log files associated with a particular standby or primary database. Objects that are not owned by any database (<code class="codeph">SITE_KEY</code> column in the recovery catalog view is null) are not listed.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d53814e1353" headers="d53814e1238 ">
                                    <p>Restore points</p>
                                 </td>
                                 <td align="left" valign="top" headers="d53814e1353 d53814e1241 ">
                                    <p><code class="codeph">LIST RESTORE POINT</code></p>
                                 </td>
                                 <td align="left" valign="top" headers="d53814e1353 d53814e1244 ">
                                    <p>You can list restore points known to the RMAN repository.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d53814e1364" headers="d53814e1238 ">
                                    <p>Names of stored scripts</p>
                                 </td>
                                 <td align="left" valign="top" headers="d53814e1364 d53814e1241 ">
                                    <p><code class="codeph">LIST SCRIPT NAMES</code></p>
                                 </td>
                                 <td align="left" valign="top" headers="d53814e1364 d53814e1244 ">
                                    <p>You can list the names of recovery catalog scripts created with the <code class="codeph">CREATE SCRIPT</code> or <code class="codeph">REPLACE SCRIPT</code> command. A recovery catalog is required.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d53814e1381" headers="d53814e1238 ">
                                    <p>Failures for use with <a href="glossary.html#GUID-5E618F7B-127F-4BE2-9ED5-E9D1B828434D"><span class="xrefglossterm">Data Recovery Advisor</span></a></p>
                                 </td>
                                 <td align="left" valign="top" headers="d53814e1381 d53814e1241 ">
                                    <p><code class="codeph">LIST FAILURE</code></p>
                                 </td>
                                 <td align="left" valign="top" headers="d53814e1381 d53814e1244 ">
                                    <p>A <a href="glossary.html#GUID-046A9407-B78B-4BBA-BE2F-55D74EF4F2D8"><span class="xrefglossterm">failure</span></a> is a persistent data corruption mapped to a <a href="glossary.html#GUID-76EA30CA-A51E-44C9-AB25-E1D89AF711B2"><span class="xrefglossterm">repair option</span></a>. <a href="diagnosing-repairing-failures-dra.html#GUID-8C219B50-1F7F-4F7A-95EE-5F029AE7EB2A" title="The Data Recovery Advisor is a tool that helps reduce database recovery time by determining the best automated repair option for database failures.Data Recovery Advisor is an Oracle Database tool that automatically diagnoses data failures, determines and presents appropriate repair options, and executes repairs at the user's request.You must familiarize yourself with a few concepts before using the Data Recovery Advisor.Data Recovery Advisor has both a command-line and GUI interface. The GUI interface is available in Oracle Enterprise Manager Cloud Control.A checker is a diagnostic operation or procedure registered with the Health Monitor to assess the health of the database or its components. A failure is a persistent data corruption that is detected by a data integrity check.Every failure has a failure status: OPEN or CLOSED. Every failure has a failure priority: CRITICAL, HIGH, or LOW. Data Recovery Advisor only assigns CRITICAL or HIGH priority to diagnosed failures.For clarity, Data Recovery Advisor groups related failures together. The ADVISE FAILURE command can present both manual and automatic repair options. Data Recovery Advisor categorizes manual actions as either mandatory or optional.When possible, Data Recovery Advisor consolidates repairs to fix multiple failures into a single repair. A consolidated repair may contain multiple steps.Whenever Data Recovery Advisor generates an automated repair option, it creates a script that explains which commands RMAN intends to use to repair the failure. Data Recovery Advisor prints the location of this script, which is a text file residing on the operating system. Data Recovery Advisor is supported only on some database configurations.Data Recovery Advisor only supports single-instance databases. Oracle Real Application Clusters (Oracle RAC) databases are not supported.There are some limitations with Data Recovery Advisor in an Oracle Data Guard environment.Data Recovery Advisor can only be used to diagnose and repair data corruptions in non-CDBs and the root of a multitenant container database (CDB). Data Recovery Advisor is not supported for pluggable databases (PDBs).The Data Recovery Advisor workflow begins when you either suspect or discover a failure. You can discover failures in many ways, including error messages, alerts, trace files, and failed data integrity checks.You can use the Data Recovery Advisor to automatically diagnose data failures, determine appropriate repair options, and execute repairs in a CDB. If you suspect or know that one or more database failures have occurred, then use LIST FAILURE to obtain information about them.The easiest way to determine problems that your database is encountering is to use the LIST FAILURE command. Besides providing more verbose output, LIST FAILURE also enables you to restrict output.The database invokes data integrity checks reactively when a user transaction is trying to access corrupted data. In some cases, latent failures can go undetected. Use the ADVISE FAILURE command to display repair options after running LIST FAILURE in an RMAN session. This command prints a summary of the failures and implicitly closes all open failures that are repaired.If one or more failures exist, then you typically use LIST FAILURE to show information about the failures and then ADVISE FAILURE in the same RMAN session to obtain a report of your repair options.You can also request repair options for specific failures. You can specify failures by status (CRITICAL, HIGH, or LOW) or by failure number. You can also use EXCLUDE FAILURE to exclude one or more failures from the report.You can use Data Recovery Advisor to repair failures automatically.If ADVISE FAILURE suggests manual repairs, then try these first. If manual repairs are not possible, or if they do not repair all failures, then you can use REPAIR FAILURE to automatically fix failures suggested in the most recent ADVISE FAILURE command in your current RMAN session.By default the script is displayed to standard output. You can use the SPOOL command to write the script to an editable file.In some situations, you may want to use the CHANGE FAILURE command to alter the status or priority of a failure.">Diagnosing and Repairing Failures with Data Recovery Advisor</a> explains how to use <code class="codeph">LIST FAILURE</code> with the <code class="codeph">ADVISE</code> and <code class="codeph">REPAIR</code> commands.
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>The <code class="codeph">LIST</code> command supports options that control how output is displayed. <a href="reporting-rman-operations.html#GUID-2CD81DF5-F74C-43E1-A202-23D8811BB098__CIHJDIAB" title="This table describes the most common LIST command options.">Table 11-3</a> summarizes the most common <code class="codeph">LIST</code> options.
                     </p>
                     <div class="tblformal" id="GUID-2CD81DF5-F74C-43E1-A202-23D8811BB098__CIHJDIAB">
                        <p class="titleintable">Table 11-3 Most Common LIST Options</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="Most Common LIST Options" summary="This table describes the most common LIST command options." width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" id="d53814e1514">LIST Option</th>
                                 <th align="left" valign="bottom" id="d53814e1517">Description</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d53814e1522" headers="d53814e1514 ">
                                    <p><code class="codeph">LIST EXPIRED</code></p>
                                 </td>
                                 <td align="left" valign="top" headers="d53814e1522 d53814e1517 ">
                                    <p>Lists backups or copies that are recorded in the RMAN repository but that were not present at the expected location on disk or tape during the most recent <a href="glossary.html#GUID-F9B39FFF-D31F-4303-AF01-80A151B19D1F"><span class="xrefglossterm">crosscheck</span></a>. Such backups may have been deleted outside of RMAN.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d53814e1533" headers="d53814e1514 ">
                                    <p><code class="codeph">LIST ... BY FILE</code></p>
                                 </td>
                                 <td align="left" valign="top" headers="d53814e1533 d53814e1517 ">
                                    <p>Lists backups of each data file, archived redo log file, control file, and server parameter file. Each row describes a backup of a file.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d53814e1541" headers="d53814e1514 ">
                                    <p><code class="codeph">LIST ... SUMMARY</code></p>
                                 </td>
                                 <td align="left" valign="top" headers="d53814e1541 d53814e1517 ">
                                    <p>	Provides a one-line summary of each backup.</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>The <code class="codeph">LIST</code> objects and options are not exhausted by the contents of the preceding tables. For example, you can list backups restricted by time, path name, device type, tag, or recoverability.
                     </p>
                     <div class="infoboxnotealso" id="GUID-2CD81DF5-F74C-43E1-A202-23D8811BB098__GUID-C199A6F5-9D8F-4DAA-A7D2-19A7DD53AE2F">
                        <p class="notep1">See Also:</p>
                        <p><a href="../rcmrf/LIST.html#RCMRF132" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a> for a complete description of the <code class="codeph">LIST</code> command
                        </p>
                     </div>
                  </div>
               </div><a id="BRADV632"></a><a id="BRADV633"></a><a id="BRADV634"></a><a id="BRADV89586"></a><div class="props_rev_3"><a id="GUID-EBE4B021-273E-4208-97FC-AA1F2AE092FF" name="GUID-EBE4B021-273E-4208-97FC-AA1F2AE092FF"></a><h4 id="BRADV-GUID-EBE4B021-273E-4208-97FC-AA1F2AE092FF" class="sect4"><span class="enumeration_section">11.2.2 </span>Listing All Backups and Copies
                  </h4>
                  <div>
                     <p>Specify the desired objects with the <span class="italic"><code class="codeph">listObjList</code></span> or <span class="italic"><code class="codeph">recordSpec</code></span> clause. If you do not specify an object, then RMAN displays copies of all database files and archived redo log files.
                     </p>
                     <div class="section">
                        <p>By default, RMAN serially lists each backup or proxy copy and then identifies the files included in the backup. You can also list backups by file.</p>
                        <p>By default, RMAN lists in verbose mode, which means that it provides extensive, multiline information. You can also list backups in a summary mode if the verbose mode generates too much output.</p>
                        <p>To view a summary report of all backups and copies, execute the <code class="codeph">LIST</code> command with the <code class="codeph">SUMMARY</code> option.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-EBE4B021-273E-4208-97FC-AA1F2AE092FF__CIHECIBA">
                        <p class="titleinexample">Example 11-1 Summary Listing of All Backups</p>
                        <p>This example shows a summary of all RMAN backups.</p><pre class="pre codeblock"><code>RMAN&gt; <span class="bold">list backup summary;</span>

List of Backups
===============
Key     TY LV S Device Type Completion Time #Pieces #Copies Compressed Tag
------- -- -- - ----------- --------------- ------- ------- ---------- ---
1       B  A  A SBT_TAPE    21-OCT-13       1       1       NO         TAG20131021T094505
2       B  F  A SBT_TAPE    21-OCT-13       1       1       NO         TAG20131021T094513
3       B  A  A SBT_TAPE    21-OCT-13       1       1       NO         TAG20131021T094624
4       B  F  A SBT_TAPE    21-OCT-13       1       1       NO         TAG20131021T094639
5       B  F  A DISK        04-NOV-13       1       1       YES        TAG20131104T195949
</code></pre><p>To view verbose output for backups and copies, execute the <code class="codeph">LIST</code> command without the <code class="codeph">SUMMARY</code> option.
                        </p>
                     </div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-EBE4B021-273E-4208-97FC-AA1F2AE092FF__CIHDBBDB">
                        <p class="titleinexample">Example 11-2 Verbose Listings of Backups and Copies</p>
                        <p>This example lists RMAN backups and copies with the default verbose output.</p><pre class="pre codeblock"><code>RMAN&gt; <span class="bold">list backup;</span>

List of Backup Sets
===================

BS Key  Size       Device Type Elapsed Time Completion Time
------- ---------- ----------- ------------ ---------------
7       136M       DISK        00:00:20     04-NOV-13      
        BP Key: 7   Status: AVAILABLE  Compressed: NO  Tag: TAG20071104T200759
        Piece Name: /d2/RDBMS/backupset/2013_11_04/o1_mf_annnn_TAG20071104T200759_ztjxx3k8_.bkp

  List of Archived Logs in backup set 7
  Thrd Seq     Low SCN    Low Time  Next SCN   Next Time
  ---- ------- ---------- --------- ---------- ---------
  1    1       173832     21-OCT-13 174750     21-OCT-13
  1    2       174750     21-OCT-13 174755     21-OCT-13
  1    3       174755     21-OCT-13 174758     21-OCT-13

BS Key  Type LV Size       Device Type Elapsed Time Completion Time
------- ---- -- ---------- ----------- ------------ ---------------
8       Full    2M         DISK        00:00:01     04-NOV-13      
        BP Key: 8   Status: AVAILABLE  Compressed: NO  Tag: TAG20071104T200829
        Piece Name: /disk1/oracle/dbs/c-774627068-20131104-01
  Controlfile Included: Ckp SCN: 631510       Ckp time: 04-NOV-13
  SPFILE Included: Modification time: 21-OCT-13
</code></pre><pre class="pre codeblock"><code>RMAN&gt; <span class="bold">list copy;</span>

List of Datafile Copies
=======================
 
Key     File S Completion Time Ckp SCN    Ckp Time
------- ---- - --------------- ---------- ---------------
1       7    A 11-OCT-13       360072     11-OCT-13
        Name: /work/orcva/RDBMS/datafile/o1_mf_tbs_2_2lv7bf82_.dbf
        Tag: DF7COPY
 
2       8    A 11-OCT-13       360244     11-OCT-13
        Name: /work/orcva/RDBMS/datafile/o1_mf_tbs_2_2lv7qmcj_.dbf
        Tag: TAG20131011T184835
 
List of Control File Copies
===========================
 
Key     S Completion Time Ckp SCN    Ckp Time
------- - --------------- ---------- ---------------
3       A 11-OCT-13       360380     11-OCT-13
        Name: /d2/RDBMS/controlfile/o1_mf_TAG20131011T185335_2lv80zqd_.ctl
        Tag: TAG20131011T185335
 
List of Archived Log Copies for database with db_unique_name RDBMS
=====================================================================
 
Key     Thrd Seq     S Low Time
------- ---- ------- - ---------
1       1    1       A 11-OCT-13
        Name: /work/arc_dest/arcr_1_1_603561743.arc
 
2       1    2       A 11-OCT-13
        Name: /work/arc_dest/arcr_1_2_603561743.arc
 
3       1    3       A 11-OCT-13
        Name: /work/arc_dest/arcr_1_3_603561743.arc
</code></pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-EBE4B021-273E-4208-97FC-AA1F2AE092FF__CIHDFBDE">
                        <p class="titleinexample">Example 11-3 Listing Backups By File</p>
                        <p>This example illustrates how to list backups by file using <code class="codeph">LIST</code> with the <code class="codeph">BY FILE</code> option.
                        </p><pre class="pre codeblock"><code>RMAN&gt; <span class="bold">list backup by file;</span>

List of Datafile Backups
========================

File Key     TY LV S Ckp SCN    Ckp Time  #Pieces #Copies Compressed Tag
---- ------- -  -- - ---------- --------- ------- ------- ---------- ---
1    5       B  F  A 631092     04-NOV-13 1       1       YES        TAG20131104T195949
     2       B  F  A 175337     21-OCT-13 1       1       NO         TAG20131021T094513
2    5       B  F  A 631092     04-NOV-13 1       1       YES        TAG20131104T195949
     2       B  F  A 175337     21-OCT-13 1       1       NO         TAG20131021T094513

<span class="italic">... some rows omitted</span>

List of Archived Log Backups
============================

Thrd Seq     Low SCN    Low Time  BS Key  S #Pieces #Copies Compressed Tag
---- ------- ---------- --------- ------- - ------- ------- ---------- ---
1    1       173832     21-OCT-13 7       A 1       1       NO         TAG20131104T200759
                                  1       A 1       1       NO         TAG20131021T094505
1    2       174750     21-OCT-13 7       A 1       1       NO         TAG20131104T200759
                                  1       A 1       1       NO         TAG20131021T094505
<span class="italic">... some rows omitted</span>
1    38      575472     03-NOV-13 7       A 1       1       NO         TAG20131104T200759
1    39      617944     04-NOV-13 7       A 1       1       NO         TAG20131104T200759


List of Controlfile Backups
===========================
CF Ckp SCN Ckp Time  BS Key  S #Pieces #Copies Compressed Tag
---------- --------- ------- - ------- ------- ---------- ---
631510     04-NOV-13 8       A 1       1       NO         TAG20131104T200829
631205     04-NOV-13 6       A 1       1       NO         TAG20131104T200432

List of SPFILE Backups
======================
Modification Time BS Key  S #Pieces #Copies Compressed Tag
----------------- ------- - ------- ------- ---------- ---
21-OCT-13         8       A 1       1       NO         TAG20131104T200829
21-OCT-13         6       A 1       1       NO         TAG20131104T200432</code></pre><div class="infoboxnotealso" id="GUID-EBE4B021-273E-4208-97FC-AA1F2AE092FF__GUID-FA459717-AF6B-4533-81F0-00B453E8A6F3">
                           <p class="notep1">See Also:</p>
                           <p><a href="../rcmrf/LIST.html#RCMRF132" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a> for an explanation of the various column headings in the <code class="codeph">LIST</code> output
                           </p>
                        </div>
                     </div>
                     <!-- class="example" -->
                  </div>
               </div><a id="BRADV277"></a><a id="BRADV89589"></a><div class="props_rev_3"><a id="GUID-27C4AD72-0556-4388-AD65-8224C49E388F" name="GUID-27C4AD72-0556-4388-AD65-8224C49E388F"></a><h4 id="BRADV-GUID-27C4AD72-0556-4388-AD65-8224C49E388F" class="sect4"><span class="enumeration_section">11.2.3 </span>Listing Selected Backups and Copies
                  </h4>
                  <div>
                     <p>You can specify several different conditions to narrow your <code class="codeph">LIST</code> output.
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-27C4AD72-0556-4388-AD65-8224C49E388F__GUID-746DC500-C71E-481C-9B24-52D55ABB2B34">To list selected backups and copies:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Start RMAN and connect to a target database and recovery catalog (if used).</span></li>
                        <li class="stepexpand"><span>Run <code class="codeph">LIST COPY</code> or <code class="codeph">LIST BACKUP</code> with the <span class="italic"><code class="codeph">listObjList</code></span> or <span class="italic"><code class="codeph">recordSpec</code></span> clause. For example, enter any of the following commands:</span><div><pre class="pre codeblock"><code># lists backups of all files in database
LIST BACKUP OF DATABASE; 
# lists copy of specified datafile    
LIST COPY OF DATAFILE 'ora_home/oradata/trgt/system01.dbf'; 
# lists specified backup set
LIST BACKUPSET 213; 
# lists datafile copy
LIST DATAFILECOPY '/tmp/tools01.dbf';</code></pre><p>You can also restrict the search by specifying the <span class="italic"><code class="codeph">maintQualifier</code></span> or <code class="codeph">RECOVERABLE</code> clause. For example, enter any of the following commands:
                              </p>
                              <p></p><pre class="pre codeblock"><code># specify a backup set by tag
LIST BACKUPSET TAG 'weekly_full_db_backup';
# specify a backup or copy by device type
LIST COPY OF DATAFILE 'ora_home/oradata/trgt/system01.dbf' DEVICE TYPE sbt;
# specify a backup by directory or path
LIST COPY LIKE '/tmp/%';
# specify a backup or copy by a range of completion dates
LIST COPY OF DATAFILE 2 COMPLETED BETWEEN '10-DEC-2012' AND '17-DEC-2012';
# specify logs backed up at least twice to tape
LIST ARCHIVELOG ALL BACKED UP 2 TIMES TO DEVICE TYPE sbt;
# specify backup sets backed up at least once to disk
LIST BACKUPSET BACKED UP 1 TIMES TO DISK;
# specify backups of PDB backed up at least twice to sbt
LIST BACKUP OF PLUGGABLE DATABASE my_pdb BACKED UP 2 TIMES TO SBT;</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Examine the output.</span></li>
                     </ol>
                     <div class="section">
                        <p>The output depends upon the options that you pass to the <code class="codeph">LIST</code> command. For example, the following lists copies of data file <code class="codeph">1</code> contained in backup sets.
                        </p><pre class="pre codeblock"><code>RMAN&gt; LIST BACKUP OF DATAFILE 1;

List of Backup Sets
===================

BS Key  Type LV Size       Device Type Elapsed Time Completion Time
------- ---- -- ---------- ----------- ------------ ---------------
2       Full    230M       SBT_TAPE    00:00:49     21-OCT-13
        BP Key: 2   Status: AVAILABLE  Compressed: NO  Tag: TAG20131021T094513
        Handle: 02f4eatc_1_1   Media: /smrdir
  List of Datafiles in backup set 2
  File LV Type Ckp SCN    Ckp Time  Name
  ---- -- ---- ---------- --------- ----
  1       Full 175337     21-OCT-13 /oracle/dbs/tbs_01.f

BS Key  Type LV Size       Device Type Elapsed Time Completion Time
------- ---- -- ---------- ----------- ------------ ---------------
5       Full    233M       DISK        00:04:30     04-NOV-13
        BP Key: 5   Status: AVAILABLE  Compressed: NO  Tag: TAG20131104T195949
        Piece Name: /disk1/2013_11_04/o1_mf_nnndf_TAG20131104T195949_ztjxfvgz_.bkp
  List of Datafiles in backup set 5
  File LV Type Ckp SCN    Ckp Time  Name
  ---- -- ---- ---------- --------- ----
  1       Full 631092     04-NOV-13 /oracle/dbs/tbs_01.f
</code></pre><div class="infoboxnotealso" id="GUID-27C4AD72-0556-4388-AD65-8224C49E388F__GUID-788AC2C8-5DA8-4FD8-8633-35CADC2DE990">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="../rcmrf/listObjList.html#RCMRF133" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a> for <span class="italic"><code class="codeph">listObjList</code></span> and <span class="italic"><code class="codeph">recordSpec</code></span> syntax
                                 </p>
                              </li>
                              <li>
                                 <p> <a href="../rcmrf/LIST.html#RCMRF132" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a> for an explanation of the columns in the <code class="codeph">LIST</code> output
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-1019A5BE-C3A0-4036-86E3-017F6E620A7D" name="GUID-1019A5BE-C3A0-4036-86E3-017F6E620A7D"></a><h4 id="BRADV-GUID-1019A5BE-C3A0-4036-86E3-017F6E620A7D" class="sect4"><span class="enumeration_section">11.2.4 </span>Listing Preplugin Backups
                  </h4>
                  <div>
                     <p>Use the <code class="codeph">LIST</code> command to list preplugin backups and preplugin archived redo log files.
                     </p>
                     <div class="section">
                        <p></p>
                     </div>
                     <!-- class="section" -->
                     <div class="p">The <code class="codeph">COMPATIBLE</code> parameter for the target CDB must be set to 18.0.0 or higher.
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Start RMAN and connect to the root of the target database as a common user with the <code class="codeph">SYSDBA</code> or <code class="codeph">SYSBACKUP</code> privilege. Connect to a recovery catalog, if used.</span></li>
                        <li class="stepexpand"><span>Ensure that the target CDB is in read-write or read-only mode.</span></li>
                        <li class="stepexpand"><span>Set the current container to the PDB whose backup objects you want to display by using the <code class="codeph">SET</code> command.</span><div>
                              <p>The following command sets the current container to <code class="codeph">my_pdb</code>.
                              </p><pre class="pre codeblock"><code>SET PREPLUGIN CONTAINER = my_pdb;</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Run the <code class="codeph">LIST PREPLUGIN</code> command with the <code class="codeph"><span class="codeinlineitalic">listObjList</span></code> or <code class="codeph"><span class="codeinlineitalic">recordSpec</span></code> clause to display preplugin backups.</span><div>
                              <p>To list preplugin backups of a PDB, use the following command:</p><pre class="pre codeblock"><code>LIST PREPLUGIN BACKUP OF PLUGGABLE DATABASE pdb1;</code></pre><p>To list all preplugin archived redo log files in the target CDB, use the following command:</p><pre class="pre codeblock"><code>LIST PREPLUGIN ARCHVELOG ALL;</code></pre></div>
                        </li>
                     </ol>
                  </div>
               </div><a id="BRADV89591"></a><div class="props_rev_3"><a id="GUID-D46FAC21-3514-4A6D-967A-BDEA5E9CB0EB" name="GUID-D46FAC21-3514-4A6D-967A-BDEA5E9CB0EB"></a><h4 id="BRADV-GUID-D46FAC21-3514-4A6D-967A-BDEA5E9CB0EB" class="sect4"><span class="enumeration_section">11.2.5 </span>Listing Database Incarnations
                  </h4>
                  <div>
                     <p>Each time an <code class="codeph">OPEN</code> <code class="codeph">RESETLOGS</code> operation is performed on a database, this operation creates a new incarnation of the database.
                     </p>
                     <div class="section">
                        <p>When performing incremental backups, RMAN can use a backup from a previous incarnation or the current incarnation as a basis for subsequent incremental backups. When performing restore and recovery operations, RMAN can use backups from a previous incarnation just as it can use backups from the current incarnation, if all archived logs are available.</p>
                        <p><span class="bold">To list database incarnations:</span></p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Start RMAN and connect to a target database and recovery catalog (if used).</span></li>
                        <li class="stepexpand"><span>Run the <code class="codeph">LIST</code> <code class="codeph">INCARNATION</code> command, as shown in the following example:</span><div><pre class="pre codeblock"><code>LIST INCARNATION;
</code></pre><p>If you are using a recovery catalog, and if you register multiple target databases in the same catalog, then you can distinguish them by using the <code class="codeph">OF</code> <code class="codeph">DATABASE</code> option:
                              </p><pre class="pre codeblock"><code>LIST INCARNATION OF DATABASE prod3;
</code></pre><p>Following is a sample output of listing the incarnation of a particular database:</p><pre class="pre codeblock"><code>RMAN&gt; LIST INCARNATION OF DATABASE rdbms;

List of Database Incarnations
DB Key  Inc Key DB Name  DB ID            STATUS  Reset SCN  Reset Time
------- ------- -------- ---------------- ------  ---------- ----------
1       1       RDBMS    774627068        PARENT  1          21-OCT-13
2       2       RDBMS    774627068        CURRENT 173832     21-OCT-13
</code></pre><p>The preceding output indicates that a <code class="codeph">RESETLOGS</code> operation was performed on database <code class="codeph">rdbms</code> at SCN 173832, resulting in a new incarnation. The incarnation is distinguished by incarnation key (represented in the <code class="codeph">Inc Key</code> column).
                              </p>
                              <div class="infoboxnotealso" id="GUID-D46FAC21-3514-4A6D-967A-BDEA5E9CB0EB__GUID-7818143E-96E6-4384-A231-3336CDD5575A">
                                 <p class="notep1">See Also:</p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p><a href="../rcmrf/LIST.html#RCMRF132" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a> for an explanation of the various column headings in the <code class="codeph">LIST</code> output
                                       </p>
                                    </li>
                                    <li>
                                       <p><a href="rman-data-repair-concepts.html#GUID-9942AC94-A35D-4A06-9A45-A5A43B82B23D" title="A database incarnation is created whenever you open the database with the RESETLOGS option.">About Database Incarnations</a> database incarnations and their effect on database recovery
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                           </div>
                        </li>
                     </ol>
                  </div>
               </div>
            </div><a id="BRADV8137"></a><div class="props_rev_3"><a id="GUID-A1FDD9FE-74B8-4146-AFC4-6BD5402C8B5D" name="GUID-A1FDD9FE-74B8-4146-AFC4-6BD5402C8B5D"></a><h3 id="BRADV-GUID-A1FDD9FE-74B8-4146-AFC4-6BD5402C8B5D" class="sect3"><span class="enumeration_section">11.3 </span>Reporting on Backups and Database Schema
               </h3>
               <div>
                  <p>The RMAN <code class="codeph">REPORT</code> command analyzes the available backups and your database. 
                  </p>
                  <p>This section contains the following topics:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="reporting-rman-operations.html#GUID-84A456A0-3012-4710-B710-155C4F477671" title="The REPORT command provides various reports of RMAN backups.">About Reports of RMAN Backups</a></p>
                     </li>
                     <li>
                        <p><a href="reporting-rman-operations.html#GUID-797C90B8-FAD2-4D43-8870-70C2936BD452" title="Use the REPORT NEED BACKUP command to determine which database files need backup under a specific retention policy.">Reporting on Files Needing a Backup Under a Retention Policy</a></p>
                     </li>
                     <li>
                        <p><a href="reporting-rman-operations.html#GUID-907FD8EB-D3C8-47B1-9076-A8A6109FE989" title="When a data file has been changed by an unrecoverable operation, such as a direct load insert, normal media recovery cannot be used to recover the file, because an unrecoverable operation does not generate redo. You must perform either a full or incremental backup of affected data files after such operations, to ensure that data blocks affected by the unrecoverable operation can be recovered using RMAN.">Reporting on Data Files Affected by Unrecoverable Operations</a></p>
                     </li>
                     <li>
                        <p><a href="reporting-rman-operations.html#GUID-DFC4A04F-E0AE-42E6-9B96-3815C62EF23F" title="You can report backup sets, backup pieces, and data file copies that are obsolete that is, not needed to meet a specified retention policy by specifying the OBSOLETE keyword.">Reporting on Obsolete Backups</a></p>
                     </li>
                     <li>
                        <p><a href="reporting-rman-operations.html#GUID-732DB3CD-0D09-4A52-A358-2E1E9F5E2C82" title="The REPORT SCHEMA command lists and displays information about the database files, tablespaces, and so on.">Reporting on the Database Schema</a></p>
                     </li>
                  </ul>
               </div><a id="BRADV278"></a><a id="BRADV89593"></a><div class="props_rev_3"><a id="GUID-84A456A0-3012-4710-B710-155C4F477671" name="GUID-84A456A0-3012-4710-B710-155C4F477671"></a><h4 id="BRADV-GUID-84A456A0-3012-4710-B710-155C4F477671" class="sect4"><span class="enumeration_section">11.3.1 </span>About Reports of RMAN Backups
                  </h4>
                  <div>
                     <p>The <code class="codeph">REPORT</code> command provides various reports of RMAN backups.
                     </p>
                     <p>You can use the <code class="codeph">REPORT</code> command to answer important questions, such as:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Which files need a backup?</p>
                        </li>
                        <li>
                           <p>Which files have had unrecoverable operations performed on them?</p>
                        </li>
                        <li>
                           <p>Which backups are obsolete and can be deleted?</p>
                        </li>
                        <li>
                           <p>What was the physical schema of the target database or a database in the Data Guard environment at some previous time?</p>
                        </li>
                        <li>
                           <p>Which files have not been backed up recently? </p>
                        </li>
                     </ul>
                     <p>Reports enable you to confirm that your backup and recovery strategy is in fact meeting your requirements for database recoverability. The two major forms of <code class="codeph">REPORT</code> used to determine whether your database is recoverable are:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><code class="codeph">REPORT NEED BACKUP</code> 
                           </p>
                           <p>Reports which database files must be backed up to meet a configured or specified retention policy</p>
                        </li>
                        <li>
                           <p><code class="codeph">REPORT UNRECOVERABLE</code></p>
                           <p>Reports which database files require backup because they have been affected by some <code class="codeph">NOLOGGING</code> operation such as a direct-path <code class="codeph">INSERT</code></p>
                        </li>
                     </ul>
                     <p>The RMAN repository contains other information that you can access with the <code class="codeph">REPORT</code> command. The following table summarizes the <code class="codeph">REPORT</code> options. 
                     </p>
                     <div class="tblformal" id="GUID-84A456A0-3012-4710-B710-155C4F477671__CHDBIADB">
                        <p class="titleintable">Table 11-4 REPORT Options</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="REPORT Options" summary="This table describes REPORT command options." width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" id="d53814e2478">Contents of Report</th>
                                 <th align="left" valign="bottom" id="d53814e2481">Command</th>
                                 <th align="left" valign="bottom" id="d53814e2484">Description</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d53814e2489" headers="d53814e2478 ">
                                    <p>Obsolete backups</p>
                                 </td>
                                 <td align="left" valign="top" headers="d53814e2489 d53814e2481 ">
                                    <p><code class="codeph">REPORT OBSOLETE</code></p>
                                 </td>
                                 <td align="left" valign="top" headers="d53814e2489 d53814e2484 ">
                                    <p>Full backups, data file copies, and archived redo logs recorded in the RMAN repository that can be deleted because they are no longer needed</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d53814e2500" headers="d53814e2478 ">
                                    <p>Database schema</p>
                                 </td>
                                 <td align="left" valign="top" headers="d53814e2500 d53814e2481 ">
                                    <p><code class="codeph">REPORT SCHEMA</code></p>
                                 </td>
                                 <td align="left" valign="top" headers="d53814e2500 d53814e2484 ">
                                    <p>The names of all data files (permanent and temporary) and tablespaces for the target database at the specified point in time. If you use RMAN in a Data Guard environment, then you can report the schema for a specified <code class="codeph">DB_UNIQUE_NAME</code>.
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="infoboxnotealso" id="GUID-84A456A0-3012-4710-B710-155C4F477671__GUID-C7A2339B-984E-4C28-BCF9-810944B2E981">
                        <p class="notep1">See Also:</p>
                        <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF147" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a> for a description of the <code class="codeph">REPORT</code> command
                        </p>
                     </div>
                  </div>
               </div><a id="BRADV89594"></a><div class="props_rev_3"><a id="GUID-797C90B8-FAD2-4D43-8870-70C2936BD452" name="GUID-797C90B8-FAD2-4D43-8870-70C2936BD452"></a><h4 id="BRADV-GUID-797C90B8-FAD2-4D43-8870-70C2936BD452" class="sect4"><span class="enumeration_section">11.3.2 </span>Reporting on Files Needing a Backup Under a Retention Policy
                  </h4>
                  <div>
                     <p>Use the <code class="codeph">REPORT NEED BACKUP</code> command to determine which database files need backup under a specific retention policy. 
                     </p>
                     <div class="section">
                        <p>With no arguments, <code class="codeph">REPORT NEED BACKUP</code> reports which objects need backup under the currently configured retention policy. The output for a configured retention policy of <code class="codeph">REDUNDANCY 1</code> is similar to this example:
                        </p><pre class="pre codeblock"><code>RMAN&gt; REPORT NEED BACKUP;

RMAN retention policy will be applied to the command
RMAN retention policy is set to redundancy 1
Report of files with less than 1 redundant backups
File #bkps Name
---- ----- -----------------------------------------------------
2    0     /oracle/oradata/trgt/undotbs01.dbf
</code></pre><div class="infoboxnote" id="GUID-797C90B8-FAD2-4D43-8870-70C2936BD452__GUID-8C1D7DB6-0733-48A0-A13A-DD796EB1CE71">
                           <p class="notep1">Note:</p>
                           <p>If you disable the retention policy using <code class="codeph">CONFIGURE RETENTION POLICY TO NONE</code> , then <code class="codeph">REPORT NEED BACKUP</code> returns an error message, because without a retention policy, RMAN cannot determine which files must be backed up.
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div><a id="BRADV89595"></a><div class="props_rev_3"><a id="GUID-39CFF5D1-610D-43E5-838E-368D205B85A4" name="GUID-39CFF5D1-610D-43E5-838E-368D205B85A4"></a><h5 id="BRADV-GUID-39CFF5D1-610D-43E5-838E-368D205B85A4" class="sect5"><span class="enumeration_section">11.3.2.1 </span>Using RMAN REPORT NEED BACKUP with Different Retention Policies
                     </h5>
                     <div>
                        <p>You can use options of the <code class="codeph">REPORT NEED BACKUP</code> command to specify different retention policies.
                        </p>
                        <div class="section">
                           <p>Use one of the following forms to specify different criteria for <code class="codeph">REPORT NEED BACKUP</code>:
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><code class="codeph">REPORT NEED BACKUP RECOVERY WINDOW OF </code><span class="italic"><code class="codeph">n</code></span> <code class="codeph">DAYS</code> 
                                 </p>
                                 <p>Displays objects requiring backup to satisfy a recovery window-based retention policy</p>
                              </li>
                              <li>
                                 <p><code class="codeph">REPORT NEED BACKUP REDUNDANCY </code> <span class="italic"><code class="codeph">n</code></span></p>
                                 <p>Displays objects requiring backup to satisfy a redundancy-based retention policy</p>
                              </li>
                              <li>
                                 <p><code class="codeph">REPORT NEED BACKUP DAYS </code> <span class="italic"><code class="codeph">n</code></span> 
                                 </p>
                                 <p>Displays files that require more than <span class="italic"><code class="codeph">n</code></span> days' worth of archived redo log files for recovery
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">REPORT NEED BACKUP INCREMENTAL </code> <span class="italic"><code class="codeph">n</code></span> 
                                 </p>
                                 <p>Displays files that require application of more than <span class="italic"><code class="codeph">n</code></span> incremental backups for recovery
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="BRADV89596"></a><div class="props_rev_3"><a id="GUID-EF685338-5D24-4CDE-8737-1BDCC1122A5E" name="GUID-EF685338-5D24-4CDE-8737-1BDCC1122A5E"></a><h5 id="BRADV-GUID-EF685338-5D24-4CDE-8737-1BDCC1122A5E" class="sect5"><span class="enumeration_section">11.3.2.2 </span>Using RMAN REPORT NEED BACKUP with Tablespaces and Data Files
                     </h5>
                     <div>
                        <p>The <code class="codeph">REPORT NEED BACKUP</code> command can check the entire database, skip specified tablespaces, or check only specific tablespaces or data files against different retention policies.
                        </p>
                        <div class="section">
                           <p>The following are examples:</p><pre class="oac_no_warn" dir="ltr">REPORT NEED BACKUP RECOVERY WINDOW OF 2 DAYS DATABASE SKIP TABLESPACE TBS_2;
REPORT NEED BACKUP REDUNDANCY 2 DATAFILE 1;
REPORT NEED BACKUP TABLESPACE TBS_3; # uses configured retention policy
REPORT NEED BACKUP INCREMENTAL 2; # checks entire database</pre><div class="infoboxnotealso" id="GUID-EF685338-5D24-4CDE-8737-1BDCC1122A5E__GUID-54534F55-E894-4B4D-ABE2-FC497CD91E06">
                              <p class="notep1">See Also:</p>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF147" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a> for all possible options for <code class="codeph">REPORT NEED BACKUP</code> and an explanation of the various column headings in the output
                              </p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="BRADV89597"></a><div class="props_rev_3"><a id="GUID-2111DD16-E7E0-40F6-A07B-EC56AE6A163B" name="GUID-2111DD16-E7E0-40F6-A07B-EC56AE6A163B"></a><h5 id="BRADV-GUID-2111DD16-E7E0-40F6-A07B-EC56AE6A163B" class="sect5"><span class="enumeration_section">11.3.2.3 </span>Using REPORT NEED BACKUP with Backups on Tape or Disk Only
                     </h5>
                     <div>
                        <p>You can limit the backups tested by the <code class="codeph">REPORT NEED BACKUP</code> command to disk-based or tape-based backups only.
                        </p>
                        <div class="section">
                           <p>Following are some examples:</p><pre class="pre codeblock"><code>REPORT NEED BACKUP RECOVERY WINDOW OF 2 DAYS DATABASE DEVICE TYPE sbt;
REPORT NEED BACKUP DEVICE TYPE DISK;
REPORT NEED BACKUP TABLESPACE TBS_3 DEVICE TYPE sbt; </code></pre></div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="BRADV279"></a><a id="BRADV89598"></a><div class="props_rev_3"><a id="GUID-907FD8EB-D3C8-47B1-9076-A8A6109FE989" name="GUID-907FD8EB-D3C8-47B1-9076-A8A6109FE989"></a><h4 id="BRADV-GUID-907FD8EB-D3C8-47B1-9076-A8A6109FE989" class="sect4"><span class="enumeration_section">11.3.3 </span>Reporting on Data Files Affected by Unrecoverable Operations
                  </h4>
                  <div>
                     <p>When a data file has been changed by an unrecoverable operation, such as a direct load insert, normal media recovery cannot be used to recover the file, because an unrecoverable operation does not generate redo. You must perform either a full or incremental backup of affected data files after such operations, to ensure that data blocks affected by the unrecoverable operation can be recovered using RMAN.</p>
                     <div class="section">
                        <p class="subhead3" id="GUID-907FD8EB-D3C8-47B1-9076-A8A6109FE989__GUID-DAF77BBD-1C30-4F59-8B00-ECA967EEC592">To identify data files affected by an unrecoverable operation: </p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Start RMAN and connect to a target database and recovery catalog (if used).</span><div>
                              <div class="infoboxnotealso" id="GUID-907FD8EB-D3C8-47B1-9076-A8A6109FE989__GUID-FCDA1745-E123-473B-9C27-53D07D734C87">
                                 <p class="notep1">See Also:</p>
                                 <p><a href="starting-interacting-with-rman-client.html#GUID-E07231B2-F213-4F8F-8D02-E410A6DAE94C" title="You can create database connections from the RMAN client or the operating system command line. These database connection can be authenticated using a password file or with operating system authentication.">Making Database Connections with RMAN</a></p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Execute the <code class="codeph">REPORT UNRECOVERABLE</code> command.</span><div>
                              <p>The following example includes sample output:</p><pre class="pre codeblock"><code>RMAN&gt; REPORT UNRECOVERABLE;

Report of files that need backup due to unrecoverable operations
File Type of Backup Required Name
---- ----------------------- -----------------------------------
1    full                    /oracle/oradata/trgt/system01.dbf</code></pre></div>
                        </li>
                     </ol>
                  </div>
               </div><a id="BRADV280"></a><a id="BRADV89599"></a><div class="props_rev_3"><a id="GUID-DFC4A04F-E0AE-42E6-9B96-3815C62EF23F" name="GUID-DFC4A04F-E0AE-42E6-9B96-3815C62EF23F"></a><h4 id="BRADV-GUID-DFC4A04F-E0AE-42E6-9B96-3815C62EF23F" class="sect4"><span class="enumeration_section">11.3.4 </span>Reporting on Obsolete Backups
                  </h4>
                  <div>
                     <p>You can report backup sets, backup pieces, and data file copies that are obsolete that is, not needed to meet a specified retention policy by specifying the <code class="codeph">OBSOLETE</code> keyword. 
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-DFC4A04F-E0AE-42E6-9B96-3815C62EF23F__GUID-F492C147-08A7-4B4A-8799-75F6441DD9DC">To report obsolete backups:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Start RMAN and connect to a target database and recovery catalog (if used).</span><div>
                              <div class="infoboxnotealso" id="GUID-DFC4A04F-E0AE-42E6-9B96-3815C62EF23F__GUID-FEFCC913-7A3B-4657-AE26-A765B124A26B">
                                 <p class="notep1">See Also:</p>
                                 <p><a href="starting-interacting-with-rman-client.html#GUID-E07231B2-F213-4F8F-8D02-E410A6DAE94C" title="You can create database connections from the RMAN client or the operating system command line. These database connection can be authenticated using a password file or with operating system authentication.">Making Database Connections with RMAN</a></p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Execute the <code class="codeph">CROSSCHECK</code> command to update the status of backups in the repository compared to their status on disk.</span><div>
                              <p>In the simplest case, you could crosscheck all backups on disk, tape or both, using any one of the following commands:</p><pre class="pre codeblock"><code>CROSSCHECK BACKUP DEVICE TYPE DISK;
CROSSCHECK BACKUP DEVICE TYPE sbt;
CROSSCHECK BACKUP; # crosschecks all backups on all devices 
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Run <code class="codeph">REPORT OBSOLETE</code> to identify which backups are obsolete because they are no longer needed for recovery.</span><div>
                              <p>If you do not specify any other options, then <code class="codeph">REPORT OBSOLETE</code> displays the backups that are obsolete according to the current retention policy, as shown in the following example:
                              </p><pre class="pre codeblock"><code>RMAN&gt; REPORT OBSOLETE;

RMAN retention policy will be applied to the command
RMAN retention policy is set to redundancy 1
Report of obsolete backups and copies
Type                 Key    Completion Time    Filename/Handle
-------------------- ------ ------------------ --------------------
Datafile Copy        44     08-FEB-13          /backup/ora_df549738566_s70_s1
Datafile Copy        45     08-FEB-13          /backup/ora_df549738567_s71_s1
Datafile Copy        46     08-FEB-13          /backup/ora_df549738568_s72_s1
Backup Set           26     08-FEB-13
  Backup Piece       26     08-FEB-13          /backup/ora_df549738682_s76_s1
.
.
.
</code></pre><p>You can also check which backups are obsolete under different recovery window-based or redundancy-based retention policies, by using <code class="codeph">REPORT OBSOLETE</code> with <code class="codeph">RECOVERY WINDOW</code> and <code class="codeph">REDUNDANCY</code> options, as shown in these examples:
                              </p><pre class="pre codeblock"><code>REPORT OBSOLETE RECOVERY WINDOW OF 3 DAYS;
REPORT OBSOLETE REDUNDANCY 1;</code></pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-DFC4A04F-E0AE-42E6-9B96-3815C62EF23F__GUID-CE1EA233-EFF8-4C10-86BB-0A89EA57376A">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="maintaining-rman-backups.html#GUID-F5C3D045-279B-4AB3-8A91-3231A716402C" title="The recommended maintenance strategy is to configure a fast recovery area, a backup retention policy, and an archived redo log deletion policy. In this case, the database automatically maintains and deletes backups and archived redo logs as needed. However, manual maintenance of database backups and archived redo logs is sometimes necessary.RMAN provides multiple commands to maintain RMAN backups and repository records.RMAN always stores its metadata in the control file of each target database on which it performs operations. If you register a target database in the recovery catalog, then RMAN stores the metadata for this target database in the recovery catalog. The database in a Data Guard environment that creates a backup or copy is associated with the file. For example, if RMAN is connected to target database standby1 and backs it up, then this backup is associated with standby1.For a crosscheck, RMAN can only update the status of a file from AVAILABLE to EXPIRED when connected to the database associated with the file. RMAN can delete files when connected to any database. If RMAN is not connected as TARGET to the database associated with a file, and if RMAN cannot delete a file successfully, then RMAN prompts you to connect as TARGET to the database associated with the file. You must then use DELETE ... FORCE to delete the file metadata.If a maintenance command changes RMAN metadata only, then you can connect RMAN as TARGET to any database in the Data Guard environment. A backup remains associated with a database unless you explicitly use the CHANGE ... RESET DB_UNIQUE_NAME to associate the backup with a different database.RMAN is designed to work without a recovery catalog. If you choose not to use a recovery catalog, however, then the control file of each target database is the exclusive repository for RMAN metadata.The control file contains two types of records: circular reuse records and noncircular reuse records.When a control file record containing information about a file created in the fast recovery area is about to be reused, the database attempts to delete the file from the fast recovery area when the file is eligible for deletion. Otherwise, the database expands the size of the control file section containing the record for this file.The best way to prevent the loss of RMAN metadata because of overwritten control file records is to use a recovery catalog.If you are not using a recovery catalog to store RMAN metadata, then it is doubly important that you protect each target database control file.Although the fast recovery area is largely self-managing, some situations may require database administration intervention.RMAN uses certain rules to determine when files can be deleted from the fast recovery area.You can use the V$RECOVERY_FILE_DEST and V$RECOVERY_AREA_USAGE views to determine whether you have allocated enough space for your fast recovery area.You cannot manage the flashback logs in the fast recovery area directly other than by setting the flashback retention target or using guaranteed restore points.If the RMAN retention policy requires keeping a set of backups larger than the fast recovery area disk quota, or if the retention policy is set to NONE, then the fast recovery area can fill completely with no reclaimable space.Use the ALTER SYSTEM command to change the location of the fast recovery area.The ALTER SYSTEM command can be used to disable the fast recovery area.As a rule, the fast recovery area is self-maintaining. When an instance crashes during the creation of a file in the fast recovery area, however, the database may leave the file in the fast recovery area.Several situations can cause a discrepancy between the repository and the files that it records, including tape or disk failures and user-managed copies or deletions of RMAN-related files.To ensure that data about backups in the recovery catalog or control file is synchronized with corresponding data on disk or in the media management catalog, perform a crosscheck. The CROSSCHECK command operates only on files that are currently recorded in the RMAN repository.Crosschecks update outdated RMAN repository information about backups whose repository records do not match their physical status. For example, if a user removes archived logs from disk with an operating system command, the repository still indicates that the logs are on disk, when in fact they are not.After connecting to the target database and recovery catalog (if you use one), run CROSSCHECK commands as needed to verify the status and availability of backups known to RMAN.You can use the LIST command to report your backups and then use the CROSSCHECK command to check that specific backups described in the LIST output still exist. Use the CROSSCHECK command to verify the status and availability of preplugin backups and preplugin archived redo log files known to RMAN.RMAN provides multiple methods of changing the repository status of backups and copies.Run the CHANGE...UNAVAILABLE command when a backup cannot be found or has migrated offsite.You can designate backups as exempt from the retention policy. This technique is useful for archiving backups to comply with business requirements.Use the CHANGE command with the GUID option to change the status of backups that correspond to pluggable databases (PDBs) that have been dropped from a multitenant container database (CDB).Use the CHANGE command to modify the repository status of preplugin backups and preplugin archived redo log files.You can use the CATALOG command to make RMAN aware of the existence of archived logs not recorded in the repository or copies of database files that are created through means other than RMAN. The target database control file keeps records of all archived redo logs generated by the target database and all RMAN backups. The purpose of the CATALOG command is to add metadata to the repository when it does not have a record of files for RMAN to manage.Use the CATALOG command to propagate information about user-managed copies to the RMAN repository. After the files are cataloged, you can run the LIST command or query V$BACKUP_FILES view to confirm the information is contained in the RMAN repository.You can catalog backup pieces on disk. This technique is useful if you use an operating system utility to copy backup pieces from one location to another on the same host, or from one host to another. If you use Automatic Storage Management (ASM), an Oracle Managed Files framework, or the fast recovery area, then you may want to recatalog files that are known to the disk management system but are no longer listed in the RMAN repository. This situation can occur when the intended mechanism for tracking file names fails due to media failure, software bug, or user error.Use the CATALOG command to add preplugin archived redo log files to the RMAN repository.You can remove records for files from the RMAN repository.You can use the CHANGE ... UNCATALOG command to update the RMAN repository for the absent files.You can use the RMAN DELETE command to delete archived redo logs and RMAN backups. Every RMAN backup produces a corresponding record in the RMAN repository. This record is stored in the control file. If a recovery catalog is used, then the record can also be found in the recovery catalog after the recovery catalog is resynchronized from the control file. You can delete backups and recovery catalog records for backups.The recommended maintenance strategy is to configure a fast recovery area, a backup retention policy, and an archived redo log deletion policy.Use the RMAN DELETE command to delete backups and image copies.You can use both the DELETE and BACKUP ... DELETE commands to delete specific backups and copies.You can use BACKUP ... DELETE to back up archived redo logs, data file copies, or backup sets and then delete the input files after successfully backing them up. If you run CROSSCHECK, and if RMAN cannot locate the files, then it updates their records in the RMAN repository to EXPIRED status. You can then use the DELETE EXPIRED command to remove records of expired backups and copies from the RMAN repository.The RMAN DELETE command supports an OBSOLETE option, which deletes backups that are no longer needed to satisfy specified recoverability requirements. Use the DELETE command with the GUID option to delete backups of pluggable databases (PDBs) that have been dropped from a multitenant container database (CDB).Use the DELETE command to delete preplugin backups and prelplugin archived redo log files.To remove a database from the operating system, you can use the DROP DATABASE command in RMAN. RMAN removes the server parameter file, all data files, online redo logs, and control files belonging to the target database.">Maintaining RMAN Backups and Repository&nbsp;Records</a> for more details on how to update the RMAN repository record to contain the actual set of available backups.
                                 </p>
                              </li>
                              <li>
                                 <p><a href="configuring-rman-client-basic.html#GUID-03DE4CF6-9D9F-4806-B5CA-CAA4CF5F2133" title="The backup retention policy specifies which backups must be retained to meet your data recovery requirements.">Configuring the Backup Retention Policy</a> for a conceptual overview of RMAN backup retention policy
                                 </p>
                              </li>
                              <li>
                                 <p><a href="maintaining-rman-backups.html#GUID-ABB66655-6FAC-4375-AFA0-2E40634085A5" title="If you run CROSSCHECK, and if RMAN cannot locate the files, then it updates their records in the RMAN repository to EXPIRED status. You can then use the DELETE EXPIRED command to remove records of expired backups and copies from the RMAN repository.">Deleting Expired RMAN Backups and Copies</a> for information about deleting RMAN backups and deleting records of RMAN backups from the RMAN repository
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV281"></a><a id="BRADV89600"></a><div class="props_rev_3"><a id="GUID-732DB3CD-0D09-4A52-A358-2E1E9F5E2C82" name="GUID-732DB3CD-0D09-4A52-A358-2E1E9F5E2C82"></a><h4 id="BRADV-GUID-732DB3CD-0D09-4A52-A358-2E1E9F5E2C82" class="sect4"><span class="enumeration_section">11.3.5 </span>Reporting on the Database Schema
                  </h4>
                  <div>
                     <p>The <code class="codeph">REPORT</code> <code class="codeph">SCHEMA</code> command lists and displays information about the database files, tablespaces, and so on. 
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-732DB3CD-0D09-4A52-A358-2E1E9F5E2C82__GUID-2E5842D2-7C43-418B-AFDD-B797FA198427">To report on the database schema:</p>
                        <p>If you do not specify <code class="codeph">FOR DB_UNIQUE_NAME</code> with <code class="codeph">REPORT SCHEMA</code>, then a recovery catalog connection is optional, but a target database connection is required. In a Data Guard environment, you can specify <code class="codeph">REPORT SCHEMA FOR DB_UNIQUE_NAME</code> to report the schema for a database in the environment. In this case, an RMAN connection to a target database is not required. You can connect RMAN to the recovery catalog and set the DBID instead.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Start RMAN and connect to the desired databases.</span><div>
                              <div class="infoboxnotealso" id="GUID-732DB3CD-0D09-4A52-A358-2E1E9F5E2C82__GUID-FE5BFDF4-9EED-4B4E-A036-CA5349D3AAC5">
                                 <p class="notep1">See Also:</p>
                                 <p><a href="starting-interacting-with-rman-client.html#GUID-E07231B2-F213-4F8F-8D02-E410A6DAE94C" title="You can create database connections from the RMAN client or the operating system command line. These database connection can be authenticated using a password file or with operating system authentication.">Making Database Connections with RMAN</a></p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>If you did not connect RMAN to a target database in the previous step, and you intend to specify the <code class="codeph">FOR DB_UNIQUE_NAME</code> clause on <code class="codeph">REPORT SCHEMA</code>, then set the database DBID. For example, enter the following command:</span><div><pre class="pre codeblock"><code>RMAN&gt; SET DBID 28014364;
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Run the <code class="codeph">REPORT</code> <code class="codeph">SCHEMA</code> command as shown in the following example:</span><div><pre class="pre codeblock"><code>RMAN&gt; REPORT SCHEMA;
 
Report of database schema for database with db_unique_name DGRDBMS
 
List of Permanent Datafiles
===========================
File Size(MB) Tablespace           RB segs Datafile Name
---- -------- -------------------- ------- ------------------------
1    450      SYSTEM               YES     /disk1/oracle/dbs/t_db1.f
2    141      SYSAUX               NO      /disk1/oracle/dbs/t_ax1.f
3    50       UD1                  YES     /disk1/oracle/dbs/t_undo1.f
4    50       TBS_11               NO      /disk1/oracle/dbs/tbs_111.f
5    50       TBS_11               NO      /disk1/oracle/dbs/tbs_112.f
 
List of Temporary Files
=======================
File Size(MB) Tablespace           Maxsize(MB) Tempfile Name
---- -------- -------------------- ----------- --------------------
1    40       TEMP                 32767       /disk1/oracle/dbs/t_tmp1.f
</code></pre><p>If you use a recovery catalog, then you can use the <span class="italic"><code class="codeph">atClause</code></span> to specify a past time, SCN, or log sequence number, as shown in these examples of the command:
                              </p><pre class="pre codeblock"><code>RMAN&gt; REPORT SCHEMA AT TIME 'SYSDATE-14';     # schema 14 days ago
RMAN&gt; REPORT SCHEMA AT SCN 1000;              # schema at scn 1000
RMAN&gt; REPORT SCHEMA AT SEQUENCE 100 THREAD 1; # schema at sequence 100
RMAN&gt; REPORT SCHEMA FOR DB_UNIQUE_NAME standby1; # schema for database standby1</code></pre><div class="infoboxnotealso" id="GUID-732DB3CD-0D09-4A52-A358-2E1E9F5E2C82__GUID-2848E87E-03DE-48D8-A013-6366E597D51F">
                                 <p class="notep1">See Also:</p>
                                 <p><a href="../rcmrf/REPORT.html#RCMRF147" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a> for a description of the <code class="codeph">REPORT SCHEMA</code> output
                                 </p>
                              </div>
                           </div>
                        </li>
                     </ol>
                  </div>
               </div>
            </div><a id="BRADV631"></a><div class="props_rev_3"><a id="GUID-D14C8A12-E9A6-484D-A8AD-7E40BA714740" name="GUID-D14C8A12-E9A6-484D-A8AD-7E40BA714740"></a><h3 id="BRADV-GUID-D14C8A12-E9A6-484D-A8AD-7E40BA714740" class="sect3"><span class="enumeration_section">11.4 </span>Reporting in CDBs and PDBs
               </h3>
               <div>
                  <p>You can view reports on the metadata related to a multitenant container database (CDB), the root only, or one or more pluggable databases (PDBs). </p>
                  <p>The concepts and practices of reporting on non-CDBs is applicable to CDBs and PDBs, with the differences described in the following sections.</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="reporting-rman-operations.html#GUID-6CA4CD3A-D440-47AD-91A8-8FE5B70DED99">Reporting in CDBs</a></p>
                     </li>
                     <li>
                        <p><a href="reporting-rman-operations.html#GUID-9927031D-93FF-4758-8A2B-30A9874212D9" title="Use the LIST command with the GUID option to list backups of pluggable databases (PDBs) that have been dropped from a multitenant container database (CDB).">Reporting in PDBs</a></p>
                     </li>
                  </ul>
               </div><a id="BRADV740"></a><div class="props_rev_3"><a id="GUID-6CA4CD3A-D440-47AD-91A8-8FE5B70DED99" name="GUID-6CA4CD3A-D440-47AD-91A8-8FE5B70DED99"></a><h4 id="BRADV-GUID-6CA4CD3A-D440-47AD-91A8-8FE5B70DED99" class="sect4"><span class="enumeration_section">11.4.1 </span>Reporting in CDBs
                  </h4>
                  <div>
                     <div class="section">
                        <p>The steps to view reporting information for a CDB are similar to the ones used for a <a href="glossary.html#GUID-62A96A52-3B97-455A-A443-75B999DCAC94"><span class="xrefglossterm">non-CDB</span></a>. The only difference is that you must connect to the root as a <a href="glossary.html#GUID-2B102186-15BD-443C-B375-8CB0D442CF5F"><span class="xrefglossterm">common user</span></a> with the common <code class="codeph">SYSBACKUP</code> or common <code class="codeph">SYSDBA</code> privilege.
                        </p>
                        <p>The <code class="codeph">LIST</code> and <code class="codeph">LIST BACKUP OF</code> commands will display backups of the whole CDB. The <code class="codeph">REPORT NEED BACKUP TABLESPACE</code> command displays information about the tablespaces in the root that need backup.
                        </p>
                        <div class="infoboxnotealso" id="GUID-6CA4CD3A-D440-47AD-91A8-8FE5B70DED99__GUID-D86418B8-E318-4B1C-982F-B5BD44212D52">
                           <p class="notep1">See Also:</p>
                           <p><a href="starting-interacting-with-rman-client.html#GUID-B397ADD8-D9CF-4DDA-B6AC-8C5FF04447AD" title="You can connect the RMAN client to multitenant container databases (CDBs) and pluggable databases (PDBs).">Making RMAN Connections to a CDB</a></p>
                        </div>
                        <p>The following command, when connected to the root, displays all the data files in the CDB that need backup:</p><pre class="pre codeblock"><code>REPORT NEED BACKUP;</code></pre><p>This command, when connected to the root, provides a summary list of backups of the whole CDB:</p><pre class="pre codeblock"><code>LIST BACKUP SUMMARY;</code></pre></div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV741"></a><div class="props_rev_3"><a id="GUID-9927031D-93FF-4758-8A2B-30A9874212D9" name="GUID-9927031D-93FF-4758-8A2B-30A9874212D9"></a><h4 id="BRADV-GUID-9927031D-93FF-4758-8A2B-30A9874212D9" class="sect4"><span class="enumeration_section">11.4.2 </span>Reporting in PDBs
                  </h4>
                  <div>
                     <div class="section">
                        <p>Use one of the following techniques to view reporting information for PDBs:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Connect to the root and use the <code class="codeph">LIST ... PLUGGABLE DATABASE</code> or <code class="codeph">REPORT PLUGGABLE DATABASE</code> commands. This enables you to display information regarding one or more PDBs.
                              </p>
                              <p>The following command, when connected to the root, provides a verbose list of backups in the PDBs <code class="codeph">hr_pdb</code> and <code class="codeph">sales_pdb</code>.
                              </p><pre class="pre codeblock"><code>LIST BACKUP OF PLUGGABLE DATABASE hr_pdb, sales_pdb;
</code></pre></li>
                           <li>
                              <p>Connect to the PDB and use the <code class="codeph">LIST BACKUP</code> or <code class="codeph">REPORT</code> commands. This approach displays information for only one PDB and also uses the same commands that are used for non-CDBs.
                              </p>
                              <p>The following command, when connected to a particular PDB, displays all the data files in the PDB that need backup:</p><pre class="pre codeblock"><code>REPORT NEED BACKUP; 
</code></pre><p>When connected to a PDB, you cannot view reporting information about obsolete backups or delete obsolete backups.</p>
                              <div class="infoboxnotealso" id="GUID-9927031D-93FF-4758-8A2B-30A9874212D9__GUID-E572A755-D4E3-4E0E-A1CB-FAD7EB1688D1">
                                 <p class="notep1">See Also:</p>
                                 <p><a href="starting-interacting-with-rman-client.html#GUID-B397ADD8-D9CF-4DDA-B6AC-8C5FF04447AD" title="You can connect the RMAN client to multitenant container databases (CDBs) and pluggable databases (PDBs).">Making RMAN Connections to a CDB</a></p>
                              </div>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div class="sect4"><a id="GUID-41452417-AD51-4EC8-9700-F8E2EF84D954" name="GUID-41452417-AD51-4EC8-9700-F8E2EF84D954"></a><h5 id="BRADV-GUID-41452417-AD51-4EC8-9700-F8E2EF84D954" class="sect5"><span class="enumeration_section">11.4.2.1 </span>Listing Backups of Dropped PDBs
                     </h5>
                     <div>
                        <p>Use the <code class="codeph">LIST</code> command with the <code class="codeph">GUID</code> option to list backups of pluggable databases (PDBs) that have been dropped from a multitenant container database (CDB).
                        </p>
                        <div class="section">
                           <p></p>
                           <p>After a PDB is dropped, you cannot perform operations or query data dictionary views by using the PDB name. However, you can obtain information about dropped PDBs by querying using GUID of a PDB.</p>
                           <p><span class="bold">To list backups of dropped PDBs:</span></p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Connect to the root as a common user with the <code class="codeph">SYSDBA</code> or <code class="codeph">SYSBACKUP</code> privilege.</span></li>
                           <li class="stepexpand"><span>Query the <code class="codeph">DBA_PDB_HISTORY</code> view to determine the GUID of the PDB that was dropped.</span><div>
                                 <p>The following example displays the PDBs that were dropped from the CDB <code class="codeph">test_db</code>:
                                 </p><pre class="pre codeblock"><code>SELECT pdb_name, pdb_guid FROM dba_pdb_history
WHERE db_name = 'test_db';</code></pre></div>
                           </li>
                           <li class="stepexpand"><span>Use the <code class="codeph">LIST</code> command with the <code class="codeph">GUID</code> option to display backups of a dropped PDB.</span><div>
                                 <p>The following commands display backup sets and image copies of a dropped PDB with the specified GUID:</p><pre class="pre codeblock"><code>LIST BACKUP GUID 'CDFFD672330A7527D0147204CD0E08D4';
LIST COPY GUID 'CDFFD672330A7527D0147204CD0E08D4';
</code></pre></div>
                           </li>
                        </ol>
                     </div>
                  </div>
               </div>
            </div><a id="BRADV90911"></a><div class="props_rev_3"><a id="GUID-9E60E2AC-6667-49B5-9D31-6480BEF026B9" name="GUID-9E60E2AC-6667-49B5-9D31-6480BEF026B9"></a><h3 id="BRADV-GUID-9E60E2AC-6667-49B5-9D31-6480BEF026B9" class="sect3"><span class="enumeration_section">11.5 </span>Using V$ Views to Query Backup Metadata
               </h3>
               <div>
                  <p>In some cases, V$ views supply information that is not available through use of the <code class="codeph">LIST</code> and <code class="codeph">REPORT</code> commands. 
                  </p>
                  <p>This section describes cases in which V$ views are particularly useful and contains the following topics.</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="reporting-rman-operations.html#GUID-19ECED3C-ED0A-476F-BC59-38B7A5C5877E" title="An RMAN job is the set of commands executed within an RMAN session. Thus, one RMAN job can contain multiple commands.">Querying Details of Past and Current RMAN Jobs</a></p>
                     </li>
                     <li>
                        <p><a href="reporting-rman-operations.html#GUID-323B8278-BD20-4278-9770-53E1CF6AC986" title="The ENCRYPTED column of the V$BACKUP_PIECE and V$RMAN_BACKUP_PIECE views indicates whether a backup piece is encrypted (YES) or unencrypted (NO).">Determining the Encryption Status of Backup Pieces</a></p>
                     </li>
                  </ul>
               </div><a id="BRADV282"></a><a id="BRADV99967"></a><div class="props_rev_3"><a id="GUID-19ECED3C-ED0A-476F-BC59-38B7A5C5877E" name="GUID-19ECED3C-ED0A-476F-BC59-38B7A5C5877E"></a><h4 id="BRADV-GUID-19ECED3C-ED0A-476F-BC59-38B7A5C5877E" class="sect4"><span class="enumeration_section">11.5.1 </span>Querying Details of Past and Current RMAN Jobs
                  </h4>
                  <div>
                     <p>An RMAN job is the set of commands executed within an RMAN session. Thus, one RMAN job can contain multiple commands. </p>
                     <div class="section">
                        <p>For example, you may execute two separate <code class="codeph">BACKUP</code> commands and a <code class="codeph">RECOVER COPY</code> command in a single session. An <a href="glossary.html#GUID-5CC2A883-9CE5-48B9-A6F7-6443FE0349E5"><span class="xrefglossterm">RMAN backup job</span></a> is the set of <code class="codeph">BACKUP</code> commands executed in one RMAN job. For example, a <code class="codeph">BACKUP DATABASE</code> and <code class="codeph">BACKUP ARCHIVELOG ALL</code> command executed in the same RMAN job constitute a single RMAN backup job.
                        </p>
                        <p>The views <code class="codeph">V$RMAN_BACKUP_JOB_DETAILS</code> and <code class="codeph">V$RMAN_BACKUP_SUBJOB_DETAILS</code> and their corresponding recovery catalog versions provide details of RMAN backup jobs. For example, the views show how long a backup took, how many backup jobs have been issued, the status of each backup job (for example, whether it failed or completed), when a job started and finished, and what type of backup was performed. The <code class="codeph">SESSION_KEY</code> column is the unique key for the RMAN session in which the backup job occurred.
                        </p>
                        <p>RMAN backups often write less than they read. Because of RMAN compression, the <code class="codeph">OUTPUT_BYTES_PER_SEC</code> column cannot be used as the measurement of backup speed. The appropriate column to measure backup speed is <code class="codeph">INPUT_BYTES_PER_SEC</code>. The ratio between read and written data is described in the <code class="codeph">COMPRESSION_RATIO</code> column.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-19ECED3C-ED0A-476F-BC59-38B7A5C5877E__GUID-774785FB-0E7C-48EE-9E05-237140B5B346">To query details about past and current RMAN jobs:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Connect SQL*Plus to the database whose backup history you intend to query.</span></li>
                        <li class="stepexpand"><span>Query the <code class="codeph">V$RMAN_BACKUP_JOB_DETAILS</code> view for information about the backup type, status, and start and end time.</span><div>
                              <p>The following query shows the backup job history ordered by session key, which is the primary key for the RMAN session:</p><pre class="pre codeblock"><code>COL STATUS FORMAT a9
COL hrs    FORMAT 999.99
SELECT SESSION_KEY, INPUT_TYPE, STATUS,
       TO_CHAR(START_TIME,'mm/dd/yy hh24:mi') start_time,
       TO_CHAR(END_TIME,'mm/dd/yy hh24:mi')   end_time,
       ELAPSED_SECONDS/3600                   hrs
FROM V$RMAN_BACKUP_JOB_DETAILS
ORDER BY SESSION_KEY;
</code></pre><p>The following sample output shows the backup job history:</p><pre class="pre codeblock"><code>SESSION_KEY INPUT_TYPE    STATUS    START_TIME     END_TIME           HRS
----------- ------------- --------- -------------- -------------- -------
          9 DATAFILE FULL COMPLETED 04/18/07 18:14 04/18/07 18:15     .02
         16 DB FULL       COMPLETED 04/18/07 18:20 04/18/07 18:22     .03
        113 ARCHIVELOG    COMPLETED 04/23/07 16:04 04/23/07 16:05     .01
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Query the <code class="codeph">V$RMAN_BACKUP_JOB_DETAILS</code> view for the rate of backup jobs in an RMAN session.</span><div>
                              <p>The following query shows the backup job speed ordered by session key, which is the primary key for the RMAN session. The columns <code class="codeph">in_sec</code> and <code class="codeph">out_sec</code> display the data input and output per second.
                              </p><pre class="pre codeblock"><code>COL in_sec FORMAT a10
COL out_sec FORMAT a10
COL TIME_TAKEN_DISPLAY FORMAT a10
SELECT SESSION_KEY, 
       OPTIMIZED, 
       COMPRESSION_RATIO, 
       INPUT_BYTES_PER_SEC_DISPLAY in_sec,
       OUTPUT_BYTES_PER_SEC_DISPLAY out_sec, 
       TIME_TAKEN_DISPLAY
FROM   V$RMAN_BACKUP_JOB_DETAILS
ORDER BY SESSION_KEY;
</code></pre><p>The following sample output shows the speed of the backup jobs:</p><pre class="pre codeblock"><code>SESSION_KEY OPT COMPRESSION_RATIO IN_SEC     OUT_SEC    TIME_TAKEN
----------- --- ----------------- ---------- ---------- ----------
          9 NO                  1     8.24M      8.24M  00:01:14
         16 NO         1.32732239     6.77M      5.10M  00:01:45
        113 NO                  1     2.99M      2.99M  00:00:44
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Query the <code class="codeph">V$RMAN_BACKUP_JOB_DETAILS</code> view for the size of the backups in an RMAN session.</span><div>
                              <p>If you run <code class="codeph">BACKUP DATABASE</code>, then <code class="codeph">V$RMAN_BACKUP_JOB_DETAILS.OUTPUT_BYTES</code> shows the total size of backup sets written by the backup job for the database that you are backing up. To view backup set sizes for all registered databases, query <code class="codeph">V$RMAN_BACKUP_JOB_DETAILS</code>.
                              </p>
                              <p>The following query shows the backup job size and throughput ordered by session key, which is the primary key for the RMAN session. The columns <code class="codeph">in_size</code> and <code class="codeph">out_size</code> display the data input and output per second.
                              </p><pre class="pre codeblock"><code>COL in_size  FORMAT a10
COL out_size FORMAT a10
SELECT SESSION_KEY, 
       INPUT_TYPE,
       COMPRESSION_RATIO, 
       INPUT_BYTES_DISPLAY in_size,
       OUTPUT_BYTES_DISPLAY out_size
FROM   V$RMAN_BACKUP_JOB_DETAILS
ORDER BY SESSION_KEY;
</code></pre><p>The following sample output shows the size of the backup jobs:</p><pre class="pre codeblock"><code>SESSION_KEY INPUT_TYPE    COMPRESSION_RATIO IN_SIZE    OUT_SIZE
----------- ------------- ----------------- ---------- ----------
         10 DATAFILE FULL                 1   602.50M    602.58M
         17 DB FULL              1.13736669   634.80M    558.13M</code></pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-19ECED3C-ED0A-476F-BC59-38B7A5C5877E__GUID-6465A0E4-620B-4D90-9989-E494811AE0E5">
                           <p class="notep1">See Also:</p>
                           <p><a href="../refrn/V-RMAN_BACKUP_JOB_DETAILS.html#REFRN30391" target="_blank"><span><cite>Oracle Database Reference</cite></span></a> to learn about the <code class="codeph">V$RMAN_BACKUP_JOB_DETAILS</code> view
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV90912"></a><div class="props_rev_3"><a id="GUID-323B8278-BD20-4278-9770-53E1CF6AC986" name="GUID-323B8278-BD20-4278-9770-53E1CF6AC986"></a><h4 id="BRADV-GUID-323B8278-BD20-4278-9770-53E1CF6AC986" class="sect4"><span class="enumeration_section">11.5.2 </span>Determining the Encryption Status of Backup Pieces
                  </h4>
                  <div>
                     <p>The <code class="codeph">ENCRYPTED</code> column of the <code class="codeph">V$BACKUP_PIECE</code> and <code class="codeph">V$RMAN_BACKUP_PIECE</code> views indicates whether a backup piece is encrypted (<code class="codeph">YES</code>) or unencrypted (<code class="codeph">NO</code>).
                     </p>
                     <div class="section">
                        <p>For example, you can run the following query in SQL*Plus to determine which backup pieces are encrypted:</p><pre class="pre codeblock"><code>COL BS_REC    FORMAT 99999
COL BP_REC    FORMAT 99999
COL MB        FORMAT 9999999
COL ENCRYPTED FORMAT A7
COL TAG       FORMAT A25

SELECT S.RECID AS "BS_REC", P.RECID AS "BP_REC", P.ENCRYPTED, 
       P.TAG, P.HANDLE AS "MEDIA_HANDLE"
FROM   V$BACKUP_PIECE P, V$BACKUP_SET S
WHERE  P.SET_STAMP = S.SET_STAMP
AND    P.SET_COUNT = S.SET_COUNT;
</code></pre><p>The following sample output shows that the backups are encrypted:</p><pre class="pre codeblock"><code>BS_REC BP_REC ENCRYPT TAG
------ ------ ------- -------------------------
MEDIA_HANDLE
--------------------------------------------------------------------------------
     1      1 YES     TAG20070711T140124
/disk1/c-39525561-20070711-00
 
     2      2 YES     TAG20070711T140128
/disk1/c-39525561-20070711-01
 
     3      3 YES     TAG20070711T140130
/disk1/c-39525561-20070711-02</code></pre><div class="infoboxnotealso" id="GUID-323B8278-BD20-4278-9770-53E1CF6AC986__GUID-97012501-608B-409E-A9D1-8399833B9B75">
                           <p class="notep1">See Also:</p>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=REFRN30023" target="_blank"><span><cite>Oracle Database Reference</cite></span></a> to learn about the <code class="codeph">V$BACKUP_PIECE</code> view
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="BRADV89601"></a><div class="props_rev_3"><a id="GUID-C48F1F48-E11D-4DA4-AB54-6D7EB4CA8957" name="GUID-C48F1F48-E11D-4DA4-AB54-6D7EB4CA8957"></a><h3 id="BRADV-GUID-C48F1F48-E11D-4DA4-AB54-6D7EB4CA8957" class="sect3"><span class="enumeration_section">11.6 </span>Querying Recovery Catalog Views
               </h3>
               <div>
                  <p>The <code class="codeph">LIST</code>, <code class="codeph">REPORT</code>, and <code class="codeph">SHOW</code> commands provide the easiest means of accessing the data in the control file and the recovery catalog. 
                  </p>
                  <p>Nevertheless, you can sometimes also obtain useful information from the recovery catalog views, which reside in the recovery catalog schema and use the <code class="codeph">RC_</code> prefix.
                  </p>
                  <p>This section contains the following topics:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="reporting-rman-operations.html#GUID-09997497-FAAC-4877-8D0E-44333752FF46" title="RMAN obtains backup and recovery metadata from a target database control file and stores it in the tables of the recovery catalog. The recovery catalog views are derived from these tables. The recovery catalog views are not normalized or optimized for user queries.">About Recovery Catalog Views</a></p>
                     </li>
                     <li>
                        <p><a href="reporting-rman-operations.html#GUID-93421D43-DFBA-4267-BFEB-C9716B6B0963" title="The DB_KEY value, which is the primary key for a registered database, is used only in the recovery catalog. The easiest way is to obtain the DB_KEY is to use the DBID of the target database, which is displayed whenever you connect RMAN to a database as TARGET.">Querying Catalog Views for the Target DB_KEY or DBID Values</a></p>
                     </li>
                     <li>
                        <p><a href="reporting-rman-operations.html#GUID-57512E48-D371-4B1C-A176-B5812BC265B2" title="You can query the view RC_BACKUP_FILES for information about all backups of any database registered in the recovery catalog. Before querying RC_BACKUP_FILES, however, you must call the DBMS_RCVMAN.SETDATABASE procedure.">Querying RC_BACKUP_FILES</a></p>
                     </li>
                  </ul>
               </div><a id="BRADV89602"></a><div class="props_rev_3"><a id="GUID-09997497-FAAC-4877-8D0E-44333752FF46" name="GUID-09997497-FAAC-4877-8D0E-44333752FF46"></a><h4 id="BRADV-GUID-09997497-FAAC-4877-8D0E-44333752FF46" class="sect4"><span class="enumeration_section">11.6.1 </span>About Recovery Catalog Views
                  </h4>
                  <div>
                     <p>RMAN obtains backup and recovery metadata from a target database control file and stores it in the tables of the recovery catalog. The recovery catalog views are derived from these tables. The recovery catalog views are not normalized or optimized for user queries.</p>
                     <p>In general, the recovery catalog views are not as user-friendly as the RMAN reporting commands. For example, when you start RMAN and connect to a target database, you obtain the information for this target database only when you issue <code class="codeph">LIST</code>, <code class="codeph">REPORT</code>, and <code class="codeph">SHOW</code> commands. If you have 10 different target databases registered in the same recovery catalog, then any query of the catalog views shows the metadata for all incarnations of all 10 databases. You often must perform complex selects and joins among the views to extract usable information about a database <a href="glossary.html#GUID-4CCAB7DD-FEA7-4237-AF2C-304BA3BD52B1"><span class="xrefglossterm">incarnation</span></a>.
                     </p>
                     <p>Most of the catalog views have a corresponding <code class="codeph">V$</code> view in the database. For example, <code class="codeph">RC_BACKUP_PIECE</code> corresponds to <code class="codeph">V$BACKUP_PIECE</code>. The primary difference between the recovery catalog view and corresponding <code class="codeph">V$</code> view is that each recovery catalog view contains metadata about <span class="italic">all</span> the target databases registered in the recovery catalog. The <code class="codeph">V$</code> view contains information only about itself.
                     </p>
                     <div class="infoboxnotealso" id="GUID-09997497-FAAC-4877-8D0E-44333752FF46__GUID-73FD9B64-35DB-4678-96A4-681700E75ED4">
                        <p class="notep1">See Also:</p>
                        <p><a href="../rcmrf/recovery-catalog-views.html#RCMRF003" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a> for a description of recovery catalog views
                        </p>
                     </div>
                  </div><a id="BRADV89603"></a><div class="props_rev_3"><a id="GUID-C980FFD5-1D65-4AF7-B8EB-9FB29EF0B25D" name="GUID-C980FFD5-1D65-4AF7-B8EB-9FB29EF0B25D"></a><h5 id="BRADV-GUID-C980FFD5-1D65-4AF7-B8EB-9FB29EF0B25D" class="sect5"><span class="enumeration_section">11.6.1.1 </span>About Unique Identifiers for Registered Databases
                     </h5>
                     <div>
                        <p>Most recovery catalog views contain the columns <code class="codeph">DB_KEY</code> and <code class="codeph">DBINC_KEY</code>. Each database registered in the recovery catalog can be uniquely identified by either the primary key, which is the <code class="codeph">DB_KEY</code> column value, or the <code class="codeph">DBID</code>, which is the 32-bit unique database identifier. Each incarnation of a database is uniquely identified by the <code class="codeph">DBINC_KEY</code> column.
                        </p>
                        <p>You can use <code class="codeph">DB_KEY</code> and <code class="codeph">DBINC_KEY</code> to retrieve the records of a specific incarnation of a target database. Then, you can perform joins with most of the other catalog views to isolate records belonging to this incarnation.
                        </p>
                        <p>An important difference between catalog and <code class="codeph">V$</code> views is that a different system of unique identifiers is used for backup and recovery files. For example, many <code class="codeph">V$</code> views such as <code class="codeph">V$ARCHIVED_LOG</code> use the <code class="codeph">RECID</code> and <code class="codeph">STAMP</code> columns to form a concatenated primary key. The corresponding recovery catalog view uses a derived value as its primary keys and stores this value in a single column. For example, the primary key in <code class="codeph">RC_ARCHIVED_LOG</code> is the <code class="codeph">AL_KEY</code> column. The <code class="codeph">AL_KEY</code> column value is the primary key that RMAN displays in the <code class="codeph">LIST</code> command output.
                        </p>
                     </div>
                  </div><a id="BRADV89604"></a><div class="props_rev_3"><a id="GUID-7130E16B-67B7-430C-9990-26E5B9A916BD" name="GUID-7130E16B-67B7-430C-9990-26E5B9A916BD"></a><h5 id="BRADV-GUID-7130E16B-67B7-430C-9990-26E5B9A916BD" class="sect5"><span class="enumeration_section">11.6.1.2 </span>About Unique Identifiers in a Data Guard Environment
                     </h5>
                     <div>
                        <p>Special considerations apply when querying the recovery catalog in a Data Guard environment. </p>
                        <p>In a Data Guard environment, multiple databases share the same DBID. Several views contain a <code class="codeph">DB_UNIQUE_NAME</code> column, which indicates the <code class="codeph">DB_UNIQUE_NAME</code> of the database incarnation to which the record belongs. All databases in a Data Guard environment share the same DBID but have different <code class="codeph">DB_UNIQUE_NAME</code> values.
                        </p>
                        <p>The value of <code class="codeph">DB_UNIQUE_NAME</code> is <code class="codeph">null</code> when the database name is not known to the catalog, as for Oracle9<span class="italic">i</span> databases that are registered in a recovery catalog. Also, the column value is <code class="codeph">null</code> when a database is upgraded to Oracle Database 11<span class="italic">g</span> or later but the recovery catalog schema has not reconciled the database names for all files.
                        </p>
                        <p>In the recovery catalog views, the primary database and its associated standby databases share the same <code class="codeph">DB_KEY</code>. However, every database in a Data Guard environment has a unique <code class="codeph">RC_SITE.SITE_KEY</code> value. For example, a primary database <code class="codeph">prod</code> and its standby database <code class="codeph">standby1</code> might both have the <code class="codeph">DB_KEY</code> value of 1, whereas the <code class="codeph">SITE_KEY</code> of <code class="codeph">prod</code> is 3 and the <code class="codeph">SITE_KEY</code> of <code class="codeph">standby1</code> is 30.
                        </p>
                        <p>Some recovery catalog views do not have a <code class="codeph">DB_UNIQUE_NAME</code> column, but include a <code class="codeph">SITE_KEY</code> column. You can use the <code class="codeph">SITE_KEY</code> column to join with <code class="codeph">RC_SITE.SITE_KEY</code> to determine the <code class="codeph">DB_UNIQUE_NAME</code> of the database associated with a file. As explained in <span class="q">"<a href="rman-architecture.html#GUID-E514F9D2-D96E-4087-B8C5-5A8EB6A44E6B" title="RMAN uses a recovery catalog to track file names for all database files in a Data Guard environment.">About RMAN File Management in a Data Guard Environment</a>"</span>, every file in a Data Guard environment is associated with the primary or standby database that created it.
                        </p>
                        <div class="infoboxnotealso" id="GUID-7130E16B-67B7-430C-9990-26E5B9A916BD__GUID-462F8DEA-17EA-49BD-B370-6043F0A16056">
                           <p class="notep1">See Also:</p>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=SBYDB04700" target="_blank"><span><cite>Oracle Data Guard Concepts and Administration</cite></span></a> to learn how to report on and manage files in a Data Guard environment
                           </p>
                        </div>
                     </div>
                  </div>
               </div><a id="BRADV283"></a><a id="BRADV89605"></a><div class="props_rev_3"><a id="GUID-93421D43-DFBA-4267-BFEB-C9716B6B0963" name="GUID-93421D43-DFBA-4267-BFEB-C9716B6B0963"></a><h4 id="BRADV-GUID-93421D43-DFBA-4267-BFEB-C9716B6B0963" class="sect4"><span class="enumeration_section">11.6.2 </span>Querying Catalog Views for the Target DB_KEY or DBID Values
                  </h4>
                  <div>
                     <p>The <code class="codeph">DB_KEY</code> value, which is the primary key for a registered database, is used only in the recovery catalog. The easiest way is to obtain the <code class="codeph">DB_KEY</code> is to use the DBID of the target database, which is displayed whenever you connect RMAN to a database as <code class="codeph">TARGET</code>. 
                     </p>
                     <div class="section">
                        <p>The DBID distinguishes databases registered in the RMAN recovery catalog.</p>
                        <p>Assume that you want to obtain information about a database registered in the recovery catalog. </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3" id="GUID-93421D43-DFBA-4267-BFEB-C9716B6B0963__GUID-6F9FCFD5-25B0-411E-A307-69EA5BFD7D81">To query the catalog for information about the current incarnation of a database:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Determine the DBID for the database whose records you want to view.</span><div>
                              <p>You can obtain the DBID by looking at the output displayed when RMAN connects to the database, querying <code class="codeph">V$RMAN_OUTPUT</code>, or querying a <code class="codeph">V$DATABASE</code> view. The following example connects SQL*Plus to the desired database and queries the DBID:
                              </p><pre class="pre codeblock"><code>SQL&gt; CONNECT / AS SYSBACKUP
SQL&gt; SELECT DBID 
  2  FROM   V$DATABASE;

     DBID
---------
598368217
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Start SQL*Plus and connect to the recovery catalog database as the owner of the recovery catalog.</span></li>
                        <li class="stepexpand"><span>Obtain the database key for the database whose DBID you obtained in Step 1.</span><div>
                              <p>To obtain the <code class="codeph">DB_KEY</code> for a database run the following query, where <span class="italic"><code class="codeph">dbid_of_target</code></span> is the DBID obtained in Step 1:
                              </p><pre class="pre codeblock"><code>SELECT DB_KEY 
FROM   RC_DATABASE 
WHERE  DBID = <span class="italic">dbid_of_target</span>;
</code></pre></div>
                        </li>
                        <li class="stepexpand"><span>Query the records for the current incarnation of the database whose DBID you obtained in Step 1.</span><div>
                              <p>To obtain information about the current incarnation of a target database, specify the target database <code class="codeph">DB_KEY</code> value and perform a join with the <code class="codeph">RC_DATABASE_INCARNATION</code> view. Use a <code class="codeph">WHERE</code> condition to specify that the <code class="codeph">CURRENT_INCARNATION</code> column value is set to <code class="codeph">YES</code>. For example, to obtain information about backup sets in the current incarnation of a target database with the <code class="codeph">DB_KEY</code> value of <code class="codeph">1</code>, query as follows:
                              </p><pre class="pre codeblock"><code>SELECT BS_KEY, BACKUP_TYPE, COMPLETION_TIME
FROM   RC_DATABASE_INCARNATION i, RC_BACKUP_SET b
WHERE  i.DB_KEY = 1
AND    i.DB_KEY = b.DB_KEY
AND    i.CURRENT_INCARNATION = 'YES';</code></pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-93421D43-DFBA-4267-BFEB-C9716B6B0963__GUID-6871BCC1-759E-4FA7-BD1D-E9BF8891F5D2">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="../rcmrf/RC_DATABASE_INCARNATION.html#RCMRF174" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a> for details about the <code class="codeph">RC_DATABASE_INCARNATION</code> view
                                 </p>
                              </li>
                              <li>
                                 <p><a href="rman-data-repair-concepts.html#GUID-9942AC94-A35D-4A06-9A45-A5A43B82B23D" title="A database incarnation is created whenever you open the database with the RESETLOGS option.">About Database Incarnations</a></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="BRADV53532"></a><div class="props_rev_3"><a id="GUID-57512E48-D371-4B1C-A176-B5812BC265B2" name="GUID-57512E48-D371-4B1C-A176-B5812BC265B2"></a><h4 id="BRADV-GUID-57512E48-D371-4B1C-A176-B5812BC265B2" class="sect4"><span class="enumeration_section">11.6.3 </span>Querying RC_BACKUP_FILES
                  </h4>
                  <div>
                     <p>You can query the view <code class="codeph">RC_BACKUP_FILES</code> for information about all backups of any database registered in the recovery catalog. Before querying <code class="codeph">RC_BACKUP_FILES</code>, however, you must call the <code class="codeph">DBMS_RCVMAN.SETDATABASE</code> procedure.
                     </p>
                     <div class="section">
                        <p>Specify the DBID of a database registered in the recovery catalog, as shown in the following example:</p><pre class="pre codeblock"><code>SQL&gt; CALL DBMS_RCVMAN.SETDATABASE(null,null,null,2283997583);
</code></pre><p>The fourth parameter must be the DBID of a database registered in the recovery catalog. The other parameters must all be <code class="codeph">NULL</code>.
                        </p>
                        <div class="infoboxnotealso" id="GUID-57512E48-D371-4B1C-A176-B5812BC265B2__GUID-E938298D-50D3-4713-9B77-FA6B06E63831">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/19/bradv&amp;id=RCMRF1670" target="_blank"><span><cite>Oracle Database Backup and Recovery Reference</cite></span></a> for details about the <code class="codeph">RC_BACKUP_FILES</code> view
                                 </p>
                              </li>
                              <li>
                                 <p><a href="rman-complete-database-recovery.html#GUID-34BB2E4B-B2FC-4701-BB65-BFED027DB865" title="It is recommended that you record the DBID of your database.">Determining the DBID of the Database</a> for techniques for determining the DBID of a database
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>