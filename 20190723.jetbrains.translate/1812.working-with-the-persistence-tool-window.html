<html lang="en-US" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></meta><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="../app/v2/analytics.js"></script><link rel="canonical" href="working-with-the-persistence-tool-window.html"></link><meta charset="UTF-8"></meta><title>使用持久性工具窗口 - 帮助| IntelliJ IDEA</title><link rel="stylesheet" href="../app/v2/app.css"></link></head><body dir="ltr" data-id="Working_with_the_Persistence_tool_window"><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索IntelliJ IDEA帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="working-with-the-persistence-tool-window.html#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>IntelliJ IDEA 2019.1帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">键盘布局</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option value="primary_default" data-group="primary" selected="">Windows / Linux默认值</option><option value="primary_default_for_gnome" data-group="primary">GNOME</option><option value="primary_default_for_kde" data-group="primary">KDE</option><option value="primary_default_for_xwin" data-group="primary">XWin中</option><option value="primary_emacs" data-group="primary">Emacs的</option><option value="primary_jbuilder" data-group="primary">JBuilder的</option><option value="primary_visual_studio" data-group="primary">视觉工作室</option><option value="primary_netbeans" data-group="primary">NetBeans的</option><option value="primary_eclipse" data-group="primary">日食</option><option value="secondary_mac_os_x_10.5_" data-group="secondary">默认（Mac OS X 10.5+）</option><option value="secondary_mac_os_x" data-group="secondary">Mac OS X.</option><option value="secondary_eclipse_mac_os_x" data-group="secondary">Eclipse（Mac OS X）</option><option value="secondary_intellij_idea_classic_os_x" data-group="secondary">IntelliJ IDEA Classic（Mac OS X）</option><option value="secondary_xcode" data-group="secondary">Xcode中</option><option value="secondary_resharper" data-group="secondary">ReSharper的</option><option value="secondary_resharper_osx" data-group="secondary">ReSharper（Mac OS X）</option><option value="secondary_emacs" data-group="secondary">Emacs（Mac OS X）</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="active"><h1 id="Working_with_the_Persistence_tool_window.xml" data-toc="Working_with_the_Persistence_tool_window">使用持久性工具窗口</h1>         <aside class="warning " rel="Working_with_the_Persistence_tool_window.xml" id="4c8cd5c5" data-title=""><p>此功能仅在<b id="f7d897f5" origin="intellij-platform">Ultimate</b>版本中受支持。</p></aside>    <ul data-skip-index="skip"><li class="list__item"><a href="working-with-the-persistence-tool-window.html#7a08178e">工具窗口概述</a></li><li class="list__item"><a href="working-with-the-persistence-tool-window.html#ffcc7b95">打开“持久性”工具窗口</a></li><li class="list__item"><a href="working-with-the-persistence-tool-window.html#generate_entities_and_mappings">生成托管实体类和O / R映射</a></li><li class="list__item"><a href="working-with-the-persistence-tool-window.html#new_command">使用New命令</a></li><li class="list__item"><a href="working-with-the-persistence-tool-window.html#open_diagram">打开实体关系图</a></li><li class="list__item"><a href="working-with-the-persistence-tool-window.html#assign_data_source">将持久性单元和会话工厂与数据源相关联</a></li><li class="list__item"><a href="working-with-the-persistence-tool-window.html#assign_naming_strategy">将会话工厂与NamingStrategy实现类（Hibernate）关联</a></li><li class="list__item"><a href="working-with-the-persistence-tool-window.html#540540a7">启动JPQL或HQL控制台</a></li></ul>    <p id="0fe7f9b9">另请参见<a href="persistence-tool-window.html"><span>持久性工具窗口</span></a> 。</p>    <div class="chapter"><h2 id="7a08178e">工具窗口概述</h2>        <p id="42d4597e"><span class="control">Persistence</span>工具窗口显示JPA和Hibernate项目项，并允许您创建配置文件，&lt;persistence-unit&gt;和&lt;session-factory&gt;元素，持久类和字段（请参阅<a href="working-with-the-persistence-tool-window.html#new_command">使用New命令</a> ），导航到相关的源代码编辑器（ <kbd data-primary_default="F4" data-primary_default_for_gnome="F4" data-primary_default_for_kde="F4" data-primary_default_for_xwin="F4" data-primary_emacs="F4" data-primary_jbuilder="N/A" data-primary_visual_studio="F4" data-primary_netbeans="F4" data-primary_eclipse="F12" data-secondary_mac_os_x_10.5_="⌘↓" data-secondary_mac_os_x="F4" data-secondary_eclipse_mac_os_x="F3" data-secondary_intellij_idea_classic_os_x="N/A" data-secondary_xcode="N/A" data-secondary_resharper="N/A" data-secondary_resharper_osx="N/A" data-secondary_emacs="F4">F4</kbd> ），开放式控制台和实体关系图等等。</p>        <figure><img alt="持久性工具窗口" title="持久性工具窗口" src="../img/idea/2019.1/persistence_tool_window.png" id="b4068572" width="519" height="262"></figure>    </div>    <div class="chapter"><h2 id="ffcc7b95">打开“持久性”工具窗口</h2>        <p id="3a019d7a">要使工具窗口可用，项目中必须有一个JPA或Hibernate启用的模块，即具有JPA或Hibernate方面的模块。请参阅<a href="enabling-jpa-support.html"><span>启用JPA支持</span></a>或<a href="enabling-hibernate-support.html"><span>启用Hibernate支持</span></a> 。</p>        <p id="db6e76f1">要打开工具窗口，请执行以下操作之一：</p>        <ul class="list _ul"><li class="list__item" id="65f9a16a"><p>选择<span class="menupath" data-skip-index="skip">查看|工具窗口|坚持</span></p></li><li class="list__item" id="d8249ba9"><p>如果当前显示工具窗口栏，请单击“ <span class="control">持久性”</span>按钮（通常位于工作区的左下角）。</p></li><li class="list__item" id="a32bde5f"><p>指向<img alt="显示工具窗口栏" title="显示工具窗口栏" src="../img/idea/2019.1/show_tool_window_bars.png" id="3a5a6489" width="32" height="32" class="inline-icon-32">要么<img alt="显示隐藏工具窗口栏" title="显示隐藏工具窗口栏" src="../img/idea/2019.1/show_hide_tool_window_bars.png" id="44bf7dd9" width="32" height="27" class="inline-icon-32">在工作区的左下角，选择<span class="control">Persistence</span> 。</p></li></ul>    </div>    <div class="chapter"><h2 id="generate_entities_and_mappings">生成托管实体类和O / R映射</h2>        <p id="05f67e42">您可以通过导入为它们生成托管实体类和对象/关系映射：</p>        <ul class="list _ul"><li class="list__item" id="cd0d1a27"><p>由<a href="managing-data-sources.html#data_sources">数据源</a>表示的数据库模式。</p></li><li class="list__item" id="037035d4"><p>具有关联部署描述符文件<code class="code">ejb-jar.xml</code>的EJB构面。方面应该在同一个项目中可用。从<code class="code">ejb-jar.xml</code>检索信息时，仅处理<code class="code">&lt;entity&gt;</code>元素。</p></li><li class="list__item" id="13f0dc5b"><p>仅适用于JPA：Hibernate对象/关系映射文件（ <code class="code">.hbm.xml</code> ）。该文件应该在同一个项目中。</p></li></ul>        <p id="fe46d66c">要执行导入：</p>        <ol class="list _decimal"><li class="list__item" id="32af911e">右键单击模块，持久性单元或会话工厂，指向“ <span class="control">生成持久性映射”，</span>然后选择以下选项之一：<ul class="list _ul"><li class="list__item" id="8201df11"><p>                        <span class="control">按数据库架构</span></p></li><li class="list__item" id="fbde0d95"><p>                        <span class="control">由实体豆</span></p></li><li class="list__item" id="6588891c"><p>                        <span class="control">通过Hibernate Mappings</span> （此选项不适用于启用Hibernate的模块和会话工厂）</p></li></ul></li><li class="list__item" id="c7d0159a"><p>在<a href="generate-persistence-mapping-import-dialogs.html">打开</a>的<a href="generate-persistence-mapping-import-dialogs.html">对话框中</a> ，指定导入源和输出选项。</p></li></ol>        <p id="ec134223"><b id="09136e4d">示例：使用数据库作为源</b></p>        <ol class="list _decimal"><li class="list__item" id="c49e86d1"><p>右键单击模块，持久性单元或会话工厂，指向“ <span class="control">生成持久性映射”，</span>然后选择“ <span class="control">按数据库架构”</span> 。</p></li><li class="list__item" id="c69888ff">在打开的“ <span class="control">导入数据库架构”</span>对话框中：<ul class="list _ul"><li class="list__item" id="7dc1f5f5"><p>                        <a href="generate-persistence-mapping-import-dialogs.html#general">常规设置</a> 。选择要用作源的数据源。指定实体类的目标包，以及类名的前缀和后缀。</p></li><li class="list__item" id="e2acf061"><p>                        <a href="generate-persistence-mapping-import-dialogs.html#db_mapping">数据库架构映射</a> 。选择要映射的表和列，编辑类和字段名称（ <span class="control">Map As</span>列），并指定字段类型（ <span class="control">Mapped Type</span>列）。</p></li><li class="list__item" id="eae9ecd6"><p>                        <a href="generate-persistence-mapping-import-dialogs.html#generation_settings">生成设置</a> 。指定目标&lt;persistence-unit&gt;或&lt;session-factory&gt;，然后选择必要的输出选项。</p></li></ul></li></ol>    </div>    <div class="chapter"><h2 id="new_command">使用New命令</h2>        <p id="c570e524"><span class="control">New</span>命令允许您创建XML配置文件，&lt;persistence-unit&gt;和&lt;session-factory&gt;元素，实体类，嵌入式，映射的超类，实体侦听器和对象关系映射，实体类中的持久字段以及getter和setter方法对他们来说等</p>        <p id="d71ec1a8">可以使用上下文或“ <span class="control">文件”</span>菜单或键盘快捷键<kbd data-primary_default="Alt+Insert" data-primary_default_for_gnome="Alt+Insert" data-primary_default_for_kde="Alt+Insert" data-primary_default_for_xwin="Alt+Insert" data-primary_emacs="Alt+Insert" data-primary_jbuilder="Alt+Insert" data-primary_visual_studio="Alt+Insert" data-primary_netbeans="Alt+Insert" data-primary_eclipse="Alt+Insert" data-secondary_mac_os_x_10.5_="⌘N" data-secondary_mac_os_x="⌃N" data-secondary_eclipse_mac_os_x="⌘N" data-secondary_intellij_idea_classic_os_x="N/A" data-secondary_xcode="N/A" data-secondary_resharper="N/A" data-secondary_resharper_osx="N/A" data-secondary_emacs="N/A">Alt + Insert</kbd>访问“ <span class="control">新建”</span>命令。命令选项取决于当前选择的项目。</p>        <p id="f3f0fc0f">            <b id="838e915e">示例：创建实体类</b></p>        <ol class="list _decimal"><li class="list__item" id="7ab4e01f"><p>右键单击持久性单元或会话工厂，指向“ <span class="control">新建”</span> ，然后选择“ <span class="control">实体”</span> 。</p></li><li class="list__item" id="61ffbf82">在打开的“ <span class="control">新建实体”</span>对话框中，指定：<ul class="list _ul"><li class="list__item" id="b932c945"><p>                        <span class="control">创建类：类</span>的名称。</p></li><li class="list__item" id="7dca812b"><p>                        <span class="control">目标包：</span>应在其中创建类的包。</p></li><li class="list__item" id="d012cf80"><p>                        <span class="control">目标目标目录：</span>目标源根文件夹（如果有多个）。</p></li></ul></li><li class="list__item" id="5909bce3">对于JPA，将显示“ <span class="control">选择元数据目标”</span>对话框。选择要为其添加映射信息的文件：<ul class="list _ul"><li class="list__item" id="ffdb27b7"><p>对象/关系映射XML文件：信息将作为<code class="code">&lt;entity-mappings&gt;</code>的<code class="code">&lt;entity&gt;</code>元素添加。</p></li><li class="list__item" id="73f65d4d"><p>类文件本身（.java）：将添加<code class="code">@Entity</code>注释。</p></li></ul>                <p id="f82ae273">IntelliJ IDEA还将信息添加到<code class="code">persistence.xml</code> ，作为<code class="code">&lt;class&gt;</code>或<code class="code">&lt;mapping-file&gt;</code>元素。</p>                <p id="1cc7ce6e">对于Hibernate，不显示“ <span class="control">选择元数据目标”</span>对话框。<code class="code">@Entity</code>注释被添加到类中， <code class="code">&lt;mapping class=""&gt;</code>元素被添加到<code class="code">hibernate.cfg.xml</code> 。</p></li></ol>    </div>    <div class="chapter"><h2 id="open_diagram">打开实体关系图</h2>        <p id="b5f707ae">要打开实体关系图，请右键单击持久性单元，会话工厂，实体或字段，然后从上下文菜单中选择<span class="control">ER Diagram</span> 。</p>        <p id="eb15ec04">另请参见图<a href="diagram-toolbar-and-context-menu.html"><span>工具栏和上下文菜单</span></a>以及<a href="general-techniques-of-using-diagrams.html"><span>使用图表的常规技巧</span></a> 。</p>    </div>    <div class="chapter"><h2 id="assign_data_source">将持久性单元和会话工厂与数据源相关联</h2>        <p id="34f105f4">您可以将&lt;persistence-unit&gt;或&lt;session-factory&gt;元素与<a href="managing-data-sources.html#data_sources">数据源相关联</a> 。如果你这样做：</p>        <ul class="list _ul"><li class="list__item" id="659a7f4a"><p>引用数据库表的源代码将自动根据相应的数据源进行验证。</p></li><li class="list__item" id="303bd56b"><p>使用JPA或Hibernate控制台时，无需另外指定数据库连接设置。将自动使用为关联的DB数据源配置的相应设置。</p></li></ul>        <p id="ec9a26c6">如果通过导入数据库模式生成&lt;persistence-unit&gt;或&lt;session-factory&gt;元素，则会自动设置相应元素与数据源之间的关联。</p>        <p id="f113682f">要将持久性单元或会话工厂与数据源相关联：</p>        <ol class="list _decimal"><li class="list__item" id="f720f9d9"><p>右键单击模块，持久性单元，会话工厂或实体，然后选择“ <span class="control">分配数据源”</span> 。</p></li><li class="list__item" id="2dbf5be5"><p>在打开的对话框中，单击必要的“ <span class="control">数据源”</span>单元格，然后从列表中选择数据源。（要删除与数据源的关联，请选择<span class="control">&lt;无&gt;</span> 。）</p></li></ol>    </div>    <div class="chapter"><h2 id="assign_naming_strategy">将会话工厂与NamingStrategy实现类（Hibernate）关联</h2>        <ol class="list _decimal"><li class="list__item" id="f759b229"><p>右键单击模块，会话工厂或实体，然后选择“ <span class="control">指定命名策略”</span> 。</p></li><li class="list__item" id="f4ec8c66"><p>在打开的对话框中，单击必要的“ <span class="control">命名策略”</span>单元格，然后从列表中选择实现类。</p></li></ol>    </div>    <div class="chapter"><h2 id="540540a7">启动JPQL或HQL控制台</h2>        <p id="39da3020">右键单击persitence单元或会话工厂或其中的任何节点，然后选择<span class="control">Console</span> 。</p>        <p id="444cfe3c">也可以看看：</p>        <ul class="list _ul"><li class="list__item" id="5bbd8a25"><a href="using-jpa-console.html"><span>使用JPA控制台</span></a></li><li class="list__item" id="653657dc"><a href="working-with-the-hibernate-console.html"><span>使用Hibernate控制台</span></a></li></ul>    </div>    <div class="last-modified" data-skip-index="skip">最后修改日期：2019年3月28日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="working-with-the-hibernate-console.html">使用Hibernate控制台</a> <a class="navigation-links__next" href="kotlin.html">Kotlin</a></div><section class="seealso" data-skip-index="skip"><div class="seealso__header"><h2>也可以看看</h2></div><div class="seealso__content"><div class="seealso__col" data-skip-index="skip"><h3>程序：</h3><ul class="list"><li class="list__item"><a href="overview-of-jpa-support.html"><span>JPA支持概述</span></a></li><li class="list__item"><a href="overview-of-hibernate-support.html"><span>Hibernate支持概述</span></a></li></ul></div><div class="seealso__col" data-skip-index="skip"><h3>参考：</h3><ul class="list"><li class="list__item"><a href="persistence-tool-window.html"><span>持久性工具窗口</span></a></li></ul></div></div></section></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="../app/v2/app.js"></script></body></html>