<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="../app/v2/analytics.js"></script><link rel="canonical" href="cpu-profiler.html"><meta charset="UTF-8"><title>CPU Profiler - Help | IntelliJ IDEA</title><link rel="stylesheet" href="../app/v2/app.css"></head><body data-id="procedures.profiler"><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search IntelliJ IDEA Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="cpu-profiler.html#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>IntelliJ IDEA 2019.1 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="primary" value="primary_default" selected>Windows/Linux Default</option><option data-group="primary" value="primary_default_for_gnome">GNOME</option><option data-group="primary" value="primary_default_for_kde">KDE</option><option data-group="primary" value="primary_default_for_xwin">XWin</option><option data-group="primary" value="primary_emacs">Emacs</option><option data-group="primary" value="primary_jbuilder">JBuilder</option><option data-group="primary" value="primary_visual_studio">Visual Studio</option><option data-group="primary" value="primary_netbeans">NetBeans</option><option data-group="primary" value="primary_eclipse">Eclipse</option><option data-group="secondary" value="secondary_mac_os_x_10.5_">Default (Mac OS X 10.5+)</option><option data-group="secondary" value="secondary_mac_os_x">Mac OS X</option><option data-group="secondary" value="secondary_eclipse_mac_os_x">Eclipse (Mac OS X)</option><option data-group="secondary" value="secondary_intellij_idea_classic_os_x">IntelliJ IDEA Classic (Mac OS X)</option><option data-group="secondary" value="secondary_xcode">Xcode</option><option data-group="secondary" value="secondary_resharper">ReSharper</option><option data-group="secondary" value="secondary_resharper_osx">ReSharper (Mac OS X)</option><option data-group="secondary" value="secondary_emacs">Emacs (Mac OS X)</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="active"><h1 data-toc="procedures.profiler" id="CPU_Profiler.xml">CPU Profiler</h1>                     <aside class="warning " data-title="" rel="CPU_Profiler.xml" id="52f3ab06"><p id="6c977f8c">CPU Profiler is an experimental feature in <span class="keyword">IntelliJ IDEA Ultimate</span>.        </p></aside>        <aside class="warning " data-title="" rel="CPU_Profiler.xml" id="3066d8f7"><p id="fad84b60">CPU Profiler is available on Linux and macOS.</p></aside>        <p id="73b257d8">            <span class="emphasis">CPU Profiler</span> monitors JVM-level parameters of your application to provide a            better understanding of how your application is executed, and how exactly resources are allocated. This            data can help you find and resolve performance problems.</p>        <p id="dccb4c8f"><span class="emphasis">CPU Profiler</span> shows what functions consume what percent of CPU time. This information        can provide you a better understanding of how your application is executed, and how exactly resources are allocated.</p>        <p id="17a82ff4">            You can run the profiler for projects built with Gradle and with the native IntelliJ IDEA build tool.</p>        <p id="e94d9fe1">            Once the analysis is finished, the profiler visualizes the output data in the reports to make them more understandable. </p>        <figure><img alt="CPU Profiler" title="CPU Profiler" src="../img/idea/2019.1/ij-cpu-profiler.png" id="9a5b30d0" width="1000" height="669"></figure>                <p id="ff7227d1">            Before you start using CPU Profiler, enable this option in the list of experimental features. On Linux, you also need            to install the <span class="control">Perf</span> tool and adjust kernel options.        </p>        <section class="procedure-steps"><div class="collapse"><div class="collapse__title"><h2 id="9af3c14f">Install Perf and adjust kernel options on Linux</h2></div><div class="collapse__content"><p id="3fe4904a">If you're using Linux, make sure to complete the following steps:</p><ol class="list _decimal"><li class="list__item" id="9f1c308e"><p>Install the <span class="control">Perf</span> tool for your <span class="control">particular kernel release</span>. Use <code class="code">uname -r</code>                        to find out the exact version,                        and then install the corresponding <span class="filepath">linux-tools</span> package. For example:                    <div class="code-block" data-lang="Console"><code class="code-block__wrapper">marinak@marinak-VirtualBox:~<span class="nv">$ </span>uname -r
4.15.0-36-generic
marinak@marinak-VirtualBox:~<span class="nv">$ </span>sudo apt-get install linux-tools-4.15.0-36-generic</code></div>                    </p></li><li class="list__item" id="25b093c1">                        <p id="940e7331"><span class="control">Adjust kernel options</span>.                        Before starting the profiler on Linux, you need to set up two <a href="https://www.kernel.org/doc/Documentation/sysctl/kernel.txt" data-bypass="yes" target="_blank"><span>kernel options</span></a>:</p>                        <ul class="list _bullet"><li class="list__item" id="c1f592cf"><p><i id="730818aa" origin="intellij-platform">perf_event_paranoid</i> - controls the use of performance events data by non-root users.                                Set its value to be less than 2 to let the profiler collect performance information without root privileges:                            <div class="code-block" data-lang="Console"><code class="code-block__wrapper">sudo sh -c <span class="s1">&#39;echo 1 &gt;/proc/sys/kernel/perf_event_paranoid&#39;</span></code></div>                            </p></li><li class="list__item" id="447027a3"><p><i id="a7cf7a95" origin="intellij-platform">kptr_restrict</i> sets restrictions on exposing kernel addresses.                                To have kernel symbols properly resolved, disable the protection offered by <i id="2cfe77b7" origin="intellij-platform">kptr_restrict</i> by setting its value to 0:                                <div class="code-block" data-lang="Console"><code class="code-block__wrapper">sudo sh -c <span class="s1">&#39;echo 0 &gt;/proc/sys/kernel/kptr_restrict&#39;</span></code></div>                            </p></li></ul>                        <p id="d597edba">By default, these changes affect your current OS session only. To keep the settings across system reboots, run:</p>                        <div class="code-block" data-lang="Console"><code class="code-block__wrapper">sudo sh -c <span class="s1">&#39;echo kernel.perf_event_paranoid=1 &gt;&gt; /etc/sysctl.d/99-perf.conf&#39;</span>
sudo sh -c <span class="s1">&#39;echo kernel.kptr_restrict=0 &gt;&gt; /etc/sysctl.d/99-perf.conf&#39;</span>
sudo sh -c <span class="s1">&#39;sysctl --system&#39;</span></code></div>                       <p id="c0e657c8"> Upon the first launch of the profiler, IntelliJ IDEA checks whether kernel variables are already set up and suggests the necessary changes:</p>                        <figure><img alt="adjust linux kernel variables for the profiler" title="adjust linux kernel variables for the profiler" src="../img/idea/2019.1/cl_profiler_kernelvars.png" id="9b9600ba" width="500" height="303"></figure>                                       </li></ol></div></div></section>        <section class="procedure-steps"><h2 id="717d05a2">Enable CPU Profiler in experimental features on Linux and macOS</h2><p id="780505f0">                CPU Profiler is still an experimental feature and it's not enabled by default. To use the profiler, you need                to enable it. </p><ol class="list _decimal"><li class="list__item" id="bc4a6ab0"><p>                Press <kbd data-primary_default="Ctrl+Shift+A" data-primary_default_for_gnome="Ctrl+Shift+A" data-primary_default_for_kde="Ctrl+Shift+A" data-primary_default_for_xwin="Ctrl+Shift+A" data-primary_emacs="Escape, X" data-primary_jbuilder="Ctrl+Shift+A" data-primary_visual_studio="Ctrl+Shift+A" data-primary_netbeans="Ctrl+I" data-primary_eclipse="Ctrl+Shift+A" data-secondary_mac_os_x_10.5_="⇧⌘A" data-secondary_mac_os_x="⇧⌘A" data-secondary_eclipse_mac_os_x="⌘3" data-secondary_intellij_idea_classic_os_x="N/A" data-secondary_xcode="N/A" data-secondary_resharper="N/A" data-secondary_resharper_osx="N/A" data-secondary_emacs="⎋, X">Ctrl+Shift+A</kbd> to open the <span class="control">Find Action</span> dialog, type                <code class="code">Experimental features</code>, and press <kbd data-primary_default="Enter" data-primary_default_for_gnome="Enter" data-primary_default_for_kde="Enter" data-primary_default_for_xwin="Enter" data-primary_emacs="Enter" data-primary_jbuilder="Enter" data-primary_visual_studio="Enter" data-primary_netbeans="Enter" data-primary_eclipse="Enter" data-secondary_mac_os_x_10.5_="⏎" data-secondary_mac_os_x="⏎" data-secondary_eclipse_mac_os_x="⏎" data-secondary_intellij_idea_classic_os_x="N/A" data-secondary_xcode="N/A" data-secondary_resharper="N/A" data-secondary_resharper_osx="N/A" data-secondary_emacs="⏎">Enter</kbd>.</p></li><li class="list__item" id="ec70c656"><p>                Select the checkbox next to <code class="code">java.profiler.enabled</code>, apply the changes, and close the dialog.            </p></li></ol></section>     <div class="chapter"><h2 id="UsingTheProfiler" data-toc="procedures.profiler#UsingTheProfiler">Using the profiler</h2>                                 <section class="procedure-steps"><h2 id="run-profiler">Run the profiler</h2><ul class="list _no-style"><li class="list__item" id="9eac1f46"><p>                 From the main menu, select <span data-skip-index="skip" class="menupath">Run | Run 'class name' with Async Profiler</span>, or                 click the <img class="inline-icon-16" src="../img/idea/2019.1/icons.actions.profile.svg@2x.png" width="16" alt="Profiler"> button on the toolbar.             </p></li></ul><figure><img alt="Profiler popup informing that the data is ready" title="Profiler popup informing that the data is ready" src="../img/idea/2019.1/ij_profiler_balloon.png" id="ac5962df" width="450" height="132"></figure></section>           <p id="74fc9f23">               After the application stops, and the profiling data is ready, you will see a confirmation popup,               and the <span class="control">CPU Profiler</span> tool button will appear. Click this button to open the               CPU Profiler tool window (or go to <span data-skip-index="skip" class="menupath">View | Tool Windows | CPU Profiler</span>               if you don't use tool buttons).           </p>            <p id="7aa4cc2f">                To stop the profiler prior to stopping the application, use the                <img class="inline-icon-16" src="../img/idea/2019.1/artwork.studio.icons.shell.toolbar.stop@2x.png" width="16" alt="Stop"> button in the CPU Profiler tool window.            </p>         <section class="procedure-steps"><h2 id="export-profiler-results">Export profiler results</h2><ol class="list _decimal"><li class="list__item" id="4decdcd3"><p>                 From the main menu, select <span data-skip-index="skip" class="menupath">View | Tool Windows | CPU Profiler</span> to open the profiler                 tool window.</p></li><li class="list__item" id="8c0ad7fb"><p>                 On the left frame of the tool window, click <img class="inline-icon-16" src="../img/idea/2019.1/icons.toolbarDecorator.export.svg@2x.png" width="16" alt="Export">                 <span class="control">Export Profiler Results</span>.</p></li><li class="list__item" id="d9e37bef"><p>                 In the dialog that opens, name the file and specify a folder in which you want to save it. Click <span class="control">Save</span>.             </p></li></ol></section>        </div><div class="chapter"><h2 id="InterpretingTheResults" data-toc="procedures.profiler#InterpretingTheResults">Interpreting the results</h2>                <p id="2fb8de1b">            In the CPU Profiler tool window, the collected data is presented on three tabs - <span class="control">Flame Chart</span>,            <span class="control">Call Tree</span>, and <span class="control">Method List</span>.                        The left-hand part lists application threads; by clicking on each thread you can go in more details.            </p>        <figure><img alt="CPU Profiler" title="CPU Profiler" src="../img/idea/2019.1/ij-cpu-profiler.png" id="686c1262" width="1000" height="669"></figure>        <dl><dt id="profiler-flame-chart">Flame Chart</dt><dd>                <p id="406a2cc7">                    This tab shows you the state of the call stack at any moment of time in the performance profile.                    Each block represents a function in the stack (a stack frame).                    On the Y-axis, there is a stack depth going from bottom up. The X-axis shows the stack profile                    sorted from the most CPU-consuming functions to the least consuming ones.                </p>                                <p id="6c965df2">                    When you read the flame chart, focus on the widest blocks. These blocks are the                    functions that are presented in the profile most.                                        You can start from the bottom and move up, following the code flow from parent to child methods,                    or use the opposite direction to explore the top blocks that show the functions running directly on the CPU.                                    </p>                <p id="b8f2e28e">                    In the <span class="control">Flame Chart</span> tab, you can hover the mouse over any block to view the details:                    <figure><img alt="block details in the flame chart" title="block details in the flame chart" src="../img/idea/2019.1/ij_profiler_flamechart_hover.png" id="e300d479" width="800" height="515"></figure>                                    </p>            </dd><dt id="profiler-call-tree">Call Tree</dt><dd>                <p id="6117f560">                    The <span class="control">Call Tree</span> tab shows the program call tree with the percentage of each                    function in the total profiling time. It organizes the data to show you where the application                    spends most of the time in total.                    To configure and filter the <span class="control">Call Tree</span> view, use the                    <img class="inline-icon-16" src="../img/idea/2019.1/artwork.studio.icons.logcat.toolbar.settings@2x.png" width="16" alt="Settings">                    and <img class="inline-icon-16" src="../img/idea/2019.1/artwork.studio.icons.common.filter@2x.png" width="16" alt="Filter"> buttons.                    <figure><img alt="call tree tab in the profiler results" title="call tree tab in the profiler results" src="../img/idea/2019.1/ij_profiler_calltree_mac.png" id="44c78024" width="800" height="515"></figure>                                    </p>            </dd><dt id="profiler-method-list">Method List</dt><dd>                <p id="6bbabc0b">The <span class="control">Method List</span> tab shows the list of methods sorted by the number of samples.                    For each method from the list, the profiler provides more information on the nested tabs.                    The <span class="control">Back Traces</span> tab shows where the selected method has been called.                    The <span class="control">Merged Callees</span> tab shows call traces that started from the selected method.</p>                <figure><img alt="method list tab in the profiler results" title="method list tab in the profiler results" src="../img/idea/2019.1/ij_profiler_methodlist_mac.png" id="abea7526" width="800" height="473"></figure>                            </dd></dl>        <aside class="tip sideblock" data-title="" rel="profiler-flame-chart" id="89accb01"><p id="d177b00e">For more information about flame charts or flame graphs, see <a href="http://www.brendangregg.com/flamegraphs.html" data-bypass="yes" target="_blank"><span>Flame Graphs</span></a>.</p></aside>     </div><div class="last-modified" data-skip-index="skip">Last modified: 28 March 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__next" href="dependencies-analysis.html">Dependencies Analysis</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="../app/v2/app.js"></script></body></html>

























