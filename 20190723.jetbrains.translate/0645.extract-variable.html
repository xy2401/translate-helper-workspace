<html lang="en-US" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></meta><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="../app/v2/analytics.js"></script><link rel="canonical" href="extract-variable.html"></link><meta charset="UTF-8"></meta><title>提取变量 - 帮助| IntelliJ IDEA</title><link rel="stylesheet" href="../app/v2/app.css"></link></head><body dir="ltr" data-id="procedures.refactoring.introduceVariable"><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索IntelliJ IDEA帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="extract-variable.html#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>IntelliJ IDEA 2019.1帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">键盘布局</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option value="primary_default" data-group="primary" selected="">Windows / Linux默认值</option><option value="primary_default_for_gnome" data-group="primary">GNOME</option><option value="primary_default_for_kde" data-group="primary">KDE</option><option value="primary_default_for_xwin" data-group="primary">XWin中</option><option value="primary_emacs" data-group="primary">Emacs的</option><option value="primary_jbuilder" data-group="primary">JBuilder的</option><option value="primary_visual_studio" data-group="primary">视觉工作室</option><option value="primary_netbeans" data-group="primary">NetBeans的</option><option value="primary_eclipse" data-group="primary">日食</option><option value="secondary_mac_os_x_10.5_" data-group="secondary">默认（Mac OS X 10.5+）</option><option value="secondary_mac_os_x" data-group="secondary">Mac OS X.</option><option value="secondary_eclipse_mac_os_x" data-group="secondary">Eclipse（Mac OS X）</option><option value="secondary_intellij_idea_classic_os_x" data-group="secondary">IntelliJ IDEA Classic（Mac OS X）</option><option value="secondary_xcode" data-group="secondary">Xcode中</option><option value="secondary_resharper" data-group="secondary">ReSharper的</option><option value="secondary_resharper_osx" data-group="secondary">ReSharper（Mac OS X）</option><option value="secondary_emacs" data-group="secondary">Emacs（Mac OS X）</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="active"><h1 id="Extract_Variable.xml" data-toc="procedures.refactoring.introduceVariable">提取变量</h1>                                                                  <p id="3b192d86">如果您遇到一个难以理解的表达式或者在整个代码中的多个位置都存在重复，则<span class="emphasis">Extract Variable</span>重构可以帮助您处理将此类表达式或其部分的结果放入一个不太复杂的单独变量的问题而且更容易理解。此外，它减少了代码重复。</p>        <p id="2dfc4ac1">从Java 1.8及更高版本开始，IntelliJ IDEA还允许您<a href="extract-variable.html#extract_functional_variable">提取功能类型变量</a> 。</p>                        <section class="procedure-steps"><ol class="list _decimal"><li class="list__item" id="98876e46"><p>在编辑器中，选择要提取的表达式或其部分。您也可以将光标放在表达式中，在这种情况下，IntelliJ IDEA会为您提供潜在代码选择的列表。</p></li><li class="list__item" id="5691dfbd"><p>按<kbd data-primary_default="Ctrl+Alt+V" data-primary_default_for_gnome="Ctrl+Alt+V" data-primary_default_for_kde="Shift+Alt+V" data-primary_default_for_xwin="Ctrl+Alt+V" data-primary_emacs="Ctrl+Alt+V" data-primary_jbuilder="Ctrl+Alt+V" data-primary_visual_studio="Ctrl+Alt+V" data-primary_netbeans="Shift+Alt+V" data-primary_eclipse="Shift+Alt+L" data-secondary_mac_os_x_10.5_="⌥⌘V" data-secondary_mac_os_x="⌥⌘V" data-secondary_eclipse_mac_os_x="⌥⌘L" data-secondary_intellij_idea_classic_os_x="N/A" data-secondary_xcode="N/A" data-secondary_resharper="N/A" data-secondary_resharper_osx="N/A" data-secondary_emacs="⌃⌥V">Ctrl + Alt + V</kbd>或在主菜单上选择<span class="menupath" data-skip-index="skip">Refactor |提取|提取变量</span> 。</p></li><li class="list__item" id="2a9ad86c">选择弹出窗口中建议的名称或键入您自己的名称，然后按<kbd data-primary_default="Enter" data-primary_default_for_gnome="Enter" data-primary_default_for_kde="Enter" data-primary_default_for_xwin="Enter" data-primary_emacs="Enter" data-primary_jbuilder="Enter" data-primary_visual_studio="Enter" data-primary_netbeans="Enter" data-primary_eclipse="Enter" data-secondary_mac_os_x_10.5_="⏎" data-secondary_mac_os_x="⏎" data-secondary_eclipse_mac_os_x="⏎" data-secondary_intellij_idea_classic_os_x="N/A" data-secondary_xcode="N/A" data-secondary_resharper="N/A" data-secondary_resharper_osx="N/A" data-secondary_emacs="⏎">Enter键</kbd> 。<figure><img alt="提取物变种" title="提取物变种" src="../img/idea/2019.1/extract_var.png" id="bbb5c8d7" width="374" height="198"></figure>如果IntelliJ IDEA找到多个匹配项，则可以指定是否要为所有这些变量提取此变量。<p id="8937209a">您还可以将要提取的变量声明为<code class="code">final</code> 。</p>如果要将现有变量重新分配给新变量，请按<kbd data-primary_default="Ctrl+Alt+V" data-primary_default_for_gnome="Ctrl+Alt+V" data-primary_default_for_kde="Shift+Alt+V" data-primary_default_for_xwin="Ctrl+Alt+V" data-primary_emacs="Ctrl+Alt+V" data-primary_jbuilder="Ctrl+Alt+V" data-primary_visual_studio="Ctrl+Alt+V" data-primary_netbeans="Shift+Alt+V" data-primary_eclipse="Shift+Alt+L" data-secondary_mac_os_x_10.5_="⌥⌘V" data-secondary_mac_os_x="⌥⌘V" data-secondary_eclipse_mac_os_x="⌥⌘L" data-secondary_intellij_idea_classic_os_x="N/A" data-secondary_xcode="N/A" data-secondary_resharper="N/A" data-secondary_resharper_osx="N/A" data-secondary_emacs="⌃⌥V">Ctrl + Alt + V.</kbd>如果您有多个现有变量，IntelliJ IDEA会显示一个列表供您选择。<p id="2f25604e">您可以按<kbd data-bypass="true">Shift + Tab</kbd>更改变量的类型。</p>                    <figure><img alt="改变var的类型" title="改变var的类型" src="../img/idea/2019.1/change_type_for_var.png" id="089376e5" width="320" height="195"></figure>                            </li></ol></section>        <p id="509b5065">如果未在“ <span class="menupath" data-skip-index="skip">设置/首</span>选项”中选择“ <span class="control">启用就地模式”</span>选项<span class="menupath" data-skip-index="skip">编辑器|常规</span>对话框（ <i id="9fd0ac69">重构</i>部分），IntelliJ IDEA打开此重构的“ <span class="control">提取变量”</span>对话框。</p>        <figure><img alt="提取var对话框" title="提取var对话框" src="../img/idea/2019.1/extract_var_dialog.png" id="e1c34e03" width="293" height="191"></figure>        <div class="chapter"><h2 id="882539e7">例</h2>            <p id="5c251799">让我们提取在整个代码中出现两次的<code class="code">anotherClass.inValue()</code>变量并给它一个名称<code class="code">number</code> 。</p>            <div class="tabs" id="dae06b26"><div class="tabs__content" id="619b0d64" data-title="Java">                <div class="table-wrapper"><table class="                  _layout-fixed" width="100%" id="8e4db99a"><thead><tr id="d6f99651" class="ijRowHead"><th id="d562f482" width="50%"><p>之前</p></th><th id="f25ee318" width="50%"><p>后</p></th></tr></thead><tbody><tr id="259a3e84" class="ijRowOdd"><td id="c14f350e"><p>                            </p><div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">method</span> <span class="o">（）</span> <span class="o">{</span> <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">;</span> <span class="o">...</span>
    <span class="kt">int</span> <span class="n">b</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">anotherClass</span> <span class="o">。</span> <span class="na">intValue</span> <span class="o">（）;</span> <span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="n">anotherClass</span> <span class="o">。</span> <span class="na">intValue</span> <span class="o">（）;</span> <span class="o">}</span></code></div>                        </td><td id="6c507188"><p>                            </p><div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">method</span> <span class="o">（）</span> <span class="o">{</span> <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">;</span> <span class="o">...</span>
    <span class="kt">int</span> <span class="n">number</span> <span class="o">=</span> <span class="n">anotherClass</span> <span class="o">。</span> <span class="na">intValue</span> <span class="o">（）;</span> <span class="kt">int</span> <span class="n">b</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">number</span> <span class="o">;</span> <span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="n">number</span> <span class="o">;</span> <span class="o">}</span></code></div>                        </td></tr></tbody></table></div>                </div><div class="tabs__content" id="cab8f5fb" data-title="Kotlin">                    <div class="table-wrapper"><table class="                  _layout-fixed" width="100%" id="47e3cba5"><thead><tr id="77a238d0" class="ijRowHead"><th id="b3fe95b8" width="50%"><p>之前</p></th><th id="a27373f5" width="50%"><p>后</p></th></tr></thead><tbody><tr id="26bcf089" class="ijRowOdd"><td id="34cbd474"><p>                                </p><div class="code-block" data-lang="Actionscript"><code class="code-block__wrapper"><span class="nx">func</span> <span class="nx">方法</span> <span class="p">（）</span> <span class="p">{</span> <span class="nx">val</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">1</span> <span class="nx">val</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">anotherClass</span> <span class="o">!!</span> <span class="p">。</span> <span class="nx">intValue</span> <span class="p">（）</span> <span class="nx">val</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">b</span> <span class="o">+</span> <span class="nx">anotherClass</span> <span class="o">!!</span> <span class="p">。</span> <span class="nx">intValue</span> <span class="p">（）</span> <span class="p">}</span></code></div>                            </td><td id="f61d03d4"><p>                                </p><div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="n">func</span> <span class="nf">method</span> <span class="o">（）</span> <span class="o">{</span> <span class="n">val</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span> <span class="n">val</span> <span class="n">number</span> <span class="o">=</span> <span class="n">anotherClass</span> <span class="o">!!。</span> <span class="na">intValue</span> <span class="o">（）</span> <span class="n">val</span> <span class="n">b</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">number</span> <span class="n">val</span> <span class="n">c</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="n">number</span> <span class="o">}</span></code></div>                            </td></tr></tbody></table></div>                </div></div>        </div>                <div class="chapter"><div class="collapse"><div class="collapse__title"><h2 id="extract_functional_variable">提取功能变量</h2></div><div class="collapse__content">            <p id="52396e37">这种重构为Java 1.8及更高版本创建了一个函数表达式，为旧版Java创建了一个匿名类。</p>            <section class="procedure-steps"><ol class="list _decimal"><li class="list__item" id="692c1956"><p>在此示例中，选择代码片段<code class="code">println</code>方法的参数。</p><figure><img alt="参数println" title="参数println" src="../img/idea/2019.1/argument_println.png" id="01cd087e" width="453" height="265"></figure>                </li><li class="list__item" id="extract_functional_var"><p>在主菜单中，选择<span class="menupath" data-skip-index="skip">Refactor |提取|功能变量</span> 。<br>IntelliJ IDEA打开“ <span class="control">提取功能变量”</span>对话框。</p><figure><img alt="extrct funtional var" title="extrct funtional var" src="../img/idea/2019.1/extrct_funtional_var.png" id="b7d2e624" width="524" height="371"></figure>                </li><li class="list__item" id="24ab67bd"><p>当所选代码依赖于实例字段时，如示例中所示，将显示<span class="control">Pass字段as params</span>复选框，您可以在字段位置传递参数。</p><figure><img alt="extrct funtional var参数" title="extrct funtional var参数" src="../img/idea/2019.1/extrct_funtional_var_parameter.png" id="bac8218e" width="492" height="330"></figure>但是，例如，如果您选择的代码片段取决于任何局部变量或参数<figure><img alt="样本字符串" title="样本字符串" src="../img/idea/2019.1/sample_string.png" id="e643ed42" width="394" height="285"></figure>相应的条目将出现在列表中。<figure><img alt="局部变量和参数" title="局部变量和参数" src="../img/idea/2019.1/local_variable_and_parameter.png" id="840bc58c" width="524" height="369"></figure>取消选择对话框中的某个参数时，将使用相应的本地值。<figure><img alt="当param取消选择时" title="当param取消选择时" src="../img/idea/2019.1/when_param_deselected.png" id="58601e13" width="467" height="371"></figure>配置选项并单击“ <span class="control">确定”</span> 。</li><li class="list__item" id="451acb7b"><p>从弹出窗口中选择适用的功能界面。</p><figure><img alt="功能界面" title="功能界面" src="../img/idea/2019.1/functional_interface.png" id="7726cfda" width="675" height="288"></figure>                </li><li class="list__item" id="79a9958e"><p>如果需要，如果您不想使用列表中建议的名称，请更改提取变量的名称。</p><figure><img alt="更改变量名称" title="更改变量名称" src="../img/idea/2019.1/changing_variable_name.png" id="4db09282" width="629" height="282"></figure>                </li><li class="list__item" id="functional_parameter"><p>IntelliJ IDEA创建了可以进一步使用的lambda。</p><figure><img alt="组合功能" title="组合功能" src="../img/idea/2019.1/composed_function.png" id="9788bfc1" width="632" height="287"></figure>                </li></ol></section>            <aside class="tip sideblock" rel="functional_parameter" id="d99dda03" data-title="">                <p id="0b6dfe3d"><a href="javaintroduce.html#functional_parameter">功能参数</a>重构也可用。</p>            </aside>            <aside class="tip sideblock" rel="extract_functional_var" id="2aea0cb9" data-title=""><p id="49f5e508">从编辑器的上下文菜单中，选择<span class="menupath" data-skip-index="skip">Refactor |重构此</span> （ <kbd data-primary_default="Ctrl+Shift+Alt+T" data-primary_default_for_gnome="Ctrl+Shift+Alt+T" data-primary_default_for_kde="Ctrl+Shift+Alt+T" data-primary_default_for_xwin="Ctrl+Shift+Alt+T" data-primary_emacs="Ctrl+Shift+Alt+T" data-primary_jbuilder="Ctrl+Shift+Alt+T" data-primary_visual_studio="Ctrl+Shift+Alt+T" data-primary_netbeans="Ctrl+Shift+Alt+T" data-primary_eclipse="Ctrl+Shift+Alt+T" data-secondary_mac_os_x_10.5_="⌃T" data-secondary_mac_os_x="⌥⇧⌘T" data-secondary_eclipse_mac_os_x="⌃T" data-secondary_intellij_idea_classic_os_x="N/A" data-secondary_xcode="N/A" data-secondary_resharper="N/A" data-secondary_resharper_osx="N/A" data-secondary_emacs="⌃⌥⇧T">Ctrl + Shift + Alt + T</kbd> ），然后选择<span class="control">功能变量</span> 。</p></aside>            <div class="chapter"><h3 id="70a93f18">例</h3>                <div class="table-wrapper"><table class="                 " width="100%" id="cb9e1619"><thead><tr id="7cf49a5d" class="ijRowHead"><th id="e9728507"><p>之前</p></th><th id="69614fe7"><p>后</p></th></tr></thead><tbody><tr id="8a921097" class="ijRowOdd"><td id="19e7c060"><p>                            </p><div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="kn">import</span> <span class="nn">java.util。清单</span> <span class="o">;</span> <span class="kd">public</span> <span class="kd">class</span> <span class="nc">PrintAction</span> <span class="kd">实现</span> <span class="n">Runnable</span> <span class="o">{</span> <span class="kd">private</span> <span class="n">List</span> <span class="o">&lt;</span> <span class="n">String</span> <span class="o">&gt;</span> <span class="n">数据</span> <span class="o">;</span> <span class="kd">public</span> <span class="nf">PrintAction</span> <span class="o">（</span> <span class="n">List</span> <span class="o">&lt;</span> <span class="n">String</span> <span class="o">&gt;</span> <span class="n">data</span> <span class="o">）</span> <span class="o">{</span> <span class="k">this</span> <span class="o">。</span> <span class="na">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">;</span> <span class="o">}</span> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span> <span class="o">（）</span> <span class="o">{</span> <span class="n">System</span> <span class="o">。</span> <span class="na">出</span> <span class="o">。</span> <span class="na">的println（</span> <span class="s"><span class="o">“</span>数据：”</span> <span class="o">+</span> <span class="n">数据</span> <span class="na">的<span class="o"><span class="o">toString（））;</span></span></span> <span class="o">}</span> <span class="o">}</span></code></div>                        </td><td id="24bf4c8f"><p>                            </p><div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="kn">import</span> <span class="nn">java.util。清单</span> <span class="o">;</span> <span class="kn">import</span> <span class="nn">java.util.function。功能</span> <span class="o">;</span> <span class="kd">public</span> <span class="kd">class</span> <span class="nc">PrintAction</span> <span class="kd">实现</span> <span class="n">Runnable</span> <span class="o">{</span> <span class="kd">private</span> <span class="n">List</span> <span class="o">&lt;</span> <span class="n">String</span> <span class="o">&gt;</span> <span class="n">数据</span> <span class="o">;</span> <span class="kd">public</span> <span class="nf">PrintAction</span> <span class="o">（</span> <span class="n">List</span> <span class="o">&lt;</span> <span class="n">String</span> <span class="o">&gt;</span> <span class="n">data</span> <span class="o">）</span> <span class="o">{</span> <span class="k">this</span> <span class="o">。</span> <span class="na">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">;</span> <span class="o">}</span> <span class="kd">公共</span> <span class="kt">无效</span> <span class="nf">的<span class="o"><span class="o">run（）{</span></span></span> <span class="n">功能</span> <span class="o">&lt;</span> <span class="n">列表</span> <span class="o">&lt;</span> <span class="n">字符串</span> <span class="o">&gt;，</span> <span class="n">字符串</span> <span class="o">&gt;</span> <span class="n">演示</span> <span class="o"><span class="o"><span class="n"><span class="o">=（P）</span></span></span></span> <span class="o">- &gt;</span> <span class="s">“数据：”</span> <span class="o">+</span> <span class="n">页</span> <span class="o">。</span> <span class="na">toString</span> <span class="o">（）;</span> <span class="n">系统</span> <span class="o">。</span> <span class="na">出</span> <span class="o">。</span> <span class="na">的<span class="o"><span class="o">println（</span></span></span> <span class="n">演示</span> <span class="na">应用</span> <span class="o">（</span> <span class="n">数据</span> <span class="o">））;</span> <span class="o">}</span> <span class="o">}</span></code></div>                        </td></tr></tbody></table></div>            </div>        </div></div></div>                                      <div class="last-modified" data-skip-index="skip">最后修改日期：2019年3月28日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="extract-superclass.html">提取超类</a> <a class="navigation-links__next" href="javaintroduce.html">提取参数</a></div><section class="seealso" data-skip-index="skip"><div class="seealso__header"><h2>也可以看看</h2></div><div class="seealso__content"><div class="seealso__col" data-skip-index="skip"><h3>程序：</h3><ul class="list"><li class="list__item"><a href="working-with-source-code.html">在编辑器中选择文本</a></li><li class="list__item"><a href="rename-refactorings.html"><span>重命名重构</span></a></li><li class="list__item"><a href="specific-javascript-refactorings.html#javascript_extract_variable">在JavaScript中提取变量</a></li></ul></div><div class="seealso__col" data-skip-index="skip"><h3>参考：</h3><ul class="list"><li class="list__item"><a href="extract-variable-refactoring-dialog.html"><span>提取变量对话框</span></a></li></ul></div></div></section></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="../app/v2/app.js"></script></body></html>