<html lang="en-US" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></meta><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="../app/v2/analytics.js"></script><link rel="canonical" href="contract-annotations.html"></link><meta charset="UTF-8"></meta><title>@Contract  - 帮助| IntelliJ IDEA</title><link rel="stylesheet" href="../app/v2/app.css"></link></head><body dir="ltr" data-id="_Contract_Annotations"><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索IntelliJ IDEA帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="contract-annotations.html#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>IntelliJ IDEA 2019.1帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">键盘布局</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option value="primary_default" data-group="primary" selected="">Windows / Linux默认值</option><option value="primary_default_for_gnome" data-group="primary">GNOME</option><option value="primary_default_for_kde" data-group="primary">KDE</option><option value="primary_default_for_xwin" data-group="primary">XWin中</option><option value="primary_emacs" data-group="primary">Emacs的</option><option value="primary_jbuilder" data-group="primary">JBuilder的</option><option value="primary_visual_studio" data-group="primary">视觉工作室</option><option value="primary_netbeans" data-group="primary">NetBeans的</option><option value="primary_eclipse" data-group="primary">日食</option><option value="secondary_mac_os_x_10.5_" data-group="secondary">默认（Mac OS X 10.5+）</option><option value="secondary_mac_os_x" data-group="secondary">Mac OS X.</option><option value="secondary_eclipse_mac_os_x" data-group="secondary">Eclipse（Mac OS X）</option><option value="secondary_intellij_idea_classic_os_x" data-group="secondary">IntelliJ IDEA Classic（Mac OS X）</option><option value="secondary_xcode" data-group="secondary">Xcode中</option><option value="secondary_resharper" data-group="secondary">ReSharper的</option><option value="secondary_resharper_osx" data-group="secondary">ReSharper（Mac OS X）</option><option value="secondary_emacs" data-group="secondary">Emacs（Mac OS X）</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="active"><h1 id="@Contract_Annotations.xml" data-toc="_Contract_Annotations">@合同</h1>    <p id="5ffa4a9a"><code class="code">@Contract</code>注释用于定义方法必须满足的合同。这使IDE可以在调用已注释方法的方法中发现问题。您不仅可以使用此批注来注释自己的代码，还可以用于其他现有库。</p>    <p id="55c4516f"><code class="code">@Contract</code>注释有两个属性 - <code class="code">value</code>和<code class="code">pure</code> 。<code class="code">value</code>属性包含描述参数和返回值之间的因果关系的子句。</p>    <p id="adf559d0"><code class="code">pure</code>属性适用于不更改其对象状态但只返回新值的方法。如果未使用其返回值，则删除其调用不会影响程序状态或更改语义，除非方法调用抛出异常（异常不被视为副作用）。</p>    <p id="b3953a60">如果一个方法本身不产生副作用，则不应该将其标记为纯，但是它可以用于在另一个线程中的事件之间建立事先发生的关系，以便在另一个线程中执行的更改可能在当前可见调用此方法后的线程。另一方面，一些同步方法可以标记为纯，因为这里同步的目的是保持集合内部完整性而不是等待另一个线程中的事件。允许不会影响重要程序语义的“不可见”副作用（例如日志记录）。</p>    <p id="76cb7221">合同是一组描述输入和输出的子句。它们用<code class="code">-&gt;</code>符号分隔： <code class="code">"A -&gt; B"</code> 。这形成了一个合同，这意味着当你向一个方法提供A时，你总会得到B.合同中的条款必须用<code class="code">;</code> （分号）符号。例如：</p>    <div class="table-wrapper"><table class="no_header                 " width="100%" id="7f0866a4"><tbody><tr id="5df0b772" class="ijRowOdd"><td id="afd45526"><code class="code">@Contract（“_，null  - &gt; null”）</code></td><td id="4cf5a5b1"><p>该方法返回<code class="code">null</code> ，如果第二个参数是<code class="code">null</code> 。</p></td></tr><tr id="9e78e2af" class="ijRowEven"><td id="a4541ef2"><code class="code">@Contract（“_，null  - &gt; null; _ ,!null  - &gt;！空值”）</code></td><td id="efb8cedd"><p>如果第二个参数为<code class="code">null</code> ，则该方法返回<code class="code">null</code>否则返回<code class="code">null</code> 。</p></td></tr><tr id="48ad992d" class="ijRowOdd"><td id="069337fd"><code class="code">@Contract（“true  - &gt; fail”）</code></td><td id="61045222"><p>典型的<code class="code">assertFalse()</code>方法，如果将<code class="code">true</code>传递给它，则抛出异常。</p></td></tr><tr id="4a74a8a4" class="ijRowEven"><td id="10dca0a4"><code class="code">@Contract（“_  - &gt; this”）</code></td><td id="2d987a92"><p>该方法始终返回其限定符（例如<code class="code">StringBuilder.append</code> ）。</p></td></tr><tr id="7bd8a15f" class="ijRowOdd"><td id="3523697e"><code class="code">@Contract（“null  - &gt; fail; _  - &gt; param1”）</code></td><td id="af442e19"><p>如果第一个参数为null，则该方法抛出异常，否则返回第一个参数（例如<code class="code">Objects.requireNonNull</code> ）。</p></td></tr><tr id="191a0918" class="ijRowEven"><td id="2df59d0f"><code class="code">@合同（”！null，_  - &gt; param1;空值， ！null  - &gt; param2; null，null  - &gt; fail“）</code></td><td id="98e6e2bf"><p>该方法返回第一个非null参数，如果两个参数都为null，则抛出异常（例如Java 9中的<code class="code">Objects.requireNonNullElse</code> ）。</p></td></tr></tbody></table></div>    <section class="procedure-steps"><h2 id="2c1ac255">定义合同</h2><ol class="list _decimal"><li class="list__item" id="645097f8"><p>在方法上按<kbd data-primary_default="Alt+Enter" data-primary_default_for_gnome="Alt+Enter" data-primary_default_for_kde="Alt+Enter" data-primary_default_for_xwin="Alt+Enter" data-primary_emacs="Alt+Enter" data-primary_jbuilder="Alt+Enter" data-primary_visual_studio="Alt+Enter" data-primary_netbeans="Alt+Enter" data-primary_eclipse="Alt+Enter" data-secondary_mac_os_x_10.5_="⌥⏎" data-secondary_mac_os_x="⌥⏎" data-secondary_eclipse_mac_os_x="⌘1" data-secondary_intellij_idea_classic_os_x="N/A" data-secondary_xcode="N/A" data-secondary_resharper="N/A" data-secondary_resharper_osx="N/A" data-secondary_emacs="⌥⏎">Alt + Enter</kbd> ，然后选择<span class="control">添加方法合同</span>或<span class="control">编辑方法合同</span> 。</p></li><li class="list__item" id="5a4c88bf"><p>配置合同并应用更改。</p><figure><img alt="合同注释lib1" title="合同注释lib1" src="../img/idea/2019.1/contract_annotation_lib1.png" id="88cc171b" width="300" height="370"></figure>        </li></ol></section>    <div class="chapter"><h2 id="9d304af0">句法</h2>        <p id="9e4601dd"><code class="code">@Contract</code>注释值具有以下语法：</p>        <p id="605fcb52">            <code class="code">contract :: =（clause';'）*子句</code><br>            <code class="code">clause :: = args' - &gt;'效果</code><br>            <code class="code">args :: =（（arg'，'）* arg）？</code><br>            <code class="code">arg :: = value-constraint</code><br>            <code class="code">value-constraint :: ='_'| 'null'| “！null'| '假'| '真正'</code><br>            <code class="code">effect :: ='_'| 'null'| “！null'| '假'| '真'| '失败'| '新'| '这个'| 'param'号码</code><br>            <code class="code">number :: = [1-9] [0-9] *</code>        </p>        <p id="d5a62c22">限制是：</p>        <div class="table-wrapper"><table class="no_header                 " width="100%" id="46dce846"><tbody><tr id="e3aabc39" class="ijRowOdd"><td id="3335046e"><code class="code">_</code></td><td id="03be209a"><p>任何价值</p></td></tr><tr id="2a48f4ef" class="ijRowEven"><td id="62c5bffd"><p><code class="code">空值</code>  </p></td><td id="b6717468"><p>空值</p></td></tr><tr id="d4538568" class="ijRowOdd"><td id="f7476532"><p> <code class="code">！空值</code>  </p></td><td id="d685859c"><p>静态证明值不为空</p></td></tr><tr id="ebfee2e9" class="ijRowEven"><td id="f69b736a"><p><code class="code">真正</code>  </p></td><td id="750d1bd3"><p>真布尔值</p></td></tr><tr id="8aea603d" class="ijRowOdd"><td id="0949c946"><p> <code class="code">假</code> </p></td><td id="4450336d"><p>假布尔值</p></td></tr><tr id="0abba227" class="ijRowEven"><td id="625f9cd0"><p> <code class="code">失败</code>  </p></td><td id="9d21746e"><p>如果参数满足参数约束，则该方法抛出异常</p></td></tr><tr id="aa0f42dc" class="ijRowOdd"><td id="580b3c81"><p> <code class="code">新</code>  </p></td><td id="58e0941d"><p>每次执行该方法时，它都会返回一个非null的新对象，该对象与方法执行之前存在于堆中的其他对象不同。如果方法是纯的，则新对象不存储在任何字段或数组中，如果未使用方法返回值，则会丢失该对象。</p></td></tr><tr id="332b5b04" class="ijRowEven"><td id="d82dabaa"><p> <code class="code">这个</code>  </p></td><td id="9d655ee9"><p>该方法返回非null <code class="code">this</code>引用</p></td></tr><tr id="e12ab311" class="ijRowOdd"><td id="38ac023d"><p><code class="code">param1（param2，param3等）</code>  </p></td><td id="02131468"><p>该方法返回其第一个（第二个，第三个等）参数</p></td></tr></tbody></table></div>    </div>    <div class="last-modified" data-skip-index="skip">最后修改日期：2019年3月28日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="nullable-and-notnull-annotations.html">@Nullable和@NotNull</a> <a class="navigation-links__next" href="parametersarenonnullbydefault-annotation.html">@ParametersAreNonnullByDefault</a></div><section class="seealso" data-skip-index="skip"><div class="seealso__header"><h2>也可以看看</h2></div><div class="seealso__content"><div class="seealso__col" data-skip-index="skip"><h3>程序：</h3><ul class="list"><li class="list__item"><a href="code-inspection.html"><span>代码检查</span></a></li><li class="list__item"><a href="intention-actions.html"><span>意图行动</span></a></li></ul></div></div></section></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="../app/v2/app.js"></script></body></html>