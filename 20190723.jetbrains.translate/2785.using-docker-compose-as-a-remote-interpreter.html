<html lang="en-US" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></meta><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="../app/v2/analytics.js"></script><link rel="canonical" href="using-docker-compose-as-a-remote-interpreter.html"></link><meta charset="UTF-8"></meta><title>使用Docker Compose配置远程解释器 - 帮助| PyCharm</title><link rel="stylesheet" href="../app/v2/app.css"></link></head><body dir="ltr" data-id="add_interpreter_docker_compose"><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索PyCharm帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="using-docker-compose-as-a-remote-interpreter.html#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>PyCharm 2019.1帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">键盘布局</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option value="primary_default" data-group="primary" selected="">Windows / Linux默认值</option><option value="primary_default_for_gnome" data-group="primary">GNOME</option><option value="primary_default_for_kde" data-group="primary">KDE</option><option value="primary_default_for_xwin" data-group="primary">XWin中</option><option value="primary_emacs" data-group="primary">Emacs的</option><option value="primary_visual_studio" data-group="primary">视觉工作室</option><option value="primary_netbeans" data-group="primary">NetBeans的</option><option value="primary_eclipse" data-group="primary">日食</option><option value="secondary_mac_os_x_10.5_" data-group="secondary">默认（Mac OS X 10.5+）</option><option value="secondary_mac_os_x" data-group="secondary">Mac OS X.</option><option value="secondary_eclipse_mac_os_x" data-group="secondary">Eclipse（Mac OS X）</option><option value="secondary_intellij_idea_classic_os_x" data-group="secondary">IntelliJ IDEA Classic（Mac OS X）</option><option value="secondary_xcode" data-group="secondary">Xcode中</option><option value="secondary_visual_studio" data-group="secondary">视觉工作室</option><option value="secondary_resharper" data-group="secondary">ReSharper的</option><option value="secondary_resharper_osx" data-group="secondary">ReSharper（Mac OS X）</option><option value="secondary_emacs" data-group="secondary">Emacs（Mac OS X）</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="active"><h1 id="Using_Docker_Compose_as_a_Remote_Interpreter.xml" data-toc="add_interpreter_docker_compose">使用Docker Compose配置远程解释器</h1>             <aside class="warning " rel="Using_Docker_Compose_as_a_Remote_Interpreter.xml" id="91d31bba" data-title=""><p>此功能仅在<b id="3aee4c4b" origin="intellij-platform">专业</b>版中受支持。此版本是商业版，它提供了一系列出色的功能：有关详细信息，请参阅<a href="https://www.jetbrains.com/pycharm/features/editions_comparison_matrix.html" data-bypass="yes" target="_blank"><span>比较矩阵</span></a> 。</p></aside>    <div class="chapter"><h2 id="prereq" data-toc="add_interpreter_docker_compose#prereq">先决条件</h2>        <p id="c1c60257">确保满足以下先决条件：</p>                        <ul class="list _ul"><li class="list__item" id="b9f23f96">                <p id="15b22ca8">Docker已安装。您可以在各种平台上安装Docker，但在这里我们将使用<a href="https://docs.docker.com/docker-for-windows/" data-bypass="yes" target="_blank"><span>Windows</span></a>安装。</p>                <p id="e0b328d3">请注意，您可能希望在不同平台上重复本教程;然后使用Docker安装<a href="https://docs.docker.com/docker-for-mac/" data-bypass="yes" target="_blank"><span>macOS</span></a>和<a href="https://docs.docker.com/engine/installation/linux/ubuntu/" data-bypass="yes" target="_blank"><span>Linux</span></a> （Ubuntu，其他与发行版相关的指令也可用）。</p>            </li><li class="list__item" id="0c4cdfd6">        <p id="e169be44">在开始使用Docker之前，请确保已启用Docker Integration和Python Docker插件。这些插件与PyCharm捆绑在一起并默认激活。如果未激活<a href="plugins-settings.html"><span>插件</span></a> ，请按照<a href="managing-plugins.html"><span>管理插件中</span></a>的说明在<a href="settings-preferences-dialog.html"><span>“设置/首选项”对话框</span></a>的<a href="settings-preferences-dialog.html"><span>“</span></a> <a href="plugins-settings.html"><span>插件”</span></a>页面上启用它们。</p>                </li></ul>    </div>    <div class="chapter"><h2 id="example" data-toc="add_interpreter_docker_compose#example">准备一个例子</h2>              <p id="e28cc0ff">我们实际上可以重复使用与Docker <a href="using-docker-as-a-remote-interpreter.html#example">相同的示例</a> ，但对于Docker Compose来说它没有意义 - 太简单了......</p>        <p id="33b8aa78">为了展示Docker Compose应用程序的实际示例，我们将使用一个Django应用程序和一个在单独容器中运行的PostgreSQL数据库。<a href="https://github.com/ErnstHaagsman/djangodocker" data-bypass="yes" target="_blank"><span>从GitHub获取项目，</span></a>并在PyCharm（ <span class="menupath" data-skip-index="skip">File | Open</span> ）中打开它。</p>        <p id="d56e5d3a">对于这个Django应用程序，我们应该创建两个容器：一个用于数据库，一个用于应用程序本身。我们将使用Docker Compose将两个容器链接在一起。</p>                </div>    <div class="chapter"><h2 id="dockerfile" data-toc="add_interpreter_docker_compose#dockerfile">为Docker和Docker Compose添加文件</h2>        <p id="730f3b6f">在“项目”工具窗口中，右键单击项目根目录，然后选择“ <span class="menupath" data-skip-index="skip">新建”|文件</span> （ <kbd data-primary_default="Alt+Insert" data-primary_default_for_gnome="Alt+Insert" data-primary_default_for_kde="Alt+Insert" data-primary_default_for_xwin="Alt+Insert" data-primary_emacs="Alt+Insert" data-primary_visual_studio="Ctrl+N" data-primary_netbeans="Alt+Insert" data-primary_eclipse="Alt+Insert" data-secondary_mac_os_x_10.5_="⌘N" data-secondary_mac_os_x="⌃N" data-secondary_eclipse_mac_os_x="⌘N" data-secondary_intellij_idea_classic_os_x="N/A" data-secondary_xcode="N/A" data-secondary_visual_studio="⌃N" data-secondary_resharper="N/A" data-secondary_resharper_osx="N/A" data-secondary_emacs="N/A">Alt + Insert</kbd> ），输入文件名（此处为<code class="code">Dockerfile</code> ）并输入以下代码：</p>        <div class="code-block" data-lang="Generic"><code class="code-block__wrapper">FROM python：3.6 WORKDIR / app <span class="c">＃首先复制需求，我们确保Docker将缓存</span> <span class="c">＃我们安装的需求，而不是在每个构建版本上重新安装</span> COPY requirements.txt /app/requirements.txt RUN pip install -r requirements.txt <span class="c">＃现在复制我们的代码，并运行它</span> COPY。 / app EXPOSE 8000 CMD <span class="o">[</span> <span class="s2">“python”</span> ， <span class="s2">“manage.py”</span> ， <span class="s2">“runserver”</span> ， <span class="s2">“0.0.0.0：8000”</span> <span class="o">]</span></code></div>                <p id="docker-compose">接下来，对<code class="code">docker-compose.yml</code>文件重复相同的步骤并输入以下代码：</p>        <div class="code-block" data-lang="Generic"><code class="code-block__wrapper">版本： <span class="s1">'2'</span>服务：web：build :.端口： - <span class="s2">“8000：8000”</span>卷： - 。：/ app links： -  db db：image： <span class="s2">“postgres：9.6”</span> ports： - <span class="s2">“5432：5432”</span>环境：POSTGRES_PASSWORD：hunter2</code></div>                <p id="2815bb7a">我们来看看<code class="code">docker-compose.yml</code>文件。此文件定义了2个服务： <code class="code">web</code>和<code class="code">db</code> ，并将它们链接在一起。</p>            </div>    <div class="chapter"><h2 id="configuring-docker" data-toc="add_interpreter_docker_compose#configuring-docker">配置Docker</h2>        <p id="92d24334">现在我们已经准备好了我们的示例，让我们配置Docker。</p>        <p id="5062b5db">为此，请打开“设置”对话框（ <kbd data-primary_default="Ctrl+Alt+S" data-primary_default_for_gnome="Ctrl+Alt+S" data-primary_default_for_kde="Ctrl+Alt+S" data-primary_default_for_xwin="Ctrl+Alt+S" data-primary_emacs="Ctrl+Alt+S" data-primary_visual_studio="Alt+F7" data-primary_netbeans="Ctrl+Alt+S" data-primary_eclipse="Ctrl+Alt+S" data-secondary_mac_os_x_10.5_="⌘," data-secondary_mac_os_x="⌘," data-secondary_eclipse_mac_os_x="⌘," data-secondary_intellij_idea_classic_os_x="N/A" data-secondary_xcode="N/A" data-secondary_visual_studio="⌥F7" data-secondary_resharper="N/A" data-secondary_resharper_osx="N/A" data-secondary_emacs="⌃⌥S">Ctrl + Alt + S</kbd>或单击<img class="inline-icon-16" src="../img/idea/2019.1/icons.general.settings.svg@2x.png" width="16" alt="设置">在主工具栏上），然后单击<span class="control">Build，Execution，Deployment</span>节点下的<a href="docker-connection-settings.html"><span>Docker</span></a>页面。点击<img class="inline-icon-16" src="../img/idea/2019.1/icons.general.add.svg@2x.png" width="16" alt="添加docker服务器">创建一个Docker服务器。</p>        <p id="d7d256c1">接受建议的默认值：</p>        <figure><img alt="Docker设置" title="Docker设置" src="../img/idea/2019.1/py_docker_settings.png" id="9b03ac8e" width="763" height="933"></figure>                <p id="60f7f4f4">对于macOS，选择<span class="control">Docker for Mac</span>以连接到Docker守护程序。</p>        <figure><img alt="Docker设置" title="Docker设置" src="../img/idea/2019.1/py_docker_settings_mac.png" id="11c89a1d" width="801" height="970"></figure>        <p id="46149753">接下来，应用更改。</p>    </div>    <div class="chapter"><h2 id="docker-compose-remote" data-toc="add_interpreter_docker_compose#docker-compose-remote">配置Docker Compose作为远程解释器</h2>        <p id="79dc6282">现在让我们定义一个基于Docker-Compose的远程解释器。</p>                                                    <p id="b3afd240">通过以下任一方式打开“ <span class="control">添加Python解释器”</span>对话框：</p>            <ul class="list _ul"><li class="list__item" id="b59f5852"><p>当您在<span class="control">编辑器中时</span> ，最方便的方法是使用<a href="status-bar.html#python-interpreter-widget"><span>状态栏中</span></a>的<span class="control">Python解释器</span>小部件。单击小部件并选择<span class="menupath" data-skip-index="skip">Add Interpreter ...</span></p></li><li class="list__item" id="a91cc8d3"><p id="dd65d1ef">如果您位于“ <span class="control">设置/首选项”</span>对话框（ <kbd data-primary_default="Ctrl+Alt+S" data-primary_default_for_gnome="Ctrl+Alt+S" data-primary_default_for_kde="Ctrl+Alt+S" data-primary_default_for_xwin="Ctrl+Alt+S" data-primary_emacs="Ctrl+Alt+S" data-primary_visual_studio="Alt+F7" data-primary_netbeans="Ctrl+Alt+S" data-primary_eclipse="Ctrl+Alt+S" data-secondary_mac_os_x_10.5_="⌘," data-secondary_mac_os_x="⌘," data-secondary_eclipse_mac_os_x="⌘," data-secondary_intellij_idea_classic_os_x="N/A" data-secondary_xcode="N/A" data-secondary_visual_studio="⌥F7" data-secondary_resharper="N/A" data-secondary_resharper_osx="N/A" data-secondary_emacs="⌃⌥S">Ctrl + Alt + S</kbd> ）中，请选择“ <span class="menupath" data-skip-index="skip">项目&lt;项目名称&gt;”项目口译员</span> 。点击<img class="inline-icon-16" src="../img/idea/2019.1/icons.general.gearPlain.svg@2x.png" width="16" alt="配置项目解释器">图标，然后选择<span class="control">添加</span> 。</p></li></ul>                        <p id="8b783fd4">在打开的对话框中，选择<span class="control">Docker Compose</span>选项，从下拉列表中选择Docker服务器，Docker Compose服务（此处为<code class="code">web</code> ），配置文件（此处<code class="code">docker-compose.yml</code> ）和图像名称（此处为<code class="code">python</code> ）。</p>            <p id="68e94154">为什么我们选择<code class="code">web</code> ？这个选择的原因在于，在配置基于Docker-Compose的解释器之后，我们将能够创建定期运行配置，这将改变我们选择的容器的行为。因此，如果我们想调试容器中的代码，那就是我们应该在这里选择的代码。compose文件中的所有其他容器将始终与此一起启动，但是您无法从PyCharm影响它们的行为 - 它们总是表现得就像使用命令<code class="code">docker-compose up</code>命令启动它们一样线。</p>            <p id="d3378fe6">接下来，等待PyCharm启动Docker-Compose配置进行扫描和索引：</p>                        <figure><img alt="配置远程Python解释器" title="配置远程Python解释器" src="../img/idea/2019.1/py_docker_as_remote.png" id="4fa7608c" width="904" height="1106"></figure>                                             </div>    <div class="chapter"><h2 id="tw" data-toc="add_interpreter_docker_compose#tw">使用Docker工具窗口</h2>        <p id="bce8f9eb">由于我们已经<a href="using-docker-compose-as-a-remote-interpreter.html#configuring-docker">配置了Docker</a> ，因此Docker工具窗口按钮出现在PyCharm主窗口的底部。</p>                <p id="2c0b5626">单击此按钮，看到您的容器正在运行：</p>        <figure><img alt="Docker窗口" title="Docker窗口" src="../img/idea/2019.1/py_docker_running_container.png" id="0948c1fa" width="400" height="660"></figure>            </div>    <div class="chapter"><h2 id="db_Settings" data-toc="add_interpreter_docker_compose#db_Settings">配置数据库凭据</h2>        <p id="f153179a">修改Django项目中<code class="code">settings.py</code>文件的<code class="code">DATABASES</code>部分以添加数据库配置详细信息：</p>        <div class="code-block" data-lang="Python"><code class="code-block__wrapper"><span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span> <span class="s">'default'</span> <span class="p">：</span> <span class="p">{</span> <span class="s">'ENGINE'</span> <span class="p">：</span> <span class="s">'django.db.backends.postgresql'</span> <span class="p">，</span> <span class="s">'NAME'</span> <span class="p">：</span> <span class="s">'postgres'</span> <span class="p">，</span> <span class="s">'USER'</span> <span class="p">：</span> <span class="s">'postgres'</span> <span class="p">，</span> <span class="s">'PASSWORD'</span> <span class="p">：</span> <span class="s">'hunter2'</span> <span class="p">，</span> <span class="s">'HOST'</span> <span class="p">：</span> <span class="s">'db'</span> <span class="p">}</span> <span class="p">}</span></code></div>    </div>    <div class="chapter"><h2 id="run" data-toc="add_interpreter_docker_compose#run">在Docker-Compose下运行您的应用程序</h2>        <p id="f299559c">首先，当我们执行Django应用程序时，我们必须运行迁移。</p>                <p id="920a07fc">为此，请选择“ <span class="menupath" data-skip-index="skip">工具”|运行'manage.py'任务</span>并输入<code class="code">migrate</code> ：</p>        <figure><img alt="manage.py任务正在Docker中运行" title="manage.py任务正在Docker中运行" src="../img/idea/2019.1/py_docker_run_manage_py_task.png" id="b3f9050f" width="743" height="798"></figure>            <p id="419b5ceb">（有关详细信息，请参阅<a href="running-manage-py.html"><span>manage.py实用程序的运行任务</span></a> 。）</p>        <p id="60d15598">接下来，创建一个普通的Django服务器运行/调试配置。为此，请在主菜单上选择<span class="menupath" data-skip-index="skip">“运行”|编辑配置......</span> ;在打开的对话框中单击<img class="inline-icon-16" src="../img/idea/2019.1/icons.general.add.svg@2x.png" width="16" alt="添加Django Server的运行/调试配置">并选择<span class="control">Django Server</span> ：</p>            <figure><img alt="Django服务器的运行/调试配置" title="Django服务器的运行/调试配置" src="../img/idea/2019.1/py_docker_run_django_server.png" id="7b63512e" width="1453" height="1131"></figure>            <p id="9b1e1ec9">            <span class="emphasis">你唯一应该注意的是， <span class="control">Host</span>字段必须设置为<code class="code">0.0.0.0</code> - 以确保我们监听来自Docker容器外部的请求。</span>            </p>            <p id="1a74539d">启动此配置（ <span class="menupath" data-skip-index="skip">运行|运行'RunDjangoApp'</span> ）：</p>            <figure><img alt="Docker撰写运行" title="Docker撰写运行" src="../img/idea/2019.1/py_docker_compose_run.png" id="e9959a87" width="2178" height="378"></figure>            <p id="1">要在Web浏览器中查看输出，请转到<a href="http://localhost:8000" data-bypass="yes" target="_blank"><span>http：// localhost：8000</span></a> （在地址栏中，将<code class="code">0.0.0.0</code>更改为<code class="code">localhost</code> ）：</p>            <figure><img alt="Django应用程序输出" title="Django应用程序输出" src="../img/idea/2019.1/py_docker_django_app_result.png" id="ccca01ea" width="891" height="281"></figure>            <aside class="tip sideblock" rel="1" id="0f769be6" data-title="">                <p id="55c9ce29">如果您使用的是Docker Machine，请改用机器的IP地址。</p>            </aside>                    </div>        <div class="chapter"><h2 id="summary" data-toc="add_interpreter_docker_compose#summary">摘要</h2>        <p id="c1811070">让我们总结一下在PyCharm的帮助下所做的工作：</p>        <ul class="list _ul"><li class="list__item" id="5ebc04e3"><p>我们从GitHub下载了一个Django应用程序并打开它。</p></li><li class="list__item" id="17ae2924"><p>我们在项目中添加了特定的Docker Compose文件。</p></li><li class="list__item" id="d69727da"><p>我们基于Docker Compose配置了一个远程解释器。</p></li><li class="list__item" id="1576166c"><p>我们在Docker Compose容器中运行了我们的Django应用程序。</p></li></ul>    </div>    <div class="last-modified" data-skip-index="skip">最后修改日期：2019年3月28日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="using-docker-as-a-remote-interpreter.html">使用Docker配置远程解释器</a> <a class="navigation-links__next" href="installing-uninstalling-and-upgrading-packages.html">安装，卸载和升级包</a></div><section class="seealso" data-skip-index="skip"><div class="seealso__header"><h2>也可以看看</h2></div><div class="seealso__content"><div class="seealso__col" data-skip-index="skip"><h3>语言，框架和技术：</h3><ul class="list"><li class="list__item"><a href="debugging-django-templates.html"><span>调试Django模板</span></a></li></ul></div><div class="seealso__col" data-skip-index="skip"><h3>参考：</h3><ul class="list"><li class="list__item"><a href="docker-connection-settings.html"><span>搬运工人</span></a></li></ul></div></div></section></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="../app/v2/app.js"></script></body></html>