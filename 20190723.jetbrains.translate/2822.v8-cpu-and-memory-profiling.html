<html lang="en-US" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></meta><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="../app/v2/analytics.js"></script><link rel="canonical" href="v8-cpu-and-memory-profiling.html"></link><meta charset="UTF-8"></meta><title>V8 CPU和内存分析 - 帮助| PyCharm</title><link rel="stylesheet" href="../app/v2/app.css"></link></head><body dir="ltr" data-id="V8_CPU_and_Memory_Profiling"><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索PyCharm帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="v8-cpu-and-memory-profiling.html#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>PyCharm 2019.1帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">键盘布局</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option value="primary_default" data-group="primary" selected="">Windows / Linux默认值</option><option value="primary_default_for_gnome" data-group="primary">GNOME</option><option value="primary_default_for_kde" data-group="primary">KDE</option><option value="primary_default_for_xwin" data-group="primary">XWin中</option><option value="primary_emacs" data-group="primary">Emacs的</option><option value="primary_visual_studio" data-group="primary">视觉工作室</option><option value="primary_netbeans" data-group="primary">NetBeans的</option><option value="primary_eclipse" data-group="primary">日食</option><option value="secondary_mac_os_x_10.5_" data-group="secondary">默认（Mac OS X 10.5+）</option><option value="secondary_mac_os_x" data-group="secondary">Mac OS X.</option><option value="secondary_eclipse_mac_os_x" data-group="secondary">Eclipse（Mac OS X）</option><option value="secondary_intellij_idea_classic_os_x" data-group="secondary">IntelliJ IDEA Classic（Mac OS X）</option><option value="secondary_xcode" data-group="secondary">Xcode中</option><option value="secondary_visual_studio" data-group="secondary">视觉工作室</option><option value="secondary_resharper" data-group="secondary">ReSharper的</option><option value="secondary_resharper_osx" data-group="secondary">ReSharper（Mac OS X）</option><option value="secondary_emacs" data-group="secondary">Emacs（Mac OS X）</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="active"><h1 id="V8_CPU_and_Memory_Profiling.xml" data-toc="V8_CPU_and_Memory_Profiling">V8 CPU和内存分析</h1>         <aside class="warning " rel="V8_CPU_and_Memory_Profiling.xml" id="7f3db149" data-title=""><p>此功能仅在<b id="cff9cc51" origin="intellij-platform">专业</b>版中受支持。此版本是商业版，它提供了一系列出色的功能：有关详细信息，请参阅<a href="https://www.jetbrains.com/pycharm/features/editions_comparison_matrix.html" data-bypass="yes" target="_blank"><span>比较矩阵</span></a> 。</p></aside>    <p id="ws_v8_profiling_intro">使用PyCharm，您可以使用<a href="https://v8.dev/docs/profile" data-bypass="yes" target="_blank"><span>V8基于样本的分析器</span></a>捕获和分析<span class="emphasis">Node.js</span>应用程序的CPU配置文件和堆快照。</p>    <p id="796d9d15">您还可以打开并浏览Google Chrome DevTools中捕获的配置文件和快照，以获取客户端代码。</p>    <div class="chapter"><h2 id="ws_v8_profiling_preparing" data-toc="V8_CPU_and_Memory_Profiling#ws_v8_profiling_preparing">在你开始之前</h2>        <p id="419b1ef4">确保您的计算机上有<a href="http://nodejs.org/" data-bypass="yes" target="_blank"><span>Node.js.</span></a></p>    </div>    <div class="chapter"><h2 id="ws_node_cpu_profiling" data-toc="V8_CPU_and_Memory_Profiling#ws_node_cpu_profiling">CPU分析</h2>        <p id="ecfd080b">CPU分析可帮助您更好地了解代码的哪些部分占用大部分CPU时间，以及V8 JavaScript引擎如何执行和优化代码。</p>        <p id="6b32bb12">Node.js PyCharm中的CPU分析基于V8内置CPU分析器，它提供有关代码执行和JavaScript引擎本身行为的信息，包括垃圾收集周期，编译和重新编译以及代码优化。</p>        <p id="360afe5c">探查器以特定间隔拍摄快照，这些间隔称为刻度线。测量不仅针对代码的工作，还针对引擎本身执行的活动，例如编译，系统库调用，优化和垃圾收集。</p>        <section class="procedure-steps"><h2 id="ws_node_configuring_cpu_profiling">启用CPU分析</h2><p id="6ad9b780">要在应用程序启动时调用V8 CPU分析，您需要在<span class="control">Node.js</span>运行配置中指定其他设置。</p><ol class="list _decimal"><li class="list__item" id="db539f2d"><p>在主菜单上，选择<span class="menupath" data-skip-index="skip">“运行”|编辑配置</span> 。点击<img class="inline-icon-16" src="../img/idea/2019.1/icons.general.add@2x.png" width="16" alt="图标一般添加">在工具栏上，从列表中选择<span class="control">Node.js.</span></p></li><li class="list__item" id="84719617"><p>从列表中，选择<span class="emphasis">Node.js</span>运行配置以激活CPU分析或创建新配置，如<a href="running-and-debugging-node-js.html"><span>运行和调试Node.js中所述</span></a> 。</p></li><li class="list__item" id="c16969b3">                    <p id="9d6be794">切换到<span class="control">V8 Profiling</span>选项卡，然后选中<span class="control">Record CPU profiling info</span>复选框。在“ <span class="control">日志文件夹”</span>字段中，指定将存储记录日志的文件夹的路径，日志文件名为<code class="code">isolate-&lt;session number&gt;</code> 。</p>                                        <figure><img alt="V8分析器选项卡" title="V8分析器选项卡" src="../img/idea/2019.1/ws_v8_profiler_tab_light.png" id="72c7c703" class=" _border-line" width="600" height="461"></figure>                </li></ol></section>        <section class="procedure-steps"><h2 id="ws_node_collecting_cpu_profiling_data">收集CPU分析信息</h2><ol class="list _decimal"><li class="list__item" id="e7d2ebc6">                    <p id="8f35b10c">从主工具栏上的列表中选择运行配置，然后单击<img class="inline-icon-16" src="../img/idea/2019.1/icons.toolwindows.toolWindowRun.svg@2x.png" width="16" alt="运行按钮">或选择<span class="menupath" data-skip-index="skip">运行|</span>从主菜单中<span class="menupath" data-skip-index="skip">运行&lt;配置名称&gt;</span> 。</p>                </li><li class="list__item" id="044dc8e9">                    <p id="ac3c2d5a">执行需要配置的方案时，单击以停止该过程<img class="inline-icon-16" src="../img/idea/2019.1/icons.actions.suspend.svg@2x.png" width="16" alt="停止按钮">在工具栏上。</p>                </li></ol></section>        <div class="chapter"><h3 id="ws_node_analyzing_cpu_profiling_data">分析CPU分析日志</h3>            <p id="08e1f2f6">当您停止应用程序时，PyCharm会自动打开<span class="control">V8 Profiling</span>工具窗口并在其中显示收集的分析数据。如果窗口已打开并显示另一个会话的收集数据，PyCharm将打开一个新选项卡。自动打开的选项卡以控制应用程序执行和收集分析数据的运行配置命名。</p>            <p id="ee6bf3c5">要打开并分析以前保存的某些性能分析数据，请转到主菜单上的<span class="menupath" data-skip-index="skip">V8性能分析 - 分析V8性能分析日志</span> ，然后选择相关的<code class="code">isolate-&lt;session number&gt;</code> 。PyCharm创建一个单独的选项卡，其中包含所选日志文件的名称。</p>                    <p id="140a9c2d">根据收集的分析数据，PyCharm构建三个调用树并在单独的窗格中显示每个调用树。使用这些调用树，您可以从两个不同的角度分析应用程序执行：一方面，哪些调用是耗时的（“重”），另一方面，“谁叫谁”。</p>            <div class="chapter"><h4 id="ws_v8_spu_profiling_call_trees_metrics">了解调用树中的度量标准</h4>            <p id="f490bf8b">调用树使用<span class="emphasis">Total</span>和<span class="emphasis">Self</span>度量标准，这些度量标准显示函数中的滴答数或其与总执行时间的比率：</p>            <ul class="list _bullet"><li class="list__item" id="1da8fcfb"><p>                    <span class="emphasis">Total</span>显示在函数内部花费了多少时间以及它调用的函数。</p></li><li class="list__item" id="c94bc8ca"><p>                    <span class="emphasis">Self</span>表示仅在函数内部花费了多少时间而没有考虑其子节点。</p></li></ul>                <p id="e2c5c668"><span class="emphasis">Of Parent</span>度量标准显示函数的纯执行时间与调用它的函数（ <span class="emphasis">Parent</span> ）的执行时间之比。</p>            </div>            <div class="chapter"><h4 id="ws_v8_spu_profiling_call_trees_optimization">V8优化器</h4>            <p id="ws_v8_cpu_profiling_optimization">在某些情况下，V8可以优化您的代码，有关详细信息，请参阅<a href="http://floitsch.blogspot.de/2012/03/optimizing-for-v8-introduction.html" data-bypass="yes" target="_blank"><span>优化V8</span></a> ：</p>            <ul class="list _bullet"><li class="list__item" id="88b8718d"><p>函数名称前面的星号（ <code class="code">*</code> ）表示该函数已经过优化。</p></li><li class="list__item" id="e41cb5fa">                    <p id="1d64cbaf">波浪号（ <code class="code">~</code> ）表示该功能可能需要优化但由于某些原因尚未优化。如果代码短时间运行，引擎可以推迟优化或跳过它，但是代码可以重写的位置处的代数可以获得更好的性能。</p>                </li></ul>            </div>            <div class="chapter"><h4 id="ws_v8_spu_profiling_call_trees_top_calls">热门呼叫树</h4>                    <p id="537417ff">“ <span class="control">热门呼叫”</span>窗格按<span class="emphasis">自行</span>度量标准按降序排列已执行活动。对于每个活动，将显示其<span class="emphasis">总计百分比</span> ， <span class="emphasis">总百分比</span>和<span class="emphasis">自我百分比</span>指标。对于每个函数调用，PyCharm显示文件的名称，行和定义函数的列。</p>                                    <figure><img alt="V8 CPU分析：Top Calls树" title="V8 CPU分析：Top Calls树" src="../img/idea/2019.1/v8ProfilerCPUTopCalls_light.png" id="0e8c5728" class=" _border-line" width="600" height="878"></figure>                    <p id="85acb0b1">“ <span class="control">概述”</span>窗格中的图表显示<span class="emphasis">Self％</span>指标高于1％的通话的<span class="emphasis">自我</span>时间分布。</p>                </div>                <div class="chapter"><h4 id="ws_v8_spu_profiling_call_trees_bottom_up">自下而上的树</h4>                    <aside class="tip sideblock" rel="ws_v8_cpu_profiling_call_trees_bottom_up_intro" id="823d800b" data-title="">                        <p id="9bff62a5">如果您遇到<span class="emphasis">繁重的</span>功能并且想要找出它的调用位置，则<span class="control">自下而上的</span>树很有用。</p>                    </aside>                    <p id="ws_v8_cpu_profiling_call_trees_bottom_up_intro">“ <span class="control">自下而上”</span>窗格还列出了<span class="emphasis">自我</span>指标按降序排序的已执行活动。与“ <span class="control">热门呼叫”</span>窗格不同，“ <span class="control">自下而上”</span>窗格仅显示<span class="emphasis">总百分比</span>度量值大于2的活动以及调用它们的函数。</p>                    <ul class="list _bullet"><li class="list__item" id="fb19d985"><p>对于每个活动，将显示其在<span class="emphasis">刻度线中的</span>执行时间和<span class="emphasis">Of Parent</span>指标。</p></li><li class="list__item" id="d9f5dcb3"><p>对于每个函数调用，PyCharm显示文件的名称，行和定义函数的列。</p></li></ul>                                        <figure><img alt="V8 CPU分析：自下而上的树" title="V8 CPU分析：自下而上的树" src="../img/idea/2019.1/v8ProfilerCPUBottomUp_light.png" id="af23e16f" class=" _border-line" width="600" height="630"></figure>                </div>                <div class="chapter"><h4 id="ws_v8_spu_profiling_call_trees_top_down">自上而下的树</h4>                    <p id="bc255699">“ <span class="control">自上而下”</span>窗格显示整个调用层次结构，其中的函数是顶部显示的执行入口点。对于每个活动，将显示其<span class="emphasis">总计</span> ， <span class="emphasis">总百分比</span> ， <span class="emphasis">自我</span>和<span class="emphasis">自我％</span>指标。对于每个函数调用，PyCharm显示文件的名称，行和定义函数的列。</p>                    <figure><img alt="V8分析：自上而下的树" title="V8分析：自上而下的树" src="../img/idea/2019.1/v8ProfilerCPUTopDown_light.png" id="dd49bb39" class=" _border-line" width="600" height="818"></figure>                                    </div>            <section class="procedure-steps"><h2 id="8f2a65fe">浏览调用树</h2><ul class="list "><li class="list__item" id="df30a253">                    <p id="62584ce8">要导航到功能的源代码，请选择此功能并按<kbd data-primary_default="F4" data-primary_default_for_gnome="F4" data-primary_default_for_kde="F4" data-primary_default_for_xwin="F4" data-primary_emacs="F4" data-primary_visual_studio="F4" data-primary_netbeans="F4" data-primary_eclipse="F12" data-secondary_mac_os_x_10.5_="⌘↓" data-secondary_mac_os_x="F4" data-secondary_eclipse_mac_os_x="F3" data-secondary_intellij_idea_classic_os_x="N/A" data-secondary_xcode="N/A" data-secondary_visual_studio="F4" data-secondary_resharper="N/A" data-secondary_resharper_osx="N/A" data-secondary_emacs="F4">F4</kbd>或<img class="inline-icon-16" src="../img/idea/2019.1/icons.actions.edit.svg@2x.png" width="16" alt="编辑按钮">在工具栏上或从上下文菜单中选择“ <span class="control">跳转到源</span> ”。</p>                </li><li class="list__item" id="725f7073">                    <p id="1d2a4244">要切换到另一个窗格并从另一个透视图检查呼叫，请选择该呼叫并单击<img class="inline-icon-16" src="../img/idea/2019.1/NodeJS.com.jetbrains.nodejs.icons.Navigate_inMainTree@2x.png" width="16" alt="导航到按钮">在工具栏上，或从呼叫的上下文菜单中选择“ <span class="control">导航到</span> ”，然后选择目标。PyCharm切换到选定的窗格并将焦点移动到调用。</p>                </li></ul></section>                <section class="procedure-steps"><h2 id="9e41a1d8">展开或折叠节点</h2><p id="eda7d22b">当PyCharm打开一个用于分析会话的选项卡时，默认情况下它会扩展具有最重呼叫的节点。在探索树时，您可能希望折叠其中一些节点或展开其他节点。</p><ul class="list "><li class="list__item" id="4d76c2c1">                        <p id="9d223508">要展开或折叠节点，请从其上下文菜单中选择“ <span class="control">展开节点”</span>或“ <span class="control">折叠节点”</span> 。</p>                    </li><li class="list__item" id="02313feb">                        <p id="9d87c935">要折叠活动窗格中的所有节点，请单击<img class="inline-icon-16" src="../img/idea/2019.1/icons.actions.collapseall.svg@2x.png" width="16" alt="全部折叠按钮">在工具栏上。</p>                    </li><li class="list__item" id="c59a3f96">                        <p id="72bcfefb">要恢复原始树演示文稿，请单击<img class="inline-icon-16" src="../img/idea/2019.1/icons.actions.expandall.svg@2x.png" width="16" alt="Expand Heavy Traces按钮"> 。</p>                    </li></ul></section>                <section class="procedure-steps"><h2 id="883c7620">过滤掉轻微的电话</h2><p id="ef38a821">这样做只能看到实际导致性能问题的调用。</p><ul class="list _no-style"><li class="list__item" id="886b9190">                        <p id="5fad8b8c">点击<img class="inline-icon-16" src="../img/idea/2019.1/icons.general.filter.svg@2x.png" width="16" alt="过滤按钮">然后，在工具栏上，使用滑块指定要显示的呼叫的最小<span class="emphasis">总百分比</span>或<span class="emphasis">父百分比</span>值，然后单击<span class="control">完成</span> 。</p>                    </li></ul></section>                <section class="procedure-steps"><h2 id="89a0f462">保存并比较分析数据</h2><ul class="list "><li class="list__item" id="4259c282">                        <p id="2646878a">要使用函数及其度量标准保存行，请从函数的上下文菜单中选择“ <span class="control">复制</span> ”。如果要比较两个会话中的函数的度量，例如，在对代码进行一些改进之后，这可能会有所帮助。</p>                    </li><li class="list__item" id="805266fc">                        <p id="068069c0">要仅保存函数名称和定义文件的名称，请从函数的上下文菜单中选择“ <span class="control">复制调用</span> ”。</p>                    </li><li class="list__item" id="1136933b"><p>要将项目与剪贴板的内容进行<span class="control">比较，请</span>从项目的上下文菜单中选择“ <span class="control">与剪贴板比较</span> ”。PyCharm打开<span class="emphasis">差异查看器</span> 。</p></li><li class="list__item" id="fd6ae939"><p>要将当前日志与另一个隔离进行比较，请单击<img class="inline-icon-16" src="../img/idea/2019.1/icons.actions.diff.svg@2x.png" width="16" alt="比较按钮">在工具栏上。在打开的对话框中，选择隔离以比较当前隔离。要缩小搜索范围，请指定目标隔离是在当前隔离之前还是之后进行。</p></li></ul></section>                    <section class="procedure-steps"><h2 id="7ebaab8c">导出呼叫树</h2><ul class="list _no-style"><li class="list__item" id="1d56e0a3">                            <p id="b259ccb0">要将当前窗格中的调用树保存为文本文件，请单击<img class="inline-icon-16" src="../img/idea/2019.1/icons.toolbarDecorator.export.svg@2x.png" width="16" alt="导出按钮">在工具栏上，并在打开的对话框中指定目标文件。</p>                        </li></ul></section>            <div class="chapter"><h4 id="ws_node_profiling_analyzing_flame_chart">分析火焰图表</h4>                <p id="8171a15a">使用多色<span class="control">火焰图表</span>查找应用程序暂停的位置，并探索引发这些暂停的调用。</p>                                <figure><img alt="火焰图" title="火焰图" src="../img/idea/2019.1/ws_v8_profiler_flame_chart_light.png" id="b7d71418" class=" _border-line" width="600" height="736"></figure>                <p id="b68c3c44">该图表包括四个方面：</p>                <ul class="list _ul"><li class="list__item" id="a97559b8"><p>上部区域显示带有两个滑块的时间轴，以限制要调查的片段的开头和结尾。</p></li><li class="list__item" id="3ed4158d"><p>底部区域以多色图表的形式显示一堆调用。当第一次调用时，每个函数都被赋予一个随机颜色，因此当前会话中每个函数的调用都以这种颜色显示。</p></li><li class="list__item" id="5edfb880"><p>中间区域显示来自<span class="emphasis">垃圾收集器</span> ，引擎，外部调用和执行本身的调用的摘要。为这些活动保留的颜色列在该区域的顶部。</p></li><li class="list__item" id="54c1fb5d"><p>右侧窗格列出了所选片段中的调用，对于每个调用，列表显示其持续时间，被调用函数的名称以及定义函数的文件。</p></li></ul>                <p id="7f29d96b">底部区域和右侧区域是同步的：当您通过时间线拖动底部区域中的滑块时，右侧窗格中的焦点将移动到每个时刻执行的调用。</p>                <p id="660e7d6b">此外，如果单击底部区域中的呼叫，滑块将自动移动到该窗口，右侧窗格中的焦点将切换到相应的功能，如果需要，列表会自动滚动。反之亦然，如果单击列表中的某个项目，PyCharm会在底部区域中选择相应的调用并自动将滑块拖动到该区域：</p>                <section class="procedure-steps"><h2 id="062ac7ac">在时间轴中选择片段</h2><ul class="list "><li class="list__item" id="9da6748e">                        <p id="06a8591a">要在一段时间内探索过程，您需要在时间轴中选择相应的片段。要执行此操作，请拖动滑块或单击两个滑块之间的<span class="emphasis">窗口</span>并将其拖动到所需的片段。</p>                        <p id="376c0bf0">在任何一种情况下，下面的多色图表显示了所选片段中的一系列调用。</p>                    </li><li class="list__item" id="ade343c8"><p>要放大图表，请单击所选片段，然后单击<img class="inline-icon-16" src="../img/idea/2019.1/icons.general.zoomIn.svg@2x.png" width="16" alt="缩放按钮">在工具栏上。PyCharm打开一个新选项卡，并显示放大的选定片段以适应选项卡宽度，以便您可以查看具有更多详细信息的片段。</p></li></ul></section>                    <section class="procedure-steps"><h2 id="1f747e7f">浏览火焰图表</h2><p id="f9876a96">通过右侧区域中的调用，您可以跳转到被调用函数的源代码，工具窗口的其他窗格以及具有特定度量的火焰图中的区域。</p><ul class="list "><li class="list__item" id="33ee50cc">                            <p id="7064a77b">要跳转到被调用函数的源代码，请从调用的上下文菜单中选择<span class="control">Jump to Source</span> 。</p>                        </li><li class="list__item" id="7793f841">                            <p id="53b471a1">要使火焰图使用特定的呼叫指标对片段进行缩放，请选择呼叫并单击<img class="inline-icon-16" src="../img/idea/2019.1/NodeJS.com.jetbrains.nodejs.icons.Navigate_inMainTree@2x.png" width="16" alt="导航到按钮">或者从呼叫的上下文菜单中选择“ <span class="control">导航到</span> ”，然后选择指标。</p>                        </li><li class="list__item" id="2f67a76a">                            <p id="48effd8c">您还可以导航到调用的堆栈跟踪以查看和分析异常。为此，请从呼叫的上下文菜单中选择“ <span class="control">显示为堆栈跟踪</span> ”。PyCharm在单独的选项卡中打开堆栈跟踪，返回到<span class="control">Flame Chart</span>窗格，单击底部的<span class="control">V8 CPU Profiling</span>工具窗口按钮。</p>                        </li></ul></section>            </div>        </div>    </div>    <div class="chapter"><h2 id="ws_node_memory_profiling" data-toc="V8_CPU_and_Memory_Profiling#ws_node_memory_profiling">内存分析</h2>        <p id="0244e387">内存分析使您可以检测内存泄漏和动态内存问题，并找到导致它们的代码片段。</p>        <section class="procedure-steps"><h2 id="ws_node_configuring_memory_profiling">启用内存分析</h2><p id="fe2b2a43">要在应用程序启动时调用内存快照，您需要在<span class="control">Node.js</span>运行配置中指定其他设置。</p><ol class="list _decimal"><li class="list__item" id="c7126e91"><p>在主菜单上，选择<span class="menupath" data-skip-index="skip">“运行”|编辑配置</span> 。点击<img class="inline-icon-16" src="../img/idea/2019.1/icons.general.add@2x.png" width="16" alt="图标一般添加">在工具栏上，从列表中选择<span class="control">Node.js.</span></p></li><li class="list__item" id="6f41edd7"><p>从列表中，选择<span class="emphasis">Node.js</span>运行配置以激活CPU分析或创建新配置，如<a href="running-and-debugging-node-js.html"><span>运行和调试Node.js中所述</span></a> 。</p></li><li class="list__item" id="0d88ddd8">                    <p id="2dc4b625">切换到<span class="control">V8 Profiling</span>选项卡，然后选中<span class="control">允许获取堆快照</span>复选框。</p>                </li></ol></section>            <section class="procedure-steps"><h2 id="ws_node_collecting_memory_profiling_data">收集内存分析信息</h2><ol class="list _decimal"><li class="list__item" id="a76a2cab">                    <p id="90255c10">从主工具栏上的列表中选择运行配置，然后单击<img class="inline-icon-16" src="../img/idea/2019.1/icons.toolwindows.toolWindowRun.svg@2x.png" width="16" alt="运行按钮">或选择<span class="menupath" data-skip-index="skip">运行|</span>从主菜单中<span class="menupath" data-skip-index="skip">运行&lt;配置名称&gt;</span> 。</p>                </li><li class="list__item" id="5117a0f1">                    <p id="f5408ee5">在应用程序执行期间的任何时候，单击<img class="inline-icon-16" src="../img/idea/2019.1/icons.actions.startMemoryProfile.svg@2x.png" width="16" alt="Take Heap Snapshot按钮">在“ <span class="control">运行”</span>工具窗口的工具栏上。</p>                </li><li class="list__item" id="b51c730e">                    <p id="5e4233dc">在打开的对话框中，指定快照的名称以及存储它的文件夹的路径。要立即开始分析快照，请选中“ <span class="control">打开快照”</span>复选框。</p>                </li></ol></section>        <div class="chapter"><h3 id="ws_node_analyzing_memory_profiling_data">分析内存快照</h3>            <p id="3e81e3b9">拍摄快照并选择分析时，PyCharm会打开<span class="control">V8堆</span>工具窗口，其中包含收集的数据。如果窗口已打开并显示另一个会话的收集数据，PyCharm将打开一个新选项卡。</p>            <p id="57cbb00c">要打开并分析以前保存的一些内存分析数据，请转到主菜单上的<span class="menupath" data-skip-index="skip">V8性能分析 - 分析V8堆快照</span> ，然后选择相关的<code class="code">.heapsnapshot</code>文件。PyCharm创建一个单独的选项卡，其中包含所选文件的名称。</p>            <p id="2c9d5aa6">工具窗口有三个选项卡，用于显示来自不同视点的收集信息。</p>                <ul class="list _bullet"><li class="list__item" id="aeb06374">                        <p id="8c008e31">在<span class="control">遏制</span>选项卡显示在几个顶级项分组应用程序中的对象<span class="emphasis">：DOMWindow对象</span> ， <span class="emphasis">本地浏览器的对象</span> <span class="emphasis">，GC</span>和<span class="emphasis">根</span> ，这是根的<span class="emphasis">垃圾收集器</span>实际使用。有关详细信息，请参阅<a href="https://developer.chrome.com/devtools/docs/javascript-memory-profiling#containment-view" data-bypass="yes" target="_blank"><span>遏制视图</span></a> 。</p>                        <p id="e6d89990">对于每个对象，选项卡显示其<span class="emphasis">与GC根的距离</span> ，即对象和GC根之间节点的最短简单路径，对象的<a href="https://developer.chrome.com/devtools/docs/javascript-memory-profiling#shallow-size" data-bypass="yes" target="_blank"><span>浅大小</span></a>以及对象的<a href="https://developer.chrome.com/devtools/docs/javascript-memory-profiling#retained-size" data-bypass="yes" target="_blank"><span>保留大小</span></a> 。除了对象大小的绝对值外，PyCharm还显示了对象占用的内存百分比。</p>                    </li><li class="list__item" id="0d16b51a">                        <p id="1ad1f504">“ <span class="control">最大对象”</span>选项卡显示按<a href="https://developer.chrome.com/devtools/docs/javascript-memory-profiling#retained-size" data-bypass="yes" target="_blank"><span>保留大小</span></a>排序的内存最多的对象。在此选项卡中，您可以发现通过在某个全局对象中累积数据而引发的内存泄漏。</p>                    </li><li class="list__item" id="e80b13b1">                        <p id="196cc702">“ <span class="control">摘要”</span>选项卡显示应用程序中按类型分组的对象。该选项卡显示每种类型的对象数，它们的大小以及它们占用的内存百分比。该信息可能是存储器状态的线索。</p>                    </li></ul>            <p id="fe86b238">每个选项卡都有一个“ <span class="control">详细信息”</span>窗格，该窗格显示GC根目录中当前所选对象的路径以及对象的<span class="emphasis">保留器</span>列表，即保留指向所选对象的链接的对象。每个堆快照都有许多“后退”引用和循环，因此每个对象总是有许多保留器。</p>                <section class="procedure-steps"><h2 id="beb898cb">使用文本标签标记对象</h2><p id="4ebef517">标签可帮助您区分对象并在不丢失上下文的情况下从一个对象移动到另一个对象。</p><ul class="list _no-style"><li class="list__item" id="22a636c6">                        <p id="8f8c80ff">要为对象设置标签，请选择该对象并单击<img class="inline-icon-16" src="../img/idea/2019.1/platform-impl.com.intellij.ide.ui.laf.icons.graphite.checkmark.svg@2x.png" width="16" alt="标记按钮">在工具栏上或从上下文菜单中选择<span class="control">标记</span> 。然后在打开的对话框中指定文本标签。</p>                    </li></ul></section>                <section class="procedure-steps"><h2 id="11721a72">浏览快照</h2><ul class="list "><li class="list__item" id="5e87741d">                        <p id="ec7ef65b">要导航到与对象对应的函数或变量，请选择此对象并单击<img class="inline-icon-16" src="../img/idea/2019.1/icons.actions.edit.svg@2x.png" width="16" alt="编辑器按钮">在工具栏上或从上下文菜单中选择“ <span class="control">编辑源</span> ”。如果禁用了按钮和菜单选项，则表示PyCharm未找到与所选对象对应的任何函数或变量。</p>                        <p id="560bc902">如果找到多个函数或变量，PyCharm会在建议列表中显示它们。</p>                    </li><li class="list__item" id="490eec12">                        <p id="502e0544">为了帮助您调查但从围堵点对象，集中对象之间的联系，PyCharm让您从一个对象跳的<span class="control">最大对象</span>或<span class="control">摘要</span>选项卡或<span class="control">纪录</span> ，以期<span class="control">遏制</span>该选项卡中的同一个对象。</p>                        <p id="b3f2a7ff">为此，选择对象并单击<img class="inline-icon-16" src="../img/idea/2019.1/NodeJS.com.jetbrains.nodejs.icons.Navigate_inMainTree@2x.png" width="16" alt="导航到按钮">在工具栏上，或从上下文菜单中选择“ <span class="control">在主树中导航”</span> 。</p>                    </li></ul></section>                <section class="procedure-steps"><h2 id="65c38ed5">搜索快照</h2><ol class="list _decimal"><li class="list__item" id="aef59f32"><p>在<span class="control">遏制</span>选项卡，单击<img class="inline-icon-16" src="../img/idea/2019.1/icons.actions.find.svg@2x.png" width="16" alt="查找按钮">在工具栏上。</p></li><li class="list__item" id="99e7929e">                        <p id="c2328fcb">在打开的<span class="control">V8堆搜索</span>对话框中，指定要搜索的搜索模式和范围。可用范围是：</p>                        <ul class="list _bullet"><li class="list__item" id="ebadc889"><p>                                <span class="control">无处不在：</span>选中此复选框可在所有范围内搜索。选中此复选框后，将禁用所有其他搜索类型。</p></li><li class="list__item" id="518301da">                                <p id="23096895">                                    <span class="control">链接名称：</span>选中此复选框以在调用<span class="emphasis">C ++运行</span> <span class="emphasis">时时</span>搜索<span class="emphasis">V8</span>创建的对象名称。</p>                                <p id="f83d23e2">在<span class="control">V8堆</span>工具窗口中，链接名称标有<code class="code">%</code>字符（ <code class="code">%&lt;link name&gt;</code> ）。</p>                            </li><li class="list__item" id="ea9b97fb"><p>                                <span class="control">类名：</span>选中此复选框可在函数构造函数中进行搜索。</p></li><li class="list__item" id="97a8908d"><p>                                <span class="control">文本字符串：</span>选中此复选框可在对象内容中执行文本搜索。</p></li><li class="list__item" id="de52cf2f">                                <p id="c1dc451f">                                    <span class="control">快照对象ID：</span>选中此复选框可在对象的唯一标识符中进行搜索。在创建对象时， <span class="emphasis">V8</span>会以格式为每个对象分配这样一个唯一标识符，并保留它直到对象被销毁。这意味着您可以在同一会话中拍摄的多个快照中查找和比较相同的对象。</p>                                <p id="0408f064">在<span class="control">V8堆</span>工具窗口中，对象ID用<code class="code">@</code>字符标记（ <code class="code">@&lt;object id&gt;</code> ）。</p>                            </li><li class="list__item" id="a75c5e3e"><p>                                <span class="control">标记：</span>选中此复选框可通过单击手动搜索您手动设置的标签<img class="inline-icon-16" src="../img/idea/2019.1/platform-impl.com.intellij.ide.ui.laf.icons.graphite.checkmark.svg@2x.png" width="16" alt="标记按钮">在<span class="control">遏制</span>选项卡的工具栏上。</p></li></ul>                    </li></ol><p id="a7050548">搜索结果显示在“ <span class="control">详细信息”</span>窗格中，在<span class="control">“&lt;搜索模式&gt;”</span>视图的单独<span class="control">出现中</span> 。要使搜索结果按照您指定的搜索范围分组，请按工具栏上的“ <span class="control">按类别分组”</span>切换按钮。</p><p id="317d230f">下次打开对话框时，它将显示上一次搜索的设置。</p></section>        </div>    </div>    <div class="last-modified" data-skip-index="skip">最后修改日期：2019年3月28日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="unit-testing-node-js.html">测试Node.js</a> <a class="navigation-links__next" href="installing-and-removing-external-software-using-node-package-manager.html">npm和Yarn</a></div><section class="seealso" data-skip-index="skip"><div class="seealso__header"><h2>也可以看看</h2></div><div class="seealso__content"><div class="seealso__col" data-skip-index="skip"><h3>程序：</h3><ul class="list"><li class="list__item"><a href="running-and-debugging-node-js.html"><span>运行和调试Node.js</span></a></li><li class="list__item"><a href="developing-node-js-applications.html"><span>Node.js的</span></a></li></ul></div><div class="seealso__col" data-skip-index="skip"><h3>参考：</h3><ul class="list"><li class="list__item"><a href="run-debug-configuration-node-js.html"><span>运行/调试配置：Node.js</span></a></li></ul></div></div></section></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="../app/v2/app.js"></script></body></html>