<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 4. Creating system images with Image Builder web console interface</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="creating-system-images-with-composer-web-console-interface_composing-a-customized-rhel-system-image"/>Chapter 4. Creating system images with Image Builder web console interface</h1></div></div></div><p>
			Image Builder is a tool for creating custom system images. To control Image Builder and create your custom system images, you can use the web console interface. Note that the <a class="link" href="creating-system-images-with-composer-command-line-interface_composing-a-customized-rhel-system-image.html" title="Chapter 3. Creating system images with Image Builder command line interface">command line interface</a> is the currently preferred alternative, because it offers more features.
		</p><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="accessing-composer-gui-in-the-rhel-8-web-console_creating-system-images-with-composer-web-console-interface"/>Accessing Image Builder GUI in the RHEL 8 web console</h1></div></div></div><p>
				The <span class="strong"><strong>cockpit-composer</strong></span> plugin for the RHEL 8 web console enables users to manage Image Builder blueprints and composes with a graphical interface. Note that the preferred method for controlling Image Builder is at the moment using the command line interface.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist"><li class="listitem">
						You must have root access to the system.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist"><li class="listitem"><p class="simpara">
						Open <code class="literal"><a class="link" href="https://localhost:9090/">https://localhost:9090/</a></code> in a web browser on the system where Image Builder is installed.
					</p><p class="simpara">
						For more information how to remotely access Image Builder, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/managing_systems_using_the_rhel_8_web_console">managing systems using the RHEL 8 web console</a>.
					</p></li><li class="listitem">
						Log into the web console with credentials for an user account with sufficient privileges on the system.
					</li><li class="listitem"><p class="simpara">
						To display the Image Builder controls, click the <code class="literal">Image Builder</code> icon, which is in the upper-left corner of the window.
					</p><p class="simpara">
						The Image Builder view opens, listing existing blueprints.
					</p></li></ol></div><div class="itemizedlist"><p class="title"><strong>Related information</strong></p><ul class="itemizedlist"><li class="listitem">
						<a class="xref" href="creating-system-images-with-composer-command-line-interface_composing-a-customized-rhel-system-image.html" title="Chapter 3. Creating system images with Image Builder command line interface">Chapter 3, <em>Creating system images with Image Builder command line interface</em></a>
					</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="creating-a-composer-blueprint-in-the-web-console-interface_creating-system-images-with-composer-web-console-interface"/>Creating an Image Builder blueprint in the web console interface</h1></div></div></div><p>
				To describe the customized system image, create a blueprint first.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist"><li class="listitem">
						You have opened the Image Builder interface of the RHEL 8 web console in a browser.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist"><li class="listitem"><p class="simpara">
						Click <span class="guibutton">Create Blueprint</span> in the top right corner.
					</p><p class="simpara">
						A pop-up appears with fields for the blueprint name and description.
					</p></li><li class="listitem"><p class="simpara">
						Fill in the name of the blueprint, its description, then click <span class="guibutton">Create</span>.
					</p><p class="simpara">
						The screen changes to blueprint editing mode.
					</p></li><li class="listitem"><p class="simpara">
						Add components that you want to include in the system image:
					</p><div class="informalexample"><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">
								On the left, enter all or part of the component name in the <code class="literal">Available Components</code> field and press <span class="guibutton">Enter</span>.
							</p><p class="simpara">
								The search is added to the list of filters under the text entry field, and the list of components below is reduced to these that match the search.
							</p><p class="simpara">
								If the list of components is too long, add further search terms in the same way.
							</p></li><li class="listitem">
								The list of components is paged. To move to other result pages, use the arrows and entry field above the component list.
							</li><li class="listitem">
								Click on name of the component you intend to use to display its details. The right pane fills with details of the components, such as its version and dependencies.
							</li><li class="listitem">
								Select the version you want to use in the <code class="literal">Component Options</code> box, with the <code class="literal">Version Release</code> dropdown.
							</li><li class="listitem">
								Click <span class="guibutton">Add</span> in the top left.
							</li><li class="listitem">
								If you added a component by mistake, remove it by clicking the <span class="guibutton">…​</span> button at the far right of its entry in the right pane, and select <code class="literal">Remove</code> in the menu.
							</li></ol></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
							If you do not intend to select version for some components, you can skip the component details screen and version selection by clicking the <span class="guibutton">+</span> buttons on the right side of the component list.
						</p></div></div></li><li class="listitem"><p class="simpara">
						To save the blueprint, click <span class="guibutton">Commit</span> in the top right A dialog with a summary of the changes pops up. Click <span class="guibutton">Commit</span>.
					</p><p class="simpara">
						A small pop-up on the right informs you of the saving progress and then the result.
					</p></li><li class="listitem"><p class="simpara">
						To exit the editing screen, click <code class="literal">Back to Blueprints</code> in the top left.
					</p><p class="simpara">
						The Image Builder view opens, listing existing blueprints.
					</p></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="editing-a-composer-blueprint-in-the-web-console-interface_creating-system-images-with-composer-web-console-interface"/>Editing an Image Builder blueprint in the web console interface</h1></div></div></div><p>
				To change the specifications for a custom system image, edit the corresponding blueprint.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist"><li class="listitem">
						You have opened the Image Builder interface of the RHEL 8 web console in a browser.
					</li><li class="listitem">
						A blueprint exists.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist"><li class="listitem"><p class="simpara">
						Locate the blueprint that you want to edit by entering its name or a part of it into the search box at top left, and press <span class="keycap"><strong>Enter</strong></span>.
					</p><p class="simpara">
						The search is added to the list of filters under the text entry field, and the list of blueprints below is reduced to these that match the search.
					</p><p class="simpara">
						If the list of blueprints is too long, add further search terms in the same way.
					</p></li><li class="listitem"><p class="simpara">
						On the right side of the blueprint, press the <span class="guibutton">Edit Blueprint</span> button that belongs to the blueprint.
					</p><p class="simpara">
						The view changes to the blueprint editing screen.
					</p></li><li class="listitem">
						Remove unwanted components by clicking their <span class="guibutton">⫶</span> button at the far right of its entry in the right pane, and select <code class="literal">Remove</code> in the menu.
					</li><li class="listitem"><p class="simpara">
						Change version of existing components:
					</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">
								On the Blueprint Components search field, enter component name or a part of it into the field under the heading <code class="literal">Blueprint Components</code> and press <span class="guibutton">Enter</span>.
							</p><p class="simpara">
								The search is added to the list of filters under the text entry field, and the list of components below is reduced to these that match the search.
							</p><p class="simpara">
								If the list of components is too long, add further search terms in the same way.
							</p></li><li class="listitem"><p class="simpara">
								Click the <span class="guibutton">⫶</span> button at the far right of the component entry, and select <code class="literal">View</code> in the menu.
							</p><p class="simpara">
								A component details screen opens in the right pane.
							</p></li><li class="listitem"><p class="simpara">
								Select the desired version in the <code class="literal">Version Release</code> drop-down menu and click <span class="guibutton">Apply Change</span> in top right.
							</p><p class="simpara">
								The change is saved and the right pane returns to listing the blueprint components.
							</p></li></ol></div></li><li class="listitem"><p class="simpara">
						Add new components:
					</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">
								On the left, enter component name or a part of it into the field under the heading <code class="literal">Available Components</code> and press <span class="guibutton">Enter</span>.
							</p><p class="simpara">
								The search is added to the list of filters under the text entry field, and the list of components below is reduced to these that match the search.
							</p><p class="simpara">
								If the list of components is too long, add further search terms in the same way.
							</p></li><li class="listitem">
								The list of components is paged. To move to other result pages, use the arrows and entry field above the component list.
							</li><li class="listitem">
								Click on name of the component you intend to use to display its details. The right pane fills with details of the components, such as its version and dependencies.
							</li><li class="listitem">
								Select the version you want to use in the <code class="literal">Component Options</code> box, with the <code class="literal">Version Release</code> drop-down menu.
							</li><li class="listitem">
								Click <span class="guibutton">Add</span> in the top right.
							</li><li class="listitem">
								If you added a component by mistake, remove it by clicking the <span class="guibutton">⫶</span> button at the far right of its entry in the right pane, and select <code class="literal">Remove</code> in the menu.
							</li></ol></div></li></ol></div><div class="informalexample"><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
					If you do not intend to select version for some components, you can skip the component details screen and version selection by clicking the <span class="guibutton">+</span> buttons on the right side of the component list.
				</p></div></div><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">
						Commit a new version of the blueprint with your changes:
					</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">
								Click the <span class="guibutton">Commit</span> button in top right.
							</p><p class="simpara">
								A pop-up window with a summary of your changes appears.
							</p></li><li class="listitem"><p class="simpara">
								Review your changes and confirm them by clicking <span class="guibutton">Commit</span>.
							</p><p class="simpara">
								A small pop-up on the right informs you of the saving progress and then result. A new version of the blueprint is created.
							</p></li><li class="listitem"><p class="simpara">
								In the top left, click <code class="literal">Back to Blueprints</code> to exit the editing screen.
							</p><p class="simpara">
								The Image Builder view opens, listing existing blueprints.
							</p></li></ol></div></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="adding-users-and-groups-to-a-composer-blueprint-in-the-web-console-interface_creating-system-images-with-composer-web-console-interface"/>Adding users and groups to an Image Builder blueprint in the web console interface</h1></div></div></div><p>
				Adding customizations such as users and groups to blueprints in the web console interface is currently not possible. To work around this limitation, use the <span class="strong"><strong><span class="GUI">Terminal</span></strong></span> tab in web console to use the command line interface (CLI) workflow.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist"><li class="listitem">
						A blueprint must exist.
					</li><li class="listitem"><p class="simpara">
						A CLI text editor such as <code class="literal">vim</code>, <code class="literal">nano</code>, or <code class="literal">emacs</code> must be installed. To install them:
					</p><pre class="screen"># yum install <span class="emphasis"><em>editor-name</em></span></pre></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist"><li class="listitem">
						Find out the name of the blueprint: Open the Image Builder (<span class="strong"><strong><span class="GUI">Image builder</span></strong></span>) tab on the left in the RHEL 8 web console to see the name of the blueprint.
					</li><li class="listitem">
						Navigate to the CLI in web console: Open the system administation tab on the left, then select the last item <span class="strong"><strong><span class="GUI">Terminal</span></strong></span> from the list on the left.
					</li><li class="listitem"><p class="simpara">
						Enter the super-user (root) mode:
					</p><pre class="screen">$ sudo bash</pre><p class="simpara">
						Provide your credentials when asked. Note that the terminal does not reuse your credentials you entered when logging into the web console.
					</p><p class="simpara">
						A new shell with root privileges starts in your home directory.
					</p></li><li class="listitem"><p class="simpara">
						Export the blueprint to a file:
					</p><pre class="screen"># composer-cli blueprints save <span class="emphasis"><em>BLUEPRINT-NAME</em></span></pre></li><li class="listitem"><p class="simpara">
						Edit the file <span class="emphasis"><em>BLUEPRINT-NAME</em></span>.toml with a CLI text editor of your choice and add the users and groups.
					</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
							RHEL 8 web console does not have any built-in feature to edit text files on the system, so the use of a CLI text editor is required for this step.
						</p></div><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">
								For every user to be added, add this block to the file:
							</p><pre class="screen">[[customizations.user]]
name = "<span class="emphasis"><em>USER-NAME</em></span>"
description = "<span class="emphasis"><em>USER-DESCRIPTION</em></span>"
password = "<span class="emphasis"><em>PASSWORD-HASH</em></span>"
key = "<span class="emphasis"><em>ssh-rsa (...) key-name</em></span>"
home = "/home/<span class="emphasis"><em>USER-NAME</em></span>/"
shell = "<span class="emphasis"><em>/usr/bin/bash</em></span>"
groups = [<span class="emphasis"><em>"users", "wheel"</em></span>]
uid = <span class="emphasis"><em>NUMBER</em></span>
gid = <span class="emphasis"><em>NUMBER</em></span></pre><p class="simpara">
								Replace <span class="emphasis"><em>PASSWORD-HASH</em></span> with the actual password hash. To generate the hash, use eg. this command:
							</p><pre class="screen">$ python3 -c 'import crypt,getpass;pw=getpass.getpass();print(crypt.crypt(pw) if (pw==getpass.getpass("Confirm: ")) else exit())'</pre><p class="simpara">
								Replace <span class="emphasis"><em>ssh-rsa (…​) key-name</em></span> with the actual public key.
							</p><p class="simpara">
								Replace the other placeholders with suitable values.
							</p><p class="simpara">
								Leave out any of the lines as needed, only the user name is required.
							</p></li><li class="listitem"><p class="simpara">
								For every user group to be added, add this block to the file:
							</p><pre class="screen">[[customizations.group]]
name = "<span class="emphasis"><em>GROUP-NAME</em></span>"
gid = <span class="emphasis"><em>NUMBER</em></span></pre></li><li class="listitem">
								Increase the version number.
							</li><li class="listitem">
								Save the file and close the editor.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Import the blueprint back into Image Builder:
					</p><pre class="screen"># composer-cli blueprints push <span class="emphasis"><em>BLUEPRINT-NAME</em></span>.toml</pre><p class="simpara">
						Note that you must supply the file name including the <code class="literal">.toml</code> extension, while in other commands you use only the name of the blueprint.
					</p></li><li class="listitem"><p class="simpara">
						To verify that the contents uploaded to Image Builder match your edits, list the contents of blueprint:
					</p><pre class="screen"># composer-cli blueprints show <span class="emphasis"><em>BLUEPRINT-NAME</em></span></pre><p class="simpara">
						Check if the version matches what you put in the file and if your customizations are present.
					</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
							The Image Builder plugin for RHEL 8 web console does not show any information that could be used to verify that the changes have been applied, unless you edited also the packages included in the blueprint.
						</p></div></li><li class="listitem"><p class="simpara">
						Exit the privileged shell:
					</p><pre class="screen"># exit</pre></li><li class="listitem"><p class="simpara">
						Open the Image Builder (<span class="strong"><strong><span class="GUI">Image builder</span></strong></span>) tab on the left and refresh the page, in all browsers and all tabs where it was opened.
					</p><p class="simpara">
						This prevents state cached in the loaded page from accidentally reverting your changes.
					</p></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional information</strong></p><ul class="itemizedlist"><li class="listitem">
						<a class="xref" href="creating-system-images-with-composer-command-line-interface_composing-a-customized-rhel-system-image.html#composer-blueprint-format_creating-system-images-with-composer-command-line-interface" title="Image Builder blueprint format">the section called “Image Builder blueprint format”</a>
					</li><li class="listitem">
						<a class="xref" href="creating-system-images-with-composer-command-line-interface_composing-a-customized-rhel-system-image.html#editing-a-composer-blueprint-with-command-line-interface_creating-system-images-with-composer-command-line-interface" title="Editing an Image Builder blueprint with command line interface">the section called “Editing an Image Builder blueprint with command line interface”</a>
					</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="creating-a-system-image-with-composer-in-the-web-console-interface_creating-system-images-with-composer-web-console-interface"/>Creating a system image with Image Builder in the web console interface</h1></div></div></div><p>
				The following steps below describe creating a system image.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist"><li class="listitem">
						You have opened the Image Builder interface of the RHEL 8 web console in a browser.
					</li><li class="listitem">
						A blueprint exists.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist"><li class="listitem"><p class="simpara">
						Locate the blueprint that you want to build an image by entering its name or a part of it into the search box at top left, and press <span class="keycap"><strong>Enter</strong></span>.
					</p><p class="simpara">
						The search is added to the list of filters under the text entry field, and the list of blueprints below is reduced to these that match the search.
					</p><p class="simpara">
						If the list of blueprints is too long, add further search terms in the same way.
					</p></li><li class="listitem"><p class="simpara">
						On the right side of the blueprint, press the <span class="guibutton">Create Image</span> button that belongs to the blueprint.
					</p><p class="simpara">
						A pop-up window appears.
					</p></li><li class="listitem"><p class="simpara">
						Select the image type and architecture and press <span class="guibutton">Create</span>.
					</p><p class="simpara">
						A small pop-up in the top right informs you that the image creation has been added to the queue.
					</p></li><li class="listitem"><p class="simpara">
						Click the name of the blueprint.
					</p><p class="simpara">
						A screen with details of the blueprint opens.
					</p></li><li class="listitem"><p class="simpara">
						Click the <code class="literal">Images</code> tab to switch to it. The image that is being created is listed with the status <code class="literal">In Progress</code>.
					</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
							Image creation takes a longer time, measured in minutes. There is no indication of progress while the image is created.
						</p></div><p class="simpara">
						To abort image creation, press its <span class="guibutton">Stop</span> button on the right.
					</p></li><li class="listitem">
						Once the image is successfully created, the <span class="guibutton">Stop</span> button is replaced by a <span class="guibutton">Download</span> button. Click this button to download the image to your system.
					</li></ol></div></div></div></body></html>