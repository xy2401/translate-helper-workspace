<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 6. Scanning the system for security compliance and vulnerabilities</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="scanning-the-system-for-security-compliance-and-vulnerabilities_security-hardening"/>Chapter 6. Scanning the system for security compliance and vulnerabilities</h1></div></div></div><p>
			A compliance audit is a process of figuring out whether a given object follows all the rules written out in a compliance policy. The compliance policy is defined by security professionals who specify required settings, often in the form of a checklist, that are to be used in the computing environment.
		</p><p>
			The compliance policy can vary substantially across organizations and even across different systems within the same organization. Differences among these policies are based on the purpose of these systems and its importance for the organization. The custom software settings and deployment characteristics also raise a need for custom policy checklists.
		</p><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="security-compliance-tools-in-rhel_scanning-the-system-for-security-compliance-and-vulnerabilities"/>Security compliance tools in RHEL</h1></div></div></div><p>
				Red Hat Enterprise Linux provides tools that allow for a fully automated compliance audit. These tools are based on the Security Content Automation Protocol (SCAP) standard and are designed for automated tailoring of compliance policies.
			</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						<span class="strong"><strong>SCAP Workbench</strong></span> - The <code class="literal">scap-workbench</code> graphical utility is designed to perform configuration and vulnerability scans on a single local or remote system. It can be also used to generate security reports based on these scans and evaluations.
					</li><li class="listitem">
						<span class="strong"><strong>OpenSCAP</strong></span> - The <code class="literal">oscap</code> command-line utility is designed to perform configuration and vulnerability scans on a local system, to validate security compliance content, and to generate reports and guides based on these scans and evaluations.
					</li><li class="listitem">
						<span class="strong"><strong>SCAP Security Guide (SSG)</strong></span> - The <code class="literal">scap-security-guide</code> package provides the latest collection of security policies for Linux systems. The guidance consists of a catalog of practical hardening advice, linked to government requirements where applicable. The project bridges the gap between generalized policy requirements and specific implementation guidelines.
					</li><li class="listitem">
						<span class="strong"><strong>Script Check Engine (SCE)</strong></span> - SCE is an extension to the SCAP protocol that allows administrators to write their security content using a scripting language, such as Bash, Python, or Ruby. The SCE extension is provided in the <code class="literal">openscap-engine-sce</code> package.
					</li></ul></div><p>
				If you require performing automated compliance audits on multiple systems remotely, you can utilize OpenSCAP solution for Red Hat Satellite.
			</p><h3><a id="additional_resources_8"/>Additional resources</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						<code class="literal">oscap(8)</code> - The manual page for the <code class="literal">oscap</code> command-line utility provides a complete list of available options and their usage explanation.
					</li><li class="listitem">
						<code class="literal">scap-workbench(8)</code> - The manual page for the <code class="literal">SCAP Workbench</code> application provides a basic information about the application as well as some links to potential sources of SCAP content.
					</li><li class="listitem">
						<code class="literal">scap-security-guide(8)</code> - The manual page for the <code class="literal">scap-security-guide</code> project provides further documentation about the various available SCAP security profiles. Examples how to utilize the provided benchmarks using the OpenSCAP utility are provided as well.
					</li><li class="listitem">
						For more details about using OpenSCAP with Red Hat Satellite, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.3/html/administering_red_hat_satellite/chap-red_hat_satellite-administering_red_hat_satellite-security_compliance_management">Security Compliance Management in the Administering Red Hat Satellite Guide</a>.
					</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="red-hat-security-advisories-oval-feed_scanning-the-system-for-security-compliance-and-vulnerabilities"/>Red Hat Security Advisories OVAL feed</h1></div></div></div><p>
				Red Hat Enterprise Linux security auditing capabilities are based on the Security Content Automation Protocol (SCAP) standard. SCAP is a multi-purpose framework of specifications that supports automated configuration, vulnerability and patch checking, technical control compliance activities, and security measurement.
			</p><p>
				SCAP specifications create an ecosystem where the format of security content is well known and standardized while the implementation of the scanner or policy editor is not mandated. Such a status enables organizations to build their security policy (SCAP content) once, no matter how many security vendors do they employ.
			</p><p>
				The Open Vulnerability Assessment Language (OVAL) is the essential and oldest component of SCAP. Unlike other tools or custom scripts, the OVAL language describes a required state of resources in a declarative manner. The OVAL language code is never executed directly but by means of an OVAL interpreter tool called scanner. The declarative nature of OVAL ensures that the state of the assessed system is not accidentally modified.
			</p><p>
				Like all other SCAP components, OVAL is based on XML. The SCAP standard defines several document formats. Each of them includes a different kind of information and serves a different purpose.
			</p><p>
				<a class="link" href="https://access.redhat.com/security/team/">Red Hat Product Security</a> helps customers evaluate and manage risk by tracking and investigating all security issues affecting Red Hat customers. It provides timely and concise patches and security advisories on the Red Hat Customer Portal. Red Hat creates and supports OVAL patch definitions, providing machine-readable versions of our security advisories.
			</p><p>
				The <a class="link" href="https://www.redhat.com/security/data/oval/">RHSA OVAL definitions</a> are available individually and as a complete package, and are updated within an hour of a new security advisory being made available on the Red Hat Customer Portal.
			</p><p>
				Each OVAL patch definition maps one-to-one to a Red Hat Security Advisory (RHSA). Since an RHSA can contain fixes for multiple vulnerabilities, each vulnerability is listed separately by its Common Vulnerabilities and Exposures (CVE) name and has a link to its entry in our public bug database.
			</p><p>
				The RHSA OVAL definitions are designed to check for vulnerable versions of RPM packages installed on a system. It is possible to extend these definitions to include further checks - for instance, to find out if the packages are being used in a vulnerable configuration. These definitions are designed to cover software and updates shipped by Red Hat. Additional definitions are required to detect the patch status of third-party software.
			</p><h3><a id="additional_resources_9"/>Additional resources</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						<a class="link" href="https://access.redhat.com/articles/221883">Red Hat and OVAL compatibility</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/articles/2123171">Red Hat and CVE compatibility</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/security/updates/advisory">Notifications and Advisories</a> in the <a class="link" href="https://access.redhat.com/security/overview">Product Security Overview</a>
					</li><li class="listitem">
						<a class="link" href="https://www.redhat.com/security/data/metrics/">Security Data Metrics</a>
					</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="scanning-the-system-for-vulnerabilities_scanning-the-system-for-security-compliance-and-vulnerabilities"/>Scanning the system for vulnerabilities</h1></div></div></div><p>
				The <code class="literal">oscap</code> command-line utility enables users to scan local systems, validate security compliance content, and generate reports and guides based on these scans and evaluations. This utility serves as a front end to the OpenSCAP library and groups its functionalities to modules (sub-commands) based on the type of SCAP content it processes.
			</p><h3><a id="prerequisites_2"/>Prerequisites</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						The <code class="literal">AppStream</code> repository is enabled.
					</li></ul></div><h3><a id="procedure_4"/>Procedure</h3><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">
						Install the <code class="literal">openscap-scanner</code> package:
					</p><pre class="screen"># yum install openscap-scanner</pre></li><li class="listitem"><p class="simpara">
						Download the latest RHSA OVAL definitions for your system:
					</p><pre class="screen"># wget https://www.redhat.com/security/data/oval/com.redhat.rhsa-RHEL8.xml</pre></li><li class="listitem"><p class="simpara">
						Scan the system for vulnerabilities and save results to the <span class="emphasis"><em>vulnerability.html</em></span> file:
					</p><pre class="screen"># oscap oval eval --report <span class="emphasis"><em>vulnerability.html</em></span> Red_Hat_Enterprise_Linux_8.xml</pre><p class="simpara">
						You can check the results in a browser of your choice, for example:
					</p><pre class="screen">$ firefox <span class="emphasis"><em>vulnerability.html</em></span> &amp;</pre></li></ol></div><h3><a id="additional_resources_10"/>Additional resources</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						The <code class="literal">oscap(8)</code> man page.
					</li><li class="listitem">
						The <a class="link" href="https://www.redhat.com/security/data/oval/">Red Hat OVAL definitions</a> list.
					</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="scanning-remote-systems-for-vulnerabilities_scanning-the-system-for-security-compliance-and-vulnerabilities"/>Scanning remote systems for vulnerabilities</h1></div></div></div><p>
				You can check also remote systems for vulnerabilities with the OpenSCAP scanner. This functionality is enabled by the <code class="literal">oscap-ssh</code> tool over the SSH protocol.
			</p><h3><a id="prerequisites_3"/>Prerequisites</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						The <code class="literal">AppStream</code> repository is enabled.
					</li><li class="listitem">
						The <code class="literal">openscap-scanner</code> package is installed on the remote systems.
					</li><li class="listitem">
						The SSH server is running on the remote systems.
					</li></ul></div><h3><a id="procedure_5"/>Procedure</h3><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">
						Install the <code class="literal">openscap-utils</code> package:
					</p><pre class="screen"># yum install openscap-utils</pre></li><li class="listitem"><p class="simpara">
						Download the latest RHSA OVAL definitions for your system:
					</p><pre class="screen"># wget https://www.redhat.com/security/data/oval/Red_Hat_Enterprise_Linux_8.xml</pre></li><li class="listitem"><p class="simpara">
						Scan a remote system with the <span class="emphasis"><em>machine1</em></span> host name, SSH running on port 22, and the <span class="emphasis"><em>joesec</em></span> user name for vulnerabilities and save results to the <span class="emphasis"><em>remote-vulnerability.html</em></span> file:
					</p><pre class="screen"># oscap-ssh <span class="emphasis"><em>joesec@machine1</em></span> 22 oval eval --report <span class="emphasis"><em>remote-vulnerability.html</em></span> Red_Hat_Enterprise_Linux_8.xml</pre></li></ol></div><h3><a id="additional_resources_11"/>Additional resources</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						The <code class="literal">oscap-ssh(8)</code> man page.
					</li><li class="listitem">
						The <a class="link" href="https://www.redhat.com/security/data/oval/">Red Hat OVAL definitions</a> list.
					</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="assessing-security-compliance-with-a-specific-baseline_scanning-the-system-for-security-compliance-and-vulnerabilities"/>Assessing security compliance with a specific baseline</h1></div></div></div><p>
				The <code class="literal">SCAP Security Guide</code> suite provides profiles for several platforms in a form of XCCDF, OVAL, and data stream documents. The <span class="emphasis"><em>profile</em></span> is a set of rules based on a security policy, such as Operating System Protection Profile (OSPP) or Payment Card Industry Data Security Standard (PCI-DSS). This enables you to audit the system in an automated way in respect of security standards.
			</p><h3><a id="prerequisites_4"/>Prerequisites</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						The <code class="literal">openscap-scanner</code> package is installed.
					</li></ul></div><h3><a id="procedure_6"/>Procedure</h3><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">
						Install the <code class="literal">scap-security-guide</code> packages:
					</p><pre class="screen"># yum install scap-security-guide</pre></li><li class="listitem"><p class="simpara">
						Display detailed information about a selected data stream using the <code class="literal">oscap info</code> sub-command. In the <code class="literal">Profiles</code> section, you can find a list of available profiles and their IDs:
					</p><pre class="screen">$ oscap info /usr/share/xml/scap/ssg/content/ssg-rhel8-ds.xml
...
Profiles:
  Title: PCI-DSS v3 Control Baseline for Red Hat Enterprise Linux 8
    Id: xccdf_org.ssgproject.content_profile_pci-dss
  Title: OSPP - Protection Profile for General Purpose Operating Systems
    Id: xccdf_org.ssgproject.content_profile_ospp
...
[trimmed for clarity]</pre><p class="simpara">
						Select a profile from the data-stream file and display more details about the selected profile by providing the last part of an ID identified in the output of the previous command to the <code class="literal">--profile</code> option of <code class="literal">oscap info</code>. For example, the OSPP profile has Id: <code class="literal">xccdf_org.ssgproject.content_profile_ospp</code>, and the value for the <code class="literal">--profile</code> option is <code class="literal">ospp</code>:
					</p><pre class="screen">$ oscap info --profile ospp /usr/share/xml/scap/ssg/content/ssg-rhel8-ds.xml</pre><p class="simpara">
						The PCI-DSS v3 Control Baseline profile is identified by <code class="literal">xccdf_org.ssgproject.content_profile_pci-dss</code>:
					</p><pre class="screen">$ oscap info --profile pci-dss /usr/share/xml/scap/ssg/content/ssg-rhel8-ds.xml
...
Description: Ensures PCI-DSS v3 related security configuration settings are applied.
[trimmed for clarity]</pre><p class="simpara">
						Alternatively, when using GUI, install the <code class="literal">scap-security-guide-doc</code> package and open the <code class="literal"><a class="link" href="file:///usr/share/doc/scap-security-guide/guides/ssg-rhel8-guide-index.html">file:///usr/share/doc/scap-security-guide/guides/ssg-rhel8-guide-index.html</a></code> file in a web browser. After you select a required profile in the top right field of the <span class="emphasis"><em>Guide to the Secure Configuration of Red Hat Enterprise Linux 8</em></span> document, you can see a relevant command for the following evaluation.
					</p></li><li class="listitem"><p class="simpara">
						Evaluate the system of how it complies with the selected profile and save scan’s results in the <span class="emphasis"><em>report.html</em></span> HTML file, for example:
					</p><pre class="screen">$ oscap xccdf eval --report <span class="emphasis"><em>report.html</em></span> --profile ospp /usr/share/xml/scap/ssg/content/ssg-rhel8-ds.xml</pre><p class="simpara">
						With the <code class="literal">openscap-utils</code> package installed on your system and the <code class="literal">openscap-scanner</code> package installed on a remote system, you can also scan the remote system with the <span class="emphasis"><em>machine1</em></span> host name, SSH running on port 22, and the <span class="emphasis"><em>joesec</em></span> user name for vulnerabilities and save results to the <span class="emphasis"><em>remote-report.html</em></span> file:
					</p><pre class="screen">$ oscap-ssh joesec@machine1 22 xccdf eval --report remote_report.html --profile ospp /usr/share/xml/scap/ssg/content/ssg-rhel8-ds.xml</pre></li></ol></div><h3><a id="additional_resources_12"/>Additional resources</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						<code class="literal">scap-security-guide(8)</code> man page
					</li><li class="listitem">
						The SCAP Security Guide documentation installed in the <code class="literal"><a class="link" href="file:///usr/share/doc/scap-security-guide/">file:///usr/share/doc/scap-security-guide/</a></code> directory.
					</li><li class="listitem">
						The <a class="link" href="file:///usr/share/doc/scap-security-guide/guides/ssg-rhel8-guide-index.html">Guide to the Secure Configuration of Red Hat Enterprise Linux 8</a> installed with the <code class="literal">scap-security-guide-doc</code> package.
					</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="related-information-scanning-the-system-for-security-compliance-and-vulnerabilities"/>Related information</h1></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						<a class="link" href="http://www.open-scap.org">The OpenSCAP project page</a> - The home page to the OpenSCAP project provides detailed information about the oscap utility and other components and projects related to SCAP.
					</li><li class="listitem">
						<a class="link" href="https://www.open-scap.org/tools/scap-workbench/">The SCAP Workbench project page</a> - The home page to the SCAP Workbench project provides detailed information about the scap-workbench application.
					</li><li class="listitem">
						<a class="link" href="https://www.open-scap.org/security-policies/scap-security-guide/">The SCAP Security Guide (SSG) project page</a> - The home page to the SSG project that provides the latest security content for Red Hat Enterprise Linux.
					</li><li class="listitem">
						<a class="link" href="http://scap.nist.gov/">National Institute of Standards and Technology (NIST) SCAP page</a> - This page represents a vast collection of SCAP related materials, including SCAP publications, specifications, and the SCAP Validation Program.
					</li><li class="listitem">
						<a class="link" href="http://nvd.nist.gov/">National Vulnerability Database (NVD)</a> - This page represents the largest repository of SCAP content and other SCAP standards based vulnerability management data.
					</li><li class="listitem">
						<a class="link" href="http://www.redhat.com/security/data/oval/">Red Hat OVAL content repository</a> - This is a repository containing OVAL definitions for vulnerabilities of Red Hat Enterprise Linux systems. This is the recommended source of vulnerability content.
					</li><li class="listitem">
						<a class="link" href="http://cve.mitre.org/">MITRE CVE</a> - This is a database of publicly known security vulnerabilities provided by the MITRE corporation. For RHEL, using OVAL CVE content provided by Red Hat is recommended.
					</li><li class="listitem">
						<a class="link" href="http://oval.mitre.org/">MITRE OVAL</a> - This page represents an OVAL related project provided by the MITRE corporation. Among other OVAL related information, these pages contain the latest version of the OVAL language and a repository of OVAL content with thousands of OVAL definitions. Note that for scanning RHEL, using OVAL CVE content provided by Red Hat is recommended.
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en/red-hat-satellite/">Red Hat Satellite documentation</a> - This set of guides describes, among other topics, how to maintain system security on multiple systems by using OpenSCAP.
					</li></ul></div></div></div></body></html>