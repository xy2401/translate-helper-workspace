<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 12. Controlling LVM device scanning</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="assembly_device-scan-configuring-and-managing-logical-volumes"/>Chapter 12. Controlling LVM device scanning</h1></div></div></div><p>
			You can control LVM device scanning by configuring filters in the <code class="literal">/etc/lvm/lvm.conf</code> file. The filters in the <code class="literal">lvm.conf</code> file consist of a series of simple regular expressions that get applied to the device names in the <code class="literal">/dev</code> directory to decide whether to accept or reject each block device found.
		</p><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="proc-controlling-device-scans-with-filters-device-scan"/>Configuring filters to control device scanning</h1></div></div></div><p>
				The following examples show the use of filters to control which devices LVM scans. Note that some of these examples do not necessarily represent recommended practice, as the regular expressions are matched freely against the complete pathname. For example, <code class="literal">a/loop/</code> is equivalent to <code class="literal">a/.*loop.*/</code> and would match <code class="literal">/dev/solooperation/lvol1</code>.
			</p><p>
				The following filter adds all discovered devices, which is the default behavior as there is no filter configured in the configuration file:
			</p><pre class="literallayout">filter = [ "a/.*/" ]</pre><p>
				The following filter removes the cdrom device in order to avoid delays if the drive contains no media:
			</p><pre class="literallayout">filter = [ "r|/dev/cdrom|" ]</pre><p>
				The following filter adds all loop and removes all other block devices:
			</p><pre class="literallayout">filter = [ "a/loop.*/", "r/.*/" ]</pre><p>
				The following filter adds all loop and IDE and removes all other block devices:
			</p><pre class="literallayout">filter =[ "a|loop.*|", "a|/dev/hd.*|", "r|.*|" ]</pre><p>
				The following filter adds just partition 8 on the first IDE drive and removes all other block devices:
			</p><pre class="literallayout">filter = [ "a|^/dev/hda8$|", "r/.*/" ]</pre></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="proc-controlling-device-scans-filters-device-scan"/>Controlling whether LVM commands scan logical volumes</h1></div></div></div><p>
				By default, LVM commands do not scan the logical volumes on your system. This default behavior provides the following advantages:
			</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						If there are many active logical volumes on the system, every LVM command would require additional time, negatively impacting performance and causing unwanted delays or timeouts.
					</li><li class="listitem">
						If logical volumes contain physical volumes from a guest VM image, the host usually does not want to scan or use those layered physical volumes which belong to the guest. Note, however, that in the cases where a guest VM’s physical volume exists directly on an SCSI device visible to the host, in order to prevent LVM on the host from accessing those physical volumes you will need to configure a filter, as described in <a class="link" href="assembly_device-scan-configuring-and-managing-logical-volumes.html#proc-controlling-device-scans-with-filters-device-scan" title="Configuring filters to control device scanning">Configuring filters to control device scanning</a>.
					</li></ul></div><p>
				Scanning logical volumes may be necessary when layering physical volumes on top of logical volumes is intentional. This will allow the <code class="literal">pvcreate</code> command to be run on a logical volume. To configure LVM to scan all logical volumes, set the <code class="literal">scan_lvs</code> configuration option in the <code class="literal">/etc/lvm/lvm.conf</code> file to <code class="literal">scan_lvs=1</code>. To restrict which logical volumes LVM commands scan, you can then set up device filters in the <code class="literal">/etc/lvm/lvm.conf</code> configuration file, as described in <a class="link" href="assembly_device-scan-configuring-and-managing-logical-volumes.html#proc-controlling-device-scans-with-filters-device-scan" title="Configuring filters to control device scanning">Configuring filters to control device scanning</a>.
			</p></div></div></body></html>