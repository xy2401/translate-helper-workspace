<html  xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 9. 开始使用NetworkManager管理网络</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"></head><body ><div class="chapter"><div class="titlepage"><div><div><h1 class="title">Chapter 9. 开始使用NetworkManager管理网络</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="Overview_of_NetworkManager_getting-started-with-networking-devices-with-NetworkManager"></a> NetworkManager概述</h1></div></div></div><p>Red Hat Enterprise Linux 8使用默认网络服务<span class="strong"><strong><span class="application">NetworkManager</span></strong></span> ，它是一个动态网络控制和配置守护程序，可在网络设备和连接可用时保持网络设备和连接的活动状态。仍支持传统的<code class="literal">ifcfg</code>类型配置文件。
			</p><p>每个网络设备对应一个<span class="strong"><strong><span class="application">NetworkManager</span></strong></span>设备。网络设备的配置完全存储在单个<span class="strong"><strong>NetworkManager</strong></span>连接中。您可以执行将<span class="strong"><strong>NetworkManager</strong></span>连接应用于<span class="strong"><strong>NetworkManager</strong></span>设备的网络配置。
			</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Benefits_of_Using_NetworkManager_getting-started-with-networking-devices-with-NetworkManager"></a>使用NetworkManager的好处</h2></div></div></div><p>使用NetworkManager的主要好处是：</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">通过D-Bus提供API，允许查询和控制网络配置和状态。通过这种方式，可以通过多个应用程序检查和配置网络，从而确保同步和最新的网络状态。例如，通过Web浏览器监视和配置服务器的RHEL Web控制台使用<span class="strong"><strong><span class="application">NetworkManager</span></strong></span> D-BUS接口来配置网络，以及<span class="strong"><strong>Gnome GUI</strong></span> ， <span class="strong"><strong>nmcli</strong></span>和<span class="strong"><strong>nm-connection-editor</strong></span>工具。其中一个工具中的每个更改都会被其他所有工具检测到。
						</li><li class="listitem">使网络管理更容易： <span class="strong"><strong><span class="application">NetworkManager</span></strong></span>确保网络连接正常工作。当它检测到系统中没有网络配置但有网络设备时， <span class="strong"><strong><span class="application">NetworkManager</span></strong></span>会创建临时连接以提供连接。
						</li><li class="listitem">提供与用户的简单连接设置： <span class="strong"><strong><span class="application">NetworkManager</span></strong></span>通过不同的工具提供管理 - <span class="strong"><strong><span class="application">GUI，nmtui，nmcli</span></strong></span> 。
						</li><li class="listitem">支持配置灵活性。例如，配置WiFi接口， <span class="strong"><strong><span class="application">NetworkManager</span></strong></span>扫描并显示可用的WiFi网络。您可以选择一个接口， <span class="strong"><strong><span class="application">NetworkManager</span></strong></span>会显示所需的凭据，在重新启动过程后提供自动连接。<span class="strong"><strong><span class="application">NetworkManager</span></strong></span>可以配置网络别名，IP地址，静态路由，DNS信息和VPN连接，以及许多特定于连接的参数。您可以修改配置选项以反映您的需求。
						</li><li class="listitem">在重新启动过程之后维护设备状态并接管在重新启动期间设置为受管模式的接口。
						</li><li class="listitem">处理未明确设置为非托管但由用户或其他网络服务手动控制的设备。
						</li></ul></div><h3><a id="additional_resources_3"></a>其他资源</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							<a class="xref" href="getting-started-with-managing-networking-with-NetworkManager_configuring-and-managing-networking.html#NetworkManager-tools_getting-started-with-networking-devices-with-NetworkManager" title="NetworkManager工具">名为“NetworkManager工具”的部分</a>
						</li><li class="listitem">有关安装和使用RHEL 8 Web控制台的更多信息，请参阅<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/managing_systems_using_the_rhel-8_web_console/">使用RHEL 8 Web控制台管理系统</a> 。
						</li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="Installing-NetworkManager_getting-started-with-networking-devices-with-NetworkManager"></a>安装NetworkManager</h1></div></div></div><p>
				<span class="strong"><strong><span class="application">NetworkManager</span></strong></span>默认安装在Red Hat Enterprise Linux 8上。如果不是，请以<code class="literal">root</code>身份输入：</p><pre class="literallayout">~]# yum install NetworkManager</pre><h3><a id="additional_resources_4"></a>其他资源</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						<a class="xref" href="getting-started-with-managing-networking-with-NetworkManager_configuring-and-managing-networking.html#Overview_of_NetworkManager_getting-started-with-networking-devices-with-NetworkManager" title="NetworkManager概述">名为“NetworkManager概述”的部分</a>
					</li><li class="listitem">
						<a class="xref" href="getting-started-with-managing-networking-with-NetworkManager_configuring-and-managing-networking.html#Benefits_of_Using_NetworkManager_getting-started-with-networking-devices-with-NetworkManager" title="使用NetworkManager的好处">“使用NetworkManager的好处”一节</a>
					</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="Checking-the-Status-of-NetworkManager_getting-started-with-networking-devices-with-NetworkManager"></a>检查NetworkManager的状态</h1></div></div></div><p>要检查<span class="strong"><strong><span class="application">NetworkManager</span></strong></span>是否正在运行：</p><pre class="literallayout">~]$ systemctl status NetworkManager
NetworkManager.service - Network Manager
   Loaded: loaded (/lib/systemd/system/NetworkManager.service; enabled)
   Active: active (running) since Fri, 08 Mar 2013 12:50:04 +0100; 3 days ago</pre><p>请注意，当<span class="strong"><strong><span class="application">NetworkManager</span></strong></span>未运行时， <code class="literal">systemctl status</code>命令显示<code class="literal">Active: inactive (dead)</code> 。
			</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="Starting-NetworkManager_getting-started-with-networking-devices-with-NetworkManager"></a>启动NetworkManager</h1></div></div></div><p>要启动<span class="strong"><strong><span class="application">NetworkManager</span></strong></span> ：</p><pre class="literallayout">~]# systemctl start NetworkManager</pre><p>要在启动时自动启用<span class="strong"><strong><span class="application">NetworkManager</span></strong></span> ：</p><pre class="literallayout">~]# systemctl enable NetworkManager</pre></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="NetworkManager-tools_getting-started-with-networking-devices-with-NetworkManager"></a> NetworkManager工具</h1></div></div></div><div class="table"><a id="tb-A_Summary_of_NetworkManager_Tools_and_Applications"></a><p class="title"><strong>表3.1。NetworkManager工具和应用程序的摘要</strong></p><div class="table-contents"><table border="1" summary="A summary of NetworkManager tools and applications"><colgroup><col class="col_1"><col class="col_2"></colgroup><thead><tr><th valign="top" style="text-align:left">应用程序或工具</th><th valign="top" style="text-align:left">描述</th></tr></thead><tbody><tr><td valign="top" style="text-align:left"> <p>
								<span class="strong"><strong><span class="application">nmcli</span></strong></span>
							</p>
							 </td><td valign="top" style="text-align:left"> <p>一种命令行工具，可使用户和脚本与<span class="strong"><strong><span class="application">NetworkManager</span></strong></span>交互。请注意， <span class="strong"><strong><span class="application">nmcli</span></strong></span>可以在没有GUI（如服务器）的系统上使用，以控制<span class="strong"><strong><span class="application">NetworkManager的</span></strong></span>所有方面。它提供了作为GUI工具的更深层功能。
							</p>
							 </td></tr><tr><td valign="top" style="text-align:left"> <p>
								<span class="strong"><strong><span class="application">nmtui</span></strong></span>
							</p>
							 </td><td valign="top" style="text-align:left"> <p><span class="strong"><strong><span class="application">NetworkManager的</span></strong></span>简单基于curses的文本用户界面（TUI）
							</p>
							 </td></tr><tr><td valign="top" style="text-align:left"> <p>
								<span class="strong"><strong><span class="application">纳米连接编辑器</span></strong></span>
							</p>
							 </td><td valign="top" style="text-align:left"> <p>用于<span class="strong"><strong><span class="application">控制中心</span></strong></span>实用程序尚未处理的某些任务的图形用户界面工具，例如配置绑定和组合连接。您可以添加，删除和修改<span class="strong"><strong><span class="application">NetworkManager</span></strong></span>存储的网络连接。要启动它，请在终端中输入<span class="strong"><strong><span class="application">nm-connection-editor</span></strong></span> 。
							</p>
							 </td></tr><tr><td valign="top" style="text-align:left"> <p>
								<span class="strong"><strong><span class="application">控制中心</span></strong></span>
							</p>
							 </td><td valign="top" style="text-align:left"> <p>GNOME Shell提供的图形用户界面工具，可供桌面用户使用。它包含一个网络设置工具。要启动它，请按<span class="keycap"><strong>超级</strong></span>键进入活动概览，键入<span class="strong"><strong><span class="application">网络</span></strong></span> ，然后按<span class="keycap"><strong>Enter键</strong></span> 。出现网络设置工具。
							</p>
							 </td></tr><tr><td valign="top" style="text-align:left"> <p>
								<span class="strong"><strong><span class="application">网络连接图标</span></strong></span>
							</p>
							 </td><td valign="top" style="text-align:left"> <p>GNOME Shell提供的图形用户界面工具，表示<span class="strong"><strong><span class="application">NetworkManager</span></strong></span>报告的网络连接状态。该图标具有多个状态，可用作您当前使用的连接类型的可视指示器。
							</p>
							 </td></tr></tbody></table></div></div><h3><a id="additional_resources_5"></a>其他资源</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						<a class="xref" href="Configuring-IP-Networking-with-nmtui_configuring-and-managing-networking.html" title="Chapter 9. 使用nmtui配置IP网络">第5章， <em>使用nmtui配置IP网络</em></a>
					</li><li class="listitem">
						<a class="xref" href="Configuring-Networking-with-nmcli_configuring-and-managing-networking.html" title="Chapter 9. 使用nmcli配置网络">第6章， <em>使用nmcli配置网络</em></a>
					</li><li class="listitem">
						<a class="xref" href="Configuring-Networking-with-GNOME-GUI_configuring-and-managing-networking.html" title="Chapter 9. 使用GNOME GUI配置网络">第7章， <em>使用GNOME GUI配置网络</em></a>
					</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="Running-Dispatcher-Scripts_getting-started-with-networking-devices-with-NetworkManager"></a>运行调度程序脚本</h1></div></div></div><p>
				<span class="strong"><strong><span class="application">NetworkManager</span></strong></span>提供了一种运行其他自定义脚本以根据连接状态启动或停止服务的方法。默认情况下，/ <code class="literal">/etc/NetworkManager/dispatcher.d/</code> / <span class="strong"><strong><span class="application">NetworkManager /</span></strong></span> <code class="literal">/etc/NetworkManager/dispatcher.d/</code>目录存在， <span class="strong"><strong><span class="application">NetworkManager</span></strong></span>按字母顺序在那里运行脚本。每个脚本必须是<code class="literal">root</code> <span class="strong"><strong>拥有</strong></span>的可执行文件<span class="strong"><strong>，</strong></span>并且必须仅对文件所有者具有<code class="literal">write permission</code> 。
			</p><h3><a id="additional_resources_6"></a>其他资源</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">有关运行NetworkManager调度程序脚本的详细信息，请参阅Red Hat知识库解决方案<a class="link" href="https://access.redhat.com/solutions/2841131">如何编写NetworkManager调度程序脚本以应用ethtool命令</a> 。
					</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="Using-NetworkManager-with-sysconfig-files_getting-started-with-networking-devices-with-NetworkManager"></a>将NetworkManager与sysconfig文件一起使用</h1></div></div></div><p><code class="literal">/etc/sysconfig/</code>目录是配置文件和脚本的位置。大多数网络配置信息都存储在那里，但VPN，移动宽带和PPPoE配置除外，它们存储在<code class="literal">/etc/NetworkManager/</code>子目录中。例如，特定于接口的信息存储在<code class="literal">/etc/sysconfig/network-scripts/</code>目录中的<code class="literal">ifcfg</code>文件中。
			</p><p>对于全局设置，请使用<code class="literal">/etc/sysconfig/network</code>文件。VPN，移动宽带和PPPoE连接的信息存储在<code class="literal">/etc/NetworkManager/system-connections/</code> 。
			</p><p>在Red Hat Enterprise Linux 8中，如果编辑<code class="literal">ifcfg</code>文件， <span class="strong"><strong><span class="application">NetworkManager</span></strong></span>不会自动<code class="literal">ifcfg</code>更改，必须提示您注意更改。如果使用其中一个工具更新<span class="strong"><strong><span class="application">NetworkManager</span></strong></span>配置文件设置，则在使用该配置文件重新连接之前， <span class="strong"><strong><span class="application">NetworkManager</span></strong></span>不会实施这些更改。例如，如果使用编辑器更改了配置文件，则<span class="strong"><strong><span class="application">NetworkManager</span></strong></span>必须再次读取配置文件。
			</p><p>要确保这一点，请以<code class="literal">root</code>身份输入以重新加载所有连接配置文件：</p><pre class="literallayout">~]# nmcli connection reload</pre><p>另外，重装<span class="strong"><strong>只有一个</strong></span>更改的文件， <code class="literal">ifcfg- <span class="emphasis"><em>ifname</em></span></code> ：</p><pre class="literallayout">~]# nmcli con load /etc/sysconfig/network-scripts/ifcfg-ifname</pre><p>请注意，您可以使用上面的命令指定多个文件名。
			</p><p>要在更改后重新启动连接，请使用：</p><pre class="literallayout">~]# nmcli con up <span class="emphasis"><em>connection-name</em></span></pre><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="legacy_network_scripts_support"></a>传统网络脚本支持</h2></div></div></div><p>网络脚本在Red Hat Enterprise Linux 8中已弃用，默认情况下不再提供。基本安装提供了<code class="literal">ifup</code>和<code class="literal">ifdown</code>脚本的新版本，它通过<span class="strong"><strong><span class="application">nmcli</span></strong></span>工具调用<span class="strong"><strong><span class="application">NetworkManager</span></strong></span> 。在Red Hat Enterprise Linux 8中，要运行<code class="literal">ifup</code>和<code class="literal">ifdown</code>脚本，必须运行<span class="strong"><strong><span class="application">NetworkManager</span></strong></span> 。
				</p><div class="note" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title">注意</h3><p>不执行<code class="literal">/sbin/ifup-local</code> ， <code class="literal">ifdown-pre-local</code>和<code class="literal">ifdown-local</code>脚本中的自定义命令。
					</p><p>如果需要这些脚本中的任何一个，则仍可以使用以下命令在系统中安装已弃用的网络脚本：</p><pre class="literallayout">~]# yum install network-scripts</pre><p><code class="literal">ifup</code>和<code class="literal">ifdown</code>脚本链接到已安装的旧网络脚本。
					</p><p>调用旧网络脚本会显示有关其弃用的警告。
					</p></div><h3><a id="additional_resources_7"></a>其他资源</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							<code class="literal">NetworkManager(8)</code>手册页 - 介绍网络管理守护程序。
						</li><li class="listitem">
							<code class="literal">NetworkManager.conf(5)</code>手册页 - 描述<code class="literal">NetworkManager</code>配置文件。
						</li><li class="listitem">
							<code class="literal">/usr/share/doc/initscripts/sysconfig.txt</code> - 描述传统网络服务所理解的<code class="literal">ifcfg</code>配置文件及其指令。
						</li><li class="listitem">
							<code class="literal">ifcfg(8)</code>手册页 - 简要介绍<code class="literal">ifcfg</code>命令。
						</li></ul></div></div></div></div></body></html>