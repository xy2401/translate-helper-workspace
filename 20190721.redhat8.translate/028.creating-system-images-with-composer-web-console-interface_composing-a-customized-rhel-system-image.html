<html  xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 9. 使用Image Builder Web控制台界面创建系统映像</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"></head><body ><div class="chapter"><div class="titlepage"><div><div><h1 class="title">Chapter 9. 使用Image Builder Web控制台界面创建系统映像</h1></div></div></div><p>Image Builder是一个用于创建自定义系统映像的工具。要控制Image Builder并创建自定义系统映像，可以使用Web控制台界面。请注意， <a class="link" href="creating-system-images-with-composer-command-line-interface_composing-a-customized-rhel-system-image.html" title="Chapter 9. 使用Image Builder命令行界面创建系统映像">命令行界面</a>是当前首选的替代方法，因为它提供了更多功能。
		</p><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="accessing-composer-gui-in-the-rhel-8-web-console_creating-system-images-with-composer-web-console-interface"></a>访问RHEL 8 Web控制台中的Image Builder GUI</h1></div></div></div><p>RHEL 8 Web控制台的<span class="strong"><strong>cockpit-composer</strong></span>插件使用户能够管理Image Builder蓝图并使用图形界面进行编写。请注意，目前使用命令行界面控制Image Builder的首选方法。
			</p><div class="itemizedlist"><p class="title"><strong>先决条件</strong></p><ul class="itemizedlist"><li class="listitem">您必须具有系统的root访问权限。
					</li></ul></div><div class="orderedlist"><p class="title"><strong>程序</strong></p><ol class="orderedlist"><li class="listitem"><p class="simpara">在安装了Image Builder的系统上的Web浏览器中打开<code class="literal"><a class="link" href="https://localhost:9090/">https://localhost:9090/</a></code> 。
					</p><p class="simpara">有关如何远程访问Image Builder的更多信息，请参阅<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/managing_systems_using_the_rhel_8_web_console">使用RHEL 8 Web控制台管理系统</a> 。
					</p></li><li class="listitem">使用具有足够系统权限的用户帐户的凭据登录Web控制台。
					</li><li class="listitem"><p class="simpara">要显示Image Builder控件，请单击窗口左上角的<code class="literal">Image Builder</code>图标。
					</p><p class="simpara">将打开“图像构建器”视图，其中列出了现有蓝图
					</p></li></ol></div><div class="itemizedlist"><p class="title"><strong>相关信息</strong></p><ul class="itemizedlist"><li class="listitem">
						<a class="xref" href="creating-system-images-with-composer-command-line-interface_composing-a-customized-rhel-system-image.html" title="Chapter 9. 使用Image Builder命令行界面创建系统映像">第3章， <em>使用Image Builder命令行界面创建系统映像</em></a>
					</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="creating-a-composer-blueprint-in-the-web-console-interface_creating-system-images-with-composer-web-console-interface"></a>在Web控制台界面中创建Image Builder蓝图</h1></div></div></div><p>要描述自定义系统映像，请先创建蓝图。
			</p><div class="itemizedlist"><p class="title"><strong>先决条件</strong></p><ul class="itemizedlist"><li class="listitem">您已在浏览器中打开RHEL 8 Web控制台的Image Builder界面。
					</li></ul></div><div class="orderedlist"><p class="title"><strong>程序</strong></p><ol class="orderedlist"><li class="listitem"><p class="simpara">单击右上角的“ <span class="guibutton">创建蓝图</span> ”。
					</p><p class="simpara">将出现一个弹出窗口，其中包含蓝图名称和说明的字段。
					</p></li><li class="listitem"><p class="simpara">填写蓝图的名称及其说明，然后单击“ <span class="guibutton">创建”</span> 。
					</p><p class="simpara">屏幕变为蓝图编辑模式。
					</p></li><li class="listitem"><p class="simpara">添加要包含在系统映像中的组件：</p><div class="informalexample"><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">在左侧，在“ <code class="literal">Available Components</code>字段中输入全部或部分组件名称，然后按<span class="guibutton">Enter键</span> 。
							</p><p class="simpara">搜索将添加到文本输入字段下的过滤器列表中，下面的组件列表将缩减为与搜索匹配的列表。
							</p><p class="simpara">如果组件列表太长，请以相同方式添加更多搜索项。
							</p></li><li class="listitem">组件列表被分页。要移至其他结果页面，请使用组件列表上方的箭头和输入字段。
							</li><li class="listitem">单击要用于显示其详细信息的组件的名称。右侧窗格填充组件的详细信息，例如其版本和依赖项。
							</li><li class="listitem">在“ <code class="literal">Version Release</code>下拉列表中，在“ <code class="literal">Component Options</code>框中选择要使用的<code class="literal">Version Release</code> 。
							</li><li class="listitem">单击左上角的“ <span class="guibutton">添加</span> ”。</li><li class="listitem">如果错误地添加的成分，通过点击最右边的在右窗格中条目的<span class="guibutton">...</span>按钮删除它，然后选择<code class="literal">Remove</code>的菜单。
							</li></ol></div><div class="note" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title">注意</h3><p>如果您不打算为某些组件选择版本，可以通过单击组件列表右侧的<span class="guibutton">+</span>按钮跳过组件详细信息屏幕和版本选择。
						</p></div></div></li><li class="listitem"><p class="simpara">要保存蓝图，请单击右上角的“ <span class="guibutton">提交”</span>弹出一个包含更改摘要的对话框。单击<span class="guibutton">提交</span> 。
					</p><p class="simpara">右侧的小弹出窗口会通知您保存进度和结果。
					</p></li><li class="listitem"><p class="simpara">要退出编辑屏幕，请单击左上角的“ <code class="literal">Back to Blueprints</code> ”。</p><p class="simpara">将打开“图像构建器”视图，其中列出了现有蓝图
					</p></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="editing-a-composer-blueprint-in-the-web-console-interface_creating-system-images-with-composer-web-console-interface"></a>在Web控制台界面中编辑Image Builder蓝图</h1></div></div></div><p>要更改自定义系统映像的规范，请编辑相应的蓝图。
			</p><div class="itemizedlist"><p class="title"><strong>先决条件</strong></p><ul class="itemizedlist"><li class="listitem">您已在浏览器中打开RHEL 8 Web控制台的Image Builder界面。
					</li><li class="listitem">存在蓝图。
					</li></ul></div><div class="orderedlist"><p class="title"><strong>程序</strong></p><ol class="orderedlist"><li class="listitem"><p class="simpara">通过在左上角的搜索框中输入其名称或部分名称来找到要编辑的蓝图，然后按<span class="keycap"><strong>Enter键</strong></span> 。
					</p><p class="simpara">搜索将添加到文本输入字段下的过滤器列表中，下面的蓝图列表将缩减为与搜索匹配的列表。
					</p><p class="simpara">如果蓝图列表太长，请以相同方式添加更多搜索字词。
					</p></li><li class="listitem"><p class="simpara">在蓝图的右侧，按下属于<span class="guibutton">蓝图</span>的“ <span class="guibutton">编辑蓝图”</span>按钮。
					</p><p class="simpara">视图将更改为蓝图编辑屏幕。
					</p></li><li class="listitem">通过单击右窗格中其条目最右侧的<span class="guibutton">⫶</span>按钮删除不需要的组件，然后在菜单中选择“ <code class="literal">Remove</code> ”。
					</li><li class="listitem"><p class="simpara">更改现有组件的版本：</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">在Blueprint Components搜索字段中，在标题<code class="literal">Blueprint Components</code>下的字段中输入组件名称或其一部分，然后按<span class="guibutton">Enter键</span> 。
							</p><p class="simpara">搜索将添加到文本输入字段下的过滤器列表中，下面的组件列表将缩减为与搜索匹配的列表。
							</p><p class="simpara">如果组件列表太长，请以相同方式添加更多搜索项。
							</p></li><li class="listitem"><p class="simpara">单击组件条目最右侧的<span class="guibutton">⫶</span>按钮，然后在菜单中选择“ <code class="literal">View</code> ”。
							</p><p class="simpara">将在右窗格中打开组件详细信息屏幕。
							</p></li><li class="listitem"><p class="simpara">在<code class="literal">Version Release</code>下拉菜单中选择所需的版本，然后单击右上角的<span class="guibutton">Apply Change</span> 。
							</p><p class="simpara">保存更改，右窗格返回列出蓝图组件。
							</p></li></ol></div></li><li class="listitem"><p class="simpara">添加新组件：</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">在左侧，在“ <code class="literal">Available Components</code> ”标题下的字段中输入组件名称或其中的一部分，然后按<span class="guibutton">Enter键</span> 。
							</p><p class="simpara">搜索将添加到文本输入字段下的过滤器列表中，下面的组件列表将缩减为与搜索匹配的列表。
							</p><p class="simpara">如果组件列表太长，请以相同方式添加更多搜索项。
							</p></li><li class="listitem">组件列表被分页。要移至其他结果页面，请使用组件列表上方的箭头和输入字段。
							</li><li class="listitem">单击要用于显示其详细信息的组件的名称。右侧窗格填充组件的详细信息，例如其版本和依赖项。
							</li><li class="listitem">使用“ <code class="literal">Version Release</code>下拉菜单，在“ <code class="literal">Component Options</code>框中选择要使用的<code class="literal">Version Release</code> 。
							</li><li class="listitem">单击右上角的“ <span class="guibutton">添加</span> ”。
							</li><li class="listitem">如果您错误地添加了某个组件，请通过单击右侧窗格中其条目最右侧的<span class="guibutton">⫶</span>按钮将其<code class="literal">Remove</code> ，然后在菜单中选择“ <code class="literal">Remove</code> ”。
							</li></ol></div></li></ol></div><div class="informalexample"><div class="note" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title">注意</h3><p>如果您不打算为某些组件选择版本，可以通过单击组件列表右侧的<span class="guibutton">+</span>按钮跳过组件详细信息屏幕和版本选择。
				</p></div></div><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">使用您的更改提交新版本的蓝图：</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">单击右上角的“ <span class="guibutton">提交”</span>按钮。
							</p><p class="simpara">将出现一个弹出窗口，其中包含您的更改摘要。
							</p></li><li class="listitem"><p class="simpara">查看更改并单击“ <span class="guibutton">提交”进行确认</span> 。
							</p><p class="simpara">右侧的小弹出窗口会通知您保存进度和结果。创建了新版本的蓝图。
							</p></li><li class="listitem"><p class="simpara">在左上角，单击“ <code class="literal">Back to Blueprints</code>以退出编辑屏幕。
							</p><p class="simpara">将打开“图像构建器”视图，其中列出了现有蓝图
							</p></li></ol></div></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="adding-users-and-groups-to-a-composer-blueprint-in-the-web-console-interface_creating-system-images-with-composer-web-console-interface"></a>在Web控制台界面中将用户和组添加到Image Builder蓝图</h1></div></div></div><p>目前无法在Web控制台界面中将自定义项（如用户和组）添加到蓝图中。要解决此限制，请使用Web控制台中的“ <span class="strong"><strong><span class="GUI">终端”</span></strong></span>选项卡以使用命令行界面（CLI）工作流。
			</p><div class="itemizedlist"><p class="title"><strong>先决条件</strong></p><ul class="itemizedlist"><li class="listitem">必须存在蓝图。
					</li><li class="listitem"><p class="simpara">必须安装CLI文本编辑器，如<code class="literal">vim</code> ， <code class="literal">nano</code>或<code class="literal">emacs</code> 。要安装它们：</p><pre class="screen"># yum install <span class="emphasis"><em>editor-name</em></span></pre></li></ul></div><div class="orderedlist"><p class="title"><strong>程序</strong></p><ol class="orderedlist"><li class="listitem">找出蓝图的名称：打开RHEL 8 Web控制台左侧的Image Builder（ <span class="strong"><strong><span class="GUI">图像构建器</span></strong></span> ）选项卡，查看蓝图的名称。
					</li><li class="listitem">在Web控制台中导航到CLI：打开左侧的系统管理选项卡，然后从左侧列表中选择最后一个项目<span class="strong"><strong><span class="GUI">终端</span></strong></span> 。</li><li class="listitem"><p class="simpara">进入超级用户（root）模式：</p><pre class="screen">$ sudo bash</pre><p class="simpara">询问时提供您的凭据。请注意，终端不会重复使用您登录Web控制台时输入的凭据。
					</p><p class="simpara">具有root权限的新shell将在主目录中启动。
					</p></li><li class="listitem"><p class="simpara">将蓝图导出到文件：</p><pre class="screen"># composer-cli blueprints save <span class="emphasis"><em>BLUEPRINT-NAME</em></span></pre></li><li class="listitem"><p class="simpara">使用您选择的CLI文本编辑器编辑文件BLUEPRINT <span class="emphasis"><em>-NAME</em></span> .toml，并添加用户和组。
					</p><div class="important" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title">重要</h3><p>RHEL 8 Web控制台没有任何内置功能来编辑系统上的文本文件，因此此步骤需要使用CLI文本编辑器。
						</p></div><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">对于要添加的每个用户，将此块添加到文件中：</p><pre class="screen">[[customizations.user]]
name = "<span class="emphasis"><em>USER-NAME</em></span>"
description = "<span class="emphasis"><em>USER-DESCRIPTION</em></span>"
password = "<span class="emphasis"><em>PASSWORD-HASH</em></span>"
key = "<span class="emphasis"><em>ssh-rsa (...) key-name</em></span>"
home = "/home/<span class="emphasis"><em>USER-NAME</em></span>/"
shell = "<span class="emphasis"><em>/usr/bin/bash</em></span>"
groups = [<span class="emphasis"><em>"users", "wheel"</em></span>]
uid = <span class="emphasis"><em>NUMBER</em></span>
gid = <span class="emphasis"><em>NUMBER</em></span></pre><p class="simpara">用实际密码哈希替换<span class="emphasis"><em>PASSWORD-HASH</em></span> 。要生成哈希，请使用例如。这个命令：</p><pre class="screen">$ python3 -c 'import crypt,getpass;pw=getpass.getpass();print(crypt.crypt(pw) if (pw==getpass.getpass("Confirm: ")) else exit())'</pre><p class="simpara">用实际公钥替换<span class="emphasis"><em>ssh-rsa（...）key-name</em></span> 。
							</p><p class="simpara">用合适的值替换其他占位符。
							</p><p class="simpara">根据需要省略任何行，只需要用户名。
							</p></li><li class="listitem"><p class="simpara">对于要添加的每个用户组，将此块添加到文件中：</p><pre class="screen">[[customizations.group]]
name = "<span class="emphasis"><em>GROUP-NAME</em></span>"
gid = <span class="emphasis"><em>NUMBER</em></span></pre></li><li class="listitem">增加版本号。
							</li><li class="listitem">保存文件并关闭编辑器。
							</li></ol></div></li><li class="listitem"><p class="simpara">将蓝图导回到Image Builder：</p><pre class="screen"># composer-cli blueprints push <span class="emphasis"><em>BLUEPRINT-NAME</em></span>.toml</pre><p class="simpara">请注意，您必须提供包含<code class="literal">.toml</code>扩展名的文件名，而在其他命令中，您只能使用蓝图的名称。
					</p></li><li class="listitem"><p class="simpara">要验证上传到Image Builder的内容是否与您的编辑匹配，请列出蓝图的内容：</p><pre class="screen"># composer-cli blueprints show <span class="emphasis"><em>BLUEPRINT-NAME</em></span></pre><p class="simpara">检查版本是否与文件中的版本匹配，以及是否存在自定义项。
					</p><div class="important" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title">重要</h3><p>除非您还编辑了蓝图中包含的软件包，否则RHEL 8 Web控制台的Image Builder插件不会显示可用于验证是否已应用更改的任何信息。
						</p></div></li><li class="listitem"><p class="simpara">退出特权shell：</p><pre class="screen"># exit</pre></li><li class="listitem"><p class="simpara">打开左侧的<span class="strong"><strong><span class="GUI">图像构建</span></strong></span>器（ <span class="strong"><strong><span class="GUI">图像构建器</span></strong></span> ）选项卡，然后在所有浏览器以及打开它的所有选项卡中刷新页面。
					</p><p class="simpara">这可以防止加载页面中缓存的状态意外还原您的更改。
					</p></li></ol></div><div class="itemizedlist"><p class="title"><strong>附加信息</strong></p><ul class="itemizedlist"><li class="listitem">
						<a class="xref" href="creating-system-images-with-composer-command-line-interface_composing-a-customized-rhel-system-image.html#composer-blueprint-format_creating-system-images-with-composer-command-line-interface" title="图像生成器蓝图格式">名为“Image Builder蓝图格式”的部分</a>
					</li><li class="listitem">
						<a class="xref" href="creating-system-images-with-composer-command-line-interface_composing-a-customized-rhel-system-image.html#editing-a-composer-blueprint-with-command-line-interface_creating-system-images-with-composer-command-line-interface" title="使用命令行界面编辑Image Builder蓝图">“使用命令行界面编辑图像生成器蓝图”一节</a>
					</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="creating-a-system-image-with-composer-in-the-web-console-interface_creating-system-images-with-composer-web-console-interface"></a>使用Web控制台界面中的Image Builder创建系统映像</h1></div></div></div><p>以下步骤描述了创建系统映像。
			</p><div class="itemizedlist"><p class="title"><strong>先决条件</strong></p><ul class="itemizedlist"><li class="listitem">您已在浏览器中打开RHEL 8 Web控制台的Image Builder界面。
					</li><li class="listitem">存在蓝图。
					</li></ul></div><div class="orderedlist"><p class="title"><strong>程序</strong></p><ol class="orderedlist"><li class="listitem"><p class="simpara">通过在左上角的搜索框中输入其名称或部分名称来找到要构建图像的蓝图，然后按<span class="keycap"><strong>Enter键</strong></span> 。
					</p><p class="simpara">搜索将添加到文本输入字段下的过滤器列表中，下面的蓝图列表将缩减为与搜索匹配的列表。
					</p><p class="simpara">如果蓝图列表太长，请以相同方式添加更多搜索字词。
					</p></li><li class="listitem"><p class="simpara">在蓝图的右侧，按下属于蓝图的“ <span class="guibutton">创建图像”</span>按钮。
					</p><p class="simpara">出现一个弹出窗口。
					</p></li><li class="listitem"><p class="simpara">选择图像类型和体系结构，然后按“ <span class="guibutton">创建”</span> 。
					</p><p class="simpara">右上角的小弹出窗口通知您已将图像创建添加到队列中。
					</p></li><li class="listitem"><p class="simpara">单击蓝图的名称。
					</p><p class="simpara">将打开一个包含蓝图详细信息的屏幕。
					</p></li><li class="listitem"><p class="simpara">单击<code class="literal">Images</code>选项卡切换到它。将创建正在创建的映像，其状态<code class="literal">In Progress</code> 。
					</p><div class="note" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title">注意</h3><p>图像创建需要更长的时间，以分钟为单位。创建图像时没有进度指示。
						</p></div><p class="simpara">要中止图像创建，请按右侧的“ <span class="guibutton">停止”</span>按钮。
					</p></li><li class="listitem">成功创建映像后，“ <span class="guibutton">停止”</span>按钮将替换为“ <span class="guibutton">下载”</span>按钮。单击此按钮可将图像下载到系统中。
					</li></ol></div></div></div></body></html>