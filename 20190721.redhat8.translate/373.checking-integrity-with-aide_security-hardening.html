<html  xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 9. 使用AIDE检查完整性</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"></head><body ><div class="chapter"><div class="titlepage"><div><div><h1 class="title">Chapter 9. 使用AIDE检查完整性</h1></div></div></div><p>高级入侵检测环境（ <code class="literal">AIDE</code> ）是一种实用程序，它在系统上创建文件数据库，然后使用该数据库来确保文件完整性并检测系统入侵。
		</p><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="installing-aide_checking-integrity-with-aide"></a>安装AIDE</h1></div></div></div><p>安装<code class="literal">AIDE</code>并启动其数据库需要执行以下步骤。
			</p><h3><a id="prerequisites_5"></a>先决条件</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><code class="literal">AppStream</code>存储库已启用。
					</li></ul></div><h3><a id="procedure_7"></a>程序</h3><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">要安装<span class="emphasis"><em>助手</em></span>包：</p><pre class="screen"># yum install aide</pre></li><li class="listitem"><p class="simpara">要生成初始数据库：</p><pre class="screen"># aide --init</pre><div class="note" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title">注意</h3><p>在默认配置中， <code class="literal">aide --init</code>命令仅检查<code class="literal">/etc/aide.conf</code>文件中定义的一组目录和文件。要在<code class="literal">AIDE</code>数据库中包含其他目录或文件，并更改其监视的参数，请相应地编辑<code class="literal">/etc/aide.conf</code> 。
						</p></div></li><li class="listitem"><p class="simpara">要开始使用数据库，请从初始数据库文件名中删除<code class="literal">.new</code>子字符串：</p><pre class="screen"># mv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz</pre></li><li class="listitem">要更改<code class="literal">AIDE</code>数据库的位置，请编辑<code class="literal">/etc/aide.conf</code>文件并修改<code class="literal">DBDIR</code>值。为了提高安全性，请将数据库，配置和<code class="literal">/usr/sbin/aide</code>二进制文件存储在安全位置（如只读介质）中。
					</li></ol></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="performing-integrity-checks-with-aide_checking-integrity-with-aide"></a>使用<code class="literal">AIDE</code>执行完整性检查</h1></div></div></div><h3><a id="prerequisites_6"></a>先决条件</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						正确安装<code class="literal">AIDE</code>并初始化其数据库。请参阅<a class="xref" href="checking-integrity-with-aide_security-hardening.html#installing-aide_checking-integrity-with-aide" title="安装AIDE">“安装AIDE”一节</a>
					</li></ul></div><h3><a id="procedure_8"></a>程序</h3><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">要启动手动检查：</p><pre class="screen"># aide --check
Start timestamp: 2018-07-11 12:41:20 +0200 (AIDE 0.16)
AIDE found differences between database and filesystem!!
...
[trimmed for clarity]</pre></li><li class="listitem"><p class="simpara">至少应将<code class="literal">AIDE</code>配置为运行每周扫描。最多应该每天运行<code class="literal">AIDE</code> 。例如，要使用<code class="literal">AIDE</code>命令在<span class="emphasis"><em>04:05</em></span> am安排每日执行<code class="literal">cron</code> ，请将以下行添加到<code class="literal">/etc/crontab</code>文件中：</p><pre class="screen"> 05 4 * * * root /usr/sbin/aide --check</pre></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="updating-an-aide-database_checking-integrity-with-aide"></a>更新AIDE数据库</h1></div></div></div><p>验证系统更改（例如软件包更新或配置文件调整）后，建议更新基准<code class="literal">AIDE</code>数据库。
			</p><h3><a id="prerequisites_7"></a>先决条件</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						正确安装<code class="literal">AIDE</code>并初始化其数据库。请参阅<a class="xref" href="checking-integrity-with-aide_security-hardening.html#installing-aide_checking-integrity-with-aide" title="安装AIDE">“安装AIDE”一节</a>
					</li></ul></div><h3><a id="procedure_9"></a>程序</h3><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">更新基线<span class="strong"><strong>AIDE</strong></span>数据库：</p><pre class="screen"># aide --update</pre><p class="simpara"><span class="strong"><strong>aide --update</strong></span>命令创建<code class="literal">/var/lib/aide/aide.db.new.gz</code>数据库文件。
					</p></li><li class="listitem">要开始使用更新的数据库进行完整性检查，请从文件名中删除<code class="literal">.new</code>子字符串。
					</li></ol></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="related-information-checking-integrity-with-aide"></a>相关信息</h1></div></div></div><p>有关<code class="literal">AIDE</code>其他信息，请参阅<code class="literal">aide(1)</code>手册页。
			</p></div></div></body></html>