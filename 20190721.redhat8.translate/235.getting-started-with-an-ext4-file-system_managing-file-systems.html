<html  xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 9. 开始使用ext4文件系统</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"></head><body ><div class="chapter"><div class="titlepage"><div><div><h1 class="title">Chapter 9. 开始使用ext4文件系统</h1></div></div></div><p>作为系统管理员，您可以创建，装载，调整大小，备份和还原ext4文件系统。ext4文件系统是ext3文件系统的可扩展扩展。使用Red Hat Enterprise Linux 8，它可以支持最大单个文件大小为<code class="literal">16</code> TB，文件系统最大可支持<code class="literal">50</code> TB。
		</p><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="features-of-an-ext4-file-system_getting-started-with-an-ext4-file-system"></a> ext4文件系统的功能</h1></div></div></div><p>以下是ext4文件系统的功能：</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">使用扩展区：ext4文件系统使用扩展区，这可以提高使用大型文件时的性能并减少大型文件的元数据开销。
					</li><li class="listitem">Ext4相应地标记未分配的块组和inode表部分，这允许在文件系统检查期间跳过块组和表部分。它导致快速文件系统检查，随着文件系统的大小增加，这将变得更加有益。
					</li><li class="listitem">元数据校验和：默认情况下，此功能在Red Hat Enterprise Linux 8中启用。
					</li><li class="listitem"><p class="simpara">ext4文件系统的分配功能：</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">持续的预分配</li><li class="listitem">延迟分配</li><li class="listitem">多块分配</li><li class="listitem">条带感知分配</li></ul></div></li><li class="listitem">扩展属性（ <code class="literal">xattr</code> ）：这允许系统为每个文件关联几个附加的名称和值对。
					</li><li class="listitem"><p class="simpara">配额日记：这可以避免在崩溃后进行冗长的配额一致性检查。
					</p><div class="note" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title">注意</h3><p>ext4中唯一支持的日记记录模式是<code class="literal">data=ordered</code> （默认值）。有关更多信息，请参阅<a class="link" href="https://access.redhat.com/solutions/424073">RHEL是否支持EXT日记选项“data = writeback”？</a> 知识库文章。
						</p></div></li><li class="listitem">亚秒时间戳 - 这给出了亚秒的时间戳。
					</li></ul></div><h3><a id="additional_resources_61"></a>其他资源</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><code class="literal">ext4</code>手册页。
					</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="creating-an-ext-file-system_getting-started-with-an-ext4-file-system"></a>创建ext4文件系统</h1></div></div></div><p>作为系统管理员，您可以使用<code class="literal">mkfs.ext4</code>命令在块设备上创建ext4文件系统。
			</p><h3><a id="prerequisites_32"></a>先决条件</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">磁盘上的分区。有关创建MBR或GPT分区的信息，请参阅<a class="xref" href="assembly_getting-started-with-partitions_managing-file-systems.html#assembly_creating-a-partition-table-on-a-disk_assembly_getting-started-with-partitions" title="在磁盘上创建分区表">“在磁盘上创建分区表”一节</a> 。
					</p><p class="simpara">或者，使用LVM或MD卷。
					</p></li></ul></div><h3><a id="procedure_62"></a>程序</h3><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">要创建ext4文件系统：</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">对于常规分区设备，LVM卷，MD卷或类似设备，请使用以下命令：</p><pre class="screen"># mkfs.ext4 /dev/<span class="emphasis"><em>block_device</em></span></pre><p class="simpara">将/ dev / <span class="emphasis"><em>block_device</em></span>替换为块设备的路径。
							</p><p class="simpara">例如， <code class="literal">/dev/sdb1</code> ， <code class="literal">/dev/disk/by-uuid/05e99ec8-def1-4a5e-8a9d-5945339ceb2a</code> ，或<code class="literal">/dev/my-volgroup/my-lv</code> 。通常，默认选项对于大多数使用方案是最佳的。
							</p></li><li class="listitem"><p class="simpara">对于条带块设备（例如，RAID5阵列），可以在创建文件系统时指定条带几何。使用适当的条带几何可以增强ext4文件系统的性能。例如，要在4k块文件系统上创建具有64k步长（即16 x 4096）的文件系统，请使用以下命令：</p><pre class="screen"># mkfs.ext4 -E stride=16,stripe-width=64 /dev/<span class="emphasis"><em>block_device</em></span></pre><p class="simpara">在给定的示例中：</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">stride = value：指定RAID块大小</li><li class="listitem">stripe-width = value：指定RAID设备中的数据磁盘数，或条带中的条带单元数。
									</li></ul></div></li></ul></div><div class="note" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title">注意</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">在创建文件系统时指定UUID：</p><pre class="screen"># mkfs.ext4 -U <span class="emphasis"><em>UUID</em></span> /dev/<span class="emphasis"><em>block_device</em></span></pre><p class="simpara">将<span class="emphasis"><em>UUID</em></span>替换为您要设置的UUID：例如， <code class="literal">7cd65de3-e0be-41d9-b66d-96d749c02da7</code> 。
								</p><p class="simpara">将/ dev / <span class="emphasis"><em>block_device</em></span>替换为ext4文件系统的路径以将UUID添加到其中：例如， <code class="literal">/dev/sda8</code> 。
								</p></li><li class="listitem"><p class="simpara">在创建文件系统时指定标签：</p><pre class="screen"># mkfs.ext4 -L <span class="emphasis"><em>label-name</em></span> /dev/<span class="emphasis"><em>block_device</em></span></pre></li></ul></div></div></li><li class="listitem"><p class="simpara">要查看创建的ext4文件系统：</p><pre class="screen"># blkid</pre></li></ol></div><h3><a id="additional_resources_62"></a>其他资源</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><code class="literal">ext4</code>手册页。
					</li><li class="listitem"><code class="literal">mkfs.ext4</code>手册页。
					</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="mounting-an-ext-file-system_getting-started-with-an-ext4-file-system"></a>挂载ext4文件系统</h1></div></div></div><p>作为系统管理员，您可以使用<code class="literal">mount</code>实用程序安装ext4文件系统。
			</p><h3><a id="prerequisites_33"></a>先决条件</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">一个ext4文件系统。有关创建ext4文件系统的信息，请参阅<a class="xref" href="getting-started-with-an-ext4-file-system_managing-file-systems.html#creating-an-ext-file-system_getting-started-with-an-ext4-file-system" title="创建ext4文件系统">“创建ext4文件系统”一节</a> 。
					</li></ul></div><h3><a id="procedure_63"></a>程序</h3><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">要创建装入点以装入文件系统：</p><pre class="screen"># mkdir <span class="emphasis"><em>/mount/point</em></span></pre><p class="simpara">用必须创建分区的挂载点的目录名替换<span class="emphasis"><em>/ mount / point</em></span> 。
					</p></li><li class="listitem"><p class="simpara">要挂载ext4文件系统：</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">要安装没有额外选项的ext4文件系统：</p><pre class="screen"># mount /dev/<span class="emphasis"><em>block_device /mount/point</em></span></pre></li><li class="listitem">要永久挂载文件系统，请参阅<a class="xref" href="assembly_mounting-file-systems_managing-file-systems.html#assembly_persistently-mounting-file-systems_assembly_mounting-file-systems" title="持久安装文件系统">“永久挂载文件系统”一节</a> 。
							</li></ul></div></li><li class="listitem"><p class="simpara">要查看已安装的文件系统：</p><pre class="screen"># df -h</pre></li></ol></div><h3><a id="additional_resources_63"></a>其他资源</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><code class="literal">mount</code>手册页。
					</li><li class="listitem"><code class="literal">ext4</code>手册页。
					</li><li class="listitem"><code class="literal">fstab</code>手册页。
					</li><li class="listitem">
						<a class="xref" href="assembly_mounting-file-systems_managing-file-systems.html" title="Chapter 9. 挂载文件系统">第9章， <em>挂载文件系统</em></a>
					</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="resizing-an-ext-file-system_getting-started-with-an-ext4-file-system"></a>调整ext4文件系统的大小</h1></div></div></div><p>作为系统管理员，您可以使用<code class="literal">resize2fs</code>实用程序调整ext4文件系统的大小。<code class="literal">resize2fs</code>实用程序以文件系统块大小为单位读取大小，除非使用指示特定单元的后缀。以下后缀表示具体单位：</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">s（扇区） - <code class="literal">512</code>字节扇区</li><li class="listitem">K（千字节） - <code class="literal">1,024</code>字节</li><li class="listitem">M（兆字节） - <code class="literal">1,048,576</code>字节</li><li class="listitem">G（千兆字节） - <code class="literal">1,073,741,824</code>字节</li><li class="listitem">T（兆兆字节） - <code class="literal">1,099,511,627,776</code>字节</li></ul></div><h3><a id="prerequisites_34"></a>先决条件</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">一个ext4文件系统。有关创建ext4文件系统的信息，请参阅<a class="xref" href="getting-started-with-an-ext4-file-system_managing-file-systems.html#creating-an-ext-file-system_getting-started-with-an-ext4-file-system" title="创建ext4文件系统">“创建ext4文件系统”一节</a> 。
					</li><li class="listitem">适当大小的基础块设备，用于在调整大小后保存文件系统。
					</li></ul></div><h3><a id="procedure_64"></a>程序</h3><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">要调整ext4文件系统的大小，请执行以下步骤：</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">要缩小和增大未安装的ext4文件系统的大小：</p><pre class="screen"># umount /dev/<span class="emphasis"><em>block_device</em></span>
# e2fsck -f /dev/<span class="emphasis"><em>block_device</em></span>
# resize2fs /dev/<span class="emphasis"><em>block_device</em></span> <span class="emphasis"><em>size</em></span></pre><p class="simpara">将<span class="emphasis"><em>/ dev / block_device</em></span>替换为块设备的路径，例如<code class="literal">/dev/sdb1</code> 。
							</p><p class="simpara">使用<code class="literal">s</code> ， <code class="literal">K</code> ， <code class="literal">M</code> ， <code class="literal">G</code>和<code class="literal">T</code>后缀将<span class="emphasis"><em>大小</em></span>替换为所需的调整大小值。
							</p></li><li class="listitem"><p class="simpara">使用<code class="literal">resize2fs</code>命令挂载时可以生成ext4文件系统：</p><pre class="screen"># resize2fs <span class="emphasis"><em>/mount/device size</em></span></pre><div class="note" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title">注意</h3><p>扩展时，size参数是可选的（通常是冗余的）。<code class="literal">resize2fs</code>自动扩展以填充容器的可用空间，通常是逻辑卷或分区。
								</p></div></li></ul></div></li><li class="listitem"><p class="simpara">要查看已调整大小的文件系统：</p><pre class="screen"># df -h</pre></li></ol></div><h3><a id="additional_resources_64"></a>其他资源</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><code class="literal">resize2fs</code>手册页。
					</li><li class="listitem"><code class="literal">e2fsck</code>手册页。
					</li><li class="listitem"><code class="literal">ext4</code>手册页。
					</li></ul></div></div></div></body></html>