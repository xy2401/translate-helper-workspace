<html  xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 9. nftables入门</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"></head><body ><div class="chapter"><div class="titlepage"><div><div><h1 class="title">Chapter 9. nftables入门</h1></div></div></div><p><code class="literal">nftables</code>框架使管理员能够配置Linux内核防火墙使用的数据包过滤规则。
		</p><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="introduction-to-nftables_getting-started-with-nftables"></a> nftables介绍</h1></div></div></div><p><code class="literal">nftables</code>框架提供了数据包分类工具，它是<code class="literal">iptables</code> ， <code class="literal">ip6tables</code> ， <code class="literal">arptables</code>和<code class="literal">ebtables</code>工具的指定后继者。与以前的数据包过滤工具相比，它在方便性，功能和性能方面提供了许多改进，最值得注意的是：</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">查找表而不是线性处理</li><li class="listitem"><code class="literal">IPv4</code>和<code class="literal">IPv6</code>协议的单一框架</li><li class="listitem">所有规则都以原子方式应用，而不是获取，更新和存储完整的规则集</li><li class="listitem">支持在规则集（ <code class="literal">nftrace</code> ）中调试和跟踪以及监视跟踪事件（在<code class="literal">nft</code>工具中）</li><li class="listitem">更一致和紧凑的语法，没有特定于协议的扩展</li><li class="listitem">适用于第三方应用程序的Netlink API</li></ul></div><p>与<code class="literal">iptables</code>类似， <code class="literal">nftables</code>使用表来存储链。链包含执行操作的单独规则。<code class="literal">nft</code>工具取代了之前的数据包过滤框架中的所有工具。所述<code class="literal">libnftnl</code>库可以被用于具有低级别的相互作用<code class="literal">nftables</code>在网络链路API <code class="literal">libmnl</code>库。
			</p><p>在RHEL 8中， <code class="literal">nftables</code>用作默认的<code class="literal">firewalld</code>后端。虽然<code class="literal">nftables</code>后端与防火墙配置中的先前<code class="literal">iptables</code>后端向后兼容，但您可以通过将<code class="literal">FirewallBackend</code>选项设置为<code class="literal">/etc/firewalld/firewalld.conf</code>文件中的<code class="literal">iptables</code>值来切换回<code class="literal">iptables</code> 。
			</p><p>在模块的效果<code class="literal">nftables</code>可以使用可观察到规则集<code class="literal">nft</code>列表的规则集的命令。由于这些工具将表，链和规则添加到<code class="literal">nftables</code>规则集，请注意<code class="literal">nftables</code>规则集操作（例如<code class="literal">nftables</code> <code class="literal">nft flush ruleset</code>命令）可能会影响使用以前单独的旧命令安装的规则集。
			</p><p>要快速识别工具的哪个变体，版本信息已更新为包含后端名称。在RHEL 8中，基于nftables的<code class="literal">iptables</code>工具打印以下版本字符串：</p><pre class="screen">$ iptables --version
iptables v1.8.0 (nf_tables)</pre><p>为了进行比较，如果存在legacy iptables工具，则会打印以下版本信息：</p><pre class="screen">$ iptables --version
iptables v1.8.0 (legacy)</pre><h3><a id="additional_resources_35"></a>其他资源</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">在<code class="literal">nft(8)</code>手册页提供了用于配置并检查数据包使用所述nftables滤波的综合参考文档<code class="literal">nft</code>命令行工具。
					</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="converting-iptables-to-nftables_getting-started-with-nftables"></a>将iptables转换为nftables</h1></div></div></div><p>Red Hat Enterprise Linux 8提供<code class="literal">iptables-translate</code>和<code class="literal">ip6tables-translate</code>工具，将现有的<code class="literal">iptables</code>或<code class="literal">ip6tables</code>规则转换为<code class="literal">nftables</code>的等效规则。
			</p><p>请注意，某些扩展缺少翻译支持。如果存在这样的扩展名，该工具将打印带有<code class="literal">#</code>符号前缀的未翻译规则。例如：</p><pre class="screen">| % iptables-translate -A INPUT -j CHECKSUM --checksum-fill
| nft # -A INPUT -j CHECKSUM --checksum-fill</pre><p>此外，用户可以使用<code class="literal">iptables-restore-translate</code>和<code class="literal">ip6tables-restore-translate</code>工具来转换规则转储。请注意，在此之前，用户可以使用<code class="literal">iptables-save</code>或<code class="literal">ip6tables-save</code>命令打印当前规则的转储。例如：</p><pre class="screen">| % sudo iptables-save &gt;/tmp/iptables.dump
| % iptables-restore-translate -f /tmp/iptables.dump
| # Translated by iptables-restore-translate v1.8.0 on Wed Oct 17 17:00:13 2018
| add table ip nat
| ...</pre><p>有关更多信息以及可能的选项和值列表，请输入<code class="literal">iptables-translate --help</code>命令。
			</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="related-information-getting-started-with-nftables"></a>相关信息</h1></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><a class="link" href="https://developers.redhat.com/blog/2016/10/28/what-comes-after-iptables-its-successor-of-course-nftables/">iptables之后会发生什么？它的继任者当然是：nftables</a>文章解释了为什么<code class="literal">nftables</code>取代了<code class="literal">iptables</code> 。
					</li><li class="listitem"><a class="link" href="https://developers.redhat.com/blog/2018/08/10/firewalld-the-future-is-nftables/">Firewalld：The Future是nftables</a>文章提供了关于<code class="literal">nftables</code>额外信息，作为<code class="literal">firewalld</code>的默认后端。
					</li></ul></div></div></div></body></html>