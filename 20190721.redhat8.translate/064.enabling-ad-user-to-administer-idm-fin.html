<html  xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 9. 允许AD用户管理IdM</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"></head><body ><div class="chapter"><div class="titlepage"><div><div><h1 class="title">Chapter 9. 允许AD用户管理IdM</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idoverrides-to-allow-ad-user-to-administer-idm-fin"></a> AD用户的ID覆盖</h1></div></div></div><p>在Red Hat Enterprise Linux（RHEL）7中，外部组成员资格允许AD用户和组在系统安全服务守护程序（SSSD）的帮助下访问POSIX环境中的IdM资源。
			</p><p>IdM LDAP服务器有自己的机制来授予访问控制权。RHEL 8引入了一个更新，允许为AD用户添加ID用户覆盖，作为IdM组的成员。ID覆盖是描述特定ID视图中特定Active Directory用户或组属性应该是什么样的记录，在本例中为默认信任视图。作为更新的结果，IdM LDAP服务器能够将IdM组的访问控制规则应用于AD用户。
			</p><p>AD用户现在可以使用IdM UI的自助服务功能，例如上传他们的SSH密钥或更改他们的个人数据。AD管理员无需拥有两个不同的帐户和密码即可完全管理IdM。
			</p><div class="note" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title">注意</h3><p>目前，IDM中的所选功能可能仍然无法供AD用户使用。例如，从IdM <code class="literal">admins</code>组中将IdM用户的密码设置为AD用户可能会失败。
				</p></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="using-idoverrides-to-allow-ad-user-to-administer-idm-fin"></a>使用ID覆盖使AD用户能够管理IdM</h1></div></div></div><h3><a id="prerequisites_22"></a>先决条件</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">在您的IdM服务器上启用了<code class="literal">idm:DL1</code>流，您已切换到通过此流传递的RPM：</p><pre class="literallayout"># <span class="strong"><strong>yum module enable idm:DL1</strong></span>
# <span class="strong"><strong>yum distro-sync</strong></span></pre></li><li class="listitem"><p class="simpara"><code class="literal">idm:DL1/adtrust</code>配置文件安装在您的IdM服务器上。
					</p><pre class="literallayout"># <span class="strong"><strong>yum module install idm:DL1/adtrust</strong></span></pre><p class="simpara">该配置文件包含安装与Active Directory具有信任协议的IdM服务器所需的所有软件包，包括<code class="literal">ipa-idoverride-memberof</code>软件包。
					</p></li><li class="listitem">设置了一个有效的身份管理环境。有关详细信息，请参阅<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/installing_identity_management/index#installing-idm">安装Identity Management</a> 。
					</li><li class="listitem">已设置Identity Management环境与Active Directory之间的工作信任。
					</li></ul></div><h3><a id="procedure_31"></a>程序</h3><p>此过程描述了为Active Directory（AD）用户创建和使用ID覆盖，以使该用户权限与Identity Management（IdM）用户的权限相同。在此过程中，处理配置为信任控制器或信任代理的IdM服务器。有关信任控制器和信任代理的详细信息，请参阅<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/planning_identity_management_and_access_control/#trust-controllers-and-trust-agents_planning-a-cross-forest-trust-between-idm-and-ad">规划身份管理中的</a> <span class="emphasis"><em>信任</em></span> <span class="emphasis"><em>控制器</em></span> <span class="emphasis"><em>和</em></span> <span class="emphasis"><em>信任</em></span> <span class="emphasis"><em>代理</em></span> 。
			</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">作为IdM管理员，在“默认信任视图”中为AD用户创建ID覆盖。例如，要为<code class="literal">ad_user@ad.example.com</code>用户创建ID覆盖：</p><pre class="literallayout"># <span class="strong"><strong>kinit admin</strong></span>
# <span class="strong"><strong>ipa idoverrideuser-add 'default trust view' ad_user@ad.example.com</strong></span></pre></li><li class="listitem"><p class="simpara">将默认信任视图中的ID覆盖作为成员添加到IdM组。如果相关组是IdM角色的成员，则ID覆盖所代表的AD用户将获得使用IdM API时角色授予的所有权限，包括命令行界面和IdM Web UI。例如，要将<code class="literal">ad_user@ad.example.com</code>用户的ID覆盖添加到<code class="literal">admins</code>组：</p><pre class="literallayout"># <span class="strong"><strong>ipa group-add-member admins --idoverrideusers=ad_user@ad.example.com</strong></span></pre></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="using-idm-cli-as-ad-user-fin"></a>以AD用户身份管理IdM命令行界面（CLI）</h1></div></div></div><p>此过程检查Active Directory用户是否可以登录Identity Management CLI并运行适合其角色的命令。
			</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">销毁IdM管理员的当前Kerberos票证：</p><pre class="literallayout"># <span class="strong"><strong>kdestroy -A</strong></span></pre><div class="note" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title">注意</h3><p>需要销毁Kerberos票证，因为MIT Kerberos中的GSSAPI实现按优先级选择目标服务领域的凭据，在本例中为IdM领域。这意味着如果正在使用凭证缓存集合，即KCM：，KEYRING：或DIR：类型的凭证缓存，则将使用先前获得的<code class="literal">admin</code>或任何其他IdM委托人的凭据来访问IdM API而不是AD用户的凭据。
						</p></div></li><li class="listitem"><p class="simpara">获取已为其创建ID覆盖的AD用户的Kerberos凭据：</p><pre class="literallayout"># <span class="strong"><strong>kinit ad_user@AD.EXAMPLE.COM</strong></span>
<span class="strong"><strong>Password for ad_user@AD.EXAMPLE.COM:</strong></span></pre></li><li class="listitem"><p class="simpara">测试AD用户的ID覆盖享有与IdM组中的成员身份相同的权限，作为该组中的任何IdM用户。如果已将AD用户的ID覆盖添加到<code class="literal">admins</code>组，则AD用户可以在IdM中创建组：</p><pre class="literallayout"># <span class="strong"><strong>ipa group-add some-new-group</strong></span>
----------------------------
Added group "some-new-group"
----------------------------
  Group name: some-new-group
  GID: 1997000011</pre></li></ol></div></div></div></body></html>