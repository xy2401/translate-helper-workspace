<html  xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 9. IdM命令行实用程序简介</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"></head><body ><div class="chapter"><div class="titlepage"><div><div><h1 class="title">Chapter 9. IdM命令行实用程序简介</h1></div></div></div><p>以下部分介绍了使用Identity Management（IdM）命令行实用程序的基础知识。
		</p><h2><a id="prerequisites_2"></a>先决条件</h2><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">已安装且可访问的IdM服务器。
				</p><p class="simpara">有关详细信息，请参阅<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/installing_identity_management">安装Identity Management</a> 。
				</p></li><li class="listitem"><p class="simpara">要使用IPA命令行界面，请使用有效的Kerberos票证对IdM进行身份验证。
				</p><p class="simpara">有关获取有效Kerberos票证的详细信息，请参阅<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/configuring_and_managing_identity_management/index#logging-in-to-ipa-from-the-command-line_getting-started-using-identity-management">从命令行登录Identity Management</a> 。
				</p></li></ul></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="what-is-the-ipa-command-line-interface_introduction-to-the-ipa-command-line-utilities"></a>什么是IPA命令行界面</h1></div></div></div><p>IPA命令行界面（CLI）是身份管理（IdM）管理的基本命令行界面。
			</p><p>它支持许多用于管理IdM的子命令，例如用于添加新用户的<code class="literal">ipa user-add</code>命令。
			</p><p>IPA CLI允许您：</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">添加，管理或删除网络中的用户，组，主机和其他对象。
					</li><li class="listitem">管理证书。
					</li><li class="listitem">搜索条目。
					</li><li class="listitem">显示和列出对象。
					</li><li class="listitem">设置访问权限。
					</li><li class="listitem">获取有关正确命令语法的帮助。
					</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="what-is-the-ipa-help_introduction-to-the-ipa-command-line-utilities"></a>什么是IPA帮助</h1></div></div></div><p>IPA帮助是IdM服务器的内置文档系统。
			</p><p>IPA命令行界面（CLI）从加载的IdM插件模块生成可用的帮助主题。如果要成功运行IPA帮助，则需要：</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">安装并运行IdM服务器。
					</li></ul></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">使用有效的Kerberos票证进行身份验证。
					</li></ul></div><p>执行不带选项的<code class="literal">ipa help</code>命令会显示有关基本帮助用法和最常用命令示例的信息。
			</p><p>使用选项执行帮助具有以下语法：</p><pre class="literallayout"><span class="strong"><strong>$ ipa help [TOPIC | COMMAND | topics | commands]</strong></span></pre><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						<code class="literal"><span class="strong"><strong>[]</strong></span></code> - 括号表示所有参数都是可选的，您只需编写<code class="literal">ipa help</code>执行该命令。
					</li><li class="listitem">
						<code class="literal"><span class="strong"><strong>|</strong></span></code> - 管道字符表示<span class="strong"><strong>或</strong></span> 。因此，您可以使用基本<code class="literal">ipa help</code>命令使用TOPIC或COMMAND或主题或命令。
					</li><li class="listitem">
						<code class="literal"><span class="strong"><strong>topics</strong></span></code> - 您可以运行命令<code class="literal">ipa help topics</code> ，它将正确执行。该命令显示IPA帮助涵盖的主题列表，例如， <code class="literal">user</code> ， <code class="literal">cert</code> ， <code class="literal">server</code>和许多其他主题。
					</li><li class="listitem">
						<code class="literal"><span class="strong"><strong>TOPIC</strong></span></code> - 带有大写字母的<span class="strong"><strong>TOPIC</strong></span>意味着变量，因此，您可以使用特定主题，例如， <code class="literal">ipa help user</code>
					</li><li class="listitem">
						<code class="literal"><span class="strong"><strong>commands</strong></span></code> - 您可以运行命令<code class="literal">ipa help commands</code> ，它将正确执行。该命令显示IPA帮助所涵盖的命令列表，例如， <code class="literal">user-add</code> ， <code class="literal">ca-enable</code> ， <code class="literal">server-show</code>等等。
					</li><li class="listitem">
						<code class="literal"><span class="strong"><strong>COMMAND</strong></span></code> - 带大写字母的<span class="strong"><strong>COMMAND</strong></span>表示变量，因此，您可以使用特定命令，例如， <code class="literal">ipa help user-add</code>
					</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="using-ipa-help-topics_introduction-to-the-ipa-command-line-utilities"></a>使用IPA帮助主题</h1></div></div></div><p>以下过程可帮助您了解如何在命令行界面中使用IPA帮助。
			</p><h3><a id="procedure_4"></a>程序</h3><div class="orderedlist"><ol class="orderedlist"><li class="listitem">打开终端并连接到IdM服务器。
					</li><li class="listitem"><p class="simpara">输入<code class="literal">ipa help topics</code>以显示帮助所涵盖的主题列表。
					</p><pre class="literallayout">$ <span class="strong"><strong>ipa help topics</strong></span></pre></li><li class="listitem"><p class="simpara">选择其中一个主题并根据以下模式创建命令： <code class="literal">ipa help [topic_name]</code> ，而不是<code class="literal">topic_name</code>字符串，添加您在上一步中列出的主题之一。
					</p><p class="simpara">在该示例中，我们使用以下主题： <code class="literal">user</code>
					</p><pre class="literallayout">$ <span class="strong"><strong>ipa help user</strong></span></pre></li><li class="listitem"><p class="simpara">如果IPA帮助命令太长而您看不到整个文本，请使用以下语法：</p><pre class="literallayout">$ <span class="strong"><strong>ipa help user | less</strong></span></pre><p class="simpara">然后，您可以向下滚动并阅读整个帮助。
					</p></li></ol></div><p>IPA CLI显示<code class="literal">user</code>主题的帮助页面。阅读概述后，您可以看到许多带有使用主题命令的模式的示例。
			</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="using-ipa-help-commands_introduction-to-the-ipa-command-line-utilities"></a>使用IPA帮助命令</h1></div></div></div><p>以下过程可帮助您了解在命令行界面中创建IPA帮助命令。
			</p><h3><a id="procedure_5"></a>程序</h3><div class="orderedlist"><ol class="orderedlist"><li class="listitem">打开终端并连接到IdM服务器。
					</li><li class="listitem"><p class="simpara">输入<code class="literal">ipa help commands</code>以显示帮助所涵盖的命令列表。
					</p><pre class="literallayout">$ <span class="strong"><strong>ipa help commands</strong></span></pre></li><li class="listitem"><p class="simpara">选择其中一个命令并根据以下模式创建帮助命令： <code class="literal">ipa help &lt;COMMAND&gt;</code> ，而不是<code class="literal">&lt;COMMAND&gt;</code>字符串，添加您在上一步中列出的命令之一。
					</p><pre class="literallayout">$ <span class="strong"><strong>ipa help user-add</strong></span></pre></li></ol></div><h3><a id="additional_resources_2"></a>其他资源</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">有关详细信息，请参阅<code class="literal">man ipa</code>页面。
					</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="the-structure-of-ipa-commands_introduction-to-the-ipa-command-line-utilities"></a> IPA命令的结构</h1></div></div></div><p>IPA CLI区分以下类型的命令：</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">内置命令 - 内置命令在IdM服务器中都可用。
					</li><li class="listitem">插件提供了命令</li></ul></div><p>IPA命令的结构允许您管理各种类型的对象。例如：</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">用户，</li><li class="listitem">主机，</li><li class="listitem">DNS记录，</li><li class="listitem">证书，</li></ul></div><p>和许多其他人。
			</p><p>对于大多数这些对象，IPA CLI包含以下命令：</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">添加（ <code class="literal">add</code> ）</li><li class="listitem">修改（ <code class="literal">mod</code> ）</li><li class="listitem">删除（ <code class="literal">del</code> ）</li><li class="listitem">搜索（ <code class="literal">find</code> ）</li><li class="listitem">显示（ <code class="literal">show</code> ）</li></ul></div><p>命令具有以下结构：</p><p>
				<code class="literal">ipa user-add</code> ， <code class="literal">ipa user-mod</code> ， <code class="literal">ipa user-del</code> ， <code class="literal">ipa user-find</code> ， <code class="literal">ipa user-show</code>
			</p><p>
				<code class="literal">ipa host-add</code> ， <code class="literal">ipa host-mod</code> ， <code class="literal">ipa host-del</code> ， <code class="literal">ipa host-find</code> ， <code class="literal">ipa host-show</code>
			</p><p>
				<code class="literal">ipa dnsrecord-add</code> ， <code class="literal">ipa dnsrecord-mod</code> ， <code class="literal">ipa dnsrecord-del</code> ， <code class="literal">ipa dnsrecord-find</code> ， <code class="literal">ipa dnrecord-show</code>
			</p><p>您可以使用<code class="literal">ipa user-add [options]</code>创建用户，其中<code class="literal">[options]</code>是可选的。如果仅使用<code class="literal">ipa user-add</code>命令，脚本会逐个询问您的详细信息。
			</p><p>要更改现有对象，需要定义对象，因此该命令还包括object： <code class="literal">ipa user-mod USER_NAME [options]</code> 。
			</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="using-an-ipa-command-to-add-a-user-account-to-idm_introduction-to-the-ipa-command-line-utilities"></a>使用IPA命令将用户帐户添加到IdM</h1></div></div></div><p>以下介绍如何使用命令行将新用户添加到Identity Management数据库。
			</p><h3><a id="prerequisites_3"></a>先决条件</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">您需要具有管理员权限才能将用户帐户添加到IdM服务器。
					</li></ul></div><h3><a id="procedure_6"></a>程序</h3><div class="orderedlist"><ol class="orderedlist"><li class="listitem">打开终端并连接到IdM服务器。
					</li><li class="listitem"><p class="simpara">输入添加新用户的命令：</p><pre class="literallayout">$ <span class="strong"><strong>ipa user-add</strong></span></pre><p class="simpara">该命令运行一个脚本，您可以在其中添加创建用户帐户所需的基本数据。
					</p></li><li class="listitem">在<span class="strong"><strong>名字：</strong></span>字段中，输入新用户的名字，然后按<span class="strong"><strong>Enter</strong></span>键。
					</li><li class="listitem">在<span class="strong"><strong>姓氏：</strong></span>字段中，输入新用户的姓氏，然后按<span class="strong"><strong>Enter</strong></span>键。
					</li><li class="listitem"><p class="simpara">在<span class="strong"><strong>用户登录[建议的用户名]：</strong></span>输入用户名或只需按<span class="strong"><strong>Enter</strong></span>键，如果建议的用户名适合您。
					</p><p class="simpara">用户名对于整个IdM数据库必须是唯一的。如果发生错误，用户已经存在，则需要从头开始使用<code class="literal">ipa user-add</code>命令并尝试使用其他用户名。
					</p></li></ol></div><p>成功添加用户名后，用户帐户已添加到IdM数据库，IPA CLI在输出上打印以下日志：</p><pre class="literallayout">----------------------
Added user "euser"
----------------------
User login: euser
First name: Example
Last name: User
Full name: Example User
Display name: Example User
Initials: EU
Home directory: /home/euser
GECOS: Example User
Login shell: /bin/sh
Principal name: euser@IDM.EXAMPLE.COM
Principal alias: euser@IDM.EXAMPLE.COM
Email address: euser@idm.example.com
UID: 427200006
GID: 427200006
<span class="strong"><strong>Password: False</strong></span>
Member of groups: ipausers
<span class="strong"><strong>Kerberos keys available: False</strong></span></pre><p>如您所见，用户密码未设置为用户帐户。如果要添加密码，请使用以下语法中的<code class="literal">ipa user-add</code>命令：</p><pre class="literallayout">$ <span class="strong"><strong>ipa user-add --first=Example --last=User --password</strong></span></pre><p>然后，IPA CLI会要求您添加或确认用户名和密码。
			</p><p>如果用户已经创建，则只能使用`ipa user-mod`命令添加密码。
			</p><h3><a id="additional_resources_3"></a>其他资源</h3><p>有关参数的更多信息，请在命令行中输入以下help命令：</p><pre class="literallayout">$ <span class="strong"><strong>ipa help user-add</strong></span></pre></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="using-an-ipa-command-to-modify-a-user-account-in-idm_introduction-to-the-ipa-command-line-utilities"></a>使用IPA命令修改IdM中的用户帐户</h1></div></div></div><p>您可以为每个用户帐户更改许多参数。例如，您可以向用户添加新密码。
			</p><p>基本命令语法与<code class="literal">user-add</code>语法不同，因为您需要定义要对其执行更改的现有用户帐户，例如，添加密码。
			</p><h3><a id="prerequisites_4"></a>先决条件</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">您需要具有管理员权限才能修改IdM服务器中的用户帐户。
					</li></ul></div><h3><a id="procedure_7"></a>程序</h3><div class="orderedlist"><ol class="orderedlist"><li class="listitem">打开终端并连接到IdM服务器。
					</li><li class="listitem"><p class="simpara">输入添加密码的命令：</p><pre class="literallayout">$ <span class="strong"><strong>ipa user-mod euser --password</strong></span></pre><p class="simpara">该命令运行一个脚本，您可以在其中添加新密码。
					</p></li><li class="listitem">输入新密码，然后按<span class="strong"><strong>Enter</strong></span>键。
					</li></ol></div><p>成功添加用户名后，用户帐户已添加到IdM数据库，IPA CLI在输出上打印以下日志：</p><pre class="literallayout">----------------------
Modified user "euser"
----------------------
User login: euser
First name: Example
Last name: User
Home directory: /home/euser
Principal name: euser@IDM.EXAMPLE.COM
Principal alias: euser@IDM.EXAMPLE.COM
Email address: euser@idm.example.com
UID: 427200006
GID: 427200006
<span class="strong"><strong>Password: True</strong></span>
Member of groups: ipausers
<span class="strong"><strong>Kerberos keys available: True</strong></span></pre><p>现在为帐户设置了用户密码，用户可以登录IdM。</p><h3><a id="additional_resources_4"></a>其他资源</h3><p>有关参数的更多信息，请在命令行中输入以下help命令：</p><pre class="literallayout">$ <span class="strong"><strong>ipa help user-mod</strong></span></pre></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="how-to-supply-a-list-of-values-to-the-ipa-utilities_introduction-to-the-ipa-command-line-utilities"></a>如何为IdM实用程序提供值列表</h1></div></div></div><p>身份管理（IdM）将多值属性的值存储在列表中。
			</p><p>IdM支持以下提供多值列表的方法：</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">在同一命令调用中多次使用相同的命令行参数：</p><pre class="literallayout">$ <span class="strong"><strong>ipa permission-add <span class="emphasis"><em>--right=read --permissions=write --permissions=delete ...</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">或者，您可以将列表括在大括号中，在这种情况下，shell执行扩展：</p><pre class="literallayout">$ <span class="strong"><strong>ipa permission-add <span class="emphasis"><em>--right={read,write,delete} ...</em></span></strong></span></pre></li></ul></div><p>上面的示例显示了一个命令<code class="literal"><span class="strong"><strong>permission-add</strong></span></code> ，它为对象<code class="literal"><span class="strong"><strong>permission-add</strong></span></code>了权限。该示例中未提及该对象。而不是<code class="literal"><span class="strong"><strong>…​</strong></span></code>你需要添加您要添加的权限的对象。
			</p><p>从命令行更新此类多值属性时，IdM会使用新列表完全覆盖以前的值列表。因此，在更新多值属性时，必须指定整个新列表，而不仅仅是要添加的单个值。
			</p><p>在上面的命令中，权限列表包括读取，写入和删除。当您决定使用<code class="literal"><span class="strong"><strong>permission-mod</strong></span></code>命令更新列表时，必须添加所有值，否则将删除未提及的值。
			</p><p>
				<span class="strong"><strong>示例1：</strong></span> - <code class="literal"><span class="strong"><strong>ipa permission-mod</strong></span></code>命令更新以前添加的所有权限。
			</p><pre class="literallayout">$ <span class="strong"><strong>ipa permission-mod <span class="emphasis"><em>--right=read --right=write --right=delete ...</em></span></strong></span></pre><p>要么</p><pre class="literallayout">$ <span class="strong"><strong>ipa permission-mod <span class="emphasis"><em>--right={read,write,delete} ...</em></span></strong></span></pre><p>
				<span class="strong"><strong>示例2</strong></span> - <code class="literal"><span class="strong"><strong>ipa permission-mod</strong></span></code>命令删除<code class="literal"><span class="strong"><strong>--right=delete</strong></span></code>参数，因为它不包含在命令中：</p><pre class="literallayout">$ <span class="strong"><strong>ipa permission-mod <span class="emphasis"><em>--right=read --right=write ...</em></span></strong></span></pre><p>要么</p><pre class="literallayout">$ <span class="strong"><strong>ipa permission-mod <span class="emphasis"><em>--right={read,write} ...</em></span></strong></span></pre></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="how-to-use-special-characters-with-the-ipa-utilities_introduction-to-the-ipa-command-line-utilities"></a>如何在IdM实用程序中使用特殊字符</h1></div></div></div><p>将包含特殊字符的命令行参数传递给<code class="literal">ipa</code>命令时，请使用反斜杠（\）转义这些字符。例如，常见的特殊字符包括尖括号（&lt;和&gt;），和号（＆），星号（*）或竖线（|）。
			</p><p>例如，要转义星号（*）：</p><pre class="literallayout">$ <span class="strong"><strong>ipa certprofile-show certificate_profile --out=<span class="emphasis"><em>exported\*profile.cfg</em></span></strong></span></pre><p>包含未转义的特殊字符的命令无法按预期工作，因为shell无法正确解析此类字符。
			</p></div></div></body></html>