<html  xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 9. 管理Application Stream内容的版本</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"></head><body ><div class="chapter"><div class="titlepage"><div><div><h1 class="title">Chapter 9. 管理Application Stream内容的版本</h1></div></div></div><p>AppStream存储库中的内容可以在多个版本中提供，对应于模块流。本章介绍了在以仅以启用新模块流的其他方式更改启用的模块流时需要执行的操作。
		</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
					<a class="xref" href="managing-versions-of-appstream-content_using-appstream.html#modular-dependencies-and-stream-changes_managing-versions-of-appstream-content" title="模块化依赖关系和流更改">“模块化依赖关系和流更改”一节</a>描述了模块化依赖关系规则。
				</li><li class="listitem">
					<a class="xref" href="managing-versions-of-appstream-content_using-appstream.html#interaction-of-modular-and-non-modular-dependencies_managing-versions-of-appstream-content" title="模块化和非模块化依赖关系的交互">“模块化和非模块化依赖关系的交互”一节</a>提供了有关模块流的依赖关系如何影响包依赖关系的详细信息。
				</li><li class="listitem">
					<a class="xref" href="managing-versions-of-appstream-content_using-appstream.html#resetting-module-streams_managing-versions-of-appstream-content" title="重置模块流">“重置模块流”一节</a>提供了将模块重置为初始状态的步骤。
				</li><li class="listitem">
					<a class="xref" href="managing-versions-of-appstream-content_using-appstream.html#disabling-all-streams-of-a-module_managing-versions-of-appstream-content" title="禁用模块的所有流">“禁用模块的所有流”一节</a>提供了完全禁用模块及其所有流的步骤。
				</li><li class="listitem">
					<a class="xref" href="managing-versions-of-appstream-content_using-appstream.html#switching-module-streams-to-install-a-different-version-of-content_managing-versions-of-appstream-content" title="切换模块流以安装不同版本的内容">“切换模块流以安装不同版本的内容”一节</a>描述了如何在已安装某些内容时通过切换模块的活动流来安装不同版本的内容。
				</li></ul></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="modular-dependencies-and-stream-changes_managing-versions-of-appstream-content"></a>模块化依赖关系和流更改</h1></div></div></div><p>传统上，提供内容的包依赖于其他包，并且通常指定所需的依赖性版本。对于模块中包含的包，此机制也适用，但将包及其特定版本分组到模块和流中提供了进一步的约束。此外，模块流可以声明对其他模块的流的依赖性，而与它们包含和提供的包无关。
			</p><p>在对包或模块进行任何操作之后，所有底层安装包的整个依赖关系树必须满足包声明的所有条件。此外，必须满足所有模块流依赖性。
			</p><p>结果是：</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">启用模块流可能需要启用其他模块的流。
					</li><li class="listitem">安装模块流配置文件或从流安装软件包可能需要启用其他模块流并安装其他软件包。
					</li><li class="listitem">禁用模块流可能需要禁用其他模块流。不会自动删除任何包裹。
					</li><li class="listitem">删除包可能需要删除其他包。如果这些包由模块提供，则模块流保持启用状态以准备进一步安装，即使这些流中没有安装任何包也是如此。这反映了未使用的yum存储库的行为。
					</li></ul></div><p>当已启用相同模块的另一个流时，无法启用模块流。要切换流，必须先重置模块，然后启用新流。强烈建议在切换到不同的流之前删除从流中安装的所有软件包，因为它会阻止系统到达可以安装软件包而没有存储库或流提供它们的状态。
			</p><p>从技术上讲，重置模块不会自动更改任何已安装的软件包。删除上一个流提供的包以及依赖于它们的任何包是一个明确的手动操作。
			</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="interaction-of-modular-and-non-modular-dependencies_managing-versions-of-appstream-content"></a>模块化和非模块化依赖关系的交互</h1></div></div></div><p>
				<a class="link" href="managing-versions-of-appstream-content_using-appstream.html#modular-dependencies-and-stream-changes_managing-versions-of-appstream-content" title="模块化依赖关系和流更改">模块化依赖项</a>是常规RPM依赖项之上的附加层。模块化依赖关系的行为类似于存储库之间的假设依赖关系。这意味着安装不同的软件包不仅需要解析RPM依赖项，而且还必须事先解决模块化依赖项。
			</p><p>系统将始终保留模块和流选择，除非明确指示更改它们。模块化程序包将接收包含在当前启用的提供此程序包的模块流中的更新，但不会升级到包含在不同流中的版本。
			</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="resetting-module-streams_managing-versions-of-appstream-content"></a>重置模块流</h1></div></div></div><p>重置模块是一种将其所有流恢复到其初始状态的操作 - 既不启用也不禁用。如果模块具有默认流，则该流由于重置模块而变为活动状态。
			</p><div class="itemizedlist"><p class="title"><strong>程序</strong></p><ul class="itemizedlist"><li class="listitem"><p class="simpara">重置模块状态：</p><pre class="screen"># yum module reset <span class="emphasis"><em>module-name</em></span></pre><p class="simpara">模块的所有流都返回到初始状态。没有删除已安装的内容。
					</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="disabling-all-streams-of-a-module_managing-versions-of-appstream-content"></a>禁用模块的所有流</h1></div></div></div><p>具有默认流的模块将始终具有一个活动的流。在无法访问所有模块流的内容的情况下，可以禁用整个模块。
			</p><div class="itemizedlist"><p class="title"><strong>先决条件</strong></p><ul class="itemizedlist"><li class="listitem">您必须了解<a class="link" href="introduction-to-modules_using-appstream.html#module-streams_introduction-to-modules" title="Module streams"><span class="emphasis"><em>活动模块流</em></span></a>的<a class="link" href="introduction-to-modules_using-appstream.html#module-streams_introduction-to-modules" title="模块流">概念</a> 。
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>程序</strong></p><ul class="itemizedlist"><li class="listitem"><p class="simpara">禁用模块：</p><pre class="screen"># yum module disable <span class="emphasis"><em>module-name</em></span></pre><p class="simpara">
						<code class="literal">yum</code>要求确认，然后禁用模块及其所有流。所有模块流都变为非活动状态。没有删除已安装的内容。
					</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="switching-module-streams-to-install-a-different-version-of-content_managing-versions-of-appstream-content"></a>切换模块流以安装不同版本的内容</h1></div></div></div><p>切换到不同的模块流通常意味着将软件包升级或降级到与系统上安装的当前版本不同的版本。
			</p><p>该程序的一般意图是：</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">首先删除已安装的内容，</li><li class="listitem">然后更改启用的流，</li><li class="listitem">最后安装新内容。
					</li></ul></div><p>此序列减少了依赖性可能阻止您继续执行的操作量，而是将它们集中到几个步骤中。
			</p><div class="itemizedlist"><p class="title"><strong>先决条件</strong></p><ul class="itemizedlist"><li class="listitem">模块流必须处于活动状态，并且必须存在另一个模块流。
					</li><li class="listitem">您必须了解<a class="link" href="managing-versions-of-appstream-content_using-appstream.html#modular-dependencies-and-stream-changes_managing-versions-of-appstream-content" title="模块化依赖关系和流更改">模块化依赖项解析</a> 。
					</li><li class="listitem">记下您正在进行的更改，以便您可以撤消它们。
					</li><li class="listitem">请记住，程序包和模块化依赖项可能会阻止您完成此过程，就像程序包依赖项可以在以前版本的Red Hat Enterprise Linux中那样。
					</li></ul></div><div class="orderedlist"><p class="title"><strong>程序</strong></p><ol class="orderedlist"><li class="listitem"><p class="simpara">从当前活动的模块流及其依赖项中删除安装的内容：</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">列出从模块安装的软件包：</p><pre class="screen">$ yum module info <span class="emphasis"><em>module-name</em></span> | grep module+el8 | sed 's/.*: //g;s/\n/ /g' | xargs yum list installed</pre><p class="simpara">这将列出从此模块安装的所有软件包。
							</p></li><li class="listitem"><p class="simpara">删除上一步中列出的包：</p><pre class="screen"># yum remove <span class="emphasis"><em>package</em></span></pre><p class="simpara">使用上一步中列出的包替换<span class="emphasis"><em>包</em></span> 。您可以提供由空格分隔的多个包名称。
							</p><p class="simpara">包依赖关系可能会强制您删除依赖包。确保记下这些包，找到使用<code class="literal">yum module provides</code>命令<code class="literal">yum module provides</code>的<code class="literal">yum module provides</code> ，并保留列表以供后续步骤使用。
							</p></li><li class="listitem"><p class="simpara">将模块配置文件标记为已卸载：</p><pre class="screen"># yum module remove <span class="emphasis"><em>module-name</em></span></pre></li></ol></div></li><li class="listitem"><p class="simpara">重置模块及其流：</p><pre class="screen"># yum module reset <span class="emphasis"><em>module-name</em></span></pre></li><li class="listitem"><p class="simpara">启用新流并解决模块化依赖关系：</p><pre class="screen"># yum module enable <span class="emphasis"><em>module-name</em></span>:<span class="emphasis"><em>new-stream</em></span></pre><p class="simpara"><code class="literal">yum</code>工具将显示包和模块依赖关系所需更改的摘要，并要求确认。模块化依赖项可能会阻止您立即执行此操作。在这种情况下，递归地将此过程应用于其他模块流，或重置它们。要查找这些流，请参阅此步骤的命令输出以及您在步骤1中创建的列表。
					</p><p class="simpara">要继续此过程，您必须成功启用新流。如果组合的依赖项阻止您这样做，请还原您的更改：启用原始流并安装回包。
					</p></li><li class="listitem"><p class="simpara">从模块的新流安装内容。
					</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">从新流安装配置文件：</p><pre class="screen"># yum module install <span class="emphasis"><em>module-name</em></span>:<span class="emphasis"><em>new-stream</em></span>/<span class="emphasis"><em>profile</em></span></pre></li><li class="listitem"><p class="simpara">安装新流提供的各个包：</p><pre class="screen"># yum module install <span class="emphasis"><em>package</em></span></pre></li></ol></div></li></ol></div></div></div></body></html>