<html  xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 9. 控制LVM设备扫描</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"></head><body ><div class="chapter"><div class="titlepage"><div><div><h1 class="title">Chapter 9. 控制LVM设备扫描</h1></div></div></div><p>您可以通过在<code class="literal">/etc/lvm/lvm.conf</code>文件中配置过滤器来控制LVM设备扫描。<code class="literal">lvm.conf</code>文件中的过滤器由一系列简单的正则表达式组成，这些表达式应用于<code class="literal">/dev</code>目录中的设备名称，以决定是接受还是拒绝找到的每个块设备。
		</p><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="proc-controlling-device-scans-with-filters-device-scan"></a>配置过滤器以控制设备扫描</h1></div></div></div><p>以下示例显示了使用过滤器来控制LVM扫描的设备。请注意，其中一些示例不一定代表建议的做法，因为正则表达式与完整路径名自由匹配。例如， <code class="literal">a/loop/</code>等同于<code class="literal">a/.*loop.*/</code>并匹配<code class="literal">/dev/solooperation/lvol1</code> 。
			</p><p>以下过滤器添加了所有已发现的设备，这是默认行为，因为配置文件中未配置过滤器：</p><pre class="literallayout">filter = [ "a/.*/" ]</pre><p>以下过滤器删除了cdrom设备，以避免在驱动器不包含介质时出现延迟：</p><pre class="literallayout">filter = [ "r|/dev/cdrom|" ]</pre><p>以下过滤器添加所有循环并删除所有其他块设备：</p><pre class="literallayout">filter = [ "a/loop.*/", "r/.*/" ]</pre><p>以下过滤器添加所有循环和IDE并删除所有其他块设备：</p><pre class="literallayout">filter =[ "a|loop.*|", "a|/dev/hd.*|", "r|.*|" ]</pre><p>以下过滤器仅在第一个IDE驱动器上添加分区8，并删除所有其他块设备：</p><pre class="literallayout">filter = [ "a|^/dev/hda8$|", "r/.*/" ]</pre></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="proc-controlling-device-scans-filters-device-scan"></a>控制LVM命令是否扫描逻辑卷</h1></div></div></div><p>默认情况下，LVM命令不扫描系统上的逻辑卷。此默认行为具有以下优点：</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">如果系统上有许多活动逻辑卷，则每个LVM命令都需要额外的时间，从而对性能产生负面影响并导致不必要的延迟或超时。
					</li><li class="listitem">如果逻辑卷包含来宾VM映像中的物理卷，则主机通常不希望扫描或使用属于guest虚拟机的那些分层物理卷。但请注意，如果guest虚拟机的物理卷直接存在于主机可见的SCSI设备上，为了防止主机上的LVM访问这些物理卷，您需要配置过滤器，如<a class="link" href="assembly_device-scan-configuring-and-managing-logical-volumes.html#proc-controlling-device-scans-with-filters-device-scan" title="配置过滤器以控制设备扫描">配置中所述过滤器来控制设备扫描</a> 。
					</li></ul></div><p>当故意在逻辑卷之上分层物理卷时，可能需要扫描逻辑卷。这将允许<code class="literal">pvcreate</code>命令在逻辑卷上运行。要将LVM配置为扫描所有逻辑卷，请将<code class="literal">scan_lvs</code>文件中的<code class="literal">/etc/lvm/lvm.conf</code>配置选项设置为<code class="literal">scan_lvs=1</code> 。要限制LVM命令扫描哪些逻辑卷，您可以在<code class="literal">/etc/lvm/lvm.conf</code>配置文件中设置设备筛选器，如<a class="link" href="assembly_device-scan-configuring-and-managing-logical-volumes.html#proc-controlling-device-scans-with-filters-device-scan" title="配置过滤器以控制设备扫描">配置筛选器以控制设备扫描中所述</a> 。
			</p></div></div></body></html>