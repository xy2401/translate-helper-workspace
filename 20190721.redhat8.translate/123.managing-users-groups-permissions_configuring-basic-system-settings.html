<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 4. Managing user and group accounts and setting permissions on files</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="managing-users-groups-permissions_configuring-basic-system-settings"/>Chapter 4. Managing user and group accounts and setting permissions on files</h1></div></div></div><p>
			The control of users and groups is a core element of Red Hat Enterprise Linux system administration. This section explains how to add, manage, and delete users and groups in the graphical user interface and on the command line, and covers advanced topics, such as creating group directories.
		</p><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="user-groups-intro_managing-users-groups-permissions"/>Introduction to Users and Groups</h1></div></div></div><p>
				While users can be either people (meaning accounts tied to physical users) or accounts that exist for specific applications to use, groups are logical expressions of organization, tying users together for a common purpose. Users within a group share the same permissions to read, write, or execute files owned by that group.
			</p><p>
				Each user is associated with a unique numerical identification number called a <span class="emphasis"><em>user ID</em></span> (<span class="strong"><strong>UID</strong></span>). Likewise, each group is associated with a <span class="emphasis"><em>group ID</em></span> (<span class="strong"><strong>GID</strong></span>). A user who creates a file is also the owner and group owner of that file. The file is assigned separate read, write, and execute permissions for the owner, the group, and everyone else. The file owner can be changed only by <code class="literal">root</code>, and access permissions can be changed by both the <code class="literal">root</code> user and file owner.
			</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="users-groups-reserved-ids_managing-users-groups-permissions"/>Reserved user and group IDs</h1></div></div></div><p>
				Red Hat Enterprise Linux reserves user and group IDs below 1000 for system users and groups. By default, the <span class="strong"><strong><span class="application">User Manager</span></strong></span> does not display the system users. Reserved user and group IDs are documented in the <code class="literal">setup</code> package. To view the documentation, use this command:
			</p><pre class="literallayout">cat /usr/share/doc/setup*/uidgid</pre><p>
				The recommended practice is to assign IDs starting at 5,000 that were not already reserved, as the reserved range can increase in the future. To make the IDs assigned to new users by default start at 5,000, change the <code class="literal">UID_MIN</code> and <code class="literal">GID_MIN</code> directives in the <code class="literal">/etc/login.defs</code> file:
			</p><pre class="literallayout">[file contents truncated]
UID_MIN                  5000
[file contents truncated]
GID_MIN                  5000
[file contents truncated]</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
					For users created before you changed <code class="literal">UID_MIN</code> and <code class="literal">GID_MIN</code> directives, UIDs will still start at the default 1000.
				</p></div><p>
				Even with new user and group IDs beginning with 5,000, it is recommended not to raise IDs reserved by the system above 1000 to avoid conflict with systems that retain the 1000 limit.
			</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="user-private-groups_managing-users-groups-permissions"/>User private groups</h1></div></div></div><p>
				Red Hat Enterprise Linux uses a <span class="emphasis"><em>user private group</em></span> (<span class="emphasis"><em>UPG</em></span>) scheme, which makes UNIX groups easier to manage. A user private group is created whenever a new user is added to the system. It has the same name as the user for which it was created and that user is the only member of the user private group.
			</p><p>
				User private groups make it safe to set default permissions for a newly created file or directory, allowing both the user and <span class="strong"><strong>the group of that user</strong></span> to make modifications to the file or directory.
			</p><p>
				The setting which determines what permissions are applied to a newly created file or directory is called a <span class="emphasis"><em>umask</em></span> and is configured in the <code class="literal">/etc/bashrc</code> file. Traditionally on UNIX-based systems, the <code class="literal">umask</code> is set to <code class="literal">022</code>, which allows only the user who created the file or directory to make modifications. Under this scheme, all other users, <span class="strong"><strong>including members of the creator’s group</strong></span>, are not allowed to make any modifications. However, under the UPG scheme, this "group protection" is not necessary since every user has their own private group.
			</p><p>
				A list of all groups is stored in the <code class="literal">/etc/group</code> configuration file.
			</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="shadow-passwords_managing-users-groups-permissions"/>Shadow Passwords</h1></div></div></div><p>
				In environments with multiple users, it is very important to use <span class="emphasis"><em>shadow passwords</em></span> provided by the <code class="literal">shadow-utils</code> package to enhance the security of system authentication files. For this reason, the installation program enables shadow passwords by default.
			</p><p>
				The advantages of shadow passwords over the traditional way of storing passwords on UNIX-based systems are:
			</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						Shadow passwords improve system security by moving encrypted password hashes from the world-readable <code class="literal">/etc/passwd</code> file to <code class="literal">/etc/shadow</code>, which is readable only by the <code class="literal">root</code> user.
					</li><li class="listitem">
						Shadow passwords store information about password aging.
					</li><li class="listitem">
						Shadow passwords allow to enforce some of the security policies set in the <code class="literal">/etc/login.defs</code> file.
					</li></ul></div><p>
				Most utilities provided by the <code class="literal">shadow-utils</code> package work properly whether or not shadow passwords are enabled. However, since password aging information is stored exclusively in the <code class="literal">/etc/shadow</code> file, some utilities and commands do not work without first enabling shadow passwords:
			</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						The <code class="literal">chage</code> utility for setting password aging parameters.
					</li><li class="listitem">
						The <code class="literal">gpasswd</code> utility for administrating the <code class="literal">/etc/group</code> file.
					</li><li class="listitem">
						The <code class="literal">usermod</code> command with the <code class="literal">-e, --expiredate</code> or <code class="literal">-f, --inactive</code> option.
					</li><li class="listitem">
						The <code class="literal">useradd</code> command with the <code class="literal">-e, --expiredate</code> or <code class="literal">-f, --inactive</code> option.
					</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="managing-users-group-gui_managing-users-groups-permissions"/>Managing users in a graphical environment</h1></div></div></div><p>
				The <span class="strong"><strong><span class="application">Users</span></strong></span> utility allows you to view, modify, add, and delete local users in the graphical user interface.
			</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sec-redhat-config-users-list"/>Using the Users Settings tool</h2></div></div></div><p>
					Press the <span class="keycap"><strong>Super</strong></span> key to enter the Activities Overview, type <code class="literal">Users</code> and then press <span class="keycap"><strong>Enter</strong></span>. The <span class="strong"><strong><span class="application">Users</span></strong></span> settings tool appears. The <span class="keycap"><strong>Super</strong></span> key appears in a variety of options, depending on the keyboard and other hardware, but often as either the Windows or Command key, and typically to the left of the Space bar. Alternatively, you can open the <span class="strong"><strong><span class="application">Users</span></strong></span> utility from the Settings menu after clicking your user name in the top right corner of the screen.
				</p><p>
					To make changes to the user accounts, first select the <span class="keycap"><strong>Unlock</strong></span> button and authenticate yourself as indicated by the dialog box that appears. Note that unless you have superuser privileges, the application will prompt you to authenticate as <code class="literal">root</code>. To add and remove users, select the <span class="guibutton">+</span> and <span class="guibutton">-</span> button respectively. To add a user to the administrative group <code class="literal">wheel</code>, change the Account Type from <code class="literal">Standard</code> to <code class="literal">Administrator</code>. To edit a user’s language setting, select the language and a drop-down menu appears.
				</p><div class="figure"><a id="fig-managing-users"/><p class="title"><strong>Figure 4.1. The Users Settings Tool</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/managing_users.png" alt="managing users"/></div></div></div><p>
					When a new user is created, the account is disabled until a password is set. The Password drop-down menu, shown in <a class="xref" href="managing-users-groups-permissions_configuring-basic-system-settings.html#fig-managing-users-password" title="Figure 4.2. The Password Menu">Figure 4.2, “The Password Menu”</a>, contains the options to set a password by the administrator immediately, choose a password by the user at the first login, or create a guest account with no password required to log in. You can also disable or enable an account from this menu.
				</p><div class="figure"><a id="fig-managing-users-password"/><p class="title"><strong>Figure 4.2. The Password Menu</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/managing_users_password.png" alt="managing users password"/></div></div></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="managing-users-group-cli_managing-users-groups-permissions"/>Managing users using command-line tools</h1></div></div></div><p>
				Apart from the <span class="strong"><strong><span class="application">Users</span></strong></span> settings tool described in <a class="xref" href="managing-users-groups-permissions_configuring-basic-system-settings.html#sec-redhat-config-users-list" title="Using the Users Settings tool">the section called “Using the Users Settings tool”</a>, which is designed for basic managing of users, you can use command line tools for managing users and groups that are listed in the table below.
			</p><div class="table"><a id="table-users-tools"/><p class="title"><strong>Table 4.1. Command line utilities for managing users and groups</strong></p><div class="table-contents"><table summary="Command line utilities for managing users and groups" border="1"><colgroup><col class="col_1"/><col class="col_2"/></colgroup><thead><tr><th style="text-align: left" valign="top">Utilities</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
								<code class="literal">id</code>
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								Displays user and group IDs.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								<code class="literal">useradd</code>, <code class="literal">usermod</code>, <code class="literal">userdel</code>
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								Standard utilities for adding, modifying, and deleting user accounts.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								<code class="literal">groupadd</code>, <code class="literal">groupmod</code>, <code class="literal">groupdel</code>
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								Standard utilities for adding, modifying, and deleting groups.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								<code class="literal">gpasswd</code>
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								Utility primarily used for modification of group password in the <code class="literal">/etc/gshadow</code> file which is used by the <code class="literal">newgrp</code> command.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								<code class="literal">pwck</code>, <code class="literal">grpck</code>
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								Utilities that can be used for verification of the password, group, and associated shadow files.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								<code class="literal">pwconv</code>, <code class="literal">pwunconv</code>
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								Utilities that can be used for the conversion of passwords to shadow passwords, or back from shadow passwords to standard passwords.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								<code class="literal">grpconv</code>, <code class="literal">grpunconv</code>
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								Similar to the previous, these utilities can be used for conversion of shadowed information for group accounts.
							</p>
							 </td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sec-users-tools-users-add"/>Adding a new user</h2></div></div></div><p>
					To add a new user to the system, type the following at a shell prompt as <code class="literal">root</code>:
				</p><pre class="literallayout"><code class="literal">useradd</code> <span class="emphasis"><em>options</em></span> <span class="emphasis"><em>username</em></span></pre><p>
					Here <span class="emphasis"><em>options</em></span> are command-line options as described in <a class="xref" href="managing-users-groups-permissions_configuring-basic-system-settings.html#table-useradd-options" title="Table 4.2. Common useradd command-line options">Table 4.2, “Common useradd command-line options”</a>.
				</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>
						With RHEL 8, you cannot use all-numeric user names. The reason for not allowing such names is that this can confuse tools that work with user names and user ids, which are numbers.
					</p></div><p>
					By default, the <code class="literal">useradd</code> command creates a locked user account. To unlock the account, run the following command as <code class="literal">root</code> to assign a password:
				</p><pre class="literallayout"><code class="literal">passwd</code> <span class="emphasis"><em>username</em></span></pre><div class="table"><a id="table-useradd-options"/><p class="title"><strong>Table 4.2. Common useradd command-line options</strong></p><div class="table-contents"><table summary="Common useradd command-line options" border="1"><colgroup><col class="col_1"/><col class="col_2"/></colgroup><thead><tr><th style="text-align: left" valign="top">Option</th><th style="text-align: left" valign="top"> </th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
									<code class="literal">-c</code> '<span class="emphasis"><em>comment</em></span>'
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>comment</em></span> can be replaced with any string. This option is generally used to specify the full name of a user.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									<code class="literal">-d</code> <span class="emphasis"><em>home_directory</em></span>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Home directory to be used instead of default <code class="literal">/home/<span class="emphasis"><em>username</em></span>/</code>.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									<code class="literal">-e</code> <span class="emphasis"><em>date</em></span>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Date for the account to be disabled in the format YYYY-MM-DD.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									<code class="literal">-f</code> <span class="emphasis"><em>days</em></span>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Number of days after the password expires until the account is disabled. If <code class="literal">0</code> is specified, the account is disabled immediately after the password expires. If <code class="literal">-1</code> is specified, the account is not disabled after the password expires.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									<code class="literal">-g</code> <span class="emphasis"><em>group_name</em></span>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Group name or group number for the user’s default (primary) group. The group must exist prior to being specified here.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									<code class="literal">-G</code> <span class="emphasis"><em>group_list</em></span>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									List of additional (supplementary, other than default) group names or group numbers, separated by commas, of which the user is a member. The groups must exist prior to being specified here.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									<code class="literal">-m</code>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Create the home directory if it does not exist.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									<code class="literal">-M</code>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Do not create the home directory.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									<code class="literal">-N</code>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Do not create a user private group for the user.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									<code class="literal">-p</code> <span class="emphasis"><em>password</em></span>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									The password encrypted with <code class="literal">crypt</code>.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									<code class="literal">-r</code>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Create a system account with a UID less than 1000 and without a home directory.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									<code class="literal">-s</code>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									User’s login shell, which defaults to <code class="literal">/bin/bash</code>.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									<code class="literal">-u</code> <span class="emphasis"><em>uid</em></span>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									User ID for the user, which must be unique and greater than 999.
								</p>
								 </td></tr></tbody></table></div></div><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
						The default range of IDs for system and normal users has been changed in Red Hat Enterprise Linux 7 from earlier releases. Before Red Hat Enterprise Linux 7, UID 1-499 was used for system users and values above for normal users. The default range for system users is now 1-999. This change might cause problems when migrating to Red Hat Enterprise Linux 8 with existing users having UIDs and GIDs between 500 and 999. The default ranges of UID and GID can be changed in the <code class="literal">/etc/login.defs</code> file.
					</p></div><p>
					The following steps illustrate what happens if the command <code class="literal">useradd juan</code> is issued on a system that has shadow passwords enabled:
				</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">
							A new line for <code class="literal">juan</code> is created in <code class="literal">/etc/passwd</code>:
						</p><pre class="literallayout">juan:x:1001:1001::/home/juan:/bin/bash</pre><p class="simpara">
							The line has the following characteristics:
						</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
									It begins with the user name <code class="literal">juan</code>.
								</li><li class="listitem">
									There is an <code class="literal">x</code> for the password field indicating that the system is using shadow passwords.
								</li><li class="listitem">
									A UID greater than 999 is created. Under Red Hat Enterprise Linux 7, UIDs below 1000 are reserved for system use and should not be assigned to users.
								</li><li class="listitem">
									A GID greater than 999 is created. Under Red Hat Enterprise Linux 7, GIDs below 1000 are reserved for system use and should not be assigned to users.
								</li><li class="listitem">
									The optional <span class="emphasis"><em>GECOS</em></span> information is left blank. The GECOS field can be used to provide additional information about the user, such as their full name or phone number.
								</li><li class="listitem">
									The home directory for <code class="literal">juan</code> is set to <code class="literal">/home/juan/</code>.
								</li><li class="listitem">
									The default shell is set to <code class="literal">/bin/bash</code>.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							A new line for <code class="literal">juan</code> is created in <code class="literal">/etc/shadow</code>:
						</p><pre class="literallayout">juan:!!:14798:0:99999:7:::</pre><p class="simpara">
							The line has the following characteristics:
						</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
									It begins with the user name <code class="literal">juan</code>.
								</li><li class="listitem"><p class="simpara">
									Two exclamation marks (<code class="literal">!!</code>) appear in the password field of the <code class="literal">/etc/shadow</code> file, which locks the account.
								</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
										If an encrypted password is passed using the <code class="literal">-p</code> flag, it is placed in the <code class="literal">/etc/shadow</code> file on the new line for the user.
									</p></div></li><li class="listitem">
									The password is set to never expire.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							A new line for a group named <code class="literal">juan</code> is created in <code class="literal">/etc/group</code>:
						</p><pre class="literallayout">juan:x:1001:</pre><p class="simpara">
							A group with the same name as a user is called a <span class="emphasis"><em>user private group</em></span>. For more information on user private groups, see <a class="xref" href="managing-users-groups-permissions_configuring-basic-system-settings.html#user-private-groups_managing-users-groups-permissions" title="User private groups">the section called “User private groups”</a>.
						</p><p class="simpara">
							The line created in <code class="literal">/etc/group</code> has the following characteristics:
						</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
									It begins with the group name <code class="literal">juan</code>.
								</li><li class="listitem">
									An <code class="literal">x</code> appears in the password field indicating that the system is using shadow group passwords.
								</li><li class="listitem">
									The GID matches the one listed for <code class="literal">juan</code>'s primary group in <code class="literal">/etc/passwd</code>.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							A new line for a group named <code class="literal">juan</code> is created in <code class="literal">/etc/gshadow</code>:
						</p><pre class="literallayout">juan:!::</pre><p class="simpara">
							The line has the following characteristics:
						</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
									It begins with the group name <code class="literal">juan</code>.
								</li><li class="listitem">
									An exclamation mark (<code class="literal">!</code>) appears in the password field of the <code class="literal">/etc/gshadow</code> file, which locks the group.
								</li><li class="listitem">
									All other fields are blank.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							A directory for user <code class="literal">juan</code> is created in the <code class="literal">/home</code> directory:
						</p><pre class="literallayout">~]# ls -ld /home/juan
drwx------. 4 juan juan 4096 Mar  3 18:23 /home/juan</pre><p class="simpara">
							This directory is owned by user <code class="literal">juan</code> and group <code class="literal">juan</code>. It has <span class="emphasis"><em>read</em></span>, <span class="emphasis"><em>write</em></span>, and <span class="emphasis"><em>execute</em></span> privileges <span class="strong"><strong>only</strong></span> for the user <code class="literal">juan</code>. All other permissions are denied.
						</p></li><li class="listitem"><p class="simpara">
							The files within the <code class="literal">/etc/skel/</code> directory (which contain default user settings) are copied into the new <code class="literal">/home/juan/</code> directory:
						</p><pre class="literallayout">~]# ls -la /home/juan
total 28
drwx------. 4 juan juan 4096 Mar  3 18:23 .
drwxr-xr-x. 5 root root 4096 Mar  3 18:23 ..
-rw-r—​r--. 1 juan juan   18 Jun 22  2010 .bash_logout
-rw-r—​r--. 1 juan juan  176 Jun 22  2010 .bash_profile
-rw-r—​r--. 1 juan juan  124 Jun 22  2010 .bashrc
drwxr-xr-x. 4 juan juan 4096 Nov 23 15:09 .mozilla</pre></li></ol></div><p>
					At this point, a locked account called <code class="literal">juan</code> exists on the system. To activate it, the administrator must next assign a password to the account using the <code class="literal">passwd</code> command and, optionally, set password aging guidelines.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sec-users-tools-groups-add"/>Adding a new group</h2></div></div></div><p>
					To add a new group to the system, type the following at a shell prompt as <code class="literal">root</code>:
				</p><pre class="literallayout"><code class="literal">groupadd</code> <span class="emphasis"><em>options</em></span> <span class="emphasis"><em>group_name</em></span></pre><p>
					Here <code class="literal">options</code> are command-line options as described in <a class="xref" href="managing-users-groups-permissions_configuring-basic-system-settings.html#table-groupadd-options" title="Table 4.3. Common groupadd command-line options">Table 4.3, “Common groupadd command-line options”</a>.
				</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>
						With RHEL 8, you cannot use all-numeric group names. The reason for not allowing such names is that this can confuse tools that work with group names and group ids, which are numbers.
					</p></div><div class="table"><a id="table-groupadd-options"/><p class="title"><strong>Table 4.3. Common groupadd command-line options</strong></p><div class="table-contents"><table summary="Common groupadd command-line options" border="1"><colgroup><col class="col_1"/><col class="col_2"/></colgroup><thead><tr><th style="text-align: left" valign="top">Option</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
									<code class="literal">-f</code>, <code class="literal">--force</code>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									When used with <code class="literal">-g</code> <span class="emphasis"><em>gid</em></span> and <span class="emphasis"><em>gid</em></span> already exists, <code class="literal">groupadd</code> will choose another unique <span class="emphasis"><em>gid</em></span> for the group.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									<code class="literal">-g</code> <span class="emphasis"><em>gid</em></span>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Group ID for the group, which must be unique and greater than 999.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									<code class="literal">-K</code>, <code class="literal">--key</code> <span class="emphasis"><em>key</em></span>=<span class="emphasis"><em>value</em></span>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Override <code class="literal">/etc/login.defs</code> defaults.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									<code class="literal">-o</code>, <code class="literal">--non-unique</code>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Allows creating groups with duplicate GID.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									<code class="literal">-p</code>, <code class="literal">--password</code> <span class="emphasis"><em>password</em></span>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Use this encrypted password for the new group.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									<code class="literal">-r</code>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Create a system group with a GID less than 1000.
								</p>
								 </td></tr></tbody></table></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sec-users-to-existing-groups"/>Adding an existing user to an existing group</h2></div></div></div><p>
					Use the <code class="literal">usermod</code> utility to add an already existing user to an already existing group.
				</p><p>
					Various options of <code class="literal">usermod</code> have different impact on user’s primary group and on his or her supplementary groups.
				</p><p>
					To override user’s primary group, run the following command as <code class="literal">root</code>:
				</p><pre class="literallayout"><code class="literal">usermod</code> <code class="literal">-g</code> <span class="emphasis"><em>group_name</em></span> <span class="emphasis"><em>user_name</em></span></pre><p>
					To override user’s supplementary groups, run the following command as <code class="literal">root</code>:
				</p><pre class="literallayout"><code class="literal">usermod</code> <code class="literal">-G</code> <span class="emphasis"><em>group_name1</em></span>,<span class="emphasis"><em>group_name2</em></span>,…​ <span class="emphasis"><em>user_name</em></span></pre><p>
					Note that in this case all previous supplementary groups of the user are replaced by the new group or several new groups.
				</p><p>
					To add one or more groups to user’s supplementary groups, run one of the following commands as <code class="literal">root</code>:
				</p><pre class="literallayout"><code class="literal">usermod</code> <code class="literal">-aG</code> <span class="emphasis"><em>group_name1</em></span>,<span class="emphasis"><em>group_name2</em></span>,…​ <span class="emphasis"><em>user_name</em></span></pre><pre class="literallayout"><code class="literal">usermod</code> <code class="literal">--append -G</code> <span class="emphasis"><em>group_name1</em></span>,<span class="emphasis"><em>group_name2</em></span>,…​ <span class="emphasis"><em>user_name</em></span></pre><p>
					Note that in this case the new group is added to user’s current supplementary groups.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sec-users-tools-groups-directories"/>Creating group directories</h2></div></div></div><p>
					System administrators usually like to create a group for each major project and assign people to the group when they need to access that project’s files. With this traditional scheme, file management is difficult; when someone creates a file, it is associated with the primary group to which they belong. When a single person works on multiple projects, it becomes difficult to associate the right files with the right group. However, with the UPG scheme, groups are automatically assigned to files created within a directory with the <span class="emphasis"><em>setgid</em></span> bit set. The <span class="emphasis"><em>setgid</em></span> bit makes managing group projects that share a common directory very simple because any files a user creates within the directory are owned by the group that owns the directory.
				</p><p>
					For example, a group of people need to work on files in the <code class="literal">/opt/myproject/</code> directory. Some people are trusted to modify the contents of this directory, but not everyone.
				</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">
							As <code class="literal">root</code>, create the <code class="literal">/opt/myproject/</code> directory by typing the following at a shell prompt:
						</p><pre class="literallayout"><code class="literal">mkdir /opt/myproject</code></pre></li><li class="listitem"><p class="simpara">
							Add the <code class="literal">myproject</code> group to the system:
						</p><pre class="literallayout"><code class="literal">groupadd myproject</code></pre></li><li class="listitem"><p class="simpara">
							Associate the contents of the <code class="literal">/opt/myproject/</code> directory with the <code class="literal">myproject</code> group:
						</p><pre class="literallayout"><code class="literal">chown root:myproject /opt/myproject</code></pre></li><li class="listitem"><p class="simpara">
							Allow users in the group to create files within the directory and set the <span class="emphasis"><em>setgid</em></span> bit:
						</p><pre class="literallayout"><code class="literal">chmod 2775 /opt/myproject</code></pre><p class="simpara">
							At this point, all members of the <code class="literal">myproject</code> group can create and edit files in the <code class="literal">/opt/myproject/</code> directory without the administrator having to change file permissions every time users write new files. To verify that the permissions have been set correctly, run the following command:
						</p><pre class="literallayout"><code class="literal">ls</code> <code class="literal">-ld /opt/myproject</code>
drwxrwsr-x. 3 root myproject 4096 Mar  3 18:31 /opt/myproject</pre></li><li class="listitem"><p class="simpara">
							Add users to the <code class="literal">myproject</code> group:
						</p><pre class="literallayout"><code class="literal">usermod</code> <code class="literal">-aG myproject <span class="emphasis"><em>username</em></span></code></pre></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sec-setting-default-permissions-for-new-files-using-umask"/>Setting default permissions for new files using umask</h2></div></div></div><p>
					When a process creates a file, the file has certain default permissions, for example, <code class="literal">-rw-rw-r--</code>. These initial permissions are partially defined by the <span class="emphasis"><em>file mode creation mask</em></span>, also called <span class="emphasis"><em>file permission mask</em></span> or <span class="emphasis"><em>umask</em></span>. Every process has its own umask, for example, <span class="strong"><strong><span class="application">bash</span></strong></span> has <span class="emphasis"><em>umask</em></span> <code class="literal">0022</code> by default. Process <span class="emphasis"><em>umask</em></span> can be changed.
				</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="what_umask_consists_of"/>What umask consists of</h3></div></div></div><p>
						A <span class="emphasis"><em>umask</em></span> consists of bits corresponding to standard file permissions. For example, for <span class="emphasis"><em>umask</em></span> <code class="literal">0137</code>, the digits mean that:
					</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
								<code class="literal">0</code> = no meaning, it is always <code class="literal">0</code> (umask does not affect special bits)
							</li><li class="listitem">
								<code class="literal">1</code> = for owner permissions, the execute bit is set
							</li><li class="listitem">
								<code class="literal">3</code> = for group permissions, the execute and write bits are set
							</li><li class="listitem">
								<code class="literal">7</code> = for others permissions, the execute, write, and read bits are set
							</li></ul></div><p>
						<span class="emphasis"><em>Umasks</em></span> can be represented in binary, octal, or symbolic notation. For example, the octal representation <code class="literal">0137</code> equals symbolic representation <code class="literal">u=rw-,g=r--,o=---</code>. Symbolic notation specification is the reverse of the octal notation specification: it shows the allowed permissions, not the prohibited permissions.
					</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="how_umask_works"/>How umask works</h3></div></div></div><p>
						<span class="emphasis"><em>Umask</em></span> <span class="strong"><strong>prohibits permissions</strong></span> from being set for a file:
					</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
								When a bit is set in <span class="emphasis"><em>umask</em></span>, it is unset in the file.
							</li><li class="listitem">
								When a bit is not set in <span class="emphasis"><em>umask</em></span>, it can be set in the file, depending on other factors.
							</li></ul></div><p>
						The following figure shows how <span class="emphasis"><em>umask</em></span> <code class="literal">0137</code> affects creating a new file.
					</p><div class="figure"><a id="figu-umask_example"/><p class="title"><strong>Figure 4.3. Applying umask when creating a file</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/Users_Groups-Umask_Example.png" alt="Users Groups Umask Example"/></div></div></div><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
							For security reasons, a regular file cannot have execute permissions by default. Therefore, even if <span class="emphasis"><em>umask</em></span> is <code class="literal">0000</code>, which does not prohibit any permissions, a new regular file still does not have execute permissions. However, directories can be created with execute permissions:
						</p><pre class="literallayout">[john@server tmp]$ umask 0000
[john@server tmp]$ touch file
[john@server tmp]$ mkdir directory
[john@server tmp]$ ls -lh .
total 0
<span class="strong"><strong>drwxrwxrwx.</strong></span> 2 john john 40 Nov  2 13:17 directory
<span class="strong"><strong>-rw-rw-rw-.</strong></span> 1 john john  0 Nov  2 13:17 file</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="sect-umask_in_shells"/>Managing umask in Shells</h3></div></div></div><p>
						For popular shells, such as <code class="literal">bash</code>, <code class="literal">ksh</code>, <code class="literal">zsh</code> and <code class="literal">tcsh</code>, <span class="emphasis"><em>umask</em></span> is managed using the <code class="literal">umask</code> shell <code class="literal">builtin</code>. Processes started from shell inherit its umask.
					</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="displaying_the_current_mask"/>Displaying the current mask</h4></div></div></div><p>
							To show the current <span class="emphasis"><em>umask</em></span> in octal notation:
						</p><pre class="literallayout">~]$ <code class="literal">umask</code>
0022</pre><p>
							To show the current <span class="emphasis"><em>umask</em></span> in symbolic notation:
						</p><pre class="literallayout"><code class="literal">umask</code> <code class="literal">-S</code>
u=rwx,g=rx,o=rx</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="setting_mask_in_shell_using_umask"/>Setting mask in shell using umask</h4></div></div></div><p>
							To set <span class="emphasis"><em>umask</em></span> for the current shell session using octal notation run:
						</p><pre class="literallayout"><code class="literal">umask</code> <span class="emphasis"><em>octal_mask</em></span></pre><p>
							Substitute <span class="emphasis"><em>octal_mask</em></span> with four or less digits from <code class="literal">0</code> to <code class="literal">7</code>. When three or less digits are provided, permissions are set as if the command contained leading zeros. For example, <span class="emphasis"><em>umask</em></span> <code class="literal">7</code> translates to <code class="literal">0007</code>.
						</p><div class="example"><a id="ex-setting_umask_octal"/><p class="title"><strong>Example 4.1. Setting umask Using Octal Notation</strong></p><div class="example-contents"><p>
								To prohibit new files from having write and execute permissions for owner and group, and from having any permissions for others:
							</p><pre class="literallayout"><code class="literal">umask 0337</code></pre><p>
								Or:
							</p><pre class="literallayout"><code class="literal">umask 337</code></pre></div></div><p>
							To set <span class="emphasis"><em>umask</em></span> for the current shell session using symbolic notation:
						</p><pre class="literallayout"><code class="literal">umask</code> <code class="literal">-S</code> <span class="emphasis"><em>symbolic_mask</em></span></pre><div class="example"><a id="ex-setting_umask_symbolic"/><p class="title"><strong>Example 4.2. Setting umask Using Symbolic Notation</strong></p><div class="example-contents"><p>
								To set <span class="emphasis"><em>umask</em></span> <code class="literal">0337</code> using symbolic notation:
							</p><pre class="literallayout"><code class="literal">umask</code> <code class="literal">-S u=r,g=r,o=</code></pre></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="working_with_the_default_shell_umask"/>Working with the default shell umask</h4></div></div></div><p>
							Shells usually have a configuration file where their default <span class="emphasis"><em>umask</em></span> is set. For <code class="literal">bash</code>, it is <code class="literal">/etc/bashrc</code>. To show the default <code class="literal">bash</code> umask:
						</p><pre class="literallayout"><code class="literal">grep -i -B 1 umask /etc/bashrc</code></pre><p>
							The output shows if <span class="emphasis"><em>umask</em></span> is set, either using the <code class="literal">umask</code> command or the <code class="literal">UMASK</code> variable. In the following example, <span class="emphasis"><em>umask</em></span> is set to <code class="literal">022</code> using the <code class="literal">umask</code> command:
						</p><pre class="literallayout"><code class="literal">grep -i -B 1 umask /etc/bashrc</code>
    # By default, we want <span class="emphasis"><em>umask</em></span> to get set. This sets it for non-login shell. —     if [ $UID -gt 199 ] &amp;&amp; [ “id -gn” = “id -un” ]; then
       umask 002
    else
       <span class="strong"><strong>umask 022</strong></span></pre><p>
							To change the default <span class="emphasis"><em>umask</em></span> for <code class="literal">bash</code>, change the <code class="literal">umask</code> command call or the <code class="literal">UMASK</code> variable assignment in <code class="literal">/etc/bashrc</code>. This example changes the default <span class="emphasis"><em>umask</em></span> to <code class="literal">0227</code>:
						</p><pre class="literallayout">    if [ $UID -gt 199 ] &amp;&amp; [ “id -gn” = “id -un” ]; then
       umask 002
    else
       <span class="strong"><strong>umask 227</strong></span></pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="working_with_the_default_shell_umask_of_a_specific_user"/>Working with the default shell umask of a specific user</h4></div></div></div><p>
							By default, <code class="literal">bash</code> <span class="emphasis"><em>umask</em></span> of a new user defaults to the one defined in <code class="literal">/etc/bashrc</code>.
						</p><p>
							To change <code class="literal">bash</code> <span class="emphasis"><em>umask</em></span>for a particular user, add a call to the <code class="literal">umask</code> command in <code class="literal">$HOME/.bashrc</code> file of that user. For example, to change <code class="literal">bash</code> <span class="emphasis"><em>umask</em></span> of user <code class="literal">john</code> to <code class="literal">0227</code>:
						</p><pre class="literallayout">john@server ~]$ <code class="literal">echo 'umask 227' [] /home/john/.bashrc</code></pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="setting_default_permissions_for_newly_created_home_directories"/>Setting default permissions for newly created home directories</h4></div></div></div><p>
							To change permissions with which user home directories are created, change the <code class="literal">UMASK</code> variable in the <code class="literal">/etc/login.defs</code> file:
						</p><pre class="literallayout"># The permission mask is initialized to this value. If not specified,
# the permission mask will be initialized to 022.
UMASK <span class="strong"><strong>077</strong></span></pre></div></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="users-groups-additional-resources_managing-users-groups-permissions"/>Additional Resources</h1></div></div></div><p>
				For more information on how to manage users and groups on Red Hat Enterprise Linux, see the resources listed below.
			</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sec-Users_and_Groups-Resources-Installed"/>Installed Documentation</h2></div></div></div><p>
					For information about various utilities for managing users and groups, see the following manual pages:
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							<code class="literal">useradd</code>(8) — The manual page for the <code class="literal">useradd</code> command documents how to use it to create new users.
						</li><li class="listitem">
							<code class="literal">userdel</code>(8) — The manual page for the <code class="literal">userdel</code> command documents how to use it to delete users.
						</li><li class="listitem">
							<code class="literal">usermod</code>(8) — The manual page for the <code class="literal">usermod</code> command documents how to use it to modify users.
						</li><li class="listitem">
							<code class="literal">groupadd</code>(8) — The manual page for the <code class="literal">groupadd</code> command documents how to use it to create new groups.
						</li><li class="listitem">
							<code class="literal">groupdel</code>(8) — The manual page for the <code class="literal">groupdel</code> command documents how to use it to delete groups.
						</li><li class="listitem">
							<code class="literal">groupmod</code>(8) — The manual page for the <code class="literal">groupmod</code> command documents how to use it to modify group membership.
						</li><li class="listitem">
							<code class="literal">gpasswd</code>(1) — The manual page for the <code class="literal">gpasswd</code> command documents how to manage the <code class="literal">/etc/group</code> file.
						</li><li class="listitem">
							<code class="literal">grpck</code>(8) — The manual page for the <code class="literal">grpck</code> command documents how to use it to verify the integrity of the <code class="literal">/etc/group</code> file.
						</li><li class="listitem">
							<code class="literal">pwck</code>(8) — The manual page for the <code class="literal">pwck</code> command documents how to use it to verify the integrity of the <code class="literal">/etc/passwd</code> and <code class="literal">/etc/shadow</code> files.
						</li><li class="listitem">
							<code class="literal">pwconv</code>(8) — The manual page for the <code class="literal">pwconv</code>, <code class="literal">pwunconv</code>, <code class="literal">grpconv</code>, and <code class="literal">grpunconv</code> commands documents how to convert shadowed information for passwords and groups.
						</li><li class="listitem">
							<code class="literal">id</code>(1) — The manual page for the <code class="literal">id</code> command documents how to display user and group IDs.
						</li></ul></div><p>
					For information about related configuration files, see:
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							<code class="literal">group</code>(5) — The manual page for the <code class="literal">/etc/group</code> file documents how to use this file to define system groups.
						</li><li class="listitem">
							<code class="literal">passwd</code>(5) — The manual page for the <code class="literal">/etc/passwd</code> file documents how to use this file to define user information.
						</li><li class="listitem">
							<code class="literal">shadow</code>(5) — The manual page for the <code class="literal">/etc/shadow</code> file documents how to use this file to set passwords and account expiration information for the system.
						</li></ul></div></div></div></div></body></html>