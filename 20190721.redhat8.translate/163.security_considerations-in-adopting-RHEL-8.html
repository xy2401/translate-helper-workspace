<html  xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 9. 安全</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"></head><body ><div class="chapter"><div class="titlepage"><div><div><h1 class="title">Chapter 9. 安全</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="changes-in-core-cryptographic-components_security"></a>核心加密组件的变化</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="crypto-policies_security"></a>默认情况下应用系统范围的加密策略</h2></div></div></div><p>加密策略是红帽企业Linux 8中的一个组件，它配置核心加密子系统，涵盖TLS，IPsec，DNSSEC，Kerberos协议和OpenSSH套件。它提供了一小组策略，管理员可以使用<code class="literal">update-crypto-policies</code>命令进行选择。
				</p><p><code class="literal">DEFAULT</code>系统范围的加密策略为当前威胁模型提供安全设置。它允许TLS 1.2和1.3协议，以及IKEv2和SSH2协议。如果大于2047位，则接受RSA密钥和Diffie-Hellman参数。
				</p><p>有关详细信息，请参阅Red Hat博客上的<a class="link" href="https://www.redhat.com/en/blog/consistent-security-crypto-policies-red-hat-enterprise-linux-8">Red Hat Enterprise Linux 8</a>文章中<a class="link" href="https://www.redhat.com/en/blog/consistent-security-crypto-policies-red-hat-enterprise-linux-8">的加密策略</a>的<a class="link" href="https://www.redhat.com/en/blog/consistent-security-crypto-policies-red-hat-enterprise-linux-8">一致性安全性</a>以及<code class="literal">update-crypto-policies(8)</code>手册页。
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="ciphers-protocols_security"></a>通过删除不安全的密码套件和协议来强制加密默认设置</h2></div></div></div><p>以下列表包含从RHEL 8中的核心加密库中删除的密码套件和协议。它们不存在于源中，或者在构建期间禁用它们的支持，因此应用程序无法使用它们。
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">DES（自RHEL 7起）</li><li class="listitem">所有出口级密码套件（自RHEL 7起）</li><li class="listitem">签名中的MD5（自RHEL 7起）</li><li class="listitem">SSLv2（自RHEL 7起）</li><li class="listitem">SSLv3（自RHEL 8起）</li><li class="listitem">所有ECC曲线&lt;224位（自RHEL 6起）</li><li class="listitem">所有二进制字段ECC曲线（自RHEL 6起）</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="disabled-ciphers-protocols_security"></a>在所有策略级别禁用密码套件和协议</h2></div></div></div><p>在所有加密策略级别中禁用以下密码套件和协议。它们只能通过单个应用程序的显式配置启用。
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">DH参数&lt;1024位</li><li class="listitem">密钥大小&lt;1024位的RSA</li><li class="listitem">茶花</li><li class="listitem">咏叹调</li><li class="listitem">种子</li><li class="listitem">理念</li><li class="listitem">仅限完整性的密码套件</li><li class="listitem">使用SHA-384 HMAC的TLS CBC模式密码套件</li><li class="listitem">AES-CCM8</li><li class="listitem">所有ECC曲线都与TLS 1.3不兼容，包括secp256k1</li><li class="listitem">IKEv1（自RHEL 8起）</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="fips-mode_security"></a>将系统切换到FIPS模式</h2></div></div></div><p>系统范围的加密策略包含一个策略级别，该策略级别使加密模块能够根据联邦信息处理标准（FIPS）出版物140-2的要求进行自检。启用或禁用FIPS模式的<code class="literal">fips-mode-setup</code>工具在内部使用<code class="literal">FIPS</code>系统范围的加密策略级别。
				</p><p>要在RHEL 8中将系统切换到FIPS模式，请输入以下命令并重新启动系统：</p><pre class="screen"># fips-mode-setup --enable</pre><p>有关更多信息，请参见<code class="literal">fips-mode-setup(8)</code>手册页。
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="tls-v10-v11_security"></a>不推荐使用TLS 1.0和TLS 1.1</h2></div></div></div><p>在<code class="literal">DEFAULT</code>系统范围的加密策略级别禁用TLS 1.0和TLS 1.1协议。如果您的方案（例如，Firefox Web浏览器中的视频会议应用程序）需要使用已弃用的协议，请将系统范围的加密策略切换到<code class="literal">LEGACY</code>级别：</p><pre class="screen"># update-crypto-policies --set LEGACY</pre><p>有关更多信息，请参阅<a class="link" href="https://access.redhat.com/articles/3642912">RHEL 8中</a>的<a class="link" href="https://access.redhat.com/articles/3642912">强加密默认值以及</a> Red Hat Customer Portal和<code class="literal">update-crypto-policies(8)</code>手册页上的<a class="link" href="https://access.redhat.com/articles/3642912">弱加密算法</a>知识库文章的<a class="link" href="https://access.redhat.com/articles/3642912">弃用</a> 。
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="tls-v13_security"></a>加密库中的TLS 1.3支持</h2></div></div></div><p>此更新默认在所有主要后端加密库中启用传输层安全性（TLS）1.3。这样可以在整个操作系统通信层实现低延迟，并通过利用新算法（如RSA-PSS或X25519）增强应用程序的隐私性和安全性。
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="dsa_security"></a> DSA在RHEL 8中已弃用</h2></div></div></div><p>数字签名算法（DSA）在Red Hat Enterprise Linux 8中被认为已弃用。依赖于DSA密钥的身份验证机制在默认配置中不起作用。请注意，即使在<code class="literal">LEGACY</code>系统范围的加密策略级别， <code class="literal">OpenSSH</code>客户端也不接受DSA主机密钥。
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="client-hello_security"></a> <code class="literal">SSL2</code> <code class="literal">Client Hello</code>已在<code class="literal">NSS</code>弃用</h2></div></div></div><p>传输层安全性（ <code class="literal">TLS</code> ）协议版本1.2及更早版本允许以与向后兼容安全套接字层（ <code class="literal">SSL</code> ）协议版本2的方式格式化的<code class="literal">Client Hello</code>消息开始协商。不推荐使用网络安全服务（ <code class="literal">NSS</code> ）库中对此功能的支持，默认情况下禁用此功能。
				</p><p>需要支持此功能的应用程序需要使用新的<code class="literal">SSL_ENABLE_V2_COMPATIBLE_HELLO</code> API来启用它。在未来的Red Hat Enterprise Linux 8版本中，可能会完全删除对此功能的支持。
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="nss-sql_security"></a> NSS现在默认使用SQL</h2></div></div></div><p>默认情况下，网络安全服务（NSS）库现在使用信任数据库的SQL文件格式。DBM文件格式在以前的版本中用作默认数据库格式，不支持多个进程对同一数据库的并发访问，并且已在上游弃用。因此，使用NSS信任数据库存储密钥，证书和吊销信息的应用程序现在默认以SQL格式创建数据库。尝试以旧版DBM格式创建数据库失败。现有DBM数据库以只读模式打开，并自动转换为SQL格式。请注意，自Red Hat Enterprise Linux 6起，NSS支持SQL文件格式。
				</p></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="openssh_security"></a> SSH</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="openssh-rebase_security"></a> <code class="literal">OpenSSH</code>重新定义为7.8p1版本</h2></div></div></div><p><code class="literal">openssh</code>软件包已升级到上游版本7.8p1。值得注意的变化包括：</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">删除了对<code class="literal">SSH version 1</code>协议的支持。
						</li><li class="listitem">删除了对<code class="literal">hmac-ripemd160</code>消息验证代码的支持。
						</li><li class="listitem">删除了对RC4（ <code class="literal">arcfour</code> ）密码的支持。
						</li><li class="listitem">删除了对<code class="literal">Blowfish</code>密码的支持。
						</li><li class="listitem">删除了对<code class="literal">CAST</code>密码的支持。
						</li><li class="listitem">将<code class="literal">UseDNS</code>选项的默认值更改为<code class="literal">no</code> 。
						</li><li class="listitem">默认情况下禁用<code class="literal">DSA</code>公钥算法。
						</li><li class="listitem">将<code class="literal">Diffie-Hellman</code>参数的最小模数大小更改为2048位。
						</li><li class="listitem">更改了<code class="literal">ExposeAuthInfo</code>配置选项的语义。
						</li><li class="listitem"><code class="literal">UsePrivilegeSeparation=sandbox</code>选项现在是必需的，无法禁用。
						</li><li class="listitem">将最小接受<code class="literal">RSA</code>密钥大小设置为1024位。
						</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="libssh_security"></a> <code class="literal">libssh</code> SSH作为核心加密组件实现</h2></div></div></div><p>此更改将<code class="literal">libssh</code>作为Red Hat Enterprise Linux 8中的核心加密组件引入。<code class="literal">libssh</code>库实现了Secure SHell（SSH）协议。
				</p><p>请注意， <code class="literal">libssh</code>不符合系统范围的加密策略。
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="literal_libssh2_literal_is_not_available_in_rhel_8"></a> <code class="literal">libssh2</code>在RHEL 8中不可用</h2></div></div></div><p>不推荐使用的<code class="literal">libssh2</code>库<code class="literal">libssh2</code>功能，例如支持椭圆曲线或通用安全服务应用程序接口（GSSAPI），它已从RHEL 8中删除，转而使用<code class="literal">libssh</code>
				</p></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="rsyslog_security"></a> rsyslog现在</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="rsyslog-format_security"></a>默认的<code class="literal">rsyslog</code>配置文件格式现在是非遗留的</h2></div></div></div><p>现在， <code class="literal">rsyslog</code>包中的配置文件默认使用非传统格式。遗留格式仍然可以使用，但是，混合当前和遗留配置语句有几个限制。应修改先前RHEL版本中的配置。有关更多信息，请参见<code class="literal">rsyslog.conf(5)</code>手册页。
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="rsyslog-imjournal-security"></a> <code class="literal">imjournal</code>选项和配置系统日志记录，最小化<code class="literal">journald</code>使用情况</h2></div></div></div><p>为了避免在<code class="literal">journald</code>轮换其文件时可能出现的重复记录，添加了<code class="literal">imjournal</code>选项。请注意，使用此选项可能会影响性能。
				</p><p>请注意，可以将具有<code class="literal">rsyslog</code>的系统配置为提供更好的性能，如<a class="link" href="https://access.redhat.com/articles/4058681">配置系统日志记录而不使用journald或使用最小化的journald用法</a>知识库文章中所述。
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="default-logging_security"></a>默认日志记录设置对性能的负面影响</h2></div></div></div><p>默认的日志记录环境设置可能会消耗4 GB的内存，甚至更多，在限速值的调整是复杂的<code class="literal">systemd-journald</code>与运行<code class="literal">rsyslog</code> 。
				</p><p>有关详细信息，请参阅<a class="link" href="https://access.redhat.com/articles/4095141">RHEL默认日志记录设置对性能及其缓解措施</a>的<a class="link" href="https://access.redhat.com/articles/4095141">负面影响</a>知识库文章。
				</p></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="openscap_security"></a> OpenSCAP</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="openscap-api_security"></a> OpenSCAP API已整合</h2></div></div></div><p>此更新提供已合并的OpenSCAP共享库API。已删除63个符号，添加了14个符号，4个符号已更新。OpenSCAP 1.3.0中删除的符号包括：</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">在1.2.0版中标记为已弃用的符号</li><li class="listitem">SEAP协议符号</li><li class="listitem">内部帮助函数</li><li class="listitem">未使用的库符号</li><li class="listitem">未实现的符号</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="oscap-docker_security"></a>无法使用用于安全性和合规性扫描容器的实用程序</h2></div></div></div><p>在Red Hat Enterprise Linux 7中， <code class="literal">oscap-docker</code>实用程序可用于基于Atomic技术扫描Docker容器。在Red Hat Enterprise Linux 8中，Docker和Atomic相关的<span class="strong"><strong>OpenSCAP</strong></span>命令不可用。因此， <code class="literal">oscap-docker</code> RHEL 8中没有用于安全性和兼容性扫描容器的<code class="literal">oscap-docker</code>或等效实用程序。
				</p></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="audit_security"></a>审计</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="audispd_security"></a> Audit 3.0用<code class="literal">auditd</code>替换<code class="literal">audispd</code></h2></div></div></div><p>通过此更新， <code class="literal">audispd</code>功能已移至<code class="literal">auditd</code> 。因此， <code class="literal">audispd</code>配置选项现在是<code class="literal">auditd.conf</code>一部分。另外， <code class="literal">plugins.d</code>目录已经在<code class="literal">/etc/audit</code>下移动了。现在可以通过运行<code class="literal">service auditd state</code>命令来检查<code class="literal">auditd</code>及其插件的当前状态。
				</p></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="selinux_security"></a> SELinux的</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="new-selinux-booleans_security"></a>新的SELinux布尔</h2></div></div></div><p>SELinux系统策略的此更新引入了以下布尔值：</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">colord_use_nfs</li><li class="listitem">mysql_connect_http</li><li class="listitem">pdns_can_network_connect_db</li><li class="listitem">ssh_use_tcpd</li><li class="listitem">sslh_can_bind_any_port</li><li class="listitem">sslh_can_connect_any_port</li><li class="listitem">virt_use_pcscd</li></ul></div><p>要获取包含其含义的布尔列表，并查看是否已启用或禁用布尔值，请安装<code class="literal">selinux-policy-devel</code>软件包并使用：</p><pre class="screen"># semanage boolean -l</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="selinux-python3_security"></a> SELinux包迁移到Python 3</h2></div></div></div><p><code class="literal">libselinux-python</code>包的功能现在由<code class="literal">python3-libselinux</code>包提供， <code class="literal">policycoreutils-python</code>已被<code class="literal">policycoreutils-python-utils</code>和<code class="literal">python3-policycoreutils</code>包<code class="literal">python3-policycoreutils</code> 。
				</p></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="removed_security_functionality"></a>删除了安全功能</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="all-numeric-user-group-names_security"></a> <code class="literal">shadow-utils</code>不再允许全数字用户和组名</h2></div></div></div><p><code class="literal">useradd</code>和<code class="literal">groupadd</code>命令禁止纯粹由数字字符组成的用户名和组名。不允许使用此类名称的原因是，这可能会混淆使用用户名和组名以及用户和组ID（数字）的许多工具。请注意，Red Hat Enterprise Linux 7中不推荐使用全数字用户名和组名，并且在Red Hat Enterprise Linux 8中完全删除了它们的支持。
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="securetty_security"></a> <code class="literal">securetty</code>现在默认禁用</h2></div></div></div><p>由于现代Linux系统上<code class="literal">tty</code>设备文件的动态特性，默认情况下已禁用<code class="literal">securetty</code> PAM模块，并且RHEL中不再包含<code class="literal">/etc/securetty</code>配置文件。由于<code class="literal">/etc/securetty</code>列出了许多可能的设备，因此在大多数情况下实际效果是默认允许，此更改只会产生轻微影响。但是，如果使用限制性更强的配置，则需要添加一行以启用<code class="literal">pam_securetty.so</code>模块到<code class="literal">/etc/pam.d</code>目录中的相应文件，并创建一个新的<code class="literal">/etc/securetty</code>文件。
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="clevis-http_security"></a> <code class="literal">Clevis</code> HTTP引脚已被删除</h2></div></div></div><p>已从RHEL 8中删除了<code class="literal">Clevis</code> HTTP引脚，并且无法再使用<code class="literal">clevis encrypt http</code>子命令。
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="coolkey_security"></a> <code class="literal">Coolkey</code>已被删除</h2></div></div></div><p>用于智能卡的<code class="literal">Coolkey</code>驱动程序已从RHEL 8中删除， <code class="literal">OpenSC</code>现在提供其功能。
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="crypto-utils_security"></a> <code class="literal">crypto-utils</code>已被删除</h2></div></div></div><p>已从RHEL 8中删除了<code class="literal">crypto-utils</code>软件包。您可以使用<code class="literal">openssl</code> ， <code class="literal">gnutls-utils</code>和<code class="literal">nss-tools</code>软件包提供<code class="literal">nss-tools</code> 。
				</p></div></div></div></body></html>