<html  xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 9. 使Kickstart文件可用于安装程序</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"></head><body ><div class="chapter"><div class="titlepage"><div><div><h1 class="title">Chapter 9. 使Kickstart文件可用于安装程序</h1></div></div></div><p>以下提供有关使Kickstart文件可用于目标系统上的安装程序的信息。
			</p><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="ports-for-network-based-installation_making-kickstart-files-available-to-the-installation-program"></a>基于网络的安装端口</h1></div></div></div><p>下表列出了必须在服务器上打开的端口，这些端口为每种基于网络的安装提供文件。
				</p><div class="table"><a id="idm139712676621456"></a><p class="title"><strong>表4.1。基于网络的安装端口</strong></p><div class="table-contents"><table border="1" summary="Ports for network-based installation"><colgroup><col class="col_1"><col class="col_2"></colgroup><thead><tr><th valign="top" style="text-align:left">使用的协议</th><th valign="top" style="text-align:left">港口开放</th></tr></thead><tbody><tr><td valign="top" style="text-align:left"> <p>HTTP</p>
								 </td><td valign="top" style="text-align:left"> <p>80</p>
								 </td></tr><tr><td valign="top" style="text-align:left"> <p>HTTPS</p>
								 </td><td valign="top" style="text-align:left"> <p>443</p>
								 </td></tr><tr><td valign="top" style="text-align:left"> <p>NFS</p>
								 </td><td valign="top" style="text-align:left"> <p>2049,111,2004</p>
								 </td></tr><tr><td valign="top" style="text-align:left"> <p>TFTP</p>
								 </td><td valign="top" style="text-align:left"> <p>69</p>
								 </td></tr></tbody></table></div></div><div class="itemizedlist"><p class="title"><strong>其他资源</strong></p><ul class="itemizedlist"><li class="listitem">有关详细信息，请参阅“ <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/securing_networks/index/"><span class="emphasis"><em>保护网络”</em></span></a>文档。
						</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="making-a-kickstart-file-available-on-an-nfs-server_making-kickstart-files-available-to-the-installation-program"></a>在NFS服务器上提供Kickstart文件</h1></div></div></div><p>此过程描述如何在NFS服务器上存储Kickstart脚本文件。此方法使您可以从单个源安装多个系统，而无需为Kickstart文件使用物理介质。
				</p><div class="itemizedlist"><p class="title"><strong>先决条件</strong></p><ul class="itemizedlist"><li class="listitem">您必须具有对本地网络上具有Red Hat Enterprise Linux 8的服务器的管理员级别访问权限。
						</li><li class="listitem">要安装的系统必须能够连接到服务器。
						</li><li class="listitem">服务器上的防火墙必须允许来自要安装的系统的连接。有关详细信息，请参阅<a class="xref" href="making-kickstart-files-available-to-the-installation-program_installing-rhel-as-an-experienced-user.html#ports-for-network-based-installation_making-kickstart-files-available-to-the-installation-program" title="基于网络的安装端口">“基于网络的安装的端口”一节</a> 。
						</li></ul></div><div class="orderedlist"><p class="title"><strong>程序</strong></p><ol class="orderedlist"><li class="listitem"><p class="simpara">通过以root身份运行以下命令来安装<code class="literal">nfs-utils</code>软件包：</p><pre class="screen"># yum install nfs-utils</pre></li><li class="listitem">将Kickstart文件复制到NFS服务器上的目录。
						</li><li class="listitem"><p class="simpara">使用文本编辑器打开<code class="literal">/etc/exports</code>文件，并使用以下语法添加一行：</p><pre class="screen">/<span class="emphasis"><em>exported_directory</em></span>/ <span class="emphasis"><em>clients</em></span></pre></li><li class="listitem"><p class="simpara">将<span class="emphasis"><em>/ exported_directory /</em></span>替换为包含Kickstart文件的目录的完整路径。而不是<span class="emphasis"><em>客户端</em></span> ，使用从此NFS服务器安装的计算机的主机名或IP地址，所有计算机都可以访问ISO映像的子网，或者如果要允许，则使用星号（ <code class="literal">*</code> ）任何具有NFS服务器网络访问权限的计算机都可以使用ISO映像。有关此字段格式的详细信息，请参见<span class="emphasis"><em>exports（5）</em></span>手册页。
						</p><p class="simpara">使<code class="literal">/rhel8-install/</code>目录以只读方式提供给所有客户端的基本配置是：</p><pre class="screen">/rhel8-install *</pre></li><li class="listitem">保存<code class="literal">/etc/exports</code>文件并退出文本编辑器。
						</li><li class="listitem"><p class="simpara">启动nfs服务：</p><pre class="screen"># systemctl start nfs-server.service</pre><p class="simpara">如果在更改<code class="literal">/etc/exports</code>文件之前服务正在运行，请输入以下命令，以便正在运行的NFS服务器重新加载其配置：</p><pre class="screen"># systemctl reload nfs-server.service</pre><p class="simpara">现在可以通过NFS访问Kickstart文件并准备用于安装。
						</p></li></ol></div><div class="note" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title">注意</h3><p>当指定的Kickstart源，使用<code class="literal">nfs:</code>作为协议，服务器的主机名或IP地址，冒号符号（ <code class="literal">:</code> ），和内部目录持有文件的路径。例如，如果服务器的主机名是<code class="literal">myserver.example.com</code>并且您已将文件保存在<code class="literal">/rhel8-install/my-ks.cfg</code> ，请指定<code class="literal">inst.ks=nfs:myserver.example.com:/rhel8-install/my-ks.cfg</code>作为安装源引导选项。
					</p></div><div class="itemizedlist"><p class="title"><strong>其他资源</strong></p><ul class="itemizedlist"><li class="listitem">有关为从网络进行PXE引导设置TFTP服务器的详细信息，请参阅<a class="xref" href="preparing-for-a-network-install_installing-rhel-as-an-experienced-user.html" title="Chapter 9. 准备使用PXE从网络安装">第11章， <em>准备使用PXE从网络进行安装</em></a> 。</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="making-a-kickstart-file-available-on-an-http-or-https-server_making-kickstart-files-available-to-the-installation-program"></a>在HTTP或HTTPS服务器上提供Kickstart文件</h1></div></div></div><p>此过程描述如何在HTTP或HTTPS服务器上存储Kickstart脚本文件。此方法使您可以从单个源安装多个系统，而无需为Kickstart文件使用物理介质。
				</p><div class="itemizedlist"><p class="title"><strong>先决条件</strong></p><ul class="itemizedlist"><li class="listitem">您必须具有对本地网络上具有Red Hat Enterprise Linux 8的服务器的管理员级别访问权限。
						</li><li class="listitem">要安装的系统必须能够连接到服务器。
						</li><li class="listitem">服务器上的防火墙必须允许来自要安装的系统的连接。有关详细信息，请参阅<a class="xref" href="making-kickstart-files-available-to-the-installation-program_installing-rhel-as-an-experienced-user.html#ports-for-network-based-installation_making-kickstart-files-available-to-the-installation-program" title="基于网络的安装端口">“基于网络的安装的端口”一节</a> 。
						</li></ul></div><div class="orderedlist"><p class="title"><strong>程序</strong></p><ol class="orderedlist"><li class="listitem"><p class="simpara">通过以root身份运行以下命令来安装<code class="literal">httpd</code>包：</p><pre class="screen"># yum install httpd</pre><div class="warning" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title">警告</h3><p>如果您的Apache Web服务器配置启用了SSL安全性，请验证您是否仅启用TLSv1协议，并禁用SSLv2和SSLv3。这是由于POODLE SSL漏洞（CVE-2014-3566）。有关详细信息，请参阅<a class="link" href="https://access.redhat.com/solutions/1232413">https://access.redhat.com/solutions/1232413</a> 。
							</p></div><div class="important" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title">重要</h3><p>如果将HTTPS服务器与自签名证书一起使用，则必须使用<code class="literal">inst.noverifyssl</code>选项引导安装程序。
							</p></div></li><li class="listitem">将Kickstart文件复制到HTTP（S）服务器，进入<code class="literal">/var/www/html/</code>目录的子目录。
						</li><li class="listitem"><p class="simpara">启动httpd服务：</p><pre class="screen"># systemctl start httpd.service</pre><p class="simpara">Kickstart文件现在可以访问并准备用于安装。
						</p><div class="note" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title">注意</h3><p>指定Kickstart文件的位置时，请使用<code class="literal">http://</code>或<code class="literal">https://</code>作为协议，服务器的主机名或IP地址，以及相对于HTTP服务器根目录的Kickstart文件的路径。例如，如果您使用HTTP，则服务器的主机名为<code class="literal">myserver.example.com</code> ，并且您已将Kickstart文件复制为<code class="literal">/var/www/html/rhel8-install/my-ks.cfg</code> ，请指定<code class="literal"><a class="link" href="http://myserver.example.com/rhel8-install/my-ks.cfg">http://myserver.example.com/rhel8-install/my-ks.cfg</a></code>作为文件位置。
							</p></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>其他资源</strong></p><ul class="itemizedlist"><li class="listitem">有关HTTP和FTP服务器的详细信息，请参阅<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/deploying_different_types_of_servers/">部署不同类型的服务器</a> 。
						</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="making-a-kickstart-file-available-on-a-local-volume_making-kickstart-files-available-to-the-installation-program"></a>在本地卷上提供Kickstart文件</h1></div></div></div><p>此过程描述如何将Kickstart脚本文件存储在要安装的系统上的卷上。此方法使您可以绕过对另一个系统的需求。
				</p><div class="itemizedlist"><p class="title"><strong>先决条件</strong></p><ul class="itemizedlist"><li class="listitem">您必须有一个可以移动到要安装的机器的驱动器，例如USB记忆棒。
						</li><li class="listitem">驱动器必须包含可由安装程序读取的分区。支持的类型是<code class="literal">ext2</code> ， <code class="literal">ext3</code> ， <code class="literal">ext4</code> ， <code class="literal">xfs</code>和<code class="literal">fat</code> 。
						</li><li class="listitem">驱动器必须已连接到系统并已安装其卷。
						</li></ul></div><div class="orderedlist"><p class="title"><strong>程序</strong></p><ol class="orderedlist"><li class="listitem"><p class="simpara">列出卷信息并记下要将Kickstart文件复制到的卷的UUID。
						</p><pre class="screen"># lsblk -l -p -o name,rm,ro,hotplug,size,type,mountpoint,uuid</pre></li><li class="listitem">导航到卷上的文件系统。
						</li><li class="listitem">将Kickstart文件复制到此文件系统。
						</li><li class="listitem">记下稍后将使用<code class="literal">inst.ks=</code>选项的字符串。此字符串的格式为<code class="literal">hd:UUID=<span class="emphasis"><em>volume-UUID</em></span>:<span class="emphasis"><em>path/to/kickstart-file.cfg</em></span></code> 。请注意，该路径是相对于文件系统根目录，而不是文件系统层次结构的<code class="literal">/</code> root。将<span class="emphasis"><em>volume-UUID</em></span>替换为您之前记录的UUID。
						</li><li class="listitem"><p class="simpara">卸载所有驱动器卷：</p><pre class="screen"># umount <span class="emphasis"><em>/dev/xyz</em></span> ...</pre><p class="simpara">将所有卷添加到命令中，用空格分隔。
						</p></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="making-a-kickstart-file-available-on-a-local-volume-for-automatic-loading_making-kickstart-files-available-to-the-installation-program"></a>在本地卷上提供Kickstart文件以进行自动加载</h1></div></div></div><p>特别命名的Kickstart文件可以存在于要安装的系统上的特定命名卷的根目录中。这使您可以绕过对另一个系统的需求，并使安装程序自动加载文件。
				</p><div class="itemizedlist"><p class="title"><strong>先决条件</strong></p><ul class="itemizedlist"><li class="listitem">您必须有一个可以移动到要安装的机器的驱动器，例如USB记忆棒。
						</li><li class="listitem">驱动器必须包含可由安装程序读取的分区。支持的类型是<code class="literal">ext2</code> ， <code class="literal">ext3</code> ， <code class="literal">ext4</code> ， <code class="literal">xfs</code>和<code class="literal">fat</code> 。
						</li><li class="listitem">驱动器必须已连接到系统并已安装其卷。
						</li></ul></div><div class="orderedlist"><p class="title"><strong>程序</strong></p><ol class="orderedlist"><li class="listitem"><p class="simpara">列出卷信息并记下要将Kickstart文件复制到的卷的UUID。
						</p><pre class="screen"># lsblk -l -p</pre></li><li class="listitem">导航到卷上的文件系统。
						</li><li class="listitem">将Kickstart文件复制到此文件系统的根目录中。
						</li><li class="listitem">将Kickstart文件重命名为<code class="literal">ks.cfg</code> 。
						</li><li class="listitem"><p class="simpara">将卷重命名为<code class="literal">OEMDRV</code> ：</p><div class="informalexample"><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">对于<code class="literal">ext2</code> ， <code class="literal">ext3</code>和<code class="literal">ext4</code>文件系统：</p><pre class="screen"># e2label <span class="emphasis"><em>/dev/xyz</em></span> OEMDRV</pre></li><li class="listitem"><p class="simpara">对于XFS文件系统：</p><pre class="screen"># xfs_admin -L OEMDRV <span class="emphasis"><em>/dev/xyz</em></span></pre></li></ul></div></div><p class="simpara">将<span class="emphasis"><em>/ dev / xyz</em></span>替换为卷块设备的路径。
						</p></li><li class="listitem"><p class="simpara">卸载所有驱动器卷：</p><pre class="screen"># umount <span class="emphasis"><em>/dev/xyz</em></span> ...</pre><p class="simpara">将所有卷添加到命令中，用空格分隔。
						</p></li></ol></div></div></div></body></html>