<html  xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 9. 为Kickstart安装创建安装源</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"></head><body ><div class="chapter"><div class="titlepage"><div><div><h1 class="title">Chapter 9. 为Kickstart安装创建安装源</h1></div></div></div><p>本节介绍如何使用包含所需存储库和软件包的Binary DVD ISO映像为Boot ISO映像创建安装源。
			</p><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="types-of-installation-source_creating-installation-sources-for-kickstart-installations"></a>安装源的类型</h1></div></div></div><p>您可以使用以下安装源之一来获取最小的启动映像：</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							<span class="strong"><strong>DVD：</strong></span>将二进制DVD ISO映像刻录到DVD。安装程序将自动从DVD安装软件包。</li><li class="listitem"><p class="simpara">
							<span class="strong"><strong>硬盘驱动器或USB驱动器：</strong></span>将二进制DVD ISO映像复制到驱动器并配置安装程序以从驱动器安装软件包。如果使用USB驱动器，请在安装开始之前验证它是否已连接到系统。安装开始后，安装程序无法检测介质。
						</p><div class="informalexample"><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
									<span class="strong"><strong>硬盘驱动器限制</strong></span> ： <span class="strong"><strong>硬盘驱动器上</strong></span>的二进制DVD ISO映像必须位于具有安装程序可以安装的文件系统的分区上。支持的文件系统是<code class="literal">xfs</code> ， <code class="literal">ext2</code> ， <code class="literal">ext3</code> ， <code class="literal">ext4</code>和<code class="literal">vfat (FAT32)</code> 。
								</li></ul></div><div class="warning" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title">警告</h3><p>在Microsoft Windows系统上，格式化硬盘驱动器时使用的默认文件系统是NTFS。 exFAT文件系统也可用。但是，在安装过程中，这些文件系统都不能安装。如果要在Microsoft Windows上创建硬盘驱动器或USB驱动器作为安装源，请确认已将驱动器格式化为FAT32。请注意，FAT32文件系统无法存储大于4 GiB的文件。</p><p>在Red Hat Enterprise Linux 8中，您可以从本地硬盘驱动器上的存储库启用安装。为此，您需要将DVD ISO映像的内容复制到硬盘驱动器上的目录，然后将目录指定为安装源而不是ISO映像。例如： <code class="literal">inst.repo=hd:&lt;device&gt;:&lt;path to the repository&gt;</code>
							</p></div></div></li><li class="listitem"><p class="simpara">
							<span class="strong"><strong>网络位置：</strong></span>将二进制DVD ISO映像或安装树（二进制DVD ISO映像的提取内容）复制到网络位置，并使用以下协议通过网络执行安装：</p><div class="informalexample"><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
									<span class="strong"><strong>NFS：</strong></span>二进制DVD ISO映像位于网络文件系统（NFS）共享中。
								</li><li class="listitem">
									<span class="strong"><strong>HTTPS或HTTP：</strong></span>安装树位于可通过HTTP或HTTPS访问的网络位置。</li></ul></div></div><p class="simpara">与从TFTP服务器引导一起使用时，基于网络的安装很方便。这种方法消除了创建物理介质的需要，并允许您快速在多个系统上同时部署Red Hat Enterprise Linux。
						</p></li></ul></div><div class="itemizedlist"><p class="title"><strong>其他资源</strong></p><ul class="itemizedlist"><li class="listitem">
							<a class="xref" href="preparing-for-a-network-install_installing-rhel-as-an-experienced-user.html" title="Chapter 9. 准备使用PXE从网络安装">第11章， <em>准备使用PXE从网络安装</em></a>
						</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="ports-for-network-based-installation_creating-installation-sources-for-kickstart-installations"></a>基于网络的安装端口</h1></div></div></div><p>下表列出了必须在服务器上打开的端口，这些端口为每种基于网络的安装提供文件。
				</p><div class="table"><a id="idm139712775078592"></a><p class="title"><strong>表5.1。基于网络的安装端口</strong></p><div class="table-contents"><table border="1" summary="Ports for network-based installation"><colgroup><col class="col_1"><col class="col_2"></colgroup><thead><tr><th valign="top" style="text-align:left">使用的协议</th><th valign="top" style="text-align:left">港口开放</th></tr></thead><tbody><tr><td valign="top" style="text-align:left"> <p>HTTP</p>
								 </td><td valign="top" style="text-align:left"> <p>80</p>
								 </td></tr><tr><td valign="top" style="text-align:left"> <p>HTTPS</p>
								 </td><td valign="top" style="text-align:left"> <p>443</p>
								 </td></tr><tr><td valign="top" style="text-align:left"> <p>NFS</p>
								 </td><td valign="top" style="text-align:left"> <p>2049,111,2004</p>
								 </td></tr><tr><td valign="top" style="text-align:left"> <p>TFTP</p>
								 </td><td valign="top" style="text-align:left"> <p>69</p>
								 </td></tr></tbody></table></div></div><div class="itemizedlist"><p class="title"><strong>其他资源</strong></p><ul class="itemizedlist"><li class="listitem">有关详细信息，请参阅“ <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/securing_networks/index/"><span class="emphasis"><em>保护网络”</em></span></a>文档。
						</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="creating-an-installation-source_creating-installation-sources-for-kickstart-installations"></a>在NFS服务器上创建安装源</h1></div></div></div><p>按照此过程中的步骤将安装源放在NFS服务器上。使用此安装方法可以从单个源安装多个系统，而无需连接到物理介质。
				</p><h3><a id="prerequisites"></a>先决条件</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">您具有对具有Red Hat Enterprise Linux 8的服务器的管理级访问权限，并且此服务器与要安装的系统位于同一网络上。
						</li><li class="listitem">您已下载二进制DVD映像。有关详细信息，请参阅从<span class="emphasis"><em>执行标准RHEL安装</em></span>文档<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#downloading-beta-installation-images_preparing-for-your-installation">下载安装ISO映像</a> 。
						</li><li class="listitem">您已从映像文件创建了可引导的CD，DVD或USB设备。有关详细信息，请参阅<span class="emphasis"><em>执行标准RHEL安装</em></span>文档中的<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#making-media_preparing-for-your-installation">创建安装介质</a> 。
						</li><li class="listitem">您已验证防火墙允许您安装的系统访问远程安装源。有关详细信息，请参阅<span class="emphasis"><em>执行标准RHEL安装</em></span>文档中<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#ports-for-network-based-installation_prepare-installation-source">的基于网络的安装的端口</a> 。
						</li></ul></div><h3><a id="procedure"></a>程序</h3><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">安装<code class="literal">nfs-utils</code>包：</p><pre class="screen"># yum install nfs-utils</pre></li><li class="listitem">将二进制DVD ISO映像复制到NFS服务器上的目录。
						</li><li class="listitem"><p class="simpara">使用文本编辑器打开<code class="literal">/etc/exports</code>文件，并使用以下语法添加一行：</p><pre class="screen">/<span class="emphasis"><em>exported_directory</em></span>/ <span class="emphasis"><em>clients</em></span></pre></li><li class="listitem"><p class="simpara">将<span class="emphasis"><em>/ exported_directory /</em></span>替换为带有ISO映像的目录的完整路径。使用目标系统的主机名或IP地址替换<span class="emphasis"><em>客户端</em></span> ，所有目标系统可用于访问ISO映像的子网，或者如果要允许任何具有NFS服务器网络访问权限的系统，则使用星号（ <code class="literal">*</code> ）使用ISO映像。有关此字段格式的详细信息，请参见<code class="literal">exports(5)</code>手册页。
						</p><p class="simpara">使<code class="literal">/rhel8-install/</code>目录以只读方式提供给所有客户端的基本配置是：</p><pre class="screen">/rhel8-install *</pre></li><li class="listitem">保存<code class="literal">/etc/exports</code>文件并退出文本编辑器。
						</li><li class="listitem"><p class="simpara">启动nfs服务：</p><pre class="screen"># systemctl start nfs-server.service</pre><p class="simpara">如果在更改<code class="literal">/etc/exports</code>文件之前服务正在运行，请对正在运行的NFS服务器运行以下命令以重新加载其配置：</p><pre class="screen"># systemctl reload nfs-server.service</pre><p class="simpara">现在可以通过NFS访问ISO映像，并可以将其用作安装源。
						</p></li></ol></div><div class="note" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title">注意</h3><p>配置安装源时，请使用<code class="literal">nfs:</code>作为协议，服务器主机名或IP地址，冒号<code class="literal">(:)</code>和保存ISO映像的目录。例如，如果服务器主机名是<code class="literal">myserver.example.com</code>并且您已在<code class="literal">/rhel8-install/</code>保存了ISO映像，请指定<code class="literal">nfs:myserver.example.com:/rhel8-install/</code>作为安装源。
					</p></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="creating-an-installation-source-on-http_creating-installation-sources-for-kickstart-installations"></a>使用HTTP或HTTPS创建安装源</h1></div></div></div><p>按照此过程中的步骤使用安装树为基于网络的安装创建安装源，安装树是包含二进制DVD ISO映像的提取内容和有效<code class="literal">.treeinfo</code>文件的目录。可以通过HTTP或HTTPS访问安装源。</p><h3><a id="prerequisites_2"></a>先决条件</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">您具有对具有Red Hat Enterprise Linux 8的服务器的管理级访问权限，并且此服务器与要安装的系统位于同一网络上。
						</li><li class="listitem">您已下载二进制DVD映像。有关详细信息，请参阅从<span class="emphasis"><em>执行标准RHEL安装</em></span>文档<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#downloading-beta-installation-images_preparing-for-your-installation">下载安装ISO映像</a> 。
						</li><li class="listitem">您已从映像文件创建了可引导的CD，DVD或USB设备。有关详细信息，请参阅<span class="emphasis"><em>执行标准RHEL安装</em></span>文档中的<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#making-media_preparing-for-your-installation">创建安装介质</a> 。
						</li><li class="listitem">您已验证防火墙允许您安装的系统访问远程安装源。有关详细信息，请参阅<span class="emphasis"><em>执行标准RHEL安装</em></span>文档中<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#ports-for-network-based-installation_prepare-installation-source">的基于网络的安装的端口</a> 。
						</li></ul></div><h3><a id="procedure_2"></a>程序</h3><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">安装<code class="literal">httpd</code>包：</p><pre class="screen"># yum install httpd</pre><div class="warning" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title">警告</h3><p>如果Apache Web服务器配置启用了SSL安全性，请验证是否仅启用TLSv1协议，并禁用SSLv2和SSLv3。这是由于POODLE SSL漏洞（CVE-2014-3566）。有关详细信息，请参阅<a class="link" href="https://access.redhat.com/solutions/1232413">https://access.redhat.com/solutions/1232413</a> 。
							</p></div><div class="important" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title">重要</h3><p>如果将HTTPS服务器与自签名证书一起使用，则必须使用<code class="literal">noverifyssl</code>选项引导安装程序。
							</p></div></li><li class="listitem">将二进制DVD ISO映像复制到HTTP（S）服务器。
						</li><li class="listitem"><p class="simpara">使用<code class="literal">mount</code>命令将Binary DVD ISO映像<code class="literal">mount</code>到合适的目录：</p><pre class="screen"># mount -o loop,ro -t iso9660 <span class="emphasis"><em>/image_directory/image.iso /mount_point/</em></span></pre><div class="informalexample"><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">将<span class="emphasis"><em>/image_directory/image.iso</em></span>替换为Binary DVD ISO映像的路径。
								</li><li class="listitem">将<span class="emphasis"><em>/ mount_point /</em></span>替换为您要在其中找到ISO映像内容的目录的路径。
								</li></ul></div></div></li><li class="listitem"><p class="simpara">将文件从挂载的映像复制到HTTP（S）服务器根目录。此命令使用图像的内容创建<code class="literal">/var/www/html/rhel8-install/</code>目录。
						</p><pre class="screen"># cp -r /mnt/rhel8-install/ /var/www/html/</pre></li><li class="listitem"><p class="simpara">启动<code class="literal">httpd</code>服务：</p><pre class="screen"># systemctl start httpd.service</pre><p class="simpara">现在可以访问安装树并准备好将其用作安装源。
						</p><div class="note" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title">注意</h3><p>配置安装源时，请使用<code class="literal">http://</code>或<code class="literal">https://</code>作为协议，服务器主机名或IP地址，以及包含ISO映像中相对于HTTP服务器根目录的文件的目录。例如，如果您使用的是HTTP，则服务器主机名为<code class="literal">myserver.example.com</code> ，并且您已将映像中的文件复制到<code class="literal">/var/www/html/rhel8-install/</code> ，并指定<code class="literal"><a class="link" href="http://myserver.example.com/rhel8-install/">http://myserver.example.com/rhel8-install/</a></code>作为安装源。
							</p></div></li></ol></div><h3><a id="additional_resources_2"></a>其他资源</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">有关HTTP服务器的详细信息，请参阅<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/deploying_different_types_of_servers/index/"><span class="emphasis"><em>部署不同类型的服务器</em></span></a>文档。
						</li></ul></div></div></div></body></html>