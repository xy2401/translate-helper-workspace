<html  xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 9. 安装程序和映像创建</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"></head><body ><div class="chapter"><div class="titlepage"><div><div><h1 class="title">Chapter 9. 安装程序和映像创建</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="add-ons_installation-and-booting"></a>附加组件</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="oscap"></a> OSCAP</h2></div></div></div><p>在Red Hat Enterprise Linux 8中默认启用OSCAP附加组件。
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="kdump"></a>内核转储</h2></div></div></div><p>Kdump附加组件增加了在安装期间配置内核崩溃转储的支持。此附加组件在Kickstart中完全支持（使用<code class="literal">%addon com_redhat_kdump</code>命令及其选项），并在图形和基于文本的用户界面中作为附加窗口完全集成。
				</p></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="installer-networking_installation-and-booting"></a>安装人员网络</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="device_naming_scheme"></a>设备命名方案</h2></div></div></div><p>Red Hat Enterprise Linux 8中提供了一种新的网络设备命名方案，该方案基于用户定义的前缀生成网络接口名称。<code class="literal">net.ifnames.prefix</code>引导选项允许安装程序和已安装的系统使用设备命名方案。有关信息，请参见<code class="literal">dracut.cmdline(7)</code>手册页。
				</p></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="installation-images-and-packages_installation-and-booting"></a>安装映像和包</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="unified_iso"></a>统一的ISO</h2></div></div></div><p>在Red Hat Enterprise Linux 8中，统一的ISO自动加载<span class="strong"><strong>BaseOS</strong></span>和<span class="strong"><strong>AppStream</strong></span>安装源存储库。此功能适用于安装期间加载的第一个基本存储库。例如，如果在未配置存储库的情况下引导安装，并在图形用户界面（GUI）中将统一ISO作为基本存储库，或者使用指向统一ISO的<code class="literal">inst.repo=</code>选项引导安装。</p><p>因此，AppStream存储<span class="strong"><strong>库</strong></span>在<span class="strong"><strong>Installation Source</strong></span> GUI窗口的<span class="strong"><strong>Additional Repositories</strong></span>部分下启用。您无法删除AppStream存储库或更改其设置，但您可以在<span class="strong"><strong>安装源中</strong></span>禁用它。如果使用其他基本存储库引导安装，然后将其更改为统一ISO，则此功能不起作用。如果这样做，则替换基本存储库。但是，AppStream存储库未替换并指向原始文件。
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="stage2_image"></a> Stage2图像</h2></div></div></div><p>在Red Hat Enterprise Linux 8中，可以指定<code class="literal">stage2</code>或Kickstart文件的多个网络位置以防止安装失败。此更新允许使用<code class="literal">inst.stage2</code>网络位置和Kickstart文件指定多个<code class="literal">inst.ks</code>和<code class="literal">stage2</code>引导选项。这避免了无法访问请求的文件并且安装失败的情况，因为与<code class="literal">stage2</code>或Kickstart文件的联系服务器不可访问。
				</p><p>通过此新更新，如果指定了多个位置，则可以避免安装失败。如果所有定义的位置都是URL，即<code class="literal">HTTP</code> ， <code class="literal">HTTPS</code>或<code class="literal">FTP</code> ，则将按顺序尝试它们，直到成功提取所请求的文件。如果存在不是URL的位置，则仅尝试最后指定的位置。其余位置将被忽略。
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="inst_addrepo_parameter"></a> inst.addrepo参数</h2></div></div></div><p>以前，您只能从内核引导参数指定基本存储库。在Red Hat Enterprise Linux 8中，新的内核参数<code class="literal">inst.addrepo=&lt;name&gt;,&lt;url&gt;</code>允许您在安装期间指定其他存储库。此参数有两个必需值：存储库的名称和指向存储库的URL。有关更多信息，请参阅<a class="link" href="https://anaconda-installer.readthedocs.io/en/latest/boot-options.html#inst-addrepo">inst-addrepo用法</a> 。
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="installation_from_an_expanded_iso"></a>从扩展的ISO安装</h2></div></div></div><p>Red Hat Enterprise Linux 8支持从本地硬盘驱动器上的存储库进行安装。以前，硬盘驱动器中唯一的安装方法是使用ISO映像作为安装源。但是，对于某些文件系统，Red Hat Enterprise Linux 8 ISO映像可能太大;例如，FAT32文件系统无法存储大于4 GiB的文件。在Red Hat Enterprise Linux 8中，您可以从本地硬盘驱动器上的存储库启用安装;您只需指定目录而不是ISO映像。例如： <code class="literal">inst.repo=hd:&lt;device&gt;:&lt;path to the repository&gt;</code> 。
				</p><p>有关Red Hat Enterprise Linux 8 BaseOS和AppStream存储库的更多信息，请参阅本文档的“ <span class="emphasis"><em>存储库”</em></span>部分。
				</p></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="graphical-user-interface_installation-and-booting"></a>安装程序图形用户界面</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="the_installation_summary_window"></a> “安装摘要”窗口</h2></div></div></div><p>Red Hat Enterprise Linux 8图形安装的“安装摘要”窗口已更新为新的三列布局，可改进图形安装设置的组织。
				</p></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="system-purpose_installation-and-booting"></a>系统目的RHEL中的新功能</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="system_purpose_support_in_the_graphical_installation"></a>图形安装中的系统用途支持</h2></div></div></div><p>以前，Red Hat Enterprise Linux安装程序未向Subscription Manager提供系统用途信息。在Red Hat Enterprise Linux 8中，您可以使用<span class="strong"><strong>System Purpose</strong></span>窗口在图形安装期间设置系统的预期用途，或使用<code class="literal">syspurpose</code>命令在Kickstart配置文件中设置系统的预期用途。设置系统目的时，授权服务器会接收有助于自动附加满足系统预期用途的订阅的信息。
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="system_purpose_support_in_pykickstart"></a> Pykickstart中的系统目的支持</h2></div></div></div><p>以前， <code class="literal">pykickstart</code>库无法向Subscription Manager提供系统用途信息。在Red Hat Enterprise Linux 8中， <code class="literal">pykickstart</code>解析新的<code class="literal">syspurpose</code>命令，并在自动和部分自动安装期间记录系统的预期用途。然后将信息传递给安装程序，保存在新安装的系统上，并在订阅系统时可用于Subscription Manager。
				</p></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="installer-module-support_installation-and-booting"></a>安装程序模块支持</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="installing_modules_using_kickstart"></a>使用Kickstart安装模块</h2></div></div></div><p>在Red Hat Enterprise Linux 8中，安装程序已扩展为处理所有模块化功能。Kickstart脚本现在可以启用模块和流组合，安装模块配置文件以及安装模块化程序包。
				</p></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="kickstart-changes_installation-and-booting"></a> Kickstart改变了</h1></div></div></div><p>下面的部分描述了Red Hat Enterprise Linux 8中Kickstart命令和选项的变化。
			</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="auth_or_authconfig_is_deprecated_in_rhel_8"></a>在RHEL 8中不推荐使用auth或authconfig</h2></div></div></div><p>在Red Hat Enterprise Linux 8中不推荐使用<code class="literal">auth</code>或<code class="literal">authconfig</code> Kickstart命令，因为已删除了<code class="literal">authconfig</code>工具和包。
				</p><p>与在命令行上发出的<code class="literal">authconfig</code>命令类似，Kickstart脚本中的<code class="literal">authconfig</code>命令现在使用<code class="literal">authselect-compat</code>工具来运行新的<code class="literal">authselect</code>工具。有关此兼容层及其已知问题的说明，请参见手册页<code class="literal">authselect-migration(7)</code> 。安装程序将自动检测已弃用命令的使用，并在系统上安装<code class="literal">authselect-compat</code>包以提供兼容层。
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="kickstart_no_longer_supports_btrfs"></a> Kickstart不再支持Btrfs</h2></div></div></div><p>Red Hat Enterprise Linux 8不支持Btrfs文件系统。因此，图形用户界面（GUI）和Kickstart命令不再支持Btrfs。
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="using_kickstart_files_from_previous_rhel_releases"></a>使用以前RHEL版本中的Kickstart文件</h2></div></div></div><p>如果您使用的是以前RHEL版本中的Kickstart文件，请参阅本文档的“ <span class="emphasis"><em>存储库”</em></span>部分，以获取有关Red Hat Enterprise Linux 8 BaseOS和AppStream存储库的更多信息。
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="deprecated-kickstart-comands-and-options_kickstart-changes"></a>不推荐的Kickstart命令和选项</h2></div></div></div><p>Red Hat Enterprise Linux 8中不推荐使用以下Kickstart命令和选项。在Kickstart文件中使用它们将在日志中打印警告。
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							<code class="literal">auth</code>或<code class="literal">authconfig</code> - 使用<code class="literal">authselect instead</code>
						</li><li class="listitem">
							<code class="literal">device</code>
						</li><li class="listitem">
							<code class="literal">deviceprobe</code>
						</li><li class="listitem">
							<code class="literal">dmraid</code>
						</li><li class="listitem">
							<code class="literal">install</code> - 直接使用子命令或方法作为命令</li><li class="listitem">
							<code class="literal">lilo</code>
						</li><li class="listitem">
							<code class="literal">lilocheck</code>
						</li><li class="listitem">
							<code class="literal">mouse</code>
						</li><li class="listitem">
							<code class="literal">multipath</code>
						</li><li class="listitem">
							<code class="literal">bootloader --upgrade</code>
						</li><li class="listitem">
							<code class="literal">ignoredisk --interactive</code>
						</li><li class="listitem">
							<code class="literal">partition --active</code>
						</li><li class="listitem">
							<code class="literal">reboot --kexec</code>
						</li></ul></div><p>如果仅列出特定选项，则base命令及其他选项仍可用，不会弃用。
				</p><p>另请注意，您可以使用<code class="literal">inst.ksstrict</code>引导选项将已弃用的命令警告转换为错误。
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="removed-kickstart-comands-and-options_kickstart-changes"></a>删除了Kickstart命令和选项</h2></div></div></div><p>Red Hat Enterprise Linux 8中已完全删除了以下Kickstart命令和选项。在Kickstart文件中使用它们将导致错误。
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							<code class="literal">upgrade</code> （此命令之前已被弃用。）
						</li><li class="listitem">
							<code class="literal">btrfs</code>
						</li><li class="listitem">
							<code class="literal">part/partition btrfs</code>
						</li><li class="listitem">
							<code class="literal">part --fstype btrfs</code>或<code class="literal">partition --fstype btrfs</code>
						</li><li class="listitem">
							<code class="literal">logvol --fstype btrfs</code>
						</li><li class="listitem">
							<code class="literal">raid --fstype btrfs</code>
						</li><li class="listitem">
							<code class="literal">unsupported_hardware</code>
						</li></ul></div><p>在仅列出特定选项和值的情况下，base命令及其他选项仍然可用且不会被删除。
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="new-kickstart-comands-and-options_kickstart-changes"></a>新的Kickstart命令和选项</h2></div></div></div><p>Red Hat Enterprise Linux 8中添加了以下命令和选项。
				</p><div class="itemizedlist"><p class="title"><strong>RHEL 8.0</strong></p><ul class="itemizedlist"><li class="listitem">
							<code class="literal">authselect</code>
						</li><li class="listitem">
							<code class="literal">module</code>
						</li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="image-creation_installation-and-booting"></a>图像创建</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="custom_system_image_creation_with_image_builder"></a>使用Image Builder自定义系统映像</h2></div></div></div><p>Image Builder工具使用户能够创建自定义的RHEL图像。Image Builder可以在<span class="strong"><strong><span class="package">lorax-composer</span></strong></span>包中的AppStream中使用。
				</p><p>使用Image Builder，用户可以创建包含其他包的自定义系统映像。可以通过以下方式访问Image Builder功能：</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">Web控制台中的图形用户界面</li><li class="listitem"><code class="literal">composer-cli</code>工具中的命令行界面。
						</li></ul></div><p>Image Builder输出格式包括：</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">现场ISO磁盘映像</li><li class="listitem">qcow2文件，可直接用于虚拟机或OpenStack</li><li class="listitem">文件系统映像文件</li><li class="listitem">Azure，VMWare和AWS的云图像</li></ul></div><p>要了解有关Image Builder的更多信息，请参阅文档标题<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/composing_a_customized_rhel_system_image/">撰写自定义RHEL系统映像</a> 。
				</p></div></div></div></body></html>