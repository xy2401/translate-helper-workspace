<html  xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 9. 扫描系统以确保安全合规性和漏洞</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"></head><body ><div class="chapter"><div class="titlepage"><div><div><h1 class="title">Chapter 9. 扫描系统以确保安全合规性和漏洞</h1></div></div></div><p>合规性审计是确定给定对象是否遵循合规性政策中规定的所有规则的过程。合规性策略由安全专业人员定义，安全专业人员通常以检查表的形式指定要在计算环境中使用的所需设置。
		</p><p>合规政策可能因组织甚至同一组织内的不同系统而有很大差异。这些政策之间的差异基于这些系统的目的及其对组织的重要性。自定义软件设置和部署特征也需要自定义策略清单。
		</p><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="security-compliance-tools-in-rhel_scanning-the-system-for-security-compliance-and-vulnerabilities"></a> RHEL中的安全合规性工具</h1></div></div></div><p>红帽企业Linux提供的工具允许完全自动化的合规性审计。这些工具基于安全内容自动化协议（SCAP）标准，旨在自动定制合规性策略。
			</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						<span class="strong"><strong>SCAP Workbench</strong></span> - <code class="literal">scap-workbench</code>图形实用程序旨在在单个本地或远程系统上执行配置和漏洞扫描。它还可用于根据这些扫描和评估生成安全报告。
					</li><li class="listitem">
						<span class="strong"><strong>OpenSCAP</strong></span> - <code class="literal">oscap</code>命令行实用程序旨在在本地系统上执行配置和漏洞扫描，验证安全合规性内容，并根据这些扫描和评估生成报告和指南。
					</li><li class="listitem">
						<span class="strong"><strong>SCAP安全指南（SSG）</strong></span> - <code class="literal">scap-security-guide</code>软件包为Linux系统提供最新的安全策略集合。该指南包含一系列实用强化建议，并在适用的情况下与政府要求相关联。该项目弥合了一般政策要求与具体实施准则之间的差距。
					</li><li class="listitem">
						<span class="strong"><strong>脚本检查引擎（SCE）</strong></span> -  SCE是SCAP协议的扩展，允许管理员使用脚本语言（如Bash，Python或Ruby）编写其安全内容。<code class="literal">openscap-engine-sce</code>包中提供了SCE扩展。
					</li></ul></div><p>如果您需要远程对多个系统执行自动合规性审计，则可以使用适用于Red Hat Satellite的OpenSCAP解决方案。
			</p><h3><a id="additional_resources_8"></a>其他资源</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						<code class="literal">oscap(8)</code> - <code class="literal">oscap</code>命令行实用程序的手册页提供了可用选项及其用法说明的完整列表。
					</li><li class="listitem">
						<code class="literal">scap-workbench(8)</code> - <code class="literal">SCAP Workbench</code>应用程序的手册页提供了有关应用程序的基本信息以及指向SCAP内容潜在来源的一些链接。
					</li><li class="listitem">
						<code class="literal">scap-security-guide(8)</code> - <code class="literal">scap-security-guide</code>项目的手册页提供了有关各种可用SCAP安全配置文件的更多文档。还提供了如何使用OpenSCAP实用程序利用提供的基准测试的示例。
					</li><li class="listitem">有关将OpenSCAP与Red Hat Satellite一起使用的更多详细信息，请参阅<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.3/html/administering_red_hat_satellite/chap-red_hat_satellite-administering_red_hat_satellite-security_compliance_management">“管理红帽卫星指南”中的安全合规性管理</a> 。
					</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="red-hat-security-advisories-oval-feed_scanning-the-system-for-security-compliance-and-vulnerabilities"></a>红帽安全咨询OVAL供稿</h1></div></div></div><p>红帽企业Linux安全审核功能基于安全内容自动化协议（SCAP）标准。SCAP是一个多用途规范框架，支持自动配置，漏洞和补丁检查，技术控制合规性活动和安全性测量。
			</p><p>SCAP规范创建了一个生态系统，其中安全内容的格式是众所周知和标准化的，而扫描程序或策略编辑器的实现并非强制要求。这种状态使组织能够一次性构建其安全策略（SCAP内容），无论他们使用多少安全供应商。
			</p><p>开放漏洞评估语言（OVAL）是SCAP的基本和最古老的组成部分。与其他工具或自定义脚本不同，OVAL语言以声明方式描述所需的资源状态。OVAL语言代码永远不会直接执行，而是通过名为scanner的OVAL解释器工具执行。OVAL的声明性质确保评估系统的状态不会被意外修改。
			</p><p>与所有其他SCAP组件一样，OVAL基于XML。 SCAP标准定义了几种文档格式。它们中的每一个都包含不同类型的信息，并且用于不同的目的。
			</p><p>
				<a class="link" href="https://access.redhat.com/security/team/">红帽产品安全</a>通过跟踪和调查影响红帽客户的所有安全问题，帮助客户评估和管理风险。它在红帽客户门户网站上提供及时，简洁的补丁和安全建议。Red Hat创建并支持OVAL补丁定义，提供我们安全建议的机器可读版本。
			</p><p><a class="link" href="https://www.redhat.com/security/data/oval/">RHSA OVAL定义</a>可单独提供，也可作为完整包提供，并在红帽客户门户网站上提供新安全建议后一小时内更新。
			</p><p>每个OVAL补丁定义都一对一地映射到红帽安全通报（RHSA）。由于RHSA可以包含针对多个漏洞的修复程序，因此每个漏洞都会通过其常见漏洞和披露（CVE）名称单独列出，并在我们的公共错误数据库中包含指向其条目的链接。
			</p><p>RHSA OVAL定义旨在检查系统上安装的RPM软件包的易受攻击版本。可以扩展这些定义以包括进一步检查 - 例如，查明软件包是否在易受攻击的配置中使用。这些定义旨在涵盖Red Hat提供的软件和更新。需要其他定义来检测第三方软件的修补程序状态。
			</p><h3><a id="additional_resources_9"></a>其他资源</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						<a class="link" href="https://access.redhat.com/articles/221883">Red Hat和OVAL的兼容性</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/articles/2123171">Red Hat和CVE的兼容性</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/security/overview">产品安全概述</a>中的<a class="link" href="https://access.redhat.com/security/updates/advisory">通知和建议</a>
					</li><li class="listitem">
						<a class="link" href="https://www.redhat.com/security/data/metrics/">安全数据指标</a>
					</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="scanning-the-system-for-vulnerabilities_scanning-the-system-for-security-compliance-and-vulnerabilities"></a>扫描系统是否存在漏洞</h1></div></div></div><p><code class="literal">oscap</code>命令行实用程序使用户能够扫描本地系统，验证安全合规性内容，并根据这些扫描和评估生成报告和指南。此实用程序充当OpenSCAP库的前端，并根据其处理的SCAP内容类型将其功能分组到模块（子命令）。
			</p><h3><a id="prerequisites_2"></a>先决条件</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><code class="literal">AppStream</code>存储库已启用。
					</li></ul></div><h3><a id="procedure_4"></a>程序</h3><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">安装<code class="literal">openscap-scanner</code>包：</p><pre class="screen"># yum install openscap-scanner</pre></li><li class="listitem"><p class="simpara">下载适用于您系统的最新RHSA OVAL定义：</p><pre class="screen"># wget https://www.redhat.com/security/data/oval/com.redhat.rhsa-RHEL8.xml</pre></li><li class="listitem"><p class="simpara">扫描系统是否存在漏洞并将结果保存到<span class="emphasis"><em>vulnerability.html</em></span>文件：</p><pre class="screen"># oscap oval eval --report <span class="emphasis"><em>vulnerability.html</em></span> Red_Hat_Enterprise_Linux_8.xml</pre><p class="simpara">您可以在您选择的浏览器中查看结果，例如：</p><pre class="screen">$ firefox <span class="emphasis"><em>vulnerability.html</em></span> &amp;</pre></li></ol></div><h3><a id="additional_resources_10"></a>其他资源</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><code class="literal">oscap(8)</code>手册页。
					</li><li class="listitem"><a class="link" href="https://www.redhat.com/security/data/oval/">Red Hat OVAL定义</a>列表。
					</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="scanning-remote-systems-for-vulnerabilities_scanning-the-system-for-security-compliance-and-vulnerabilities"></a>扫描远程系统是否存在漏洞</h1></div></div></div><p>您还可以使用OpenSCAP扫描程序检查远程系统是否存在漏洞。此功能由<code class="literal">oscap-ssh</code>工具通过SSH协议启用。
			</p><h3><a id="prerequisites_3"></a>先决条件</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><code class="literal">AppStream</code>存储库已启用。
					</li><li class="listitem"><code class="literal">openscap-scanner</code>包安装在远程系统上。
					</li><li class="listitem">SSH服务器正在远程系统上运行。
					</li></ul></div><h3><a id="procedure_5"></a>程序</h3><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">安装<code class="literal">openscap-utils</code>包：</p><pre class="screen"># yum install openscap-utils</pre></li><li class="listitem"><p class="simpara">下载适用于您系统的最新RHSA OVAL定义：</p><pre class="screen"># wget https://www.redhat.com/security/data/oval/Red_Hat_Enterprise_Linux_8.xml</pre></li><li class="listitem"><p class="simpara">使用<span class="emphasis"><em>machine1</em></span>主机名，端口22上运行的SSH以及漏洞的<span class="emphasis"><em>joesec</em></span>用户名扫描远程系统，并将结果保存到<span class="emphasis"><em>remote-vulnerability.html</em></span>文件：</p><pre class="screen"># oscap-ssh <span class="emphasis"><em>joesec@machine1</em></span> 22 oval eval --report <span class="emphasis"><em>remote-vulnerability.html</em></span> Red_Hat_Enterprise_Linux_8.xml</pre></li></ol></div><h3><a id="additional_resources_11"></a>其他资源</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><code class="literal">oscap-ssh(8)</code>手册页。
					</li><li class="listitem"><a class="link" href="https://www.redhat.com/security/data/oval/">Red Hat OVAL定义</a>列表。
					</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="assessing-security-compliance-with-a-specific-baseline_scanning-the-system-for-security-compliance-and-vulnerabilities"></a>评估特定基线的安全合规性</h1></div></div></div><p><code class="literal">SCAP Security Guide</code>套件以XCCDF，OVAL和数据流文档的形式提供多个平台的配置文件。<span class="emphasis"><em>配置文件</em></span>是一组基于安全策略的规则，例如操作系统保护配置文件（OSPP）或支付卡行业数据安全标准（PCI-DSS）。这使您能够以安全标准的自动方式审核系统。
			</p><h3><a id="prerequisites_4"></a>先决条件</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><code class="literal">openscap-scanner</code>包已安装。
					</li></ul></div><h3><a id="procedure_6"></a>程序</h3><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">安装<code class="literal">scap-security-guide</code>软件包：</p><pre class="screen"># yum install scap-security-guide</pre></li><li class="listitem"><p class="simpara">使用<code class="literal">oscap info</code>子命令显示有关所选数据流的详细信息。在“ <code class="literal">Profiles</code>部分中，您可以找到可用个人档案及其ID的列表：</p><pre class="screen">$ oscap info /usr/share/xml/scap/ssg/content/ssg-rhel8-ds.xml
...
Profiles:
  Title: PCI-DSS v3 Control Baseline for Red Hat Enterprise Linux 8
    Id: xccdf_org.ssgproject.content_profile_pci-dss
  Title: OSPP - Protection Profile for General Purpose Operating Systems
    Id: xccdf_org.ssgproject.content_profile_ospp
...
[trimmed for clarity]</pre><p class="simpara">从数据流文件中选择一个配置文件，并通过将上一个命令输出中标识的ID的最后一部分提供给<code class="literal">oscap info</code>的<code class="literal">--profile</code>选项，显示有关所选配置文件的更多详细<code class="literal">oscap info</code> 。例如，OSPP配置文件具有Id： <code class="literal">xccdf_org.ssgproject.content_profile_ospp</code> ，而<code class="literal">--profile</code>选项的值为<code class="literal">ospp</code> ：</p><pre class="screen">$ oscap info --profile ospp /usr/share/xml/scap/ssg/content/ssg-rhel8-ds.xml</pre><p class="simpara">PCI-DSS v3控制基线配置文件由<code class="literal">xccdf_org.ssgproject.content_profile_pci-dss</code>标识：</p><pre class="screen">$ oscap info --profile pci-dss /usr/share/xml/scap/ssg/content/ssg-rhel8-ds.xml
...
Description: Ensures PCI-DSS v3 related security configuration settings are applied.
[trimmed for clarity]</pre><p class="simpara">或者，在使用GUI时，安装<code class="literal">scap-security-guide-doc</code>软件包并打开<code class="literal"><a class="link" href="javascript:void(0);">file:///usr/share/doc/scap-security-guide/guides/ssg-rhel8-guide-index.html</a></code>网页浏览器。在<span class="emphasis"><em>“红帽企业版Linux 8安全配置指南”</em></span>文档的右上角字段中选择所需的配置文件后，您可以看到以下评估的相关命令。
					</p></li><li class="listitem"><p class="simpara">评估系统如何符合所选配置文件并将扫描结果保存在<span class="emphasis"><em>report.html</em></span> HTML文件中，例如：</p><pre class="screen">$ oscap xccdf eval --report <span class="emphasis"><em>report.html</em></span> --profile ospp /usr/share/xml/scap/ssg/content/ssg-rhel8-ds.xml</pre><p class="simpara">通过在系统上安装<code class="literal">openscap-utils</code>软件包并在远程系统上安装<code class="literal">openscap-scanner</code>软件包，您还可以使用<span class="emphasis"><em>machine1</em></span>主机名，端口22上运行的SSH以及漏洞的<span class="emphasis"><em>joesec</em></span>用户名扫描远程系统并保存结果到<span class="emphasis"><em>remote-report.html</em></span>文件：</p><pre class="screen">$ oscap-ssh joesec@machine1 22 xccdf eval --report remote_report.html --profile ospp /usr/share/xml/scap/ssg/content/ssg-rhel8-ds.xml</pre></li></ol></div><h3><a id="additional_resources_12"></a>其他资源</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						<code class="literal">scap-security-guide(8)</code>手册页</li><li class="listitem">SCAP安全指南文档安装在<code class="literal"><a class="link" href="javascript:void(0);">file:///usr/share/doc/scap-security-guide/</a></code>目录中。
					</li><li class="listitem">随<code class="literal">scap-security-guide-doc</code>软件包一起安装<a class="link" href="javascript:void(0);">的Red Hat Enterprise Linux 8安全配置</a> <code class="literal">scap-security-guide-doc</code> 。
					</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="related-information-scanning-the-system-for-security-compliance-and-vulnerabilities"></a>相关信息</h1></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						<a class="link" href="http://www.open-scap.org">OpenSCAP项目页面</a> - <a class="link" href="http://www.open-scap.org">OpenSCAP项目</a>的主页提供有关oscap实用程序以及与SCAP相关的其他组件和项目的详细信息。</li><li class="listitem">
						<a class="link" href="https://www.open-scap.org/tools/scap-workbench/">SCAP Workbench项目页面</a> - <a class="link" href="https://www.open-scap.org/tools/scap-workbench/">SCAP Workbench项目</a>的主页提供了有关scap-workbench应用程序的详细信息。
					</li><li class="listitem">
						<a class="link" href="https://www.open-scap.org/security-policies/scap-security-guide/">SCAP安全指南（SSG）项目页面</a> - <a class="link" href="https://www.open-scap.org/security-policies/scap-security-guide/">SSG项目</a>的主页，为Red Hat Enterprise Linux提供最新的安全内容。
					</li><li class="listitem">
						<a class="link" href="http://scap.nist.gov/">美国国家标准与技术研究院（NIST）SCAP页面</a> - 此页面代表了大量SCAP相关材料，包括SCAP出版物，规范和SCAP验证程序。
					</li><li class="listitem">
						<a class="link" href="http://nvd.nist.gov/">国家漏洞数据库（NVD）</a> - 此页面代表最大的SCAP内容存储库和其他基于SCAP标准的漏洞管理数据。
					</li><li class="listitem">
						<a class="link" href="http://www.redhat.com/security/data/oval/">Red Hat OVAL内容存储库</a> - 这是一个包含针对Red Hat Enterprise Linux系统漏洞的OVAL定义的存储库。这是漏洞内容的推荐来源。
					</li><li class="listitem">
						<a class="link" href="http://cve.mitre.org/">MITER CVE</a> - 这是一个由MITRE公司提供的公知安全漏洞数据库。对于RHEL，建议使用Red Hat提供的OVAL CVE内容。
					</li><li class="listitem">
						<a class="link" href="http://oval.mitre.org/">MITER OVAL</a> - 此页面代表MITRE公司提供的OVAL相关项目。在其他与OVAL相关的信息中，这些页面包含OVAL语言的最新版本以及具有数千个OVAL定义的OVAL内容存储库。请注意，对于扫描RHEL，建议使用Red Hat提供的OVAL CVE内容。
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en/red-hat-satellite/">Red Hat Satellite文档</a> - 这套指南介绍了如何使用OpenSCAP在多个系统上维护系统安全性等主题。</li></ul></div></div></div></body></html>